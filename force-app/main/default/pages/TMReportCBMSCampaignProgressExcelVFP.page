<apex:page controller="TMReportCBMSCampaignProgressCtrl" contentType="txt/xml#TMReportCBMSCampaignProgress.xls" cache="true" readOnly="true" id="TMReportCBMSCampaignProgressExcelVFP">
<apex:outputText value="{!xlsHeader}"/>
    <Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"
    xmlns:o="urn:schemas-microsoft-com:office:office"
    xmlns:x="urn:schemas-microsoft-com:office:excel"
    xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"
    xmlns:html="http://www.w3.org/TR/REC-html40">
  <Styles>
  <Style ss:ID="Default" ss:Name="Normal">
   <Alignment ss:Vertical="Bottom"/>
   <Borders/>
   <Font ss:FontName="Calibri" x:Family="Swiss" ss:Size="9" ss:Color="#000000"/>
   <Interior/>
   <NumberFormat/>
   <Protection/>
  </Style>
  <Style ss:ID="m123">
   <Alignment ss:Horizontal="Center" ss:Vertical="Top" ss:ReadingOrder="LeftToRight"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
   </Borders>
   <Font ss:FontName="Arial" x:Family="Swiss" ss:Size="9" ss:Color="#000000"/>
   <Interior/>
   <NumberFormat/>
  </Style>
  <Style ss:ID="tbHeader">
   <Alignment ss:Horizontal="Center" ss:Vertical="Top" ss:ReadingOrder="LeftToRight"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
   </Borders>
   <Font ss:FontName="Arial" x:Family="Swiss" ss:Size="9" ss:Color="#000000" ss:Bold="1"/>
   <Interior/>
   <NumberFormat/>
  </Style>

<Style ss:ID="s62">
   <Borders/>
   <Font ss:FontName="Calibri" x:Family="Swiss" ss:Size="11"/>
   <Interior/>
  </Style>
  <Style ss:ID="s64">
   <Alignment ss:Vertical="Top" ss:ReadingOrder="LeftToRight" ss:WrapText="1"/>
   <Borders/>
   <Font ss:FontName="Verdana" x:Family="Swiss" ss:Size="9" ss:Color="#000000"/>
   <Interior/>
   <NumberFormat/>
  </Style>
  
  <Style ss:ID="stitle">
   <Alignment ss:Vertical="Top" ss:ReadingOrder="LeftToRight" ss:WrapText="1"/>
   <Borders/>
   <Font ss:FontName="Arial" x:Family="Swiss" ss:Size="9" ss:Color="#000000" ss:Bold="1"/>
   <Interior/>
   <NumberFormat/>
  </Style>
 </Styles>
 
 <apex:repeat value="{!wrapList}" var="witem">
 <apex:variable var="camp" value="{!witem.camp}" />
 <Worksheet ss:Name="{!witem.camp.campaign_no__c}">
   
  <Table ss:ExpandedColumnCount="255"  x:FullColumns="1"
   x:FullRows="1" ss:StyleID="s62" ss:DefaultRowHeight="14.55" ss:DefaultColumnWidth="70">
    <Column ss:AutoFitWidth="0" ss:Width="100"/>
    <Column ss:AutoFitWidth="0" ss:Width="100"/>

    <Row ss:AutoFitHeight="0" ss:Height="18">
      <Cell   ss:StyleID="stitle"><Data ss:Type="String">Business Partner:</Data></Cell>
      <Cell   ss:StyleID="stitle"><Data ss:Type="String">{!witem.BusinessPartnerName}</Data></Cell>
   </Row>
   <Row ss:AutoFitHeight="0" ss:Height="18">
      <Cell   ss:StyleID="stitle"><Data ss:Type="String">Batch No.:</Data></Cell>
      <Cell   ss:StyleID="stitle"><Data ss:Type="String">{!witem.camp.Name}</Data></Cell>
   </Row>
   <Row ss:AutoFitHeight="0" ss:Height="18">
      <Cell   ss:StyleID="stitle"><Data ss:Type="String">Product:</Data></Cell>
      <Cell   ss:StyleID="stitle"><Data ss:Type="String">{!camp.Core_Product__r.Name}</Data></Cell>
   </Row>
   <Row ss:AutoFitHeight="0" ss:Height="18">
      <Cell   ss:StyleID="stitle"><Data ss:Type="String">Base:</Data></Cell>
      <Cell   ss:StyleID="stitle"><Data ss:Type="String"><apex:outputText value="{!witem.Base}" label="Base" id="dBase"/></Data></Cell>
   </Row>
    <Row ss:AutoFitHeight="0" ss:Height="18">
      <Cell   ss:StyleID="stitle"><Data ss:Type="String">Start Date:</Data></Cell>
      <Cell   ss:StyleID="stitle"><Data ss:Type="String"><apex:OutputText value="{0,date,dd-MM-yyyy}" escape="true">
                            <apex:Param value="{!witem.StartDate}"/></apex:OutputText></Data></Cell>
   </Row>
   <Row ss:AutoFitHeight="0" ss:Height="18">
      <Cell   ss:StyleID="stitle"><Data ss:Type="String">End Date:</Data></Cell>
      <Cell   ss:StyleID="stitle"><Data ss:Type="String"><apex:OutputText value="{0,date,dd-MM-yyyy}" escape="true">
                            <apex:Param value="{!witem.CompleteDate}"/></apex:OutputText></Data></Cell>
   </Row>
   <Row ss:AutoFitHeight="0" ss:Height="18">
      <Cell   ss:StyleID="stitle"><Data ss:Type="String">Status:</Data></Cell>
      <Cell   ss:StyleID="stitle"><Data ss:Type="String"><apex:outputText value="{!witem.Status}" label="Status" id="dStatus"/></Data></Cell>
   </Row>

     
  
   
    <Row ss:AutoFitHeight="0"></Row>
    <Row ss:AutoFitHeight="0" ss:Height="18">
      <Cell ss:Index="1" ss:StyleID="tbHeader" ss:MergeDown="1"><Data ss:Type="String">Submission Date</Data></Cell>
      <Cell ss:Index="2" ss:StyleID="tbHeader" ss:MergeDown="1"><Data ss:Type="String">Contactable Name</Data></Cell>
      <Cell ss:Index="3" ss:StyleID="tbHeader" ss:MergeDown="1"><Data ss:Type="String">Contactable Rate(For Total)</Data></Cell>
      <Cell ss:Index="4" ss:StyleID="tbHeader" ss:MergeAcross="3"><Data ss:Type="String">Reasons for CANNOT Present</Data></Cell>
      <Cell ss:Index="8" ss:StyleID="tbHeader" ss:MergeDown="1"><Data ss:Type="String">Callable Name</Data></Cell>
      <Cell ss:Index="9" ss:StyleID="tbHeader" ss:MergeDown="1"><Data ss:Type="String">Callable Rate(For Total)</Data></Cell>
      <Cell ss:Index="10" ss:StyleID="tbHeader" ss:MergeAcross="{!witem.prdListSize+2}"><Data ss:Type="String">Successful Order</Data></Cell>
      <apex:variable var="curIndex" value="{!11+witem.prdListSize+2}" />
      <Cell ss:Index="{!curIndex}" ss:StyleID="tbHeader" ss:MergeDown="1"><Data ss:Type="String">Contactable Response Rate</Data></Cell>
      <apex:variable var="curIndex" value="{!curIndex + 1}" />
      <Cell ss:Index="{!curIndex}"  ss:StyleID="tbHeader" ss:MergeDown="1"><Data ss:Type="String">Callable Response Rate</Data></Cell>
      <apex:variable var="curIndex" value="{!curIndex + 1}" />
      <Cell ss:Index="{!curIndex}" ss:StyleID="tbHeader" ss:MergeDown="1"><Data ss:Type="String">Total Response Rate (For Total)</Data></Cell>
      <apex:variable var="curIndex" value="{!curIndex + 1}" />
      <Cell ss:Index="{!curIndex}" ss:StyleID="tbHeader" ss:MergeAcross="{!witem.prdListSize+2}"><Data ss:Type="String">AARP</Data></Cell>
      <apex:variable var="curIndex" value="{!curIndex + 1 + witem.prdListSize+2}" />
      <Cell ss:Index="{!curIndex}" ss:StyleID="tbHeader" ss:MergeDown="1"><Data ss:Type="String">AARP</Data></Cell>
      <apex:variable var="curIndex" value="{!curIndex + 1}" />
      <Cell ss:Index="{!curIndex}" ss:StyleID="tbHeader" ss:MergeDown="1"><Data ss:Type="String">Pending / Consider</Data></Cell>
      <apex:variable var="curIndex" value="{!curIndex + 1}" />
      <Cell ss:Index="{!curIndex}" ss:StyleID="tbHeader" ss:MergeDown="1"><Data ss:Type="String">Unsuccess</Data></Cell>
      <apex:variable var="curIndex" value="{!curIndex + 1}" />
      <Cell ss:Index="{!curIndex}" ss:StyleID="tbHeader" ss:MergeAcross="8"><Data ss:Type="String">Reason for Unsuccess</Data></Cell>
      <apex:variable var="curIndex" value="{!curIndex + 1 +8}" />
      <Cell ss:Index="{!curIndex}" ss:StyleID="tbHeader" ss:MergeAcross="4"><Data ss:Type="String">Reference Data</Data></Cell>   
    </Row>
 
    <Row ss:AutoFitHeight="0" ss:Height="18">
      <Cell  ss:Index="4" ss:StyleID="m123" ><Data ss:Type="String">Duplicate Selling</Data></Cell>
      <Cell  ss:Index="5" ss:StyleID="m123" ><Data ss:Type="String">Refuse to Talk</Data></Cell>
      <Cell  ss:Index="6" ss:StyleID="m123" ><Data ss:Type="String">Over/Under Age</Data></Cell>
      <Cell  ss:Index="7" ss:StyleID="m123" ><Data ss:Type="String">Not Eligible</Data></Cell>
     
      <apex:variable var="curIndex" value="{!10}" />
      <apex:repeat value="{!witem.ls_hdr_p1}" var="itemh1">
         <Cell  ss:Index="{!curIndex}" ss:StyleID="m123" ><Data ss:Type="String">{!itemh1}</Data></Cell>
         <apex:variable var="curIndex" value="{!curIndex + 1}" />
      </apex:repeat> 

      <Cell  ss:Index="{!curIndex}" ss:StyleID="m123" ><Data ss:Type="String">Cancel order</Data></Cell>
      <apex:variable var="curIndex" value="{!curIndex + 1}" /> 
      <apex:repeat value="{!witem.ls_hdr_p2}" var="itemh2">
         <Cell  ss:Index="{!curIndex}" ss:StyleID="m123" ><Data ss:Type="String">{!itemh2}</Data></Cell>
         <apex:variable var="curIndex" value="{!curIndex + 1}" />
      </apex:repeat>   
      <Cell  ss:Index="{!curIndex}" ss:StyleID="m123" ><Data ss:Type="String">Cancel</Data></Cell>
      <apex:variable var="curIndex" value="{!curIndex + 1}" />
      <Cell  ss:Index="{!curIndex}" ss:StyleID="m123" ><Data ss:Type="String">FINAL</Data></Cell> 
      <apex:variable var="curIndex" value="{!curIndex + 1 +3}" />    
 
       <apex:repeat value="{!witem.ls_hdr_p1}" var="itemh3">
         <Cell  ss:Index="{!curIndex}" ss:StyleID="m123" ><Data ss:Type="String">{!itemh3}</Data></Cell>
         <apex:variable var="curIndex" value="{!curIndex + 1}" />
      </apex:repeat>   
      <Cell  ss:Index="{!curIndex}" ss:StyleID="m123" ><Data ss:Type="String">Cancel order</Data></Cell>
      <apex:variable var="curIndex" value="{!curIndex + 1}" /> 
      <apex:repeat value="{!witem.ls_hdr_p2}" var="itemh4">
         <Cell  ss:Index="{!curIndex}" ss:StyleID="m123" ><Data ss:Type="String">{!itemh4}</Data></Cell>
         <apex:variable var="curIndex" value="{!curIndex + 1}" />
      </apex:repeat>   
      <Cell  ss:Index="{!curIndex}" ss:StyleID="m123" ><Data ss:Type="String">Cancel</Data></Cell>
      <apex:variable var="curIndex" value="{!curIndex + 1}" />
      <Cell  ss:Index="{!curIndex}" ss:StyleID="m123" ><Data ss:Type="String">FINAL</Data></Cell> 
      <apex:variable var="curIndex" value="{!curIndex + 1 +3}" />  

      <Cell  ss:Index="{!curIndex}" ss:StyleID="m123" ><Data ss:Type="String">Too Expensive</Data></Cell> 
      <apex:variable var="curIndex" value="{!curIndex + 1}" />  
      <Cell  ss:Index="{!curIndex}" ss:StyleID="m123" ><Data ss:Type="String">Many similar products</Data></Cell> 
      <apex:variable var="curIndex" value="{!curIndex + 1}" />  
      <Cell  ss:Index="{!curIndex}" ss:StyleID="m123" ><Data ss:Type="String">Not enough coverage</Data></Cell> 
      <apex:variable var="curIndex" value="{!curIndex + 1}" />  
      <Cell  ss:Index="{!curIndex}" ss:StyleID="m123" ><Data ss:Type="String">Others</Data></Cell> 
      <apex:variable var="curIndex" value="{!curIndex + 1}" />  
      <Cell  ss:Index="{!curIndex}" ss:StyleID="m123" ><Data ss:Type="String">Unemployed/ No money</Data></Cell> 
      <apex:variable var="curIndex" value="{!curIndex + 1}" />  
      <Cell  ss:Index="{!curIndex}" ss:StyleID="m123" ><Data ss:Type="String">Cancel order</Data></Cell> 
      <apex:variable var="curIndex" value="{!curIndex + 1}" />  
      <Cell  ss:Index="{!curIndex}" ss:StyleID="m123" ><Data ss:Type="String">No a/c  no credit card</Data></Cell> 
      <apex:variable var="curIndex" value="{!curIndex + 1}" />  
      <Cell  ss:Index="{!curIndex}" ss:StyleID="m123" ><Data ss:Type="String">Product not suitable</Data></Cell> 
      <apex:variable var="curIndex" value="{!curIndex + 1}" />  
      <Cell  ss:Index="{!curIndex}" ss:StyleID="m123" ><Data ss:Type="String">No interest</Data></Cell> 
      <apex:variable var="curIndex" value="{!curIndex + 1}" />  

      <Cell  ss:Index="{!curIndex}" ss:StyleID="m123" ><Data ss:Type="String">Difficult contact</Data></Cell> 
      <apex:variable var="curIndex" value="{!curIndex + 1}" />  
      <Cell  ss:Index="{!curIndex}" ss:StyleID="m123" ><Data ss:Type="String">DMC</Data></Cell> 
      <apex:variable var="curIndex" value="{!curIndex + 1}" />  
      <Cell  ss:Index="{!curIndex}" ss:StyleID="m123" ><Data ss:Type="String">Drop Call</Data></Cell> 
      <apex:variable var="curIndex" value="{!curIndex + 1}" />  
      <Cell  ss:Index="{!curIndex}" ss:StyleID="m123" ><Data ss:Type="String">Foreigner</Data></Cell> 
      <apex:variable var="curIndex" value="{!curIndex + 1}" />  
      <Cell  ss:Index="{!curIndex}" ss:StyleID="m123" ><Data ss:Type="String">Invalid</Data></Cell> 
      <apex:variable var="curIndex" value="{!curIndex + 1}" />   
 
    </Row>

    <apex:repeat value="{!witem.rows}" var="data">
    <Row ss:AutoFitHeight="0">
    <Cell ss:StyleID="m123" ><Data ss:Type="String"> 
      <apex:outputPanel layout="none" rendered="{!data.Idate <= Today() }">
          <apex:OutputText value="{0,date,yyyy-MM-dd}" escape="false">
          <apex:Param value="{!data.Idate}"/></apex:OutputText>
      </apex:outputPanel>
      <apex:outputPanel layout="none" rendered="{!data.Idate > Today() }">
          Grand Total
      </apex:outputPanel>
    </Data></Cell>  
    <Cell ss:StyleID="m123" ><Data ss:Type="String">{!data.ContactableName}</Data></Cell>  
    <Cell ss:StyleID="m123" ><Data ss:Type="String"><apex:outputText value="{0, Number,0.00%}">
                                        <apex:Param value="{!data.ContactableRate}"/>
                                    </apex:OutputText></Data></Cell>
    <Cell ss:StyleID="m123" ><Data ss:Type="String">{!data.DuplicateSelling}</Data></Cell>  
    <Cell ss:StyleID="m123" ><Data ss:Type="String">{!data.RefusetoTalk}</Data></Cell>  
    <Cell ss:StyleID="m123" ><Data ss:Type="String">{!data.OverUnderAge}</Data></Cell>  
    <Cell ss:StyleID="m123" ><Data ss:Type="String">{!data.NotEligible}</Data></Cell>  
    <Cell ss:StyleID="m123" ><Data ss:Type="String">{!data.CallableName}</Data></Cell>  
    <Cell ss:StyleID="m123" ><Data ss:Type="String"><apex:outputText value="{0, Number,0.00%}">
                                        <apex:Param value="{!data.CallableRate}"/>
                                    </apex:OutputText></Data></Cell> 
    <apex:repeat value="{!data.Ls_SucP1}" var="item">
        <Cell ss:StyleID="m123" ><Data ss:Type="String">{!item}</Data></Cell>  
    </apex:repeat>  
    <Cell ss:StyleID="m123" ><Data ss:Type="String">{!data.Can_SucP1}</Data></Cell>  
    <apex:repeat value="{!data.Ls_SucP2}" var="item">
        <Cell ss:StyleID="m123" ><Data ss:Type="String">{!item}</Data></Cell>  
    </apex:repeat>  
    <Cell ss:StyleID="m123" ><Data ss:Type="String">{!data.Can_SucP2}</Data></Cell>  
    <Cell ss:StyleID="m123" ><Data ss:Type="String">{!data.SOFINAL}</Data></Cell>  
    <Cell ss:StyleID="m123" ><Data ss:Type="String"><apex:outputText value="{0, Number,0.00%}">
                                <apex:Param value="{!data.ContactableResponseRate}"/>
                            </apex:OutputText></Data></Cell>
    <Cell ss:StyleID="m123" ><Data ss:Type="String"><apex:outputText value="{0, Number,0.00%}">
                                <apex:Param value="{!data.CallableResponseRate}"/>
                            </apex:OutputText></Data></Cell>    
    <Cell ss:StyleID="m123" ><Data ss:Type="String"><apex:outputText value="{0, Number,0.00%}">
                                <apex:Param value="{!data.TotalResponseRate}"/>
                            </apex:OutputText></Data></Cell>                             
    <apex:repeat value="{!data.Ls_AnpP1}" var="item1">
        <Cell ss:StyleID="m123" ><Data ss:Type="String"><apex:outputText value="{0, number, #,###.##}">
                                   <apex:param value="{!item1}" />
                             </apex:outputText></Data></Cell>  
    </apex:repeat>                     
    <Cell ss:StyleID="m123" ><Data ss:Type="String"><apex:outputText value="{0, number, #,###.##}">
                               <apex:param value="{!data.Can_AnpP1}" />
                            </apex:outputText></Data></Cell>                      
    <apex:repeat value="{!data.Ls_AnpP2}" var="item2">
        <Cell ss:StyleID="m123" ><Data ss:Type="String"><apex:outputText value="{0, number, #,###.##}">
                                    <apex:param value="{!item2}" />
                                </apex:outputText></Data></Cell>  
    </apex:repeat>                           
    <Cell ss:StyleID="m123" ><Data ss:Type="String"><apex:outputText value="{0, number, #,###.##}">
                               <apex:param value="{!data.Can_AnpP2}" />
                            </apex:outputText></Data></Cell>                         
    <Cell ss:StyleID="m123" ><Data ss:Type="String"><apex:outputText value="{0, number, #,###.##}">
                               <apex:param value="{!data.ANPFINAL}" />
                            </apex:outputText></Data></Cell>                     
    <Cell ss:StyleID="m123" ><Data ss:Type="String"><apex:outputText value="{0, number, #,###.##}">
                               <apex:param value="{!data.AARP}" />
                            </apex:outputText></Data></Cell>                     
    <Cell ss:StyleID="m123" ><Data ss:Type="String">{!data.PendingConsider}</Data></Cell>  
    <Cell ss:StyleID="m123" ><Data ss:Type="String">{!data.Unsuccess}</Data></Cell>  
    <Cell ss:StyleID="m123" ><Data ss:Type="String">{!data.UnsuccessTooExpensive}</Data></Cell>  
    <Cell ss:StyleID="m123" ><Data ss:Type="String">{!data.UnsuccessManysimilarproducts}</Data></Cell>  
    <Cell ss:StyleID="m123" ><Data ss:Type="String">{!data.UnsuccessNotenoughcoverage}</Data></Cell>  
    <Cell ss:StyleID="m123" ><Data ss:Type="String">{!data.UnsuccessOthers}</Data></Cell>                      
    <Cell ss:StyleID="m123" ><Data ss:Type="String">{!data.UnsuccessUnemployedNomoney}</Data></Cell>  
    <Cell ss:StyleID="m123" ><Data ss:Type="String">{!data.UnsuccessCancelorder}</Data></Cell>  
    <Cell ss:StyleID="m123" ><Data ss:Type="String">{!data.UnsuccessNoacnocreditcard}</Data></Cell>  
    <Cell ss:StyleID="m123" ><Data ss:Type="String">{!data.UnsuccessProductnotsuitable}</Data></Cell>  
    <Cell ss:StyleID="m123" ><Data ss:Type="String">{!data.UnsuccessNointerest}</Data></Cell>  
    <Cell ss:StyleID="m123" ><Data ss:Type="String">{!data.RDDifficultcontact}</Data></Cell>  
    <Cell ss:StyleID="m123" ><Data ss:Type="String">{!data.RDDMC}</Data></Cell>  
    <Cell ss:StyleID="m123" ><Data ss:Type="String">{!data.RDDropCall}</Data></Cell>  
    <Cell ss:StyleID="m123" ><Data ss:Type="String">{!data.RDForeigner}</Data></Cell>  
    <Cell ss:StyleID="m123" ><Data ss:Type="String">{!data.RDInvalid}</Data></Cell>  
  
    </row>
    </apex:repeat>
 

 
     </Table>
                                                            
 </Worksheet>
 </apex:repeat>
</Workbook>


</apex:page>