<!-- Page: page -->
<apex:page showHeader="false" controller="CustomerLandingPageCtrlUat" docType="html-5.0" title="{!$Label.Cigna_Customer_Portal_Home}" applyBodyTag="false" >  
    <head>
        <!-- Google Tag Manager -->
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm..js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-PGJ23KN');</script>
<!-- End Google Tag Manager -->
<title>{!$Label.Cigna_Customer_Portal_Home}</title>

        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width"/> 
        
        <style>
            body { overflow: hidden; }
            .bs .cigna-message-bar {
                position: absolute; 
                left: 0; 
                top: 51px; 
                width: 100%;
                padding: 5px;
                color: #fff;
            }


            body,html {
              overflow-y: hidden;
            }
            
            .bs .cigna-message-panel {
                width: 100%;
                background-color: rgba(240, 240, 240, 0.9);
                position: absolute;
                left: 0;
                padding: 10px 5px 10px 5px;
                z-index: 9;
                overflow-y: auto;
                max-height: 90%;
            }
            
            .bs .cigna-message-panel-msg {
                line-height: 1.5;
                margin-right: 0 !important; 
                margin-left: 0px !important;
                margin-bottom: 20px;
            }
            
            
            /**
            .cigna-message-panel-msg div i {
                cursor: pointer; 
                cursor: hand;
            }
            */
            
            .cigna-message-panel-msg{
                cursor: pointer; 
                cursor: hand;
            }
            
            .fa {
                line-height: inherit !important;
            }
            
            .bs .cigna-message-panel .message-highlight {
                font-weight: bold;
            }
            
            @media (max-width: 767px) {
                .bs .floating-button-container {
                    position: relative;
                }       
                
                .bs .floating-button-panel {
                    position: fixed;
                    bottom: 0px;
                    width: 100%;
                    left: 0;
                    padding-top:10px;
                    font-size: 12px;
                    text-align: center;
                } 
                .bs .floating-button-panel > div {
                    padding-left: 10px !important;
                    padding-right: 10px !important;
                }
                .bs .floating-button {
                    margin-bottom: 5px;
                    font-size: 0.8em;
                    text-transform: uppercase;
                    margin-top: 5px;
                }
                
                .bs .carousel-wrapper {
                    margin-top:0px;
                }
                
                #template-templateBody{
                    position: fixed !important;
                    top: 51px;
                    right: 0px;
                    left: 0px;
                    bottom: 0px;
                }
                .bs .cigna-message-bar {
                    position: relative;
                    top: 0px;
                }
            }
            
            .owl-pagination {
                position: absolute;
                top: 0;
                left: 50%;
            }
            
            .owl-pagination .owl-page {
                position: relative;
                left: -50%;
            }
            
            .owl-buttons {
                position: absolute;
                top: 0;
                left: 50%;
            }
            .owl-buttons > div {
                left: -50%;
                position: relative;
            }
            
            .owl-theme .owl-controls .owl-page span {
                background-color: #eee;
            }
            
            .owl-banner-desc {
                position: absolute;
                color: #fff;
                top: 0;
                width: 100%;
                margin-top: 25px;
                text-align: center;
            }
            
            .owl-banner-desc > div {
                width: 70%;
                margin: 0 auto;
                padding-top: 10px;
            }
            .owl-banner-desc > div > h3 {
                font-family: "Gotham SSm A", "Gotham SSm B", "Microsoft Jhenghei", "LiHei Pro", "Heiti TC", Arial, Helvetica, sans-serif;
                font-style: normal;
                font-weight: 500;
            }
            
            .bs .cigna-message-bar {
                padding-top:10px;
                padding-bottom: 10px;
            }
            
            @media (min-width: 768px) and (max-width: 991px) {
                .bs .cigna-message-bar {
                    padding-top:12px;
                    height: 84px;
                }
                .bs .carousel-wrapper {
                    margin-top:84px;
                }
            }
            
            @media (max-width: 767px) {
                .bs .cigna-message-bar {
                    padding-top:10px !important;
                    padding-bottom:10px !important;
                }
            }
            
            @media (min-width: 992px) {
                .bs .carousel-wrapper {
                    margin-top:84px;
                }
                
                .bs .cigna-message-bar div {
                    padding: 5px;
                    
                }
            
                .bs .cigna-message-bar {
                    height: 84px;
                }
            }
            
            .bs .owl-item img {
                -webkit-filter: brightness(0.8);
                filter: brightness(0.8);
            }
            
            .breakAWord {
                //word-break: break-all;
                word-wrap: break-word;
            }
        </style>

        <apex:stylesheet value="{!URLFOR($Resource.DD_Demo, 'owl.carousel/owl.carousel.css')}" />
        <apex:stylesheet value="{!URLFOR($Resource.DD_Demo, 'owl.carousel/owl.theme.css')}" />
        <apex:stylesheet value="{!URLFOR($Resource.DD_Demo, 'owl.carousel/owl.transitions.css')}" />
        <apex:stylesheet value="{!URLFOR($Resource.Cigna_HK_Icons, 'Cigna-HK-Icons.css')}"/>
        <!-- CR-56_Link_20220214 -->
        <script type="text/javascript" src="{!URLFOR($Resource.DD_Demo, 'js/jquery-3.6.0.min.js')}"/>
        <apex:include pageName="CignaUtilJS"/> 
        
    </head>
    <body>
<!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PGJ23KN"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->
    <!-- Start of the page template -->
    <apex:composition template="CustomerPageTemplate">
    
    <!-- Start of the main body -->
    <apex:define name="body">
        <!--
        <div class="page-header">
            <h3>Coming Soon.</h3>
        </div>
        -->
        <!--<apex:actionStatus id="loader-icon">
            <!--<apex:facet name="start">
                <div class="bs col-xs-12 col-lg-12 loading-div" style="padding: 0px;">
                    <span class="loading-helper"></span>
                    <i class="spinner-icon fa fa-spinner fa-pulse fa-3x fa-fw"></i>
                    <span class="sr-only">Loading...</span>
                </div>
            </apex:facet>
        </apex:actionStatus> -->
        <apex:form id="customerLandingForm">
            
            <!-- <apex:outputPanel id="memoPanel"> -->
            <apex:outputPanel id="SubmemoPanel">
                <apex:outputPanel rendered="{!$Label.Header_Language_Code == 'en_US'}">
                <a id="cigna-message-bar" href="#" style="color: #fff;">
                    <div class="bs cigna-message-bar {!IF(numberOfMessages == 0, 'cigna-bg-blue-dark', 'cigna-bg-orange-dark')}" style="{!IF(numberOfMessages == 0, 'cursor:default;', 'cursor:pointer; cursor:hand;')}">
                        <div class="bs visible-sm" style="padding:22px;"></div>
                        <div class="bs hidden-xs hidden-sm" style="padding:20px;"></div>
                        <div class="bs col-sm-4 col-md-3" style="display: inline-block;width: initial !important;"><h5 style="margin: 5px;white-space: nowrap;">{!$Label.CUS_Welcome_To_Cigna} {!$User.FirstName}!</h5></div>
                        <div class="bs col-sm-8 col-md-9" style="width: initial !important;{!IF(numberOfMessages == 0, 'display:none;', 'display: inline-block;')}"> <!--  col-sm-4 col-md-2  col-sm-8 col-md-10 -->
                            <h5 style="margin: 5px;">
                                <apex:outputText value="{!$Label.You_have_number_messages}" >
                                    <apex:param value="{!numberOfMessages}" />
                                </apex:outputText>
                                <i class="ci-hk-caution" aria-hidden="true"></i>
                            </h5>
                        </div>
                        <div style="float: right;{!IF(numberOfMessages == 0, 'display:none;', 'display: inline-block;')}">
                            <i class="pull-right ci-hk-arrow-27" aria-hidden="true" style="margin-right: 5px;"></i>
                        </div>
                        <!-- Ray's Updates -->
                        <div class="bs " style="display: inline-block;float: right;">
                            <apex:actionStatus id="loader-icon">
                                <apex:facet name="start">
                                    <i class="spinner-icon fa fa-spinner fa-pulse fa-fw" style="margin-right: 5px;"></i>
                                </apex:facet>
                            </apex:actionStatus>
                            <apex:actionFunction name="loadPendingMemoMsg" action="{!loadPendingMemoMsg}" status="loader-icon" rerender="SubmemoPanel" oncomplete="Cigna.Home.initDisplay();"/>
                        </div>              
                    </div>
                </a>
                </apex:outputPanel>
                <apex:outputPanel rendered="{!$Label.Header_Language_Code == 'zh_TW'}">
                <a id="cigna-message-bar" href="#" style="color: #fff;">
                    <div class="bs cigna-message-bar {!IF(numberOfMessages == 0, 'cigna-bg-blue-dark', 'cigna-bg-orange-dark')}" style="{!IF(numberOfMessages == 0, 'cursor:default;padding-top:14.5px', 'cursor:pointer; cursor:hand;padding-top:14.5px')}">
                        <div class="bs visible-sm" style="padding:22px;"></div>
                        <div class="bs hidden-xs hidden-sm" style="padding:20px;"></div>
                        <div class="bs col-sm-4 col-md-3" style="display: inline-block;width: initial !important;"><h5 style="margin: 5px;white-space: nowrap;">{!$Label.CUS_Welcome_To_Cigna} {!$User.FirstName}!</h5></div>
                        <div class="bs col-sm-8 col-md-9" style="width: initial !important;{!IF(numberOfMessages == 0, 'display:none;', 'display: inline-block;')}"> <!--  col-sm-4 col-md-2  col-sm-8 col-md-10 -->
                            <h5 style="margin: 5px;">
                                <apex:outputText value="{!$Label.You_have_number_messages}" >
                                    <apex:param value="{!numberOfMessages}" />
                                </apex:outputText>
                                <i class="ci-hk-caution" aria-hidden="true"></i>
                            </h5>
                        </div>
                        <div style="float: right;{!IF(numberOfMessages == 0, 'display:none;', 'display: inline-block;')}">
                            <i class="pull-right ci-hk-arrow-27" aria-hidden="true" style="margin-right: 5px;"></i>
                        </div>
                        <!-- Ray's Updates -->
                        <div class="bs " style="display: inline-block;float: right;">
                            <apex:actionStatus id="loader-icon-2">
                                <apex:facet name="start">
                                    <i class="spinner-icon fa fa-spinner fa-pulse fa-fw" style="margin-right: 5px;"></i>
                                </apex:facet>
                            </apex:actionStatus>
                            <apex:actionFunction name="loadPendingMemoMsg" action="{!loadPendingMemoMsg}" status="loader-icon-2" rerender="SubmemoPanel" oncomplete="Cigna.Home.initDisplay();"/>
                        </div>              
                    </div>
                </a>
                </apex:outputPanel>
                
                <div class="bs carousel-wrapper"> <!-- class="bs container-fluid"  -->
                    <!-- div class="bs visible-xs" style="{!IF(numberOfMessages == 0, '', 'padding-top:17px;')}"></div -->
                    
                    <div class="bs row" style="{!IF(numberOfMessages == 0, 'display:none;', '')}">
                        <div id="mobile-msg-panel" class="bs cigna-message-panel" style="display: none !important;">
                            <div class="bs row cigna-message-panel-msg hidden-xs" style="cursor:default;">
                                <div class="bs col-sm-1">No.</div>
                                <div class="bs col-sm-2">{!$Label.Policy_No}</div>
                                <div class="bs col-sm-3">{!$Label.Category}</div>
                                <div class="bs col-sm-3">{!$Label.Type}</div>
                                <div class="bs col-sm-3">{!$Label.Last_Updated_Date}</div> 
                            </div>
                            
                            <apex:variable var="memoCount" value="{!1}" />
                            <apex:repeat value="{!memoSummaryList}" var="memoSummary">
                                <apex:outputPanel id="pcPanel" rendered="{!memoSummary.memo != null}">
                                    <div class="bs row cigna-message-panel-msg" onclick="Cigna.Util.navigateToVFP('PendingMemoVFP?requestId={!memoSummary.memo.requestId}&category={!memoSummary.category}')">
                                        <div class="bs col-sm-1 hidden-xs message-highlight">{!memoCount} </div>
                                        <div class="bs col-xs-6 col-sm-2 message-highlight breakAWord ">
                                            <apex:outputText value="{!IF(memoSummary.memo.policyNumber == '', '&nbsp;' ,memoSummary.memo.policyNumber)}" escape="false" />
                                        </div>
                                        <div class="bs col-xs-6 col-sm-3 message-highlight breakAWord ">
                                            <apex:outputText value="{!IF(memoSummary.fullCategory == '', '&nbsp;' ,memoSummary.fullCategory)}" escape="false" />
                                            <i class="ci-hk-arrow-31 pull-right visible-xs" aria-hidden="true" ></i>
                                        </div>
                                        <div class="bs col-xs-6 visible-xs">{!$Label.Type}</div>
                                        <div class="bs col-xs-6 col-sm-3 message-highlight breakAWord ">
                                            <!-- <apex:outputText value="{!IF(memoSummary.memo.workItem == '', '&nbsp;' ,memoSummary.memo.workItem)}" escape="false" /> -->
                                            <apex:outputText value="{!IF(memoSummary.memo.salesForceWorkType == '', '&nbsp;' ,memoSummary.memo.salesForceWorkType)}" escape="false" />
                                        </div>
                                        <div class="bs col-xs-6 visible-xs">{!$Label.Last_Updated_Date}</div>
                                        <div class="bs col-xs-6 col-sm-3 message-highlight breakAWord ">      
                                            <apex:outputText value="{0, date, yyyy/MM/dd}">
                                                <apex:param value="{!memoSummary.memo.statusUpdatedDateTime  }"/>
                                            </apex:outputText>
                                            <i class="ci-hk-arrow-31 pull-right hidden-xs" aria-hidden="true"></i>
                                        </div>
                                    </div>
                                </apex:outputPanel>
                                <apex:outputPanel id="claimPanel" rendered="{!memoSummary.claimMemo != null}">
                                    <div class="bs row cigna-message-panel-msg" onclick="Cigna.Util.navigateToVFP('PendingMemoVFP?requestId={!memoSummary.claimMemo.claimNumber}&category={!memoSummary.category}')">
                                        <div class="bs col-sm-1 hidden-xs message-highlight">{!memoCount} </div>
                                        <div class="bs col-xs-6 col-sm-2 message-highlight breakAWord ">
                                            <apex:outputText value="{!IF(memoSummary.claimMemo.polNumber == '', '&nbsp;' ,memoSummary.claimMemo.polNumber )}" escape="false" />
                                        </div>
                                        <div class="bs col-xs-6 col-sm-3 message-highlight breakAWord ">
                                            <apex:outputText value="{!IF(memoSummary.fullCategory == '', '&nbsp;' ,memoSummary.fullCategory)}" escape="false" />
                                            <i class="ci-hk-arrow-31 pull-right visible-xs" aria-hidden="true" ></i>
                                        </div>
                                        <div class="bs col-xs-6 visible-xs">{!$Label.Type}</div>
                                        <div class="bs col-xs-6 col-sm-3 message-highlight breakAWord ">
                                            <apex:outputText value="{!IF(memoSummary.claimMemo.claimTypeDisplay == '', 'N/A' ,memoSummary.claimMemo.claimTypeDisplay )}" escape="false" />
                                        </div>
                                        <div class="bs col-xs-6 visible-xs">{!$Label.Last_Updated_Date}</div>
                                        <div class="bs col-xs-6 col-sm-3 message-highlight breakAWord ">      
                                            <apex:outputText value="{0, date, yyyy/MM/dd}">
                                                <apex:param value="{!memoSummary.claimMemo.lastUpdateDateInDate }"/>
                                            </apex:outputText>
                                            <i class="ci-hk-arrow-31 pull-right hidden-xs" aria-hidden="true"></i>
                                        </div>
                                    </div>
                                </apex:outputPanel>
                                <!--efulfillment -->
                                <apex:outputPanel id="docPanel" rendered="{!memoSummary.docMemo != null}">
                                    <div class="bs row cigna-message-panel-msg" onclick="redirectNewDoc(this);"
                                    data-atk="{!memoSummary.docMemo.attachmentKey }" data-pn="{!memoSummary.docMemo.policyNumber}"  data-pt="{!memoSummary.policyType}"  data-isc="{!memoSummary.isClaim}"
                                    data-claimno="{!memoSummary.docMemo.claimNo}" data-key="{!memoSummary.SHA256Key}">
                                        <div class="bs col-sm-1 hidden-xs message-highlight">{!memoCount} </div>
                                        <div class="bs col-xs-6 col-sm-2 message-highlight breakAWord ">
                                            <apex:outputText value="{!IF(memoSummary.docMemo.policyNumber == '', '&nbsp;' ,memoSummary.docMemo.policyNumber )}" escape="false" />
                                        </div>
                                        <div class="bs col-xs-6 col-sm-3 message-highlight breakAWord ">
                                            <apex:outputText value="{!IF(memoSummary.fullCategory == '', '&nbsp;' ,memoSummary.fullCategory)}" escape="false" />
                                            <i class="ci-hk-arrow-31 pull-right visible-xs" aria-hidden="true" ></i>
                                        </div>
                                        <div class="bs col-xs-6 visible-xs">{!$Label.Type}</div>
                                        <div class="bs col-xs-6 col-sm-3 message-highlight breakAWord ">
                                            <apex:outputText value="{!memoSummary.docMemo.documentLocation}" escape="false" />
                                        </div>
                                        <div class="bs col-xs-6 visible-xs">{!$Label.Last_Updated_Date}</div>
                                        <div class="bs col-xs-6 col-sm-3 message-highlight breakAWord ">      
                                            <apex:outputText value="{0, date, yyyy/MM/dd}">
                                                <apex:param value="{!memoSummary.docMemo.createdDateObj}"/>
                                            </apex:outputText>
                                            <i class="ci-hk-arrow-31 pull-right hidden-xs" aria-hidden="true"></i>
                                        </div>
                                    </div>

                                </apex:outputPanel>

                                <!-- 20190715 - Minghua - Bounce Back Emails / Undelivered SMS -->
                                <apex:outputPanel id="contactHPanel" rendered="{!memoSummary.contactHMemo != null}">
                                    <div class="bs row cigna-message-panel-msg" onclick="bounceBackEmailMsg();return false;">
                                        <div class="bs col-sm-1 hidden-xs message-highlight">{!memoCount} </div>
                                        <div class="bs col-xs-6 col-sm-2 message-highlight breakAWord ">
                                            <apex:outputText value="{!IF(memoSummary.contactHMemo.messageId == '', '&nbsp;' ,memoSummary.contactHMemo.messageId)}" escape="false" />
                                        </div>
                                        <div class="bs col-xs-6 col-sm-3 message-highlight breakAWord ">
                                            <apex:outputText value="{!IF(memoSummary.fullCategory == '', '&nbsp;' ,memoSummary.fullCategory)}" escape="false" />
                                            <i class="ci-hk-arrow-31 pull-right visible-xs" aria-hidden="true" ></i>
                                        </div>
                                        <div class="bs col-xs-6 visible-xs">{!$Label.Type}</div>
                                        <div class="bs col-xs-6 col-sm-3 message-highlight breakAWord ">
                                            <apex:outputText value="{!IF(memoSummary.typeCon == '', '&nbsp;' ,memoSummary.typeCon)}" escape="false" />
                                        </div>
                                        <div class="bs col-xs-6 visible-xs">{!$Label.Last_Updated_Date}</div>
                                        <div class="bs col-xs-6 col-sm-3 message-highlight breakAWord ">      
                                            <apex:outputText value="{0, date, yyyy/MM/dd}">
                                                <apex:param value="{!memoSummary.contactHMemo.sentDateIntime}"/>
                                            </apex:outputText>
                                            <i class="ci-hk-arrow-31 pull-right hidden-xs" aria-hidden="true"></i>
                                        </div>
                                    </div>
                                </apex:outputPanel>
                                <!-- 20191224 Terry ESignature Require -->
                                <apex:outputPanel id="srPanel" rendered="{!memoSummary.signatureMemo != null}">
                                    <div class="bs row cigna-message-panel-msg" onclick="window.location='{!memoSummary.signatureMemo.E_Signature_URL__c}'">
                                        <div class="bs col-sm-1 hidden-xs message-highlight">{!memoCount} </div>
                                        <div class="bs col-xs-6 col-sm-2 message-highlight breakAWord ">
                                            <apex:outputText value="{!IF(memoSummary.signatureMemo.Policy_Number__c == '', '&nbsp;' ,memoSummary.signatureMemo.Policy_Number__c)}" escape="false" />
                                        </div>
                                        <div class="bs col-xs-6 col-sm-3 message-highlight breakAWord ">
                                            <apex:outputText value="{!IF(memoSummary.signatureMemo.Request_Type__c == '', '&nbsp;' , IF(memoSummary.signatureMemo.Request_Type__c=='Claim',$Label.Claims,$Label.Policy_Change))}" escape="false" />
                                            <i class="ci-hk-arrow-31 pull-right visible-xs" aria-hidden="true" ></i>
                                        </div>
                                        <div class="bs col-xs-6 visible-xs">{!$Label.Type}</div>
                                        <div class="bs col-xs-6 col-sm-3 message-highlight breakAWord ">
                                            <apex:outputText value="{!$Label.Signature_Require}" escape="false" />
                                        </div>
                                        <div class="bs col-xs-6 visible-xs">{!$Label.Last_Updated_Date}</div>
                                        <div class="bs col-xs-6 col-sm-3 message-highlight breakAWord ">      
                                            <apex:outputText value="{0, date, yyyy/MM/dd}">
                                                <apex:param value="{!memoSummary.signatureMemo.lastModifiedDate }"/>
                                            </apex:outputText>
                                            <i class="ci-hk-arrow-31 pull-right hidden-xs" aria-hidden="true"></i>
                                        </div>
                                    </div>
                                </apex:outputPanel>
                                
                                <apex:variable var="memoCount" value="{!memoCount + 1}" />
                            </apex:repeat>

                            <!-- 20190715 - Minghua - Bounce Back Emails / Undelivered SMS -->
                            <apex:outputPanel id="msgdiv"  rendered="{!transField != null && transField['BounceBackEmailMsg'] != null}">
                                <div id="overlayBounce" class="overlay" style="display:none;">
                                    <div id="confirmBox" class="ConfirmBox">
                                        <div id="delmsg" class="alertmsg">
                                            {!transField['BounceBackEmailMsg'][$label.Header_Language_Code_Current]}
                                        </div>
                                        <div class="bs col-xs-6 col-sm-6">
                                            <i class="glyphicon glyphicon-ok-sign oksign onclick-pointer" onclick="confirmNiv('true')"></i>
                                        </div>
                                        <div class="bs col-xs-6 col-sm-6">
                                            <i class="glyphicon glyphicon-remove-sign cancelsign onclick-pointer" onclick="confirmNiv('false')"></i>
                                        </div>
                                    </div>
                                </div>
                            </apex:outputPanel>
                            <script>
                                /*efulfillment enhanced added start*/
                                    function redirectNewDoc (obj){
                                        var polNum = $(obj).data("pn");
                                        var policyType = $(obj).data("pt");
                                        var claimno =  $(obj).data("claimno");
                                        var isClaim = $(obj).data("isc");       
                                        
                                        //Nicole_20200108_Policy Detail Security Access
                                        var SHA256Key = $(obj).data("key");
                                                              
                                        if (isClaim ==false){                                              
                                            Cigna.Util.navigateToVFP('PolicyDetailsPageVFP?policyNumber='+polNum+'&policyType='+policyType+'&SHA256Key='+SHA256Key, null, null, true);
                                        }else{
                                            Cigna.Util.navigateToVFP('ClaimDetailsVFP?claimNo='+claimno+'&policyType='+policyType, null, null, true);
                                        }
                                    }
                                    /*efulfillment enhanced added end*/

                                //20190715 - Minghua - Bounce Back Emails / Undelivered SMS
                                function confirmNiv(choice) {
                                    if (choice == 'true') {
                                        // Cigna.Util.navigateToVFP('apex/CusMyAccountPageVFP');
                                        Cigna.Util.navigateToVFP('apex/CusMyAccountUpdatePageVFP?updateType=email');
                                    }
                                    document.getElementById('overlayBounce').style.display = "none";
                                    document.getElementById('confirmBox').style.display = "none";
                                }

                                //20190715 - Minghua - Bounce Back Emails / Undelivered SMS
                                function bounceBackEmailMsg() {
                                    var overlay = document.getElementById('overlayBounce');
                                    var confirmBox = document.getElementById('confirmBox');
                                    overlay.style.opacity = .95;
                                    if (overlay.style.display == "block") {
                                        overlay.style.display = "none";
                                        confirmBox.style.display = "none";
                                    } else {
                                        overlay.style.display = "block";
                                        confirmBox.style.display = "block";
                                    }
                                }
                            </script>
                        </div>    
                    </div>
                </div>
                
            </apex:outputPanel>
                
                <!--<div class="bs carousel-wrapper"> <!-- class="bs container-fluid"  -->  
                <div>
                    <apex:outputPanel id="CarouselBanners" layout="block"> <!-- class="bs row" will introduce scrollable blank to pending memo area -->
                     
                        <div id="promotion-carousel-mobile" class="bs promotion-carousel" style="width: 100%;overflow-y: hidden;">
                            <div id="owl-promotion-mobile" class="owl-carousel owl-theme" style="max-height: 100%;">



































                                <apex:repeat value="{!BannerList}" var="bannerWrapper">
                                    <div class="item">
                                         <span class='spclick' data-isproduct="{!bannerWrapper.bannerInfo.is_product_page__c}" data-isexternal="{!bannerWrapper.bannerInfo.Is_External_Page__c}" data-url="{!bannerWrapper.redirectURL}" data-product="{!bannerWrapper.ProductCode}" 
                                        onclick="bannerRedirect({!bannerWrapper.bannerInfo.Enable_Background_Click__c},this)"  style="{!if(bannerWrapper.bannerInfo.Enable_Background_Click__c,'cursor:pointer','')}">
                                        <img class="lazyOwl img-responsive visible-xs visible-sm " style="width: 100%; max-height:100%;" data-src="{!$Site.Prefix}/servlet/servlet.FileDownload?file={!bannerWrapper.mobileBannerId}" />
                                       








                                            <apex:image styleClass="visible-md visible-lg" value="{!$Site.Prefix}/servlet/servlet.FileDownload?file={!bannerWrapper.desktopBannerId}" width="100%" 
                                            />
                                         </span>
                                        <div class="bs owl-banner-desc">




                                            <div><h3>{!bannerWrapper.bannerName}</h3></div>
                                            <div>{!bannerWrapper.bannerDescription}</div>
                                            <div>
                                            <apex:outputPanel layout="block" rendered="{!bannerWrapper.bannerInfo.Display_Learn_More_Button__c}">
                                            <button data-isproduct="{!bannerWrapper.bannerInfo.is_product_page__c}" data-isexternal="{!bannerWrapper.bannerInfo.Is_External_Page__c}" data-url="{!bannerWrapper.redirectURL}" data-product="{!bannerWrapper.ProductCode}" class="bs btn cigna-fg-white cigna-bg-green-medium learn-more-btn-new" onclick="bannerRedirect(true,this);">{!$Label.Learn_More}</button>
                                            </apex:outputPanel>
                                            </div>







                                        </div>
                                    </div>
                                </apex:repeat>
                               
                          <!--      <apex:repeat value="{!productList}" var="product">-->
                                   <!--IBM JING PORTABLE CR 0420 START-->


                                    <apex:outputPanel rendered="{!(PBTWrap!=null && isTopUpElig)}" styleClass="item"  id="CarouselBanner1"  >
                                        
                                            <img class="lazyOwl img-responsive visible-xs visible-sm " style="width: 100%; max-height:100%;" data-src="{!$Site.Prefix}/servlet/servlet.FileDownload?file={!PBTWrap.mobileBannerId}" />
                                            <apex:image styleClass="visible-md visible-lg" value="{!$Site.Prefix}/servlet/servlet.FileDownload?file={!PBTWrap.desktopBannerId}" width="100%"/>
                                                <div class="bs owl-banner-desc">
                                                <div><h3>{!PBTWrap.product.Name__c}</h3></div>
                                                <div>{!PBTWrap.product.Short_Description__c}</div>
                                                <div><button data-product="{!PBTWrap.product.Product_Code__c}" class="bs btn cigna-fg-white cigna-bg-green-medium learn-more-btn">{!$Label.Learn_More}</button></div>

                                            </div>
                                         
                                    </apex:outputPanel>

                                    <apex:outputPanel rendered="{!(PBCWrap!=null && isCoversionElig)}" styleClass="item"  id="CarouselBanner2"  >
                                        


                                            <img class="lazyOwl img-responsive visible-xs visible-sm " style="width: 100%; max-height:100%;" data-src="{!$Site.Prefix}/servlet/servlet.FileDownload?file={!PBCWrap.mobileBannerId}" />
                                            <apex:image styleClass="visible-md visible-lg" value="{!$Site.Prefix}/servlet/servlet.FileDownload?file={!PBCWrap.desktopBannerId}" width="100%"/>
                                                <div class="bs owl-banner-desc">
                                                <div><h3>{!PBCWrap.product.Name__c}</h3></div>
                                                <div>{!PBCWrap.product.Short_Description__c}</div>
                                                <div><button data-product="{!PBCWrap.product.Product_Code__c}" class="bs btn cigna-fg-white cigna-bg-green-medium learn-more-btn">{!$Label.Learn_More}</button></div>

                                            </div>
                                            <input type="hidden" id='hid' value="{!isTopUpElig}" />         
                                    </apex:outputPanel>                                   
                                     <!--IBM JING PORTABLE CR 0420 END-->


                              <!--  </apex:repeat>-->
                             
                               
                            </div>          
                        </div>
                        <apex:outputPanel id="test" >
                            <input type="hidden" id='hid' value="{!(PBTWrap!=null && isTopUpElig)}" />  
                        </apex:outputPanel> 
                        <!--CR-56_Link_20220214-->
                         <apex:actionFunction name="initPortableMedicalPlan" action="{!initPortableMedicalPlan}"  rerender="CarouselBanner2,CarouselBanner1,test,CarouselBanners" oncomplete="  Cigna.Home.initDisplay(); $('.learn-more-btn').on('click',Cigna.Home.goToGetProtected); "  />
                         
                    </apex:outputPanel>
                
                    <div class="bs row visible-xs">
                        <div class="bs row floating-button-container">
                            <div class="bs floating-button-panel cigna-fg-white cigna-bg-blue-dark">
                                <div class="bs col-lg-2 col-sm-2 col-xs-4" onclick="Cigna.Util.navigateToVFP('MyClaimVFP')">
                                    <i class="ci-hk-clip-offcial ci-hk-lg"></i>
                                    <div class="bs floating-button">
                                    {!$Label.NavBar_My_Claim}
                                    </div>
                                </div>
                                <div class="bs col-lg-2 col-sm-2 col-xs-4">
                                    <i class="ci-hk-notes ci-hk-lg" onclick="Cigna.Util.navigateToVFP('MyPolicyVFP')"></i>
                                    <div class="bs floating-button" >
                                        {!$Label.NavBar_My_Policy}
                                    </div>
                                </div>
                                <div class="bs col-lg-2 col-sm-2 col-xs-4" onclick="Cigna.Util.navigateToVFP('GetProtectedVFP')">
                                    <i class="ci-hk-beach-umbrella ci-hk-lg"></i>
                                    <div class="bs floating-button">
                                        {!$Label.NavBar_Get_A_Quote}
                                    </div>
                                </div>
                                
                            </div>
                        </div>
                    </div>
                </div>
                
                
                
            <!-- </apex:outputPanel> -->
               
        </apex:form>
    </apex:define>


    <!-- End of the main body -->
    </apex:composition>
    <!-- End of the page template -->

    <!-- CR-56_Link_20220214 -->
    <script type="text/javascript" src="{!URLFOR($Resource.DD_Demo, 'owl.carousel/owl.carousel_new.min.js')}"/>
    <script type="text/javascript">
        var Cigna = Cigna || {};
        Cigna.Home = function(){
            function togglePanel(e){
                console.log('in toggle handler');
                var panel = $('#mobile-msg-panel');
                if ($(panel).is(':visible')) {
                    $(panel).hide(0, function(){
                        $('.cigna-message-bar i.ci-hk-arrow-27').addClass('ci-hk-arrow-28').removeClass('ci-hk-arrow-27');
                    });
                } else {
                    $(panel).show(0, function(){
                        $('.cigna-message-bar i.ci-hk-arrow-28').addClass('ci-hk-arrow-27').removeClass('ci-hk-arrow-28');
                    });
                }
                e.preventDefault();
                e.stopPropagation();
            }

            function initDisplay(){
            
                if(Cigna.Util.checkWebView()){
                    if(Cigna.Util.isIOS()){
                        $('.cigna-message-bar').css("margin-top","20px");
                        if($('.cigna-message-bar').css('padding-top') == '14.5px'){
                            $('.cigna-message-bar').css("padding-top","16px");
                        }else{
                            $('.cigna-message-bar').css("padding-top","12px");
                        }
                        $('.cigna-message-bar').css("padding-bottom","10px");
                    }else{
                        $('.cigna-message-bar').css("margin-top","0");
                        $('.cigna-message-bar').css("padding-top","10px").css("padding-bottom","10px");
                    }
                }    
                
                console.log('adding event listener to message bar click');
                //CR-56_Link_20220214
                $('.cigna-message-bar').on("click",Cigna.Home.togglePanel);
                //$('#mobile-msg-panel').show();
                $('.cigna-message-bar i.ci-hk-arrow-27').addClass('ci-hk-arrow-28').removeClass('ci-hk-arrow-27');
                
                $("#owl-promotion-mobile").owlCarousel({
                    slideSpeed : 300,
                    hpaginationSpeed : 300,
                    singleItem: true,
                    itemsTabletSmall: false,
                    navigation : true,
                    lazyLoad : true,
                    itemsScaleUp: true,
                    responsive: true,
                    autoPlay: false,
                    pagination: false,
                    navigationText: [
                        '<i class="ci-hk-arrow-29" aria-hidden="true"></i>',
                        '<i class="ci-hk-arrow-31" aria-hidden="true"></i>'
                    ]
                });
            }
            
            function goToGetProtected(evt){
                var product = $(this).data('product');
                Cigna.Util.navigateToVFP('GetProtectedVFP?pc='+product);
                sessionStorage.setItem('get-protected-back-url',window.location.href);
                evt.preventDefault();
            }
            
            return {
                togglePanel : togglePanel,
                initDisplay : initDisplay,
                goToGetProtected: goToGetProtected
            }
        }();  

        /*
        function equiNavMenu(){
            alert('323');
            alert('pic=='+$('#promotion-carousel-mobile').width());
            alert('bar=='+$('#cigna-message-bar').width());
            $('#promotion-carousel-mobile').css("width",$('#cigna-message-bar').width());
            divtest.style.height = divtest.offsetHeight
        }
        
        $(window).resize(function(){
            //equiNavMenu();
        });
        */

        $(document).ready(function(){

            initPortableMedicalPlan();
            MGMEntryControl();
            Cigna.Home.initDisplay();
            loadPendingMemoMsg();
            //CR-56_Link_20220214
            $('.learn-more-btn').on("click",Cigna.Home.goToGetProtected);
         
            document.ontouchmove = function(event){
                event.preventDefault();
            } 






            



 







        });






        var referralEligible = {!referralEligible};
        sessionStorage.setItem('mgmEligible',referralEligible);
        




        function MGMEntryControl(){            
            if (referralEligible){
                $(".MGMEntry").show();
            }else{
                $(".MGMEntry").hide();            
            }


        }
    
        function bannerRedirect(enabled,obj,evnet ){
           event.preventDefault();
            if (enabled){
                var isproduct = $(obj).data('isproduct'); 
                var product = $(obj).data('product');  
                var url = $(obj).data('url'); 
                var isExternal = $(obj).data('isexternal');                               
                sessionStorage.setItem('get-protected-back-url',window.location.href);
                if (isproduct == true){
                    Cigna.Util.navigateToVFP('GetProtectedVFP?pc='+product);
                }else{
                     if (url!=""){ 
                         if (isExternal==true){ 
                            window.open(url, '_blank');               
                        }else{                             
                            Cigna.Util.navigateToVFP(url);
                        }
                    }

                }
                //event.preventDefault();
            }
        }

    </script>
    </body>
</apex:page>