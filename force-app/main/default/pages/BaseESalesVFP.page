<apex:page docType="html-5.0" sidebar="false" showHeader="false" title="Get Protected" controller="ESalesApplicationCtrl">
    <head>
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, viewport-fit=cover"/>

        <style>
        
        @media (max-width: 767px) {
            body {
                padding-top: 50px;
            }
            
            div#reallocationSpecialBoxESales {
                display: none;
                position: absolute;
                z-index: 11;
                margin: 100px auto 0px auto;
                width: 90%;
                height: 80%;
                background: #FFF;
                color: #000;
                left: 5%;
                padding: 20px;
                border-radius: 5px;
             }
        }
        @media (min-width: 768px) {
            body {
                padding-top: 50px;
                min-height: 1024px;
            }
            
            div#reallocationSpecialBoxESales {
                display: none;
                position: absolute;
                z-index: 11;
                margin: 150px auto 0px auto;
                width: 80%;
                height: 60%;
                background: #FFF;
                color: #000;
                left: 10%;
                padding:20px;
                border-radius:5px;
              }
        }
       
        
        div#reallocationOverlayESales {
            display: none;
            z-index: 10;
            background: #D9D9D6;
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0px;
            left: 0px;
            text-align: center;
          }
          
          
          
          #reallocationCloseOverlayESales {
            position: absolute;
            top: 10px;
            right: 10px;
          }
        
          #reallocationtccontentESales {
            padding:10px;
            color:#000;
            font-size:12px;
            width: 100%;
            height: 95%;
            overflow-y:auto;
          } 
          div#overlay{
            display: none;
            z-index: 11;
            background: #D9D9D6;
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0px;
            left: 0px;
            text-align: left;
        }
        
        div#specialBox{
            display: none;
            position: absolute;
            z-index: 11;
            margin: 150px auto 0px auto;
            width: 80%;
            height: 60%;
            background: #FFF;
            color: #000;
            left: 10%;
            padding:20px;
            border-radius:5px;
        }
        
        #closeOverlay{
            position: absolute;
            top: 10px;
            right: 10px;
        }
        
        #tccontent {
            padding:5px;
            color:#000;
            font-size:12px;
            width: 100%;
            height: 90%;
            overflow-y:auto;
        } 
         
            <!--additional inline css-->
            <!--tooltips-->
            .tooltip {
                position: relative;
                display: inline-block;
            }
            .tooltip .tooltiptext {
                visibility: hidden;
                width: 120px;
                background-color: black;
                color: #fff;
                text-align: center;
                border-radius: 6px;
                padding: 5px 0;
            }
            .tooltip:hover .tooltiptext {
                visibility: visible;
            }
            .tooltip-inner {
                /* Change the tooltip width here */
                max-width: 250px !important;
                /* If max-width does not work, try using width instead */
                width: 250px; 
                min-width: 100px;
            }

            .uploaded-filelist{
                padding:10px; 
                background-color:#f2f2f2;
                text-overflow: ellipsis;
                overflow:hidden;
                white-space:nowrap;
                
            }
            .helptext-icon {
                background:none !important;
                border:none !important;
                border-radius:0px !important;
                font-size:14px !important;
            }

            .content-choice{
                font-size:14px !important;
                padding-top:20px !important;
                padding-bottom:20px !important;
                border-bottom:1px solid #f2f2f2 !important;
            }

            .content-choice-remark{
                font-size:14px !important;
                padding-top:20px !important;
                padding-bottom:20px !important;
                //border-bottom:1px solid #f2f2f2 !important;
            }

            .loading-div {
                top:0px;
                left:0px;
            }

            .bs .cigna-btn-desktop {
                width: 30%;
                //text-transform: uppercase;
                font-family: "Gotham SSm A", "Gotham SSm B", "Microsoft Jhenghei", "LiHei Pro", "Heiti TC", Arial, Helvetica, sans-serif;
                font-style: normal;
                font-weight: 500;
            }
            .bs .form-control:focus {
                box-shadow: none !important;
                border-bottom: 1px solid #eac048 !important;
            }

            .bs input[type="text"], .bs input[type="tel"], .bs input[type="date"], .bs select, .bs span.form-control  {
                border-top: 0 !important;
                border-left: 0 !important;
                border-right: 0 !important;
                border-bottom: 1px solid #58595B !important;
                background: transparent;
                width: 100%;
                box-shadow: none !important;
                border-radius: 0 !important;
                background-color:#FFF!important;
            }
            
            .bs .cigna-input-addon {
                position: absolute;
                top: 0;
                right: 20px;
            }
            
            .bs .cigna-progress-bar-inner > div {
                font-size: 0.7em;
            }
            
            .bs .cigna-form-section {
                margin-top: 20px;
                margin-bottom: 20px;
            }
            
            .bs .cigna-form-section-header {
                background: #eee;
                padding-top: 20px;
                padding-bottom: 20px;
                margin-bottom: 15px;
            }
            
            .bs .cigna-answer-wrapper > p {
                background: #fff;
            }
            .bs .cigna-answer-wrapper > p > label {
                margin-left: 10px;
                margin-top: 5px;
                font-weight: normal;
                padding: 5px;
                width: 100%;
            }
            
            .bs .cigna-answer-wrapper-same-address > p {
                background: #fff;
            }
            .bs .cigna-answer-wrapper-same-address > p > label {
                //margin-left: 0px;
                margin-top: 5px;
                font-weight: normal;
                padding: 5px 0px 5px 0px;
                width: 100%;
            }
            
            .bs .cigna-layer-card {
                margin: 5px 0px 5px 0px;
                display: block;
                cursor: pointer;
            }
            .bs .cigna-layer-card:hover {
                text-decoration: none;
            }
            .bs .cigna-layer-card > div {
                padding: 10px 15px;
            }
            .bs .cigna-layer-card-desc {
                font-size: 0.9em;
            }
            .bs .cigna-layer-card-desc.cigna-fg-gray-dark {
                border-left: 1px solid #C8C9C7;
                border-right: 1px solid #C8C9C7;
                border-bottom: 1px solid #C8C9C7;
            }
            .bs .cigna-layer-card-head.cigna-bg-gray-3:before {
                font: normal normal normal 14px/1 FontAwesome;
                display: inline-block;
                height: 20px;
                margin: 0 .25em 0 0;
                padding: 0;
                vertical-align: top;
                width: 20px;
                color: #C8C9C7;
                font-size: 1.2em;
            }
            .bs .cigna-layer-card-head.cigna-bg-green-medium:before {
                font: normal normal normal 14px/1 FontAwesome;
                display: inline-block;
                content: "\f058";
                height: 20px;
                margin: 0 .25em 0 0;
                padding: 0;
                vertical-align: top;
                width: 20px;
                color: #fff;
                font-size: 1.2em;
            }
            
            
            /*
            .bs input[type="checkbox"].cigna-question-checkbox {
                display: none;
            }
            .bs input[type="checkbox"].cigna-question-checkbox ~ label {
                cursor: pointer;
            }
            .bs input[type="checkbox"].cigna-question-checkbox + label:before {
                font: normal normal normal 14px/1 FontAwesome;
                content: "\f058";
                display: inline-block;
                height: 20px;
                margin: 0 .25em 0 0;
                padding: 0;
                vertical-align: top;
                width: 20px;
                color: #D9D9D6;
                font-size: 1.2em;
            }
            .bs input[type="checkbox"].cigna-question-checkbox:checked + label:before {
                background: #fff;
                color: #39B54A;
                font: normal normal normal 14px/1 FontAwesome;
                content: "\f058";
                font-size: 1.2em;
            }
            .bs input[type="checkbox"].cigna-question-checkbox:checked + label:after {
                font-weight: bold;
            }
            */
            /*
            .signature-pad {
                width: 95%;
                height: 300px;
                background-color: #fff;
                border: 1px solid #ddd;
            }
            
            .signature-pad-body {
                width: 100%;
                height: 300px;
            }
            
            .signature-canvas {
                width: 100%;
                height: 100%;
            }
            
            .signature-pad-footer {
                width: 100%;
                height: 40px;
            }
            */
            .aps-loading-div {
                color: #39B54A;
                //text-align: center;
            } 
            
            .bs .loading-sp {
                //position: fixed;
                width: 100%;
                height: 100%;
                margin: 0;
                font-size: 1em;
                color: #39B54A;
                z-index: 999;
                background: white;
                opacity: 0.5;
                vertical-align: middle;
                text-align: center;
            }
            
            .show-in-center{   
                //position: absolute;   
                top: 50%;   
                left: 50%;   
                -webkit-transform: translate(-50%, -50%);   
                -moz-transform: translate(-50%, -50%);   
                -ms-transform: translate(-50%, -50%);   
                -o-transform: translate(-50%, -50%);   
                transform: translate(-50%, -50%);   
            }   
            
            /* GL31 jack add */
            .warning-msg {
                color: #9F6000;
                background-color: #FEEFB3;
                font-weight: 300;
                margin: 10px 20%;
                padding: 10px;
                border-radius: 3px 3px 3px 3px;
                text-align: center;
            }
            .info-msg{
                /* color: #059; */
                /* background-color: #BEF; */
                font-weight: bold;
                margin: 10px 20%;
                padding: 10px;
                border-radius: 3px 3px 3px 3px;
                text-align: center;
                font-size: 1.2em;
            }
            .bs .cigna-quote-question {
                padding:15px 0 30px 20px;
                border-bottom: 1px solid #D9D9D6;
            }

            .bs .cigna-quote-answer {
                padding-top:20px;
            }   

            /*CR-56_Link_20220214*/
            .ui-tooltip {
                background: black !important;
                max-width: 250px !important;
                width: 250px; 
                min-width: 100px;
                color: white !important;
                z-index: 1070;
                display: block;
                text-align: center !important;
                font-size: 12px !important;
                border-radius: 5px !important;
            }

        </style>

        <script type="text/javascript">
            var __sfdcSessionId = '{!GETSESSIONID()}';
            var filesToUpload = '';  
            var uploadedFile = 0;
        </script>
        <script src="/soap/ajax/32.0/connection.js" type="text/javascript"></script>

        <script type="text/javascript">
        
            var changeLanguageWarningRequired = true;

            var childWin=null;
            var isChildWinOpened = false;

            //GL31 jack add
            function checkAssessmentFinish(name){
                var boxes = $("input[id*='"+name+"']");
                console.log("boxes.length"+boxes.length);
                console.log("boxes.filter(':checked').length"+boxes.filter(':checked').length);
                if (boxes.filter(':checked').length > 0) {
                        return true;
                }
                return false;
            }

            function submitAssessmentQuestoin(){
                if(checkAssessmentFinish("Assessment_Q_1") && checkAssessmentFinish("Assessment_Q_2")){
                    $("#AssessmentWarning").css("display","none")
                    var resultMap = new Map();
                    let ele = document.getElementsByTagName('input');
                    for(let i = 0; i<ele.length;i++){
                            if(ele[i].checked){
                                    var question = {
                                            name: ele[i].id,
                                            value : ele[i].value
                                    }
                                    resultMap.set(ele[i].id,ele[i].value);
                            }
                    }
                    var myJSON = JSON.stringify( Object.fromEntries(resultMap) ) ;
                    
                    getAvailableProduct(myJSON);
                    console.log(myJSON);
                }else{
                    $("#AssessmentWarning").css("display","block");
                }
            }
            //GL31 jack add

            var autoShowAuw = function(url){
                if(url != null && url != ''){
                    // Update by minghua
                    if (childWin == null || typeof(childWin)=='undefined') {
                        childWin = window.open(url);
                    }else{
                        childWin.location = url;
                    }
                    //Ray Update: Add the pop-up to check the window for ipad/iphone safari
                    if(Cigna.Util.isIOS()&&!Cigna.Util.checkWebView()){
                        if ((childWin == null || typeof(childWin)=='undefined') && Cigna.Util.isSafari()) {  
                        //if (childWin == null || typeof(childWin)=='undefined') {  
                            //alert('Please disable your pop-up blocker and click the "Open" link again.'); 
                            var language = window.navigator.userLanguage || window.navigator.language;                          
                            if(language == 'zh-TW'||language == 'zh-CH'){
                                alert("請先確保於Safari設置中容許彈出式視窗 - 請到 [設置] -> [Safari] -> 取消勾選 [阻擋彈出式視窗], 然後按以下[關閉]繼續。");   
                            }else{
                                alert("Please make sure to enable popups in Safari settings by going to [Settings] -> [Safari] -> Uncheck [Block Pop-ups], then press [Close] below to proceed.");                      
                            }
                        } 
                        else {  
                            childWin.focus();
                        }
                    }
                    //Ray Update: End
                    isChildWinOpened = true;
                }
            }
            
            var closeChildWindow = function(){
            
                if (childWin) {
                    if (childWin.closed) {
                        isChildWinOpened = false;
                    }else{
                        childWin.close();
                        childWin = null;
                        isChildWinOpened = false;
                    }
                }
            }

            function reallocationToggleOverlayESales(){
            
                var overlay = document.getElementById('reallocationOverlayESales');
                var specialBox = document.getElementById('reallocationSpecialBoxESales');
                overlay.style.opacity = .95;
                if(overlay.style.display == "block"){
                    overlay.style.display = "none";
                    specialBox.style.display = "none";
                } else {
                    overlay.style.display = "block";
                    specialBox.style.display = "block";
                }
                
            }
            
            var Cigna = Cigna || {};
            Cigna.ESales = function(){
                
                var btnNextDisabled = false;
                var btnPrevDisabled = false;
                
                var uwPollingId, isPolling, uwCheckPollingId;
                var isAutoClose = false;
                //var childWin=null;
                //var isChildWinOpened = false;

                function nextStep(evt){
                    
                    var currentStep = $('#esales-current-step').val();
                    console.log('currentStep: '+currentStep);

                    getCreditCardNo();
                    getCreditCardNo1();
                    getBankAccNo();

                    var formvalid = 1;
                    var paymodevalid = 1;
                    var acceptTCvalid = 1;
                    if(currentStep == '{!STEP_ASSESSMENT_QUESTION}'){//GL31 jack add
                        console.log("the value: "+$("input[id*=isAvailableProduct]").val());
                        if($("input[id*=isAvailableProduct]").val() != "true"){
                            return;
                        }
                    }else if(currentStep == '{!STEP_THIRD_PARTY_PAYMENT}'){
                        formvalid = 0;
                        ThirdPartyPayment.Validate.formValidation();
                        ThirdPartyPayment.Validate.checkDOBRequired();
                        formvalid = ($("form[id*='frmThirdParty']")).validate().form();
                        //add by kit for DPSP-1009
                        $("input[id$='ThirdParty-IsMaking1stPayment']").next().remove();
                        $("input[id$='reason-others']").next().remove();
                        $("input[id$='fund-others']").next().remove();
                        $('input[type="hidden"][id$="ThirdParty-Payer"]').next().remove();
                        //Is the policy holder or the person insured making the payment?
                        if(!$("input[id$='ThirdParty-IsMaking1stPayment']").val()){
                            formvalid = 0;
                            $("input[id$='ThirdParty-IsMaking1stPayment']").after("<p style='color:red'>{!$Label.ESales_Required_Field_Error_Message}</p>");
                        }else if($("input[id$='ThirdParty-IsMaking1stPayment']").val() == 'No'){
                            //Reason for the Third Party Payment
                            if($('#ThirdPartyReason-List input[type="hidden"][value="true"]').length < 1){  
                                formvalid = 0;
                                $("input[id$='reason-others']").after("<p style='color:red'>{!$Label.ESales_Required_Field_Error_Message}</p>");
                            }
                            //Please indicate the source of fund for funding this policy.
                            if($('#FundSource-List input[type="hidden"][value="true"]').length < 1){
                                formvalid = 0; 
                                $("input[id$='fund-others']").after("<p style='color:red'>{!$Label.ESales_Required_Field_Error_Message}</p>");
                            }
                            //
                            if(!$('input[type="hidden"][id$="ThirdParty-Payer"]').val()){
                                formvalid = 0;
                                $('input[type="hidden"][id$="ThirdParty-Payer"]').after("<p style='color:red'>{!$Label.ESales_Required_Field_Error_Message}</p>");
                            }
                        }
                        //end add by kit
                        if (formvalid == 0){
                            //CR-56_Link_20220214
                            $("html,body").animate({ scrollTop: ($("form[id*='frmThirdParty']")).find(":input.error:first").offset().top - $(window).height()/2},"slow",function(){($("form[id*='frmThirdParty']")).find(":input.error:first").trigger("focus");} );
                        }else{
                            //Ray Update: Auto Scroll to Top
                            $("html, body").animate({ scrollTop: 0 }, "fast");
                            //Ray Update: End
                        }
                    }else if(currentStep == '{!STEP_CONFIRMATION}'){
                        formvalid = 0;
                        ConfirmationForm.Validate.formValidation();
                        formvalid = ($("form[id*='confirmationfrm']")).validate().form();

                        if (formvalid == 0){
                            //CR-56_Link_20220214
                            $("html,body").animate({ scrollTop: ($("form[id*='confirmationfrm']")).find(":input.error:first").offset().top - $(window).height()/2},"slow",function(){($("form[id*='confirmationfrm']")).find(":input.error:first").trigger("focus");} );
                            
                        }//else{
                        //    $("html, body").animate({ scrollTop: 0 }, "fast");
                        //}

                        console.log('###test showPaymentMode' + '{!txn.Payment_Mode__c}');

                        if($('input[type="hidden"][id$="payment-mode"]').val()==''){
                            console.log('###test showPaymentMode222');
                            $("#errSelectPaymode").show();
                            //$("input[id*='payment-mode-first-01']").focus();
                            //CR-56_Link_20220214
                            $('input[type="hidden"][id$="payment-mode"]').trigger("focus");
                            paymodevalid=0;
                        }else{
                            paymodevalid=1;
                            $("#errSelectPaymode").hide();
                        }

                        if($('input[type="hidden"][id$="select-accept-tc"]').val()==''){
                            console.log('###test showPaymentMode222');
                            $("#errCheckacceptTC").show();
                            //CR-56_Link_20220214
                            $('input[type="hidden"][id$="select-accept-tc"]').trigger("focus");
                            acceptTCvalid=0;
                        }else{
                            acceptTCvalid=1;
                            $("#errCheckacceptTC").hide();
                        }
                        
                    }

                    if (!btnNextDisabled && validateForm() && validateShareTotal() && validateShareTotalPI() && validateShareTotalC1() && validateShareTotalC2() && validateShareTotalC3() && formvalid && paymodevalid && acceptTCvalid) {

                        // add by minghua 
                        // Rancho_PI38_20210803 change all safari to pop-up
                        // if (Cigna.Util.isIOSChrome() && currentStep == '{!STEP_PERSONAL_DETAIL}') {
                        if ((Cigna.Util.isIOSChrome() || (Cigna.Util.isCustomerPortal() && Cigna.Util.isSafari() && !Cigna.Util.checkWebView())) && currentStep == '{!STEP_PERSONAL_DETAIL}') {
                            var sitePrefix = "{!$Site.Prefix}";
                            if (childWin == null || typeof(childWin)=='undefined') {
                                childWin = window.open(sitePrefix + "/apex/blankLoadingVFP");
                            }else{
                                childWin.location = sitePrefix + "/apex/blankLoadingVFP";
                            }
                            childWin.focus();
                        }
                    
                        if (currentStep == '{!STEP_ESIGNATURE}') {
                            // TO-DO: Extra Action
                            Cigna.ESignatureComp.saveSignature();
                            btnNextDisabled = true;
                            ServerESales.nextStep();
                        
                        } else if (currentStep == '{!STEP_CONFIRMATION}' && Cigna.Util.isBrokerPortal){
                            console.log('validation for upload appeal doc');

                            //CR-56_Link_20220214
                            if( $('[att-type="auwAtt"]').length > 3){
                                $('#errUpdateFileMax').show();
                                return;
                            }
                                                                                   
                            btnNextDisabled = true;
                            ServerESales.nextStep();

                        } else if (currentStep == '{!STEP_UPLOADDOC}'){
                            console.log('validation for upload doc');
                            //if($('[att-type="HKIDAttPH"]').size()<1 && $('[att-type="AddressAtt"]').size()<1 && $('[att-type="HKIDAttPI"]').size()<1
                            //CR-56_Link_20220214
                            if($('[att-type="HKIDAttPH"]').length<1 && $('[att-type="HKIDAttPI"]').length<1
                                 && $('[att-type="HKIDAttC1"]').length<1 && $('[att-type="HKIDAttC2"]').length<1 && $('[att-type="HKIDAttC3"]').length<1 && $('[att-type="HKIDAttTP"]').length<1){
                                $('#errUpdateAllFile').show();
                                return;
                            } 
                            //CR-56_Link_20220214
                            if( $('#CPDUpload').length > 0 && $('[att-type="CPDAtt"]').length<1){
                                $('#errUpdateCPDFile').show();
                                return;
                            }

                            //refreshEsignature();
                            btnNextDisabled = true;
                            ServerESales.nextStep();
                            //signatureDiv
                            //$('#signatureDiv').fadeIn();
                            
                        } else if(currentStep == '{!STEP_PAYMENT_METHOD}'){
                                                    
                            if ($('#payment-method-subseq-01').is(':checked') || $('#payment-method-subseq-02').is(':checked')) {
                                //do nothing
                                console.log('### next step: true: ' + $("input[id$='paramPaymentMethodSubseq']").val());
                            }else{
                                $("input[id$='paramPaymentMethodSubseq']").val('');
                                console.log('### next step: false');
                            }
                            
                            btnNextDisabled = true;
                            ServerESales.nextStep();

                        } else if(currentStep == '{!STEP_PAYMENT_DDA}'){
                            btnNextDisabled = true;
                            ServerESales.nextStep();
                        } else {
                            btnNextDisabled = true;
                            ServerESales.nextStep();
                        }
                        
                        //Ray Update: Auto Scroll to Top
                        $("html, body").animate({ scrollTop: 0 }, "fast");
                        //Ray Update: End
                        
                    } else if(formvalid){
                        if(Cigna.Util.isCustomerPortal()){
                            if ($('form[id$="frmApplication"] input.error').length > 0) {
                                    $('form[id$="frmApplication"] input.error')[0].focus();
                                    if (typeof evt != undefined && evt) {
                                        evt.preventDefault();
                                    }
                            }           
                        } else if(Cigna.Util.isBrokerPortal()){
                            if ($('form[id$="frmApplication"] input.error').length > 0) {
                                var elementId = $('form[id$="frmApplication"] input.error')[0].getAttribute("id");
                                if(!rePositionDOB(elementId)){
                                    $('form[id$="frmApplication"] input.error')[0].focus();
                                    $('form[id$="frmApplication"] input.error')[0].blur();
                                }
                                if (typeof evt != undefined && evt) {
                                    evt.preventDefault();
                                }
                            } else if($('form[id$="frmApplication"] select.error').length > 0){
                                $('form[id$="frmApplication"] select.error')[0].focus();
                                $('form[id$="frmApplication"] select.error')[0].blur();
                            } else if(!validateShareTotal()){
                                //CR-56_Link_20220214
                                $("input[id*='PH-Share-Percentage']").trigger("focus");
                                $("input[id*='PH-Share-Percentage']").trigger("blur");
                            } else if(!validateShareTotalPI()){
                                $("input[id*='PI-Share-Percentage']").trigger("focus");
                                $("input[id*='PI-Share-Percentage']").trigger("blur");
                            } else if(!validateShareTotalC1()){
                                $("input[id*='C1-Share-Percentage']").trigger("focus");
                                $("input[id*='C1-Share-Percentage']").trigger("blur");
                            } else if(!validateShareTotalC2()){
                                $("input[id*='C2-Share-Percentage']").trigger("focus");
                                $("input[id*='C2-Share-Percentage']").trigger("blur");
                            } else if(!validateShareTotalC3()){
                                $("input[id*='C3-Share-Percentage']").trigger("focus");
                                $("input[id*='C3-Share-Percentage']").trigger("blur");

                            } else if (!paymodevalid) {
                                console.log('###paymodevalid');
                                $('input[type="hidden"][id$="payment-mode"]').trigger("focus");
                                if (typeof evt != undefined && evt) {
                                    evt.preventDefault();
                                }
                            } else if (!acceptTCvalid) {
                                console.log('###acceptTCvalid');
                                //CR-56_Link_20220214
                                $('input[type="hidden"][id$="select-accept-tc"]').trigger("focus");
                                if (typeof evt != undefined && evt) {
                                    evt.preventDefault();
                                }
                            } else{
                                //Ray Update: Auto Scroll to Top
                                $("html, body").animate({ scrollTop: 0 }, "fast");
                                //Ray Update: End
                            }
                            
                        }
                    }
                }
                
               //CR-56_Link_20220214
                function rePositionDOB(Id){
                    if(Id.indexOf("PH-Day-DOB-Check") >= 0){
                        $("input[id*='Val-DOB-Year-PH']").trigger("focus");
                        $("input[id*='Val-DOB-Year-PH']").trigger("blur");
                        return true;
                    } else if(Id.indexOf("PI-Day-DOB-Check") >= 0){
                        $("input[id*='Val-DOB-Year-PI']").trigger("focus");
                        $("input[id*='Val-DOB-Year-PI']").trigger("blur");
                        return true;
                    } else if(Id.indexOf("CH1-Day-DOB-Check") >= 0){
                        $("input[id*='Val-DOB-Year-CH1']").trigger("focus");
                        $("input[id*='Val-DOB-Year-CH1']").trigger("blur");
                        return true;
                    } else if(Id.indexOf("CH2-Day-DOB-Check") >= 0){
                        $("input[id*='Val-DOB-Year-CH2']").trigger("focus");
                        $("input[id*='Val-DOB-Year-CH2']").trigger("blur");
                        return true;
                    } else if(Id.indexOf("CH3-Day-DOB-Check") >= 0){
                        $("input[id*='Val-DOB-Year-CH3']").trigger("focus");
                        $("input[id*='Val-DOB-Year-CH3']").trigger("blur");
                        return true;
                    }
                    
                    return false;
                }
                
                function prevStep(evt) {
                    if (!btnPrevDisabled) {
                        btnPrevDisabled = true;
                        ServerESales.prevStep();
                    }
                    evt.preventDefault();
                }
                
                function saveRecord(evt) {
                    var currentStep = $('#esales-current-step').val();
                    getCreditCardNo();
                    getCreditCardNo1();
                    getBankAccNo();

                    var formvalid = 1;
                    if(currentStep == '{!STEP_THIRD_PARTY_PAYMENT}'){
                        formvalid = 0;
                        ThirdPartyPayment.Validate.formValidation();
                        ThirdPartyPayment.Validate.checkDOBRequired();
                        formvalid = ($("form[id*='frmThirdParty']")).validate().form();
                        if (formvalid == 0){
                            //CR-56_Link_20220214
                            $("html,body").animate({ scrollTop: ($("form[id*='frmThirdParty']")).find(":input.error:first").offset().top - $(window).height()/2},"slow",function(){($("form[id*='frmThirdParty']")).find(":input.error:first").trigger("focus");} );
                        }
                    }
                    if(currentStep == '{!STEP_CONFIRMATION}'){
                        formvalid = 0;
                        ConfirmationForm.Validate.formValidation();
                        formvalid = ($("form[id*='confirmationfrm']")).validate().form();
                    
                        if (formvalid == 0){
                            //CR-56_Link_20220214
                            $("html,body").animate({ scrollTop: ($("form[id*='confirmationfrm']")).find(":input.error:first").offset().top - $(window).height()/2},"slow",function(){($("form[id*='confirmationfrm']")).find(":input.error:first").trigger("focus");} );
                        }
                    }

                    if(validateForm() && formvalid){
                        ServerESales.saveRecord();
                    }
                    
                }
                
                function finishSaving() {
                    if (Cigna.Util.isBrokerPortal()) {
                        Cigna.Util.navigateToVFP("ProductDeckVFP?tab=app", null, null, true);
                    } else {
                        Cigna.Util.navigateToVFP("MyPolicyVFP", null, null, true);
                    }
                }

                function onRadioChange(evt) {
                    var val = $(this).val();
                    var parent = $(this).parent();
                    //$(parent).siblings('p').removeClass('cigna-bg-green-medium');
                    //$(parent).addClass('cigna-bg-green-medium');
                    $(parent).siblings('input[type="hidden"]').val(val).trigger('change');
                    console.log('onRadioChange# ' + val);
                    if(this.id.indexOf('making-payment') == 0) {
                            
                        var question1 = $('input[type="hidden"][id$="ThirdParty-IsMaking1stPayment"]').val();
                        var question2 = $('input[type="hidden"][id$="ThirdParty-IsMakingSubsequentPayment"]').val();
                        if(question1 == 'No' || question2 == 'No'){
                            $('#thirdPartyForm').show();
                            //Ray Update: Fix the IE error that user cannot input in input field
                            var isIE = /(MSIE|Trident\/|Edge\/)/i.test(navigator.userAgent); 
                            if(isIE){
                                var x = $(document).scrollLeft(), y = $(document).scrollTop();
                                //CR-56_Link_20220214
                                $('[id$=reason-others]').trigger("focus").trigger("blur");                                       
                                window.scrollTo(x, y);
                            }
                            //Ray Update: End
                            
                        }else{
                            $('#thirdPartyForm').hide();
                        }
                    }

                    if ($('#payment-method-first-02').is(':checked')) {
                        $('#cheque-number').show();
                        //Ray Update: Fix the IE error that user cannot input in input field
                        var isIE = /(MSIE|Trident\/|Edge\/)/i.test(navigator.userAgent); 
                        if(isIE){
                            var x = $(document).scrollLeft(), y = $(document).scrollTop();
                            //CR-56_Link_20220214
                            $('[id$=cheque-number]').trigger("focus").trigger("blur");                                        
                            window.scrollTo(x, y);
                        }
                        //Ray Update: End
                    } else {
                        $('#cheque-number').hide();
                    }
                    
                    if(this.id.indexOf('Third-party-payer') == 0) {
                        if ($('#Third-party-payer-Ind').is(':checked')) {
                            $('#PayerIsIndividual').show();
                        } else {
                            $('#PayerIsIndividual').hide();
                        }
                        if ($('#Third-party-payer-Company').is(':checked')) {
                            $('#PayerIsCompany').show();
                        } else {
                            $('#PayerIsCompany').hide();
                        }
                    }

                    //for provide payment info question
                    if(this.id.indexOf('payment-info-question') == 0){
                        var provideinfo = $('input[type="hidden"][id$="paramProvidePaymentInfo"]').val();
                        if(provideinfo == 'Yes'){
                            $('#firstPaymentDiv').show();
                            $('#subsequentPaymentDiv').show();
                        }else{
                            $('#firstPaymentDiv').hide();
                            $('#subsequentPaymentDiv').hide();
                        }
                    }
                    
                    //for payment mode
                    if(this.id.indexOf('payment-mode-first') == 0) {
                        console.log('payment-mode-first# ' + val);
                        $('input[type="hidden"][id$="payment-mode"]').val(val);
                    }

                    evt.preventDefault();
                }
                
                function onCheckboxChange(evt) {
                    var val = $(this).is(':checked');
                    /*
                    if (val) {
                        $(this).parent().addClass('cigna-bg-green-medium');
                    } else {
                        $(this).parent().removeClass('cigna-bg-green-medium');
                    }
                    */
                    console.log('### val: ' + val);
                    if(this.id.indexOf('payment-method-subseq-01') == 0 && val == true){
                        val = 'Credit Card';
                        $("#payment-method-subseq-02").prop("checked", false);
                        $("input[id$='paramPaymentMethodSubseq']").val('Credit Card');

                    }else if(this.id.indexOf('payment-method-subseq-02') == 0 && val == true){
                        val = 'Savings';
                        $("#payment-method-subseq-01").prop("checked", false);
                        $("input[id$='paramPaymentMethodSubseq']").val('Savings');

                    }

                    $(this).siblings('input[type="hidden"]').val(val).trigger('change');

                    if(this.id.indexOf('hkid-certified') == 0 && val == false){
                        console.log('### hkidCertified: ');
                        $('input[type="hidden"][id$="hkidCertified"]').val('');
                    }

                }
                
                function onCheckboxChangeTC(evt) {
                    var val = $(this).is(':checked');
                    var parent = $(this).parent();
                    $(parent).siblings('input[type="hidden"]').val(val).trigger('change');
                    console.log('accept# ' + val);
                    if(val == true) {
                        $('input[type="hidden"][id$="select-accept-tc"]').val('true');
                        console.log('accept22# ' + $('input[type="hidden"][id$="select-accept-tc"]').val());
                    }else{
                        $('input[type="hidden"][id$="select-accept-tc"]').val('');
                    }
                }
                
                function onPIRAChange(evt){
                    var val = $(this).is(':checked');
                    if(val){
                        //$('input[id$="PI-Address-1-bk"]').val($('input[id$="PH-Address-1-bk"]').val());
                        //$('input[id$="PI-Address-2-bk"]').val($('input[id$="PH-Address-2-bk"]').val());
                        //$('input[id$="PI-Address-3-bk"]').val($('input[id$="PH-Address-3-bk"]').val());
                        //$('input[id$="PI-Address-4-bk"]').val($('input[id$="PH-Address-4-bk"]').val());
                        $('div[data-id="residential-address-part"]').hide(0);
                        $('input[type="hidden"][id$="Same-Residential-Address-PH"]').val('true');
                    } else{
                        $('input[id$="PI-Address-1-bk"]').val('');
                        $('input[id$="PI-Address-2-bk"]').val('');
                        $('input[id$="PI-Address-3-bk"]').val('');
                        $('input[id$="PI-Address-4-bk"]').val('');
                        $('div[data-id="residential-address-part"]').show(0);
                        $('input[type="hidden"][id$="Same-Residential-Address-PH"]').val('false');
                    }
                }
                /*remove permanent address
                function onPIPAChange(evt){
                    var val = $(this).is(':checked');
                    if(val){
                        //$('input[id$="PI-Permanent-Address-1"]').val($('input[id$="PH-Permanent-Address-1"]').val());
                        //$('input[id$="PI-Permanent-Address-2"]').val($('input[id$="PH-Permanent-Address-2"]').val());
                        //$('input[id$="PI-Permanent-Address-3"]').val($('input[id$="PH-Permanent-Address-3"]').val());
                        //$('input[id$="PI-Permanent-Address-4"]').val($('input[id$="PH-Permanent-Address-4"]').val());
                        $('div[data-id="permanent-address-part"]').hide(0);
                        $('input[type="hidden"][id$="Same-Permanent-Address-PH"]').val('true');
                    } else{
                        $('input[id$="PI-Permanent-Address-1"]').val('');
                        $('input[id$="PI-Permanent-Address-2"]').val('');
                        $('input[id$="PI-Permanent-Address-3"]').val('');
                        $('input[id$="PI-Permanent-Address-4"]').val('');
                        $('div[data-id="permanent-address-part"]').show(0);
                        $('input[type="hidden"][id$="Same-Permanent-Address-PH"]').val('false');
                    }
                }
                */
                function finishLoading() {
                    btnNextDisabled = false;
                    btnPrevDisabled = false;
                }
                
                function validateForm() {
                    return $("form[id*='frmApplication']").validate().form();
                }
                
                function setUWStatusPolling() {

                    if (uwPollingId == null || typeof uwPollingId == undefined) {
                        uwPollingId = setInterval(pollUWStatus, 3000);
                    }
                }
                
                function pollUWStatus() {
                    
                    if (!isPolling) {
                        isPolling = true;
                        Visualforce.remoting.Manager.invokeAction(
                            '{!$RemoteAction.ESalesApplicationCtrl.getUWStatus}', 
                            $('#esales-txn-id').val(),
                            $('#esales-current-step').val(), 
                            function(result, event){
                                if (event.status && result) {
                                    resetPollingFlag();
                                } else {
                                    isPolling = false;
                                }
                            }, 
                            {escape: true}
                        );
                    }
                }
                
                //add by minghua, for IOS chrome
                function mobileChromeSetUWStatusPolling() {
                    if (uwPollingId == null || typeof uwPollingId == undefined) {
                        uwPollingId = setInterval(mobileChromePollUWStatus, 3000);
                    }
                }
                
                //add by minghua, for IOS chrome
                function mobileChromePollUWStatus() {
                    if (!isPolling) {
                        isPolling = true;
                        Visualforce.remoting.Manager.invokeAction(
                            '{!$RemoteAction.ESalesApplicationCtrl.getUWStatus}', 
                            $('#esales-txn-id').val(),
                            $('#esales-current-step').val(), 
                            function(result, event){
                                if (event.status && result) {
                                    resetPollingFlag();
                                    // closeChildWindow();
                                    var sitePrefix = "{!$Site.Prefix}";
                                    childWin.location = sitePrefix + "/apex/blankLoadingVFP";
                                    
                                    if (uwCheckPollingId == null || typeof uwCheckPollingId == undefined) {
                                        uwCheckPollingId = setInterval(closeWindowCheck, 1000);
                                    }

                                    isAutoClose = true;
                                } else {
                                    isPolling = false;
                                }
                            }, 
                            {escape: true}
                        );
                    }
                }

                //add by minghua, for IOS chrome
                function closeWindowCheck(){
                    var currentStep = $('#esales-current-step').val();
                    // Rancho_PI38_20210803
                    if ((Cigna.Util.isIOSChrome() || (Cigna.Util.isCustomerPortal() && Cigna.Util.isSafari() && !Cigna.Util.checkWebView())) && (currentStep == '{!STEP_UNDERWRITING}' || currentStep == '{!STEP_UNDERWRITING_C1}' || currentStep == '{!STEP_UNDERWRITING_C2}' || currentStep == '{!STEP_UNDERWRITING_C3}')) {
                    }else{
                        clearInterval(uwCheckPollingId);
                        uwCheckPollingId = null;
                        closeChildWindow();
                    }
                }

                //for broker salesforce1
                function mobileSetUWStatusPolling() {
                    if (uwPollingId == null || typeof uwPollingId == undefined) {
                        uwPollingId = setInterval(mobilePollUWStatus, 8000);
                    }
                }
                
                function mobilePollUWStatus() {
                    if (!isPolling) {
                        isPolling = true;
                        hideLoadingIcon('loader-icon');
                        showLoadingIcon('aps-loading-phurl');
                        var url = $('#auw-url').val();
                        var auwcom = $('#esales-AUWCompleteStep').val();
                        var curStep = $('#esales-current-step').val();
                        if(curStep == auwcom && !Cigna.Util.isAndroid()){
                            $('input[type="hidden"][id$="esales-isCompleteAUW"]').val('true');
                            refresh();
                        }else{
                            $('input[type="hidden"][id$="esales-isCompleteAUW"]').val('false');
                        }
                        Visualforce.remoting.Manager.invokeAction(
                            '{!$RemoteAction.ESalesApplicationCtrl.getUWStatus}', 
                            $('#esales-txn-id').val(),
                            $('#esales-current-step').val(), 
                            function(result, event){
                                //alert(JSON.stringify(event) + " " + result + "isAutoClose " + isAutoClose);
                                
                                if (event.status && result) {
                                    resetPollingFlag();
                                    closeChildWindow();
                                    isAutoClose = true;
                                } else {
                                    isPolling = false;
                                    if(Cigna.Util.isAndroid()){ //for android
                                        
                                        //do nothing
                                    }else if(!Cigna.Util.checkWebView()){//for safari
                                        if ((childWin == null || childWin.closed)) {
                                            if(curStep == auwcom && isAutoClose == false){
                                                $('input[type="hidden"][id$="esales-isCompleteAUW"]').val('false');
                                                refresh();
                                            }
                                            autoShowAuw(url);
                                            isAutoClose = false;
                                        }
                                    }else if(Cigna.Util.isIOS() && Cigna.Util.isSalesforce1()){//ios salesforce1
                                        //update by minghua for AUW popup --20190618
                                        if ((childWin == null || childWin.closed)) {
                                            if(curStep == auwcom && isAutoClose == false){
                                                $('input[type="hidden"][id$="esales-isCompleteAUW"]').val('false');
                                                refresh();
                                            }
                                            autoShowAuw(url);
                                            isAutoClose = false;
                                        }
                                    //}else if(Cigna.Util.isAndroid()){ //for android
                                        
                                        //do nothing
                                        //if(curStep == auwcom && isAutoClose == false){
                                        //    $('input[type="hidden"][id$="esales-isCompleteAUW"]').val('false');
                                        //    refresh();
                                        //}
                                        //isAutoClose = false;
                                        
                                    }else{//for others
                                        if ((childWin == null || childWin.closed)) {
                                            if(curStep == auwcom && isAutoClose == false){
                                                $('input[type="hidden"][id$="esales-isCompleteAUW"]').val('false');
                                                refresh();
                                            }
                                            autoShowAuw(url);
                                            isAutoClose = false;
                                        }
                                    
                                    }
                                    
                                }
                                hideLoadingIcon('aps-loading-phurl');
                                
                            }, 
                            {escape: true}
                        );
                        
                        
                    }
                }
                
                function resetPollingFlag() {
                    isPolling = false;
                    clearUWStatusPolling();
                    nextStep();
                }
                
                function clearUWStatusPolling() {
                    clearInterval(uwPollingId);
                    uwPollingId = null;
                }
                
                function removeChild(childId) {
                    btnNextDisabled = true;
                    btnPrevDisabled = true;
                    $('input[type="hidden"][id$="remove-child-id"]').val(childId);
                    ServerESales.removeChild();
                }
                
                function removeRider(riderCode) {
                    btnNextDisabled = true;
                    btnPrevDisabled = true;
                    console.log('###test ridercode: ' + riderCode);
                    //$('input[type="hidden"][id$="remove-rider-code"]').val(riderCode);
                    $("form[id*='confirmationfrm'] input[type='hidden'][id$='remove-rider-code']").val(riderCode);
                    console.log('###test ridercode2: ' + $("form[id*='confirmationfrm'] input[type='hidden'][id$='remove-rider-code']").val());
                    ServerESales.removeRider();
                }
                function removeRiderwithRole(riderCode,personRole) {
                    btnNextDisabled = true;
                    btnPrevDisabled = true;
                    console.log('###test ridercode: ' + riderCode);
                    console.log('###test personRole: ' + personRole);
                    //$('input[type="hidden"][id$="remove-rider-code"]').val(riderCode);                    
                    $("form[id*='confirmationfrm'] input[type='hidden'][id$='remove-rider-code']").val(riderCode);
                    $("form[id*='confirmationfrm'] input[type='hidden'][id$='remove-rider-role']").val(personRole);
                    console.log('###test ridercode2: ' + $("form[id*='confirmationfrm'] input[type='hidden'][id$='remove-rider-code']").val());
                    console.log('###test ridercode2: ' + $("form[id*='confirmationfrm'] input[type='hidden'][id$='remove-rider-role']").val());
                    ServerESales.removeRider();
                }
                
                function goHome() {
                    var userAgent = window.navigator.userAgent.toLowerCase();
                    var sf1withoutBrowser = /salesforce1/i.test( userAgent );
                    
                    var sitePrefix = "{!$Site.Prefix}";
                    var url = "";
                    //Rancho_BrokerLightning_20210415
                    var tempSiteName = "{!$Setup.Portal_Settings__c.Broker_Portal_Lightning_Site_Name__c}";
                    var siteName = "{!$Site.name}";
                    console.log('siteName: '+siteName + ' tempSiteName: '+ tempSiteName);
                    
                    if (Cigna.Util.isBrokerPortal()) {
                        //Rancho_BrokerLightning_20210415
                        if(siteName==tempSiteName){
                            url = sitePrefix + "/s/";
                        }else{
                            url = sitePrefix + "/apex/BrkBrokerLandingVFP";
                        }
                    } else if (Cigna.Util.isCustomerPortal()) {
                        url = sitePrefix + "/apex/CustomerLandingPage";
                    } else {
                        var currentUrl = window.location.href.substring(window.location.href.lastIndexOf('/'));
                        if (currentUrl.toLowerCase().indexOf('/cus') == 0) {
                            url = "/apex/CustomerLandingPage"; 
                        } else if (currentUrl.toLowerCase().indexOf('/brk') == 0) {
                            //Rancho_BrokerLightning_20210415
                            //url = "/apex/BrkBrokerLandingVFP";
                            if(siteName==tempSiteName){
                                url = sitePrefix + "/s/";
                            }else{
                                url = sitePrefix + "/apex/BrkBrokerLandingVFP";
                            }
                        } else {
                            url = "/apex/CustomerLandingPage"; 
                        } 
                    }
    
                    if (Cigna.Util.isSalesforce1()) {
                        //Rancho_BrokerLightning_20210415
                        // if(sf1withoutBrowser){
                        //     sforce.one.navigateToURL(url, true);
                        // } else {
                        //     window.parent.location.href = url;
                        // }
                        if(siteName==tempSiteName){
                            window.parent.location.href = url;
                        }else{
                            sforce.one.navigateToURL(url, true);
                        }
                    } else {
                        window.location.href = url;
                    }
                }
                
                function viewOtherPlans() {
                    if (Cigna.Util.isBrokerPortal()) {
                        Cigna.Util.navigateToVFP("ProductDeckVFP", null, null, true);
                    } else {
                        Cigna.Util.navigateToVFP("GetProtectedVFP", null, null, true);
                    }
                }

                function onselectToCopy(){
                    var val = $(this).is(':checked');
                    
                    if(val){

                       var holder1 = $("[id$='DDA-Credit-Card-Holder1']").val();
                       
                       var bankName = $("[id$='DDA-Card-Issuing-Bank1']").val();
                       var cardNum1 = $("[id$='paramCreditCardNum1']").val();
                       var cardNum2 = $("[id$='paramCreditCardNum2']").val();
                       var cardNum3 = $("[id$='paramCreditCardNum3']").val();
                       var cardNum4 = $("[id$='paramCreditCardNum4']").val();
                       var expiryMth = $("[id$='card-expiry-month1']").val();
                       var expiryYr = $("[id$='card-expiry-year1']").val();

                       $("[id$='DDA-Credit-Card-Holder']").val(holder1);
                       $("[id$='DDA-Card-Issuing-Bank']").val(bankName);
                       $("[id$='creditCardNum1']").val(cardNum1);
                       $("[id$='creditCardNum2']").val(cardNum2);
                       $("[id$='creditCardNum3']").val(cardNum3);
                       $("[id$='creditCardNum4']").val(cardNum4);
                       $("[id$='card-expiry-month']").val(expiryMth);
                       $("[id$='card-expiry-year']").val(expiryYr);

                       getCreditCardNo();
                    }

                }
                
                var creditCardNo = '';
                function getCreditCardNo(){
                    
                    var num1 = $("form[id*='frmApplication'] input[id$='creditCardNum1']").val();
                    var num2 = $("form[id*='frmApplication'] input[id$='creditCardNum2']").val();
                    var num3 = $("form[id*='frmApplication'] input[id$='creditCardNum3']").val();
                    var num4 = $("form[id*='frmApplication'] input[id$='creditCardNum4']").val();
                    creditCardNo = num1 + num2 + num3 + num4;
                    
                    //if(num1.length == 4 && num2.length == 4 && num3.length == 4 && num4.length == 4){        
                        $("input[id*='Credit-Card-Number']").val(creditCardNo);
                    //}
                    
                    $("form[id*='frmApplication']").validate();
                    $("input[id*='Credit-Card-Number']").each(function(idx, elem){
                        $(elem).rules("add", {
                            maskedCreditCard: true,
                            creditCard: true
                        });
                    });
                    
                    if (creditCardNo == 16){
                        //CR-56_Link_20220214
                        $("input[id*='Credit-Card-Number']").trigger("focus");
                    }
                    
                }
                //add by Davon 18/10/2017 for InsurableInterest CR start -->
                function checkInsurable(){       
                    var disagree = $("input[id*='insurableInterest-confirm-02']").val();
                    console.log("a2:" + disagree);
                  
                    // alert(disagree);
                    $('input[id*="paramInsurableInterestConfirmError"]').val(disagree);
                    //CR-56_Link_20220214
                    $('input[id*="paramInsurableInterestConfirmError"]').trigger("focus");
                                                                        
                } 

                function checkInsurableRevocate(){
                    var agree = $("input[id*='insurableInterest-confirm-01']").val();
                    // alert(agree);            
                    $('input[id*="paramInsurableInterestConfirmError"]').val(agree);
                    //CR-56_Link_20220214
                    $('input[id*="paramInsurableInterestConfirmError"]').trigger("focus");
                }
                //add by Davon 18/10/2017 for InsurableInterest CR end -->
                var creditCardNo1 = '';
                function getCreditCardNo1(){
                    
                    var num1 = $("form[id*='frmApplication'] input[id$='paramCreditCardNum1']").val();
                    var num2 = $("form[id*='frmApplication'] input[id$='paramCreditCardNum2']").val();
                    var num3 = $("form[id*='frmApplication'] input[id$='paramCreditCardNum3']").val();
                    var num4 = $("form[id*='frmApplication'] input[id$='paramCreditCardNum4']").val();
                    creditCardNo1 = num1 + num2 + num3 + num4;
                    
                    //if(num1.length == 4 && num2.length == 4 && num3.length == 4 && num4.length == 4){        
                        $("input[id*='Credit-Card-Number1']").val(creditCardNo1);
                    //}
                    
                    $("form[id*='frmApplication']").validate();
                    $("input[id*='Credit-Card-Number1']").each(function(idx, elem){
                        $(elem).rules("add", {
                            maskedCreditCard1: true,
                            creditCard: true
                        });
                    });
                    
                    if (creditCardNo1 == 16){
                        //CR-56_Link_20220214
                        $("input[id*='Credit-Card-Number1']").trigger("focus");
                    }
                }
                
                function isSavedCreditCardValue(value){
                    return value == '{!savedCreditCardWithMask}';
                }
                function isSavedCreditCardValue1(value){
                    return value == '{!savedCreditCardWithMask1}';
                }

                function hiddenonblur(element){
                   //CR-56_Link_20220214
                   $(element).trigger("blur");
                }
                
                function getBankAccNo(){
                    
                    var bankcode = $("form[id*='frmApplication'] input[id$='bank-code']").val();
                    var branchcode = $("form[id*='frmApplication'] input[id$='branch-code']").val();
                    var bankaccountcode = $("form[id*='frmApplication'] input[id$='bank-account-code']").val();

                    var bankAcctNo = bankcode + branchcode + bankaccountcode;
                    
                    //if(bankcode.length > 0 && branchcode.length > 0 && bankaccountcode.length > 0){
                    //    $("input[id*='Bank-Account-Number']").val(bankAcctNo);
                    //}        
                    
                    $("form[id*='frmApplication']").validate();
                    $("input[id*='Bank-Account-Number']").each(function(idx, elem){
                        $(elem).rules("add", {
                            //digits: true,
                            checklength :true,
                            required: true
                        });
                    });
                    if(bankcode!=null && branchcode!=null && bankaccountcode!=null){
                        if(bankcode!='' && branchcode!='' && bankaccountcode!=''){
                            console.log('bankcode'+bankcode);
                            console.log('branchcode'+branchcode);
                            console.log('bankaccountcode'+bankaccountcode);
                            $("input[id*='Bank-Account-Number']").val(bankAcctNo);
                            //CR-56_Link_20220214
                            $("input[id*='Bank-Account-Number']").trigger("focus");
                        }
                    }
                    
                }

                function checkBankAcctLength(){
                    var bankcode = $("form[id*='frmApplication'] input[id$='bank-code']").val();
                    var branchcode = $("form[id*='frmApplication'] input[id$='branch-code']").val();
                    if(bankcode.length < 3 || branchcode.length < 3){
                        return false;
                    }
                    return true;
                }

                function validateExpiryDate(resour){
                    var elemId = resour.getAttribute("id");
                    var currentdate=new Date();
                    var nowYear=currentdate.getFullYear();
                    var nowMonth=currentdate.getMonth();

                    if(elemId.indexOf('Credit-Card-Expiry-Date1') > -1){
                        var expirymth1 = $("form[id*='frmApplication'] input[id$='card-expiry-month1']").val();
                        var expiryYr1 = $("form[id*='frmApplication'] input[id$='card-expiry-year1']").val(); 
                        var expiryDt1 = expirymth1 + '/' + expiryYr1;
                        if(expirymth1.length > 0 && expiryYr1.length > 0){
                            $("input[id*='Credit-Card-Expiry-Date1']").val(expiryDt1);
                        }

                        if(expiryYr1 > nowYear){
                            return true;
                        }else if(expiryYr1 == nowYear && expirymth1 > nowMonth){
                            return true;
                        }else{
                            return false;
                        }
                    }

                    if(elemId.indexOf('Credit-Card-Expiry-Date') > -1){
                        var expirymth = $("form[id*='frmApplication'] input[id$='card-expiry-month']").val();
                        var expiryYr = $("form[id*='frmApplication'] input[id$='card-expiry-year']").val(); 
                        var expiryDt = expirymth + '/' + expiryYr;
                        if(expirymth.length > 0 && expiryYr.length > 0){
                            $("input[id*='Credit-Card-Expiry-Date']").val(expiryDt);
                        }

                        if(expiryYr > nowYear){
                            return true;
                        }else if(expiryYr == nowYear && expirymth > nowMonth){
                            return true;
                        }else{
                            return false;
                        }
                    }
                    return true;
                }

                //validation
                function checkFirstCharacter(value){
                    //the first character cannot be space and *
                    if(value.indexOf('*') == 0 || value.indexOf(' ') == 0){
                        return false;
                    }
                    return true;
                }
                function validateLength(value, len){

                    if(value.length > len){
                        return false;
                    }

                    return true;
                }
                function checkChinese(value){
                    if(/.*[\u4e00-\u9fa5]+.*$/.test(value)) {
                        return false;
                    }
                    return true;
                }
                //add by Davon 18/10/2017 for InsurableInterest CR start -->

                function checkInsurableInterestConfirm(value){
                    if (value == 'Disagree')
                        return false;
                    return true;                 
                }

                //add by Davon 18/10/2017 for InsurableInterest CR end -->
                function checkContactNoLength(value){

                    if(value.length > 20){
                        return false;
                    }
                    return true;
                }
                function checkHKID(value){
                    //only allow english character and numbers

                    if(/^[0-9a-zA-Z]*$/.test(value)) {
                        return true;
                    }
                    return false;
                }

                // Rancho_IA_AML_Inspection_20211005: check selected area
                function checkNationality(value){
                    //Link_IA_AML_Inspection_20211229
                    var codeList = {!isSanctionCodeListNa};
                    var count = 0;
                    console.log("value:"+value);
                    console.log("codeList:"+codeList);
                    codeList.forEach((data)=>{
                        if(value == data.toString()){
                            count++;
                        }
                    });
                    if(count>0){
                        return false;
                    }
                    return true;
                }

                function checkCountry(value){
                    //Link_IA_AML_Inspection_20211229
                    var code = "{!isSanctionCodeListCou}";
                    console.log("value:"+value);
                    console.log("code:"+code);
                    var codeList = code.split(",");
                    for(var i=0;i<codeList.length;i++){
                        if(codeList[i].indexOf(value) >= 0){
                            return false;
                        }
                    }
                    return true;
                }

                function showLoadingIcon(id){
                    $('#' + id).show();
                }
        
                function hideLoadingIcon(id){
                    $('#' + id).hide();
                }
                
                function checkIsAccept(){
                    var a = $('input[type="hidden"][id$="select-accept-tc"]').val();
                    //var a = $('input[id$="select-accept-tc"]').val();
                    if(a=='true'){
                        return true;
                    } else {
                        return false;
                    }
                    return false;
                }
                
                function returnToPreviousPage(){
                    PreviouPage();
                }
                
                function changeToOthers(tar,id){
                    var oth = tar.value;
                    if(oth == 'Others'){
                        $('#' + id).show();
                    }else{
                        $('#' + id).hide();
                    }
                }
                
                
                function isHKIDHolderChange(tar,id1){
                    var holder = tar.value;
                    var holderid = tar.id;

                    if(holder == 'Yes'){
                        $('#' + id1).hide();
                        //if(holderid.indexOf('PH-isPermanentHKID') > -1){
                        //    $('#reasonpurchase').hide();
                        //}
                    }else{
                        $('#' + id1).show();
                        //if(holderid.indexOf('PH-isPermanentHKID') > -1){
                        //    $('#reasonpurchase').show();
                        //}
                    }
                }
                
                /*remove permanent address
                function ValidatePermanentAddress(){
                    
                    var add1 = $("form[id*='frmApplication'] input[id$='PH-Permanent-Address-1']").val();
                    var add2 = $("form[id*='frmApplication'] input[id$='PH-Permanent-Address-2']").val();
                    var add3 = $("form[id*='frmApplication'] input[id$='PH-Permanent-Address-3']").val();
                    var add4 = $("form[id*='frmApplication'] input[id$='PH-Permanent-Address-4']").val();
                    
                    if(add1 != ''|| add2 != '' || add3 != '' || add4 != ''){
                        $("form[id*='frmApplication']").validate();
                        $("input[id*='PH-Permanent-Address-1']").each(function(idx, elem){
                            $(elem).rules("add", {
                                required : true
                            });
                        });
                        
                    }else{
                        $("form[id*='frmApplication']").validate();
                        $("input[id*='PH-Permanent-Address-1']").each(function(idx, elem){
                            $(elem).rules("add", {
                                required : false
                            });
                        });
                    }
                    
                }
                */
                function validateShareTotal(){
                    var shareTotal = 0;
                    var hasBen = 'false';
                    
                    $("input[id*='PH-Share-Percentage']").each(function(idx, elem){
                        shareTotal+= parseInt($(elem).val());
                    });
                    
                    $("input[id*='PH-Beneficiary-Firstname']").each(function(idx, elem){
                        var benName = $("input[id*='PH-Beneficiary-Firstname']").val();
                        if(benName != ''){
                            hasBen = 'true';
                        }
                    });
                    
                    if(hasBen == 'true'){
                        if(shareTotal == '100'){
                            $('#Share-Total-errMsg').hide();
                            return true;
                            
                        }else{
                           $('#Share-Total-errMsg').show();
                            return false;
                            
                        }
                    }else{
                        return true;
                    }
                }
                
                function validateShareTotalPI(){
                    var shareTotal = 0;
                    var hasBen = 'false';
                    
                    $("input[id*='PI-Share-Percentage']").each(function(idx, elem){
                        shareTotal+= parseInt($(elem).val());
                    });
                    
                    $("input[id*='PI-Beneficiary-Firstname']").each(function(idx, elem){
                        var benName = $("input[id*='PI-Beneficiary-Firstname']").val();
                        if(benName != ''){
                            hasBen = 'true';
                        }
                    });
                    
                    if(hasBen == 'true'){
                        if(shareTotal == '100'){
                            $('#Share-Total-errMsg-PI').hide();
                            return true;
                            
                        }else{
                           $('#Share-Total-errMsg-PI').show();
                            return false;
                            
                        }
                    }else{
                        return true;
                    }
                }
                
                function validateShareTotalC1(){
                    var shareTotal = 0;
                    var hasBen = 'false';
                    
                    $("input[id*='C1-Share-Percentage']").each(function(idx, elem){
                        shareTotal+= parseInt($(elem).val());
                    });
                    
                    $("input[id*='C1-Beneficiary-Firstname']").each(function(idx, elem){
                        var benName = $("input[id*='C1-Beneficiary-Firstname']").val();
                        if(benName != ''){
                            hasBen = 'true';
                        }
                    });
                    
                    if(hasBen == 'true'){
                        if(shareTotal == '100'){
                            $('#Share-Total-errMsg-C1').hide();
                            return true;
                            
                        }else{
                           $('#Share-Total-errMsg-C1').show();
                            return false;
                            
                        }
                    }else{
                        return true;
                    }
                }
                
                function validateShareTotalC2(){
                    var shareTotal = 0;
                    var hasBen = 'false';
                    
                    $("input[id*='C2-Share-Percentage']").each(function(idx, elem){
                        shareTotal+= parseInt($(elem).val());
                    });
                    
                    $("input[id*='C2-Beneficiary-Firstname']").each(function(idx, elem){
                        var benName = $("input[id*='C2-Beneficiary-Firstname']").val();
                        if(benName != ''){
                            hasBen = 'true';
                        }
                    });
                    
                    if(hasBen == 'true'){
                        if(shareTotal == '100'){
                            $('#Share-Total-errMsg-C2').hide();
                            return true;
                            
                        }else{
                           $('#Share-Total-errMsg-C2').show();
                            return false;
                            
                        }
                    }else{
                        return true;
                    }
                }
                
                function validateShareTotalC3(){
                    var shareTotal = 0;
                    var hasBen = 'false';
                    
                    $("input[id*='C3-Share-Percentage']").each(function(idx, elem){
                        shareTotal+= parseInt($(elem).val());
                    });
                    
                    $("input[id*='C3-Beneficiary-Firstname']").each(function(idx, elem){
                        var benName = $("input[id*='C3-Beneficiary-Firstname']").val();
                        if(benName != ''){
                            hasBen = 'true';
                        }
                    });
                    
                    if(hasBen == 'true'){
                        if(shareTotal == '100'){
                            $('#Share-Total-errMsg-C3').hide();
                            return true;
                            
                        }else{
                           $('#Share-Total-errMsg-C3').show();
                            return false;
                            
                        }
                    }else{
                        return true;
                    }
                }

                /*For upload attachment*/  
                
                /*
                function uploadFile(parentId, attType){
                    
                    showLoadingIcon('snd-loading-phurl');

                    $('#errNoFile').hide();

                    $("#"+attType).each(function(){
            
                      filesToUpload=$(this)[0].files[0];
                      
                    });

                    var reader = new FileReader();
            
                    // Keep a reference to the File in the FileReader so it can be accessed in callbacks
                    reader.file = filesToUpload;
            
                    reader.onload = function(e)
                    {
                        var maxFileSize = 7340032;
                        var passFileSize;
                        var passFileType;
                        
                        if(this.file.size>maxFileSize){
                            $("#errFileSize").show();
                            passFileType = false;
                        }else{
                            passFileSize = 'true';
                            $("#errFileSize").hide();
                        }
                    
                        if(this.file.type!='application/vnd.openxmlformats-officedocument.wordprocessingml.document' && this.file.type!='application/msword' && this.file.type!='application/pdf' && this.file.type!='image/png' && this.file.type!='image/jpeg' && this.file.type!='image/tiff'){
                            $("#errFileType").show();
                        }else{
                            passFileType  = 'true';
                            $("#errFileType").hide();
                        }
                        
                        if(passFileType=='true' && passFileSize=='true' && parentId && parentId!=undefined){
                        
                            var att = new sforce.SObject("Attachment");
                            att.Name = attType+'_'+this.file.name;
                            att.ContentType = this.file.type;
                            att.ParentId = parentId;
            
                            var binary = "";
                            var bytes = new Uint8Array(e.target.result);
                            var length = bytes.byteLength;
            
                            for (var i = 0; i < length; i++)
                            {
                                binary += String.fromCharCode(bytes[i]);
                            }
            
                            att.Body = (new sforce.Base64Binary(binary)).toString();
            
                            sforce.connection.create([att],
                            {
                                onSuccess : function(result, source)
                                {
                                    if (result[0].getBoolean("success"))
                                    {
                                        console.log("new attachment created with id " + result[0].id);
                                        hideLoadingIcon('snd-loading-phurl');
                                        refreshAttlist();
                                        //checkAtt();
                                        if(attType!='auwAtt'){
                                            $("html, body").animate({ scrollTop: $(document).height() }, "slow");
                                        }
                                        
            
                                    }
                                    else
                                    {
                                        console.log("failed to create attachment " + result[0]);
                                        //alert("failed to create attachment " + result[0]);
                                        hideLoadingIcon('snd-loading-phurl');
                                        
                                    }
                                },
                                onFailure : function(error, source)
                                {
                                    console.log("an error has occurred " + error);
                                    //alert("an error has occurred " + error);
                                    hideLoadingIcon('snd-loading-phurl');
                                }
                            });
                        }else{
                            hideLoadingIcon('snd-loading-phurl');
                        }
                    };
                    
                    if(filesToUpload!='' || filesToUpload!='1'){
                        reader.readAsArrayBuffer(filesToUpload);
                        $("#errNoFile").hide();
                    }else{
                        finishSubmission();
                        $("#errNoFile").show();
                    }
                } 
                */
                
                function uploadFile(parentId, attType){
                    
                    showLoadingIcon('snd-loading-phurl');

                    $('#errNoFile').hide();

                    $("#"+attType).each(function(){
            
                      filesToUpload=$(this)[0].files[0];
                      
                    });

                    var reader = new FileReader();
            
                    // Keep a reference to the File in the FileReader so it can be accessed in callbacks
                    reader.file = filesToUpload;
                    if(typeof(filesToUpload)  === "undefined"){
                        alert('please select file.');
                    } else {
                        reader.onload = function(e)
                        {
                            // minghua - 20220523 - file virus scan
                            // var maxFileSize = 26214400;//7340032;
                            var maxFileSize = 10485760;
                            var passFileSize;
                            var passFileType;
                            
                            if(this.file.size>maxFileSize){
                                $("#errFileSize").show();
                                passFileType = false;
                            }else{
                                passFileSize = 'true';
                                $("#errFileSize").hide();
                            }
                        
                            if(this.file.type!='application/vnd.openxmlformats-officedocument.wordprocessingml.document' && this.file.type!='application/msword' && this.file.type!='application/pdf' && this.file.type!='image/png' && this.file.type!='image/jpeg' && this.file.type!='image/tiff'){
                                $("#errFileType").show();
                            }else{
                                passFileType  = 'true';
                                $("#errFileType").hide();
                            }
                            
                            if(passFileType=='true' && passFileSize=='true' && parentId && parentId!=undefined){
                                /*
                                var att = new sforce.SObject("Attachment");
                                att.Name = attType+'_'+this.file.name;
                                att.ContentType = this.file.type;
                                att.ParentId = parentId;
                                */
                                var binary = "";
                                var bytes = new Uint8Array(e.target.result);
                                var length = bytes.byteLength;
                
                                for (var i = 0; i < length; i++)
                                {
                                    binary += String.fromCharCode(bytes[i]);
                                }
                
                                //att.Body = (new sforce.Base64Binary(binary)).toString();
                                var attachment_object = {
                                    parentId: parentId,
                                    Body: window.btoa(binary), 
                                    Name: attType+'_'+this.file.name, 
                                    ContentType: this.file.type 
                                };
                                
                                 $.ajax({
                                    url: '{!$Site.BaseUrl}/services/data/v38.0/sobjects/Attachment',
                                    data: JSON.stringify(attachment_object),
                                    type: 'POST',
                                    processData: false,
                                    contentType: false,
                                    headers: {'Authorization': 'Bearer {!GETSESSIONID()}', 'Content-Type': 'application/json'},
                                    xhr: function(){
                                        var xhr = new window.XMLHttpRequest();
                                        //Upload progress
                                        xhr.upload.addEventListener("progress", function(evt){
                                            if (evt.lengthComputable) {
                                                var percentComplete = evt.loaded / evt.total;
                                                //Do something with upload progress
                                                console.log("Percentage:"+percentComplete);
                                            }
                                        }, false);
                                        return xhr;
                                    },
                                    
                                     success: function(response) {
                                        console.log(response); 
                                        hideLoadingIcon('snd-loading-phurl');
                                        refreshAttlist();
                                        //checkAtt();
                                        if(attType!='auwAtt'){
                                            $("html, body").animate({ scrollTop: $(document).height() }, "slow");
                                        }
                                    },
                                    
                                     error: function(xhr, status, error) {
                                        var errorMessage = xhr.status + ': ' + xhr.statusText
                                        console.log('ERROR:'+ errorMessage); 
                                        hideLoadingIcon('snd-loading-phurl');
                                    }
                                });
                                
                            }else{
                                hideLoadingIcon('snd-loading-phurl');
                            }
                        };
                        
                        if(filesToUpload!='' || filesToUpload!='1'){
                            reader.readAsArrayBuffer(filesToUpload);
                            $("#errNoFile").hide();
                        }else{
                            finishSubmission();
                            $("#errNoFile").show();
                        }
                    }
                } 
                
                
                function redirectToQuote() {
                
                    var params;
                    if(Cigna.Util.isBrokerPortal()){
                        params = {
                            plan : "{!paraPlan}",
                            phFN : "{!txn.Policy_Holder_First_Name__c}",
                            phLN : "{!txn.Policy_Holder_Last_Name__c}",
                            phGender : "{!txn.Gender__c}",
                            phCountryCode : "{!txn.Country_Code__c}",
                            phMobileNo : "{!txn.Contact_No__c}",
                            phDOBYear : "{!paramDOBPHYear}",
                            phDOBMonth : "{!paramDOBPHMonth}",
                            phDOBDay : "{!paramDOBPHDay}",
                            tid : "{!paramESalesTxnId}",
                            fromPage : "Esales"
                        };
                        
                        Cigna.Util.navigateToVFP("GetQuoteVFP?" + $.param(params), null, null, true);
                        
                    }else{
                        if({!txn.Basic_Plan_Code__c == 'DMB'}){
                            params = {
                                plan : "{!paraPlan}",
                                tid : "{!paramESalesTxnId}",
                                Category : "{!paraCategory}"
                            };
                        }else{
                            params = {
                                plan : "{!paraPlan}",
                                Category : "{!paraCategory}"
                            };
                        }

                        Cigna.Util.navigateToVFP("GetQuoteVFP?" + $.param(params), null, null, true);
                        
                    }
                }

                function appealQuestionYes(){
                    $('input[type="hidden"][id$="esales-isAppealYes"]').val(true);
                    $('input[type="hidden"][id$="esales-isAppealNo"]').val(false);
                    console.log('click yes: ' + $('input[type="hidden"][id$="esales-isAppealYes"]').val());
                    ServerESales.refreshAppealPanel();
                    $("html, body").animate({ scrollTop: $(document).height() }, "slow");
                }
                
                function appealQuestionNo(){
                    $('input[type="hidden"][id$="esales-isAppealNo"]').val(true);
                    $('input[type="hidden"][id$="esales-isAppealYes"]').val(false);
                    console.log('click No: ' + $('input[type="hidden"][id$="esales-isAppealNo"]').val());
                    ServerESales.refreshAppealPanel();
                    if({!txn.AUW_Overall_Result__c == 'Decline'}){
                        $('#removeChild1').hide();
                        $('#removeChild2').hide();
                        $('#removeChild3').hide();
                        $('#eSales-back-btn').hide();
                        $('#eSales-save-btn').hide();
                        $("[id*='reridericon-']").each(function(idx, elem){
                            var ids = elem.id;
                            $('#' + ids).hide();
                        });
                    }

                    $("html, body").animate({ scrollTop: $(document).height() }, "slow");
                }
                
                function refreshEsignatrueButton(){
                    
                    if($('#mobile-submit').length ){
                        $('#mobile-submit').show();
                        $('#mobile-sendEmail').hide();
                        $('#mobile-esignature-sendEmail').hide();
                        $('#mobile-esignature-submit').hide();
                    }
                }

                function redirectToSendEmail() {
                    
                    Cigna.Util.navigateToVFP("EmailQuoteVFP?tid={!paramESalesTxnId}&plan={!paraPlan}&fromPage=Esales", null, null, true);
                }
                function submitApplication(){

                    var formvalid = 1;

                    formvalid = 0;
                    ConfirmationForm.Validate.formValidation();
                    formvalid = ($("form[id*='confirmationfrm']")).validate().form();
                    if (formvalid == 0){
                        //CR-56_Link_20220214
                        $("html,body").animate({ scrollTop: ($("form[id*='confirmationfrm']")).find(":input.error:first").offset().top - $(window).height()/2},"slow",function(){($("form[id*='confirmationfrm']")).find(":input.error:first").trigger("focus");} );
                    }

                    if(validateForm() && formvalid){
                        submitApplicationfrm();
                    }
                    
                }

                function contactMe(){
                    Cigna.Util.navigateToVFP("ContactMeVFP?tid={!paramESalesTxnId}&plan={!paraPlan}&fromPage=Esales", null, null, true);
                }
                

                return {
                    autoShowAuw : autoShowAuw,
                    closeChildWindow : closeChildWindow,
                    nextStep : nextStep,
                    prevStep : prevStep,
                    finishLoading : finishLoading,
                    onRadioChange : onRadioChange,
                    onCheckboxChange : onCheckboxChange,
                    onCheckboxChangeTC : onCheckboxChangeTC,
                    onPIRAChange : onPIRAChange,
                    //onPIPAChange : onPIPAChange,
                    mobileChromeSetUWStatusPolling: mobileChromeSetUWStatusPolling,
                    setUWStatusPolling : setUWStatusPolling,
                    clearUWStatusPolling : clearUWStatusPolling,
                    resetPollingFlag : resetPollingFlag,
                    removeChild : removeChild,
                    removeRider : removeRider,
                    removeRiderwithRole : removeRiderwithRole,
                    saveRecord : saveRecord,
                    finishSaving : finishSaving,
                    goHome : goHome,
                    viewOtherPlans : viewOtherPlans,
                    onselectToCopy : onselectToCopy,
                    checkInsurable : checkInsurable,
                    checkInsurableRevocate : checkInsurableRevocate,
                    getCreditCardNo : getCreditCardNo,
                    getCreditCardNo1 : getCreditCardNo1,
                    showLoadingIcon : showLoadingIcon,
                    hideLoadingIcon : hideLoadingIcon,
                    mobileSetUWStatusPolling : mobileSetUWStatusPolling,
                    mobilePollUWStatus : mobilePollUWStatus,
                    checkIsAccept : checkIsAccept,
                    returnToPreviousPage : returnToPreviousPage,
                    changeToOthers : changeToOthers,
                    //ValidatePermanentAddress : ValidatePermanentAddress,
                    validateShareTotal : validateShareTotal,
                    validateShareTotalPI : validateShareTotalPI,
                    validateShareTotalC1 : validateShareTotalC1,
                    validateShareTotalC2 : validateShareTotalC2,
                    validateShareTotalC3 : validateShareTotalC3,
                    uploadFile : uploadFile,
                    redirectToQuote : redirectToQuote,
                    getBankAccNo : getBankAccNo,
                    appealQuestionYes : appealQuestionYes,
                    appealQuestionNo : appealQuestionNo,
                    isHKIDHolderChange : isHKIDHolderChange,
                    checkBankAcctLength : checkBankAcctLength,
                    validateExpiryDate : validateExpiryDate,
                    checkFirstCharacter : checkFirstCharacter,
                    validateLength : validateLength,
                    checkChinese : checkChinese,
                    checkInsurableInterestConfirm : checkInsurableInterestConfirm,
                    checkHKID : checkHKID,
                    checkContactNoLength : checkContactNoLength,
                    refreshEsignatrueButton : refreshEsignatrueButton,
                    isSavedCreditCardValue : isSavedCreditCardValue,
                    isSavedCreditCardValue1 : isSavedCreditCardValue1,
                    redirectToSendEmail : redirectToSendEmail,
                    submitApplication : submitApplication,
                    contactMe : contactMe,
                    // Rancho_IA_AML_Inspection_20211005
                    checkNationality : checkNationality,
                    checkCountry : checkCountry
                }
            }(); 
            
            $(document).ready(function(){
                // CR-56_Link_20220214
                $('[data-toggle="tooltip"]').tooltip();

                sforce.connection.serverUrl = "{!$Site.Prefix}/services/Soap/u/32.0";
 
                $('input[type="hidden"][id$="esales-documentloadReady"]').val(true);

                //add by minghua for popup
                if (Cigna.Util.isIOSChrome()) {
                    $('input[type="hidden"][id$="esales-isIOSChrome"]').val(true);
                }

                if (Cigna.Util.isSalesforce1() && Cigna.Util.isBrokerPortal()) {
                    $('input[type="hidden"][id$="esales-isSalesforce1"]').val(true);
                } else {
                    $('input[type="hidden"][id$="esales-isSalesforce1"]').val(false);
                }
                
                if (Cigna.Util.isSalesforce1() && Cigna.Util.isBrokerPortal() && Cigna.Util.isAndroid()) {
                    $('input[type="hidden"][id$="esales-isAndroidShowButton"]').val(true);
                } else {
                    $('input[type="hidden"][id$="esales-isAndroidShowButton"]').val(false);
                }

                // Rancho_BPE57_03_20210518
                if (Cigna.Util.isSalesforce1AUW()) {
                    $('input[type="hidden"][id$="esales-isSalesforce1AUW"]').val(true);
                } else {
                    $('input[type="hidden"][id$="esales-isSalesforce1AUW"]').val(false);
                }

                // Rancho_PI38_20210803
                if (Cigna.Util.isSafari()) {
                    $('input[type="hidden"][id$="esales-isSafari"]').val(true);
                } else {
                    $('input[type="hidden"][id$="esales-isSafari"]').val(false);
                }

                // Rancho_PI38_20210803
                if (Cigna.Util.checkWebView()) {
                    $('input[type="hidden"][id$="esales-isCustomerApp"]').val(true);
                } else {
                    $('input[type="hidden"][id$="esales-isCustomerApp"]').val(false);
                }
                
                getCustomerBasic();
                
                var edu = $("[id$='PH-EducationLevel']").val();
                if(edu && edu.toUpperCase() == 'OTHERS'){
                    $('#EducationOthers').show();
                }else{
                    $('#EducationOthers').hide();
                }
                
                var meansIncome = $("[id$='PH-means-income']").val();
                console.log('meansIncome: ' + meansIncome);
                if(meansIncome && meansIncome.toUpperCase() == 'OTHERS'){
                    $('#meansIncomeOther').show();
                }else{
                    $('#meansIncomeOther').hide();
                }
                
                var hkholder = $("[id$='PH-isPermanentHKID']").val();
                console.log('hkholder: ' + hkholder);
                if(hkholder == 'No'){
                    $('#reasonpurchase').show();
                }else{
                    $('#reasonpurchase').hide();
                }
                
                var successPay = $('input[type="hidden"][id$="esales-afterPay"]').val();
                console.log('###successPay: ' + successPay);
                if(successPay=='true'){
                    console.log('###begin: ' + successPay);
                    eSalesDoneAndCallWS();
                    $('input[type="hidden"][id$="esales-afterPay"]').val(false);
                    console.log('###afterpay: ' + $('input[type="hidden"][id$="esales-afterPay"]').val());
                }
                refreshEsignature();
                
            });
        </script>
    </head>
    <apex:define name="additionalLibraries">
         <!--additional css, bootstrap, jquery,js libraries-->
         <!-- CR-56_Link_20220214 -->
         <script type="text/javascript" src="{!URLFOR($Resource.jQuery_Validation, 'jquery.validate_new.min.js')}"/>
         <script type="text/javascript" src="{!URLFOR($Resource.jQuery_Validation, 'additional-methods.min.js')}" />
         <apex:outputPanel rendered="{!$Label.User_Language == 'zh_tw'}" layout="none">
         <script type="text/javascript" src="{!URLFOR($Resource.jQuery_Validation, '/localization/messages_zh_TW.min.js')}" />
         </apex:outputPanel>
         <apex:stylesheet value="{!URLFOR($Resource.Cigna_HK_Icons, 'Cigna-HK-Icons.css')}"/>
         
    </apex:define>
    <!--<apex:form id="frmApplication" styleClass="cigna-esales-form">-->
    <apex:outputPanel id="errmessage">
        <div class="bs row">
            <apex:pagemessages ></apex:pagemessages>
        </div>
    </apex:outputPanel>

    <apex:outputPanel id="wrapper">
        <div class="bs col-xs-12 form-horizontal">
        <apex:form id="frmApplication" styleClass="cigna-esales-form">

        <apex:actionFunction action="{!nextStep}" name="nextStep" namespace="ServerESales" 
                         reRender="wrapper,wrapperApp,errmessage" oncomplete="refreshEsignature();retrieveAUWURL_JS();Cigna.ESales.finishLoading();" status="loader-icon"
        />
        <apex:actionFunction action="{!prevStep}" name="prevStep" namespace="ServerESales" 
                             reRender="wrapper,wrapperApp" oncomplete="Cigna.ESales.finishLoading();" status="loader-icon"
        />
        <apex:actionFunction action="{!saveRecord}" name="saveRecord" namespace="ServerESales" 
                             reRender="wrapper,wrapperApp" status="loader-icon"
        />
        
        <apex:actionFunction action="{!retrieveAUWURL}" name="retrieveAUWURL_JS" status="loader-icon" reRender="wrapper,wrapperApp"
        /> 
        <apex:actionFunction action="{!getPaymentAmount}" name="getPaymentAmount" reRender="wrapper,wrapperApp"
        /> 
        <apex:actionFunction action="{!addHolderForJointAccount}" name="addHolderForJointAccount" reRender="wrapper,wrapperApp"
        /> 
        <apex:actionFunction action="{!minusHolderForJointAccount}" name="minusHolderForJointAccount" reRender="wrapper,wrapperApp"
        /> 
        <apex:actionFunction action="{!epayment}" name="epayment" reRender="wrapper,wrapperApp"
        /> 
        <apex:actionFunction action="{!onSelectHeightUnit}" name="onSelectHeightUnit" reRender="wrapper,wrapperApp"
        /> 
        <apex:actionFunction action="{!onSelectPIHeightUnit}" name="onSelectPIHeightUnit" reRender="wrapper,wrapperApp"
        /> 
        <apex:actionFunction action="{!onSelectC1HeightUnit}" name="onSelectC1HeightUnit" reRender="wrapper,wrapperApp"
        /> 
        <apex:actionFunction action="{!onSelectC2HeightUnit}" name="onSelectC2HeightUnit" reRender="wrapper,wrapperApp"
        /> 
        <apex:actionFunction action="{!onSelectC3HeightUnit}" name="onSelectC3HeightUnit" reRender="wrapper,wrapperApp"
        /> 
        <apex:actionFunction action="{!refresh}" name="refresh" reRender="wrapper,wrapperApp"
        /> 
        <apex:actionFunction action="{!getCustomerBasic}" name="getCustomerBasic" reRender="wrapper,wrapperApp" status="loader-icon"
        />  
        <apex:actionFunction action="{!returnToPreviouPage}" name="PreviouPage" reRender="wrapper,wrapperApp"
        />  
        <apex:actionFunction action="{!appealFunctionNo}" name="refreshAppealPanel" namespace="ServerESales" status="loader-icon"
        reRender="appealParam,showappealQuestion,showappealQuestionApp,showAppealRemarkUpload,showPaymentMode,showTCSelection,showReturnHome,showReturnHomeApp,showNextButton,showNextButtonApp,validationRulePanel,backSavePanel,errmessage" />
        
        <apex:actionFunction name="addRowBeneficiary" action="{!addRowBeneficiary}" rerender="wrapper,wrapperApp"/>
        <apex:actionFunction name="removeRowBeneficiary" action="{!removeRowBeneficiary}" rerender="wrapper,wrapperApp">
              <apex:param name="rowIndex" value="" assignTo="{!rowIndex}"/>
              <apex:param name="removeBenlId" value="" assignTo="{!removeBenlId}"/>
        </apex:actionFunction>
        <apex:actionFunction name="addRowBeneficiaryPI" action="{!addRowBeneficiaryPI}" rerender="wrapper,wrapperApp"/>
        <apex:actionFunction name="removeRowBeneficiaryPI" action="{!removeRowBeneficiaryPI}" rerender="wrapper,wrapperApp">
              <apex:param name="rowIndex" value="" assignTo="{!rowIndexPI}"/>
              <apex:param name="removeBenlId" value="" assignTo="{!removeBenlIdPI}"/>
        </apex:actionFunction>
        <apex:actionFunction name="addRowBeneficiaryC1" action="{!addRowBeneficiaryC1}" rerender="wrapper,wrapperApp"/>
        <apex:actionFunction name="removeRowBeneficiaryC1" action="{!removeRowBeneficiaryC1}" rerender="wrapper,wrapperApp">
              <apex:param name="rowIndex" value="" assignTo="{!rowIndexC1}"/>
              <apex:param name="removeBenlId" value="" assignTo="{!removeBenlIdC1}"/>
        </apex:actionFunction>
        <apex:actionFunction name="addRowBeneficiaryC2" action="{!addRowBeneficiaryC2}" rerender="wrapper,wrapperApp"/>
        <apex:actionFunction name="removeRowBeneficiaryC2" action="{!removeRowBeneficiaryC2}" rerender="wrapper,wrapperApp">
              <apex:param name="rowIndex" value="" assignTo="{!rowIndexC2}"/>
              <apex:param name="removeBenlId" value="" assignTo="{!removeBenlIdC2}"/>
        </apex:actionFunction>
        <apex:actionFunction name="addRowBeneficiaryC3" action="{!addRowBeneficiaryC3}" rerender="wrapper,wrapperApp"/>
        <apex:actionFunction name="removeRowBeneficiaryC3" action="{!removeRowBeneficiaryC3}" rerender="wrapper,wrapperApp">
              <apex:param name="rowIndex" value="" assignTo="{!rowIndexC3}"/>
              <apex:param name="removeBenlId" value="" assignTo="{!removeBenlIdC3}"/>
        </apex:actionFunction>
        <apex:actionFunction name="removeAttachment" action="{!removeAtt}" rerender="uploadatt,uploadUWatt">
            <apex:param name="id" value="" assignTo="{!removeAttId}" />
        </apex:actionFunction>            
        <apex:actionFunction name="refreshAttlist" rerender="uploadatt,uploadUWatt" status="loader-icon"/>
        
        <apex:actionFunction name="refreshEsignature" reRender="payment-esignature-section" status="loader-icon" />

        <apex:actionFunction action="{!eSalesDoneAndCallWS}" name="eSalesDoneAndCallWS" reRender="wrapper,wrapperApp" status="loader-icon"/>  
        
        <!-- GL31 jack add -->
        <apex:actionFunction action="{!getAvailableProduct}" name="getAvailableProduct" reRender="wrapper,wrapperApp"  status="loader-icon" oncomplete="Cigna.ESales.nextStep();">
                <apex:param name="result" value=""/>
        </apex:actionFunction>
        <apex:actionFunction name="backToAssessment" action="{!backToAssessment}" reRender="wrapper,wrapperApp" status="loader-icon"/>


        <input type="hidden" id="esales-current-step" value="{!currentStep}" />
        <input type="hidden" id="esales-txn-id" value="{!txn.Id}" />
        <input type="hidden" id="esales-AUWCompleteStep" value="{!AUWCompleteStep}" />
        
        <apex:inputHidden id="esales-isSalesforce1" value="{!isSalesforce1}" />
        <apex:inputHidden id="esales-isAndroidShowButton" value="{!isAndroidShowButton}" />
        <apex:inputHidden id="esales-documentloadReady" value="{!documentloadReady}" />
        <apex:inputHidden id="isAvailableProduct" value="{!isAvailableProduct}" /><!-- GL31 jack add -->
        <apex:inputHidden id="esales-isSalesforce1AUW" value="{!isSalesforce1AUW}" /><!-- Rancho_BPE57_03_20210518 -->
        <apex:inputHidden id="esales-isSafari" value="{!isSafari}" /><!-- Rancho_PI38_20210803 -->
        <apex:inputHidden id="esales-isCustomerApp" value="{!isCustomerApp}" /><!-- Rancho_PI38_20210803 -->

        <!-- add by minghua for popup -->
        <apex:inputHidden id="esales-isIOSChrome" value="{!isIOSChrome}" />
         
        <apex:inputHidden id="esales-afterPay" value="{!afterPay}" />
        <apex:inputHidden id="esales-basicProduct" value="{!txn.Basic_Plan_Code__c}" />

        <apex:outputPanel id="appealParam">
            <apex:inputHidden id="esales-isAppealYes" value="{!isAppealYes}" />
            <apex:inputHidden id="esales-isAppealNo" value="{!isAppealNo}" />
        </apex:outputPanel>

        <apex:outputPanel id="backSavePanel">
        <apex:outputPanel layout="block" rendered="{!currentStep >= STEP_CONFIRMATION && currentStep < STEP_PAYMENT  && !(txn.AUW_Overall_Result__c == 'Decline' && isCustomerPortal) && !(txn.AUW_Overall_Result__c == 'Decline' && isBrokerPortal && isAppealNo)}" styleClass="bs row">
            <div class="bs col-xs-12">
                <p class="bs pull-left"><a id="eSales-back-btn" class="bs cigna-fg-orange-medium onclick-pointer" style="text-decoration: none;"><i class="ci-hk-arrow-29" aria-hidden="true"></i> {!$Label.Back}</a></p>
                <p class="bs pull-right"><a id="eSales-save-btn" class="bs cigna-fg-orange-medium onclick-pointer" style="text-decoration: none;">{!$Label.Save} <i class="ci-hk-briefcase" aria-hidden="true"></i> </a></p>
            </div>
            <script>
                //CR-56_Link_20220214
                $('#eSales-back-btn').on("click",Cigna.ESales.prevStep);
                $('#eSales-save-btn').on("click",Cigna.ESales.saveRecord);
            </script>
        </apex:outputPanel>
        </apex:outputPanel>
        <apex:outputPanel layout="block" rendered="{!currentStep == STEP_PERSONAL_DETAIL}" styleClass="bs row">
            <div class="bs col-xs-12">
                <p class="bs pull-left"><a id="eSales-back-btn" class="bs cigna-fg-orange-medium onclick-pointer" style="text-decoration: none;" onclick="{!IF(currentStep == STEP_PERSONAL_DETAIL && isBrokerPortal && txn.Product__r.Life_GI__c == 'GI','Cigna.ESales.prevStep()','Cigna.ESales.redirectToQuote();')}"><i class="ci-hk-arrow-29" aria-hidden="true"></i> {!$Label.Back}</a></p><!-- GL31 jack add -->
                <p class="bs pull-right"><a id="eSales-save-btn" class="bs cigna-fg-orange-medium onclick-pointer" style="text-decoration: none;">{!$Label.Save} <i class="ci-hk-briefcase" aria-hidden="true"></i> </a></p>
            </div>
            <script>
               //CR-56_Link_20220214
               $('#eSales-save-btn').on("click",Cigna.ESales.saveRecord);
            </script>
        </apex:outputPanel>
        <!-- GL31 jack add -->
        <apex:outputPanel layout="block" rendered="{!currentStep == STEP_ASSESSMENT_QUESTION}" styleClass="bs row">
            <div class="bs col-xs-12">
                <p class="bs pull-left"><a id="eSales-back-btn" class="bs cigna-fg-orange-medium onclick-pointer" style="text-decoration: none;" onclick="{!IF(!displayWarningMessage,'Cigna.ESales.redirectToQuote();','backToAssessment();')}"><i class="ci-hk-arrow-29" aria-hidden="true"></i> {!$Label.Back}</a></p>
                <!-- <p class="bs pull-right"><a id="eSales-save-btn" class="bs cigna-fg-orange-medium onclick-pointer" style="text-decoration: none;">{!$Label.Save} <i class="ci-hk-briefcase" aria-hidden="true"></i> </a></p> -->
            </div>
            <script>
                //CR-56_Link_20220214
                $('#eSales-save-btn').on("click",Cigna.ESales.saveRecord);
            </script>
        </apex:outputPanel>
        
        <div class="bs row">
            <apex:outputPanel >
                <div class="bs hidden-xs col-sm-12 cigna-progress-bar desktopProgressBar">
                    <div class="bs cigna-progress-bar-inner">
                        <div class="bs {!IF(currentStep == STEP_PERSONAL_DETAIL, 'active', '')}">{!IF(isCustomerPortal, $Label.Your_Details, $Label.Client_Details)}</div>
                        <div class="bs {!IF(currentStep == STEP_UNDERWRITING || currentStep == STEP_UNDERWRITING_PI || currentStep == STEP_UNDERWRITING_C1 || currentStep == STEP_UNDERWRITING_C2 || currentStep == STEP_UNDERWRITING_C3, 'active', '')}">{!$Label.Underwriting_Questions}</div>
                        <div class="bs {!IF(currentStep >= STEP_CONFIRMATION && currentStep < STEP_PAYMENT_METHOD, 'active', '')}">{!$Label.Confirmation}</div>
                        <div class="bs {!IF(currentStep >= STEP_PAYMENT_METHOD && currentStep <= STEP_PAYMENT, 'active', '')}">{!$Label.Payment}</div>
                    </div>
                </div>
            </apex:outputPanel>
            <!--
            <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c == 'DMB'}">
                <div class="bs hidden-xs col-sm-12 cigna-progress-bar desktopProgressBar">
                    <div class="bs cigna-progress-bar-inner">
                        <div class="bs {!IF(currentStep == STEP_UNDERWRITING || currentStep == STEP_UNDERWRITING_PI || currentStep == STEP_UNDERWRITING_C1 || currentStep == STEP_UNDERWRITING_C2 || currentStep == STEP_UNDERWRITING_C3, 'active', '')}">{!$Label.Underwriting_Questions}</div>
                        <div class="bs {!IF(currentStep == STEP_CONFIRMATION, 'active', '')}">{!$Label.Confirmation}</div>
                        <div class="bs {!IF(currentStep >= STEP_PERSONAL_DETAIL && currentStep < STEP_PAYMENT_METHOD, 'active', '')}">{!IF(isCustomerPortal, $Label.Your_Details, $Label.Client_Details)}</div>
                        <div class="bs {!IF(currentStep >= STEP_PAYMENT_METHOD && currentStep <= STEP_PAYMENT, 'active', '')}">{!$Label.Payment}</div>
                    </div>
                </div>
            </apex:outputPanel>
            -->
            <apex:outputPanel >
                <div class="bs hidden-md hidden-sm hidden-lg col-xs-12 cigna-progress-bar">
                    <div class="bs cigna-progress-bar-inner">
                        <div style="font-size:8px" class="bs {!IF(currentStep == STEP_PERSONAL_DETAIL, 'active', '')}">{!IF(isCustomerPortal, $Label.Your_Details, $Label.Client_Details)}</div>
                        <div style="font-size:8px" class="bs {!IF(currentStep == STEP_UNDERWRITING || currentStep == STEP_UNDERWRITING_PI || currentStep == STEP_UNDERWRITING_C1 || currentStep == STEP_UNDERWRITING_C2 || currentStep == STEP_UNDERWRITING_C3, 'active', '')}">{!$Label.Underwriting_Questions}</div>
                        <div style="font-size:8px" class="bs {!IF(currentStep >= STEP_CONFIRMATION && currentStep < STEP_PAYMENT_METHOD, 'active', '')}">{!$Label.Confirmation}</div>
                        <div style="font-size:8px" class="bs {!IF(currentStep >= STEP_PAYMENT_METHOD && currentStep <= STEP_PAYMENT, 'active', '')}">{!$Label.Payment}</div>
                    </div>
                </div>
            </apex:outputPanel>
            <!--
            <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c == 'DMB'}">
                <div class="bs hidden-md hidden-sm hidden-lg col-xs-12 cigna-progress-bar">
                    <div class="bs cigna-progress-bar-inner">
                        <div style="font-size:8px" class="bs {!IF(currentStep == STEP_UNDERWRITING || currentStep == STEP_UNDERWRITING_PI || currentStep == STEP_UNDERWRITING_C1 || currentStep == STEP_UNDERWRITING_C2 || currentStep == STEP_UNDERWRITING_C3, 'active', '')}">{!$Label.Underwriting_Questions}</div>
                        <div style="font-size:8px" class="bs {!IF(currentStep == STEP_CONFIRMATION, 'active', '')}">{!$Label.Confirmation}</div>
                        <div style="font-size:8px" class="bs {!IF(currentStep >= STEP_PERSONAL_DETAIL && currentStep < STEP_PAYMENT_METHOD, 'active', '')}">{!IF(isCustomerPortal, $Label.Your_Details, $Label.Client_Details)}</div>
                        <div style="font-size:8px" class="bs {!IF(currentStep >= STEP_PAYMENT_METHOD && currentStep <= STEP_PAYMENT, 'active', '')}">{!$Label.Payment}</div>
                    </div>
                </div>
            </apex:outputPanel>
            -->
        </div>
        <!--
        <apex:outputPanel >
            <div class="bs row">
                <apex:pagemessages ></apex:pagemessages>
            </div>
        </apex:outputPanel>
        -->

        <!-- GL31 jack add -->
        <apex:outputPanel layout="block" rendered="{!currentStep == STEP_ASSESSMENT_QUESTION && !isCustomerPortal}" styleClass="bs row">
            <apex:outputPanel id="WarningMessagePanel" layout="none" >
                <apex:outputPanel rendered="{!displayWarningMessage}">
                <div  class="info-msg" >
                    <!-- <i class="fa fa-info-circle"></i> -->
                    {!warningMessage}
                </div>    
                </apex:outputPanel>
            </apex:outputPanel>
            <div id="AssessmentWarning"  class="warning-msg" style="display:none" ><span id="enquiry-type-error"><i class="fa fa-warning"></i>You should finish all assessment question to go to next step</span></div>
            <apex:repeat rendered="{!!displayWarningMessage}" var="question" value="{!assessmentQuestionList}">
                <c:EsaleCheckboxes idPrefix="{!question.questionId}" esaleQuestion="{!question}" />
            </apex:repeat>
            <!-- <apex:outputText id="availableProduct" value="{!availableProduct}"></apex:outputText> -->
        </apex:outputPanel>
        <!-- GL31 jack add -->

        <apex:outputPanel layout="block" rendered="{!currentStep == STEP_PERSONAL_DETAIL}" styleClass="bs row">
            <div class="bs col-xs-12 cigna-fg-gray-dark cigna-form-section-header"><h4>{!$Label.Policy_Holder} 
            <apex:outputPanel rendered="{!IF(txn.Number_of_Adult__c != null && txn.Number_of_Adult__c > 1 && txn.Is_Adult_1_the_Policy_Holder__c, true, false)}">&nbsp;({!$Label.eSales_Adult_1})</apex:outputPanel>
            <apex:outputPanel rendered="{!IF(txn.Number_of_Adult__c != null && txn.Number_of_Adult__c > 1 && !txn.Is_Adult_1_the_Policy_Holder__c, true, false)}">&nbsp;({!$Label.eSales_Adult_2})</apex:outputPanel></h4></div>
            <br/>
            <div id="no-permission-warning">
            </div>
            <div class="bs col-xs-12 cigna-fg-gray-dark form-horizontal" id="details-form">
                <apex:outputPanel rendered="{!!isCustomerPortal}">
                    <div class="bs col-xs-12 cigna-fg-gray-dark cigna-form-section-header"><h5>{!$Label.Personal_Detail}</h5></div>
                    <br/>
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Policy_Holder_First_Name__c.Label}" for="PH-Firstname-bk"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:inputText id="PH-Firstname-bk" value="{!txn.Policy_Holder_First_Name__c}" styleClass="bs form-control" 
                                   html-placeholder="{!$ObjectType.ESales_Transaction__c.Fields.Policy_Holder_First_Name__c.Label}"
                            />
                        </div>
                    </div>
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Policy_Holder_Last_Name__c.Label}" for="PH-Lastname-bk"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:inputText id="PH-Lastname-bk" value="{!txn.Policy_Holder_Last_Name__c}" styleClass="bs form-control" 
                                   html-placeholder="{!$ObjectType.ESales_Transaction__c.Fields.Policy_Holder_Last_Name__c.Label}"
                            />
                        </div>
                    </div>
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Gender__c.Label}" for="PH-Gender-bk"/>
                        </div>
                        <div class="bs col-sm-9">
                            <!--<apex:outputText id="PH-Gender-bk" value="{!IF($Label.Header_Language_Code == 'zh_TW',txn.Gender__c,IF(txn.Gender__c=='Male','男','女'))}" styleClass="bs form-control" />-->
                            <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c == 'DMB' && txn.PH_is_PI__c}">
                                <apex:inputField id="PH-Gender-bkDMB" value="{!txn.Gender__c}" styleClass="bs form-field-style-select" html-disabled="true" />
                            </apex:outputPanel>
                            <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c != 'DMB' || !txn.PH_is_PI__c}">
                                <apex:inputField id="PH-Gender-bk" value="{!txn.Gender__c}" styleClass="bs form-field-style-select"/>
                            </apex:outputPanel>
                        </div>
                    </div>
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$Label.Are_you_a_permanent_HK_ID_holder}" for="PH-isPermanentHKID"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:inputField id="PH-isPermanentHKID" value="{!txn.Is_Permanent_HKID_Holder__c}" styleClass="bs form-field-style-select" onchange="Cigna.ESales.isHKIDHolderChange(this, 'reasonpurchase'); return false;" />
                            <!--<apex:inputField id="PH-isPermanentHKID" value="{!txn.Is_Permanent_HKID_Holder__c}" styleClass="bs form-field-style-select" />-->
                        </div>
                    </div>
                </apex:outputPanel>
                <apex:outputPanel rendered="{!isCustomerPortal}">
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Policy_Holder_First_Name__c.Label}" for="PH-Firstname"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:inputText id="PH-Firstname" value="{!txn.Policy_Holder_First_Name__c}" styleClass="bs form-control" 
                                   html-placeholder="{!$ObjectType.ESales_Transaction__c.Fields.Policy_Holder_First_Name__c.Label}"                                   
                            />
                        </div>
                    </div>
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Policy_Holder_Last_Name__c.Label}" for="PH-Lastname"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:inputText id="PH-Lastname" value="{!txn.Policy_Holder_Last_Name__c}" styleClass="bs form-control" 
                                   html-placeholder="{!$ObjectType.ESales_Transaction__c.Fields.Policy_Holder_Last_Name__c.Label}"
                            />
                        </div>
                    </div>
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Gender__c.Label}" for="PH-Gender"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c == 'DMB' && txn.PH_is_PI__c}">
                                <apex:inputField id="PH-Gender-DMB" value="{!txn.Gender__c}" styleClass="bs form-field-style-select" html-disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                            </apex:outputPanel>
                            <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c != 'DMB' || !txn.PH_is_PI__c}">
                                <apex:inputField id="PH-Gender" value="{!txn.Gender__c}" styleClass="bs form-field-style-select"/>
                            </apex:outputPanel>
                        </div>
                    </div>
                </apex:outputPanel>
                <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <!--<apex:outputLabel value="{!IF(isCustomerPortal, $Label.HKID, $ObjectType.ESales_Transaction__c.Fields.HKID__c.Label)}" for="PH-HKID"/>-->
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.HKID__c.Label}" for="PH-HKID"/>
                        <apex:outputPanel rendered="{!!isCustomerPortal}"><i class="fa fa-info-circle" data-toggle="tooltip" data-placement="right" title="{!$Label.Quotation_hkid_tooltip}" aria-hidden="true"></i></apex:outputPanel>
                    </div>
                    <script>
                       $('[data-toggle="tooltip"]').tooltip();
                    </script>
                    <div id="input-ph-hkid" class="bs col-sm-9">
                        <apex:inputText id="PH-HKID" value="{!txn.HKID__c}" styleClass="bs form-control"/>                   
                    </div>
                </div>
               
                <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Date_of_Birth_PH__c.Label}" for="PH-DOB"/>
                    </div>
                    <div class="bs col-sm-9">
                        <!--<apex:input id="PH-DOB-Day" type="tel" value="{!paramDOBPHDay}" 
                                               html-maxlength="2" 
                                               styleClass="bs form-control text-center dob-input dob-day"
                                               size="5"
                                               style="display: inline; width: auto;"
                                               html-placeholder="{!$Label.DD}" 
                                                onkeyup="getNextInput(this,1);"   
                                                onblur="getCheckDOB('PH day',this)"                                           
                        />-->
                        <apex:input id="Val-DOB-Day-PH" type="tel" value="{!paramDOBPHDay}" 
                                               html-maxlength="2" 
                                               styleClass="bs form-control text-center dob-input dob-day question-kid-age"
                                               size="5"
                                               style="display: inline; width: auto;"
                                               html-placeholder="{!$Label.DD}" 
                                               onkeyup="getNextInput(this,1);" 
                                               onblur="getCheckDOB('PH day',this)"    
                        />
                        <apex:input id="Val-DOB-Month-PH" type="tel" value="{!paramDOBPHMonth}" 
                                               html-maxlength="2" 
                                               styleClass="bs form-control text-center dob-input dob-month question-kid-age"
                                               size="5"
                                               style="display: inline; width: auto;"
                                               html-placeholder="{!$Label.MM}"
                                               onkeyup="getNextInput(this,2);"
                                               onblur="getCheckDOB('PH month',this)"  
                        />
                        <apex:input id="Val-DOB-Year-PH" type="tel" value="{!paramDOBPHYear}" 
                                               html-maxlength="4" 
                                               styleClass="bs form-control text-center dob-input dob-year question-kid-age"
                                               size="7"
                                               style="display: inline; width: auto;"
                                               html-placeholder="{!$Label.YYYY}"
                                               onkeyup="getNextInput(this,3);"
                                               onblur="getCheckDOB('PH year',this)"
                                               
                        />
                       
                    </div>
                    <div class="bs col-sm-offset-3 col-sm-9 col-xs-12" >
                        <apex:inputText id="PH-Day-DOB-Check" value="{!paramDOBPH}" Styleclass="hidden-input-field" Style="height:0px;width:0px;border:0px !important;webkit-appearance: none;" tabindex="-1" onfocus="hiddenonblur(this)" />
                       </div> 
                </div>
                
                <!-- Rancho_IA_AML_Inspection_20211005: display below three fields for all products -->
                <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Place_of_Birth__c.Label}" for="PH-input-place-of-birth"/>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:selectList id="PH-input-place-of-birth" value="{!txn.Place_of_Birth__c}" size="1" styleClass="bs form-field-style-select">
                            <apex:selectOptions value="{!resnationalityLIst}"/>
                        </apex:selectList>
                    </div>
                </div>
                <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Nationality__c.Label}" for="PH-input-nationality"/>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:selectList id="PH-input-nationality" value="{!txn.Nationality_Code__c}" size="1" styleClass="bs form-field-style-select">
                            <apex:selectOptions value="{!NationalityList}"/>
                        </apex:selectList>
                    </div>
                </div>
                <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Place_of_Residence_PH__c.Label}" for="PH-input-place-of-res"></apex:outputLabel>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:selectList id="PH-input-place-of-res" value="{!txn.Place_of_Residence_PH__c}" size="1" styleClass="bs form-field-style-select">
                            <apex:selectOptions value="{!resnationalityLIst}"/>
                        </apex:selectList>
                    </div>
                </div>
                            
                <apex:outputPanel rendered="{!onlyHasLife}">
                    <!-- Rancho_IA_AML_Inspection_20211005 -->
                    <!-- <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Place_of_Birth__c.Label}" for="PH-BirthPlace"/>
                        </div>
                        <div id="input-ph-BirthPlace" class="bs col-sm-9">
                            <apex:inputText id="PH-BirthPlace" value="{!txn.Place_of_Birth__c}" styleClass="bs form-control" />
                        </div>
                    </div> -->
                    <!-- comment by Jack for JR1641
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Nationality__c.Label}" for="PH-Nationality"/>
                        </div>
                        <div id="input-ph-Nationality" class="bs col-sm-9">
                            <apex:selectList id="PH-Nationality" value="{!txn.Nationality_Code__c}" size="1" styleClass="bs form-field-style-select">
                                <apex:selectOptions value="{!NationalityList}"/>
                            </apex:selectList>
                        </div>
                    </div-->
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Education_Level__c.Label}" for="PH-EducationLevel"/>
                        </div>
                        <div id="input-ph-EducationLevel" class="bs col-sm-9">
                            <apex:inputfield id="PH-EducationLevel" value="{!txn.Education_Level__c}" styleClass="bs form-field-style-select" onchange="Cigna.ESales.changeToOthers(this, 'EducationOthers'); return false;"/>
                        </div>
                    </div>
                    
                    <div id="EducationOthers" class="bs form-group" style="display: none">
                        
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Others__c.Label}" for="PH-Others"/>
                        </div>
                        <div id="input-ph-Others" class="bs col-sm-9">
                            <apex:inputfield id="PH-Others" value="{!txn.Others__c}" styleClass="bs form-control" />
                        </div>
                    </div>
                    
                    <script>
                        var edu = $("[id$='PH-EducationLevel']").val();
                        if(edu == 'Others'){
                            $('#EducationOthers').show();
                        }else{
                            $('#EducationOthers').hide();
                        }
                    </script>
                </apex:outputPanel>
                
                <!-- JR1641 Jack add -->
                <!-- Rancho_IA_AML_Inspection_20211005 -->
                <!-- <apex:outputPanel rendered="{!onlyHasLife || txn.Basic_Plan_Code__c == 'NEL'}" layout="none">
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Nationality__c.Label}" for="PH-Nationality"/>
                        </div>
                        <div id="input-ph-Nationality" class="bs col-sm-9">
                            <apex:selectList id="PH-Nationality" value="{!txn.Nationality_Code__c}" size="1" styleClass="bs form-field-style-select">
                                <apex:selectOptions value="{!NationalityList}"/>
                            </apex:selectList>
                        </div>
                    </div>
                </apex:outputPanel> -->
                <!--apex:outputPanel rendered="{!txn.Basic_Plan_Code__c == 'NEL'}" layout="none">
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Residential_Address_Country__c.Label}" for="PH-ResidentialAddressCountry"></apex:outputLabel>
                        </div>
                        <div id="input-ph-ResidentialAddressCountry" class="bs col-sm-9">
                            <apex:selectList id="PH-ResidentialAddressCountry" value="{!txn.Residential_Address_Country__c}" size="1" styleClass="bs form-field-style-select">
                                <apex:selectOptions value="{!NationalityList}"/>
                            </apex:selectList>
                        </div>
                    </div>
                </apex:outputPanel-->

                <!-- add by jack for place of res-->
                <!-- Rancho_IA_AML_Inspection_20211005 -->
                <!-- <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Place_of_Residence_PH__c.Label}" for="PH-PlaceOfRes"></apex:outputLabel>
                    </div>
                    <div id="input-ph-PlaceOfRes" class="bs col-sm-9">
                        <apex:selectList id="PH-PlaceOfRes" value="{!txn.Place_of_Residence_PH__c}" size="1" styleClass="bs form-field-style-select">
                            <apex:selectOptions value="{!resnationalityLIst}"/>
                        </apex:selectList>
                    </div>
                </div> -->
                
                <apex:outputPanel rendered="{!isCustomerPortal}">
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Email_Address__c.Label}" for="PH-Email"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:inputField id="PH-Email" value="{!txn.Email_Address__c}" styleClass="bs form-control" />
                        </div>
                    </div>
                    <div class="bs form-group">
                        <div class="bs col-sm-3 col-xs-12">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Contact_No__c.Label}" for="PH-ContactNo"/>
                        </div>
                        <div class="bs col-sm-2 col-xs-4">
                            <apex:inputField id="PH-CountryCode" value="{!txn.Country_Code__c}" styleClass="bs form-control" 
                                             html-placeholder="{!$ObjectType.ESales_Transaction__c.Fields.Country_Code__c.Label}"
                                              />
                        </div>
                        <div class="bs col-sm-7 col-xs-8">
                            <apex:input type="tel" id="PH-ContactNo" value="{!paramContactNo}" styleClass="bs form-control" />
                        </div>
                    </div>
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Address_Line_1__c.Label}" for="PH-Address-1"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:inputField id="PH-Address-1" value="{!txn.Address_Line_1__c}" styleClass="bs form-control" />
                        </div>
                    </div>
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Address_Line_2__c.Label}" for="PH-Address-2"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:inputField id="PH-Address-2" value="{!txn.Address_Line_2__c}" styleClass="bs form-control" />
                        </div>
                    </div>
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Address_Line_3__c.Label}" for="PH-Address-3"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:inputField id="PH-Address-3" value="{!txn.Address_Line_3__c}" styleClass="bs form-control" />
                        </div>
                    </div>
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Address_Line_4__c.Label}" for="PH-Address-4"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:selectList id="PH-Address-4" value="{!txn.Address_Line_4_Code__c}" size="1" styleClass="bs form-field-style-select">
                                <apex:selectOptions value="{!CountryList}"/>
                            </apex:selectList>
                        </div>
                    </div>
                    <apex:outputPanel rendered="{!txn.PH_is_PI__c}">
                        <div class="bs form-group">
                            <div class="bs col-sm-3">
                                <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Smoker_Status__c.Label}" for="PH-Smoker"/>
                            </div>
                            <div class="bs col-sm-9">
                                <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c == 'DMB'}">
                                    <apex:inputField id="PH-Smoker-DMB" value="{!txn.Smoker_Status__c}" styleClass="bs form-field-style-select" html-disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                                </apex:outputPanel>
                                <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c != 'DMB'}">
                                    <apex:inputField id="PH-Smoker" value="{!txn.Smoker_Status__c}" styleClass="bs form-field-style-select"/>
                                </apex:outputPanel>
                            </div>
                        </div>
                    </apex:outputPanel>
                </apex:outputPanel>
                
                <apex:outputPanel rendered="{!!isCustomerPortal && txn.PH_is_PI__c}">
                    <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$Label.eSales_Smoking_Habit}" for="PH-Smoker-bk"/>
                    </div>
                    <div class="bs col-sm-9">
                        <!--<apex:selectList id="PH-Smoker" styleClass="bs form-control aps-selection-box" size="1" value="{!SmokingHabit}" multiselect="false">-->
                        <apex:selectList id="PH-Smoker-bk" styleClass="bs form-field-style-select" size="1" value="{!SmokingHabit}" multiselect="false" disabled="{!txn.Basic_Plan_Code__c == 'DMB'}">
                            <apex:selectOptions value="{!SmokingHabitOption}"/>
                        </apex:selectList>
                        <!--<apex:inputField id="PH-Smoker" value="{!txn.Smoker_Status__c}" styleClass="bs form-field-style-select" />-->
                    </div>
                </div>
                
                </apex:outputPanel>
                
                <apex:outputPanel rendered="{!txn.PH_is_PI__c}">
                <div class="bs form-group">
                    <div class="bs col-sm-3 col-xs-12">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Height__c.Label}" for="PH-Height"/>
                    </div>
                    <div class="bs col-sm-2 col-xs-5">
                        <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c == 'DMB'}">
                            <apex:inputField id="PH-Height-Unit_DMB" value="{!txn.Height_Unit__c}" styleClass="bs form-field-style-select" onchange="onSelectHeightUnit(); return false;" html-disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                        </apex:outputPanel>
                        <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c != 'DMB'}">
                            <apex:inputField id="PH-Height-Unit" value="{!txn.Height_Unit__c}" styleClass="bs form-field-style-select" onchange="onSelectHeightUnit(); return false;"/>
                        </apex:outputPanel>
                    </div>
                    
                    <apex:outputPanel rendered="{!showcmHeight}" id="showcmHeight">
                        <div class="bs col-sm-7 col-xs-7">
                            <apex:input type="tel" id="PH-Height" value="{!paramHeight}" styleClass="bs form-control" html-maxlength="6" disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                        </div>
                    </apex:outputPanel>
                    <apex:outputPanel rendered="{!showFTHeight}" id="showFTHeight">
                        <div class="bs col-sm-7 col-xs-7 row">
                            <div class="bs col-sm-6 col-xs-6">
                                <apex:input type="tel" id="PH-Height1" value="{!paramHeightFeet}" styleClass="bs form-control" html-maxlength="6" disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                                <apex:outputText >{!$Label.eSales_Application_Feet}</apex:outputText>
                            </div>
                            <div class="bs col-sm-6 col-xs-7">
                                <apex:input type="tel" id="PH-Height2" value="{!paramHeightInch}" styleClass="bs form-control" html-maxlength="6" disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                                <apex:outputText >{!$Label.eSales_Application_Inch}</apex:outputText>
                            </div>
                        </div>
                    </apex:outputPanel>
                        
                    
                </div>
                
                <div class="bs form-group">
                    <div class="bs col-sm-3 col-xs-12">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Weight__c.Label}" for="PH-Weight"/>
                    </div>
                    <div class="bs col-sm-2 col-xs-5">
                        <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c == 'DMB'}">
                            <apex:inputField id="PH-Weight-Unit-DMB" value="{!txn.Weight_Unit__c}" styleClass="bs form-field-style-select" html-disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                        </apex:outputPanel>
                        <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c != 'DMB'}">
                            <apex:inputField id="PH-Weight-Unit" value="{!txn.Weight_Unit__c}" styleClass="bs form-field-style-select"/>
                        </apex:outputPanel>
                    </div>
                    <div class="bs col-sm-7 col-xs-7">
                        <apex:input type="tel" id="PH-Weight" value="{!paramWeight}" styleClass="bs form-control" html-maxlength="6" disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                    </div>
                    
                </div>
                </apex:outputPanel>

                <apex:outputPanel rendered="{!onlyHasLife}">
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Name_of_Employer__c.Label}" for="PH-Employer-name"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:inputField id="PH-Employer-name" value="{!txn.Name_of_Employer__c}" styleClass="bs form-control" />
                        </div>
                    </div>
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Employer_Address_Line1__c.Label}" for="PH-Employer-Address-1"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:inputField id="PH-Employer-Address-1" value="{!txn.Employer_Address_Line1__c}" html-placeholder="{!$Label.eSales_Flat_Unit_Floor}" styleClass="bs form-control" />
                        </div>
                    </div>
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Employer_Address_Line2__c.Label}" for="PH-Employer-Address-2"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:inputField id="PH-Employer-Address-2" value="{!txn.Employer_Address_Line2__c}" html-placeholder="{!$Label.eSales_Building_Estate}" styleClass="bs form-control" />
                        </div>
                    </div>
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Employer_Address_Line3__c.Label}" for="PH-Employer-Address-3"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:inputField id="PH-Employer-Address-3" value="{!txn.Employer_Address_Line3__c}" html-placeholder="{!$Label.eSales_Street_District}" styleClass="bs form-control" />
                        </div>
                    </div>
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Employer_Address_Line4__c.Label}" for="PH-Employer-Address-4"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:inputField id="PH-Employer-Address-4" value="{!txn.Employer_Address_Line4__c}" html-placeholder="{!$Label.eSales_Area}" styleClass="bs form-control" />                            
                        </div>
                    </div>
                    
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Nature_of_Business__c.Label}" for="PH-nature-business"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:inputField id="PH-nature-business" value="{!txn.Nature_of_Business__c}" styleClass="bs form-control" />
                        </div>
                    </div>
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Job_Title__c.Label}" for="PH-job-title"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:inputField id="PH-job-title" value="{!txn.Job_Title__c}" styleClass="bs form-control" />
                        </div>
                    </div>
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Job_Duties__c.Label}" for="PH-job-duties"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:inputField id="PH-job-duties" value="{!txn.Job_Duties__c}" styleClass="bs form-control" />
                        </div>
                    </div>
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Monthly_Income__c.Label}" for="PH-monthly-income"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:inputField id="PH-monthly-income" value="{!txn.Monthly_Income__c}" styleClass="bs form-control" />
                        </div>
                    </div>
                    
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Means_of_Income__c.Label}" for="PH-means-income"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:inputField id="PH-means-income" value="{!txn.Means_of_Income__c}" styleClass="bs form-field-style-select" onchange="Cigna.ESales.changeToOthers(this, 'meansIncomeOther'); return false;" />
                        </div>
                    </div>
                    <div id="meansIncomeOther" class="bs form-group" style="display: none">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Means_of_Income_Others__c.Label}" for="PH-means-income-other"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:inputField id="PH-means-income-other" value="{!txn.Means_of_Income_Others__c}" styleClass="bs form-control" />
                        </div>
                    </div>
                    
                    <div id="reasonpurchase" class="bs form-group" style="display: none">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$Label.Reason_for_purchasing_an_insurance_policy_in_Hong_Kong}" for="PH-reason-for-nonhk"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:inputTextarea rows="5" value="{!txn.Reason_for_purchasing_in_HK__c}" style="Height: 60px" styleClass="bs form-control"/>
                        </div>
                    </div>

                    <script>
                        var meansIncome = $("[id$='PH-means-income']").val();
                        console.log('meansIncome: ' + meansIncome);
                        if(meansIncome == 'Others'){
                            $('#meansIncomeOther').show();
                        }else{
                            $('#meansIncomeOther').hide();
                        }
                        
                        var hkholder = $("[id$='PH-isPermanentHKID']").val();
                        console.log('hkholder: ' + hkholder);
                        if(hkholder == 'No'){
                            $('#reasonpurchase').show();
                        }else{
                            $('#reasonpurchase').hide();
                        }
                    </script>

                </apex:outputPanel>
                
                <apex:outputPanel rendered="{!!isCustomerPortal}">
                    <div class="bs col-xs-12 cigna-fg-gray-dark cigna-form-section-header"><h5>{!$Label.Contact_Detail}</h5></div>
                    <br/>
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$Label.eSales_Residential_Address_Line} 1" for="PH-Address-1-bk"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:inputField id="PH-Address-1-bk" value="{!txn.Address_Line_1__c}" html-placeholder="{!$Label.eSales_Flat_Unit_Floor}" styleClass="bs form-control" />
                        </div>
                    </div>
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$Label.eSales_Residential_Address_Line} 2" for="PH-Address-2-bk"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:inputField id="PH-Address-2-bk" value="{!txn.Address_Line_2__c}" html-placeholder="{!$Label.eSales_Building_Estate}" styleClass="bs form-control" />
                        </div>
                    </div>
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$Label.eSales_Residential_Address_Line} 3" for="PH-Address-3-bk"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:inputField id="PH-Address-3-bk" value="{!txn.Address_Line_3__c}" html-placeholder="{!$Label.eSales_Street_District}" styleClass="bs form-control" />
                        </div>
                    </div>
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$Label.eSales_Residential_Address_Line} 4" for="PH-Address-4-bk"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:selectList id="PH-Address-4-bk" value="{!txn.Address_Line_4_Code__c}" size="1" styleClass="bs form-field-style-select">
                                <apex:selectOptions value="{!CountryList}"/>
                            </apex:selectList>                             
                        </div>
                    </div>
                    <!--remove permanent address
                    <apex:outputPanel rendered="{!onlyHasLife}">
                        <div class="bs form-group">
                            <div class="bs col-sm-3">
                                <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Permanent_Address_Line1__c.Label}" for="PH-Permanent-Address-1"/>
                            </div>
                            <div class="bs col-sm-9">
                                <apex:inputField id="PH-Permanent-Address-1" value="{!txn.Permanent_Address_Line1__c}" html-placeholder="{!$Label.eSales_Flat_Unit_Floor}" styleClass="bs form-control" onchange="Cigna.ESales.ValidatePermanentAddress();"/>
                            </div>
                        </div>
                        <div class="bs form-group">
                            <div class="bs col-sm-3">
                                <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Permanent_Address_Line2__c.Label}" for="PH-Permanent-Address-2"/>
                            </div>
                            <div class="bs col-sm-9">
                                <apex:inputField id="PH-Permanent-Address-2" value="{!txn.Permanent_Address_Line2__c}" html-placeholder="{!$Label.eSales_Building_Estate}" styleClass="bs form-control" onchange="Cigna.ESales.ValidatePermanentAddress();"/>
                            </div>
                        </div>
                        <div class="bs form-group">
                            <div class="bs col-sm-3">
                                <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Permanent_Address_Line3__c.Label}" for="PH-Permanent-Address-3"/>
                            </div>
                            <div class="bs col-sm-9">
                                <apex:inputField id="PH-Permanent-Address-3" value="{!txn.Permanent_Address_Line3__c}" html-placeholder="{!$Label.eSales_Street_District}" styleClass="bs form-control" onchange="Cigna.ESales.ValidatePermanentAddress();"/>
                            </div>
                        </div>
                        <div class="bs form-group">
                            <div class="bs col-sm-3">
                                <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Permanent_Address_Line4__c.Label}" for="PH-Permanent-Address-4"/>
                            </div>
                            <div class="bs col-sm-9">
                                <apex:inputField id="PH-Permanent-Address-4" value="{!txn.Permanent_Address_Line4__c}" html-placeholder="{!$Label.eSales_Area}" styleClass="bs form-control" onchange="Cigna.ESales.ValidatePermanentAddress();"/>
                            </div>
                        </div>
                    </apex:outputPanel>
                    -->
                    <div class="bs form-group">
                        <div class="bs col-sm-3 col-xs-12">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Contact_No__c.Label}" for="PH-ContactNo-bk"/>
                        </div>
                        <div class="bs col-sm-2 col-xs-4">
                            <apex:inputField id="PH-CountryCode-bk" value="{!txn.Country_Code__c}" styleClass="bs form-control" 
                                             html-placeholder="{!$ObjectType.ESales_Transaction__c.Fields.Country_Code__c.Label}"
                                              />
                        </div>
                        <div class="bs col-sm-7 col-xs-8">
                            <apex:input type="tel" id="PH-ContactNo-bk" value="{!paramContactNo}" styleClass="bs form-control" />
                        </div>
                    </div>
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Email_Address__c.Label}" for="PH-Email-bk"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:inputField id="PH-Email-bk" value="{!txn.Email_Address__c}" styleClass="bs form-control" />
                            <apex:outputText >{!$Label.eSales_email_comment}</apex:outputText>
                        </div>
                    </div>

                    <apex:outputPanel rendered="{!onlyHasLife && txn.PH_is_PI__c}">
                        <div class="bs col-xs-12 cigna-fg-gray-dark cigna-form-section-header"><h5>{!$Label.Beneficiary}</h5></div>
                        <br/>
                        
                        <div class="bs row form-group">
                            <div class="bs row listcontent-header hidden-xs">
                               <div class="bs col-sm-2"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.Fields.Beneficiary_Name__c.Label}"/></div>
                               <div class="bs col-sm-2"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.Fields.Beneficiary_Last_Name__c.Label}"/></div>
                               <div class="bs col-sm-2"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.HKID_Passport_Birth_Cert_No__c.Label}"/></div>
                               <div class="bs col-sm-2"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Gender__c.Label}"/></div>
                               <div class="bs col-sm-2"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Relationship_with_the_Proposed_Person__c.Label}"/></div>
                               <div class="bs col-sm-2"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Precentage_Share__c.Label}"/><br/>{!$Label.Total_Percentage}</div>
                               <div class="bs col-sm-1">&nbsp;</div>
                            </div>
                        
                            <apex:variable value="{!0}" var="rowNum"/>
                            <apex:repeat value="{!beneficiaryList}" var="ben">
                                <div class="bs row listcontent">
                                    <div class="bs col-xs-offset-11 col-xs-1 visible-xs" >
                                        <span class="glyphicon glyphicon-minus-sign fa-lg onclick-pointer"  onclick="removeRowBeneficiary({!rowNum},'{!ben.Id}')" style="{!IF(beneficiaryList.size == 1, 'display:none;', 'display:block;')}"/>
                                    </div>
                                    <div class="bs col-xs-12 col-sm-2" style="padding:0px !important;">
                                       <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Beneficiary_Name__c.Label}"/></div>
                                       <div class="bs col-xs-12 col-sm-12 table-cell"><apex:inputField id="PH-Beneficiary-Firstname" value="{!ben.Beneficiary_Name__c}" styleclass="bs form-control" /></div>
                                    </div>
                                    <div class="bs col-xs-12 col-sm-2" style="padding:0px !important;">
                                       <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Beneficiary_Last_Name__c.Label}"/></div>
                                       <div class="bs col-xs-12 col-sm-12 table-cell"><apex:inputField id="PH-Beneficiary-Lastname" value="{!ben.Beneficiary_Last_Name__c}" styleclass="bs form-control" /></div>
                                    </div>
                                    <div class="bs col-xs-12 col-sm-2" style="padding:0px !important;">
                                       <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.HKID_Passport_Birth_Cert_No__c.Label}"/></div>
                                       <div class="bs col-xs-12 col-sm-12 table-cell"><apex:inputField id="PH-HKID-Birth-Cert-Passport-No" value="{!ben.HKID_Passport_Birth_Cert_No__c}" styleclass="bs form-control" /></div>
                                    </div>
                                    <div class="bs col-xs-12 col-sm-2" style="padding:0px !important;">
                                       <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Gender__c.Label}"/></div>
                                       <div class="bs col-xs-12 col-sm-12 table-cell"><apex:inputField id="PH-Beneficiary-Gender" value="{!ben.Gender__c}" styleclass="bs form-control" /></div>
                                    </div>
                                    <div class="bs col-xs-12 col-sm-2" style="padding:0px !important;">
                                       <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Relationship_with_the_Proposed_Person__c.Label}"/></div>
                                       <div class="bs col-xs-12 col-sm-12 table-cell"><apex:inputField id="PH-Relationship-with-Person-Insured" value="{!ben.Relationship_with_the_Proposed_Person__c}" styleclass="bs form-control" /></div>
                                    </div>
                                    <!--<div class="bs col-xs-12 col-sm-1" style="padding:0px !important;">
                                       <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Precentage_Share__c.Label}"/></div>
                                       <div class="bs col-xs-12 col-sm-12 table-cell"><apex:inputField id="PH-Share-Percentage" value="{!ben.Precentage_Share__c}" styleclass="bs form-control"/></div>
                                    </div>
                                    <div class="bs table-row col-xs-12 col-sm-1 hidden-xs" style="padding:0px !important;">
                                       <div class="bs col-sm-12 table-cell">
                                           <span class="glyphicon glyphicon-minus-sign fa-lg onclick-pointer" onclick="removeRowBeneficiary({!rowNum},'{!ben.Id}')" style="{!IF(beneficiaryList.size == 1, 'display:none;', 'display:block;')}" />
                                       </div>
                                    </div>-->
                                    <div class="bs col-xs-12 col-sm-2" style="padding:0px !important;">
                                       <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Precentage_Share__c.Label}"/></div>
                                       <div class="bs col-xs-12 col-sm-8 table-cell"><apex:inputField id="PH-Share-Percentage" value="{!ben.Precentage_Share__c}" styleclass="bs form-control"/></div>
                                       <div class="bs col-sm-4 table-cell hidden-xs">
                                           <span class="glyphicon glyphicon-minus-sign fa-lg onclick-pointer" onclick="removeRowBeneficiary({!rowNum},'{!ben.Id}')" style="{!IF(beneficiaryList.size == 1, 'display:none;', 'display:block;')}" />
                                       </div>
                                    </div>
                                </div>
                                <apex:variable value="{!rowNum + 1}" var="rowNum"/>
                            </apex:repeat>
    
                            <div id="Share-Total-errMsg" class="col-xs-offset-6 col-xs-6 col-sm-offset-8 col-sm-4 error" style="display:none; padding:10px;">
                                {!$Label.ErrMsg_total_100}
                            </div> 
                            <div class="bs col-sm-offset-10 col-sm-2 col-xs-offset-11 col-xs-1" style="padding:0px 0px 15px 0px !important;">
                                <div class="bs col-sm-offset-8 col-sm-4">
                                    <span class="glyphicon glyphicon-plus-sign fa-lg onclick-pointer" onclick="addRowBeneficiary()" style="{!IF(beneficiaryList.size == 3, 'display:none;', 'display:block;')}"/>
                                </div>
                            </div>
                        </div>
    
                    </apex:outputPanel>
                </apex:outputPanel>    
            </div>
            
        </apex:outputPanel>
        
        <!-- //add by Davon 18/10/2017 for InsurableInterest CR start -->
        <apex:outputPanel rendered="{!currentStep == STEP_PERSONAL_DETAIL  && (txn.Cover_Child__c || (txn.Number_of_Adult__c != null && txn.Number_of_Adult__c  > 1) || (isBrokerPortal && txn.Is_Adult_1_the_Policy_Holder__c == false))}" styleClass="bs row cigna-form-section" layout="block">
            <div class="bs col-xs-12 cigna-fg-gray-dark form-horizontal" >

                <div class="bs form-group">
                    <div class="bs col-xs-12">
                        <apex:outputText escape="false" value="{!$Label.eSales_InsurableInterest_Confirm_q1}"/>
                    </div>
                </div>
                <div class="bs col-xs-12 cigna-answer-wrapper">
                    <p>
                    <div class="bs col-sm-6 cigna-answer-wrapper">
                    
                        <input type="radio" id="insurableInterest-confirm-01" value="Agree" name="insurableInterest-confirm" class="bs cigna-question-radio" onclick="Cigna.ESales.checkInsurableRevocate();" />
                        <label for="insurableInterest-confirm-01">{!$Label.eSales_Agree}</label>
                    
                    </div>
                    <div class="bs col-sm-6 cigna-answer-wrapper">
                    
                        <input type="radio" id="insurableInterest-confirm-02" value="Disagree" name="insurableInterest-confirm" class="bs cigna-question-radio" onclick ="Cigna.ESales.checkInsurable();" />
                        <label id="paramInsurableInterestConfirmError_b" for="insurableInterest-confirm-02">{!$Label.eSales_Disagree}</label>
                    
                    </div>
                    </p>

                    <apex:inputText id="paramInsurableInterestConfirmError" value="{!txn.InsurableInterest_Confirm__c}" Styleclass="hidden-input-field" Style="height:0px;width:0px;border:0px !important;webkit-appearance: none;" tabindex="-1" onfocus="hiddenonblur(this)" />
                                                      
                </div>
            </div>
            
            <script>              
            //add by Davon 18/10/2017 for InsurableInterest CR start -->
                        
                $(document).ready(function(){
                 
             //add by Davon 18/10/2017 for InsurableInterest CR end -->     
                    //CR-56_Link_20220214
                    $("#insurableInterest-confirm-02").on("click",function(){                                                                      
                        $('.bs.next-btn a').removeAttr('onclick', 'Cigna.ESales.nextStep()');
                        $('.bs.next-btn a').attr('disabled', true);
                        $('.bs.next-btn a').addClass('cigna-bg-gray-dark');
                        $('.bs.next-btn a').removeClass('cigna-bg-orange-dark');
                    });

                    $("#insurableInterest-confirm-01").on("click",function(){
                        $('.bs.next-btn a').attr('onclick', 'Cigna.ESales.nextStep()');                                              
                        $('.bs.next-btn a').attr('disabled', false);
                        $('.bs.next-btn a').removeClass('cigna-bg-gray-dark');
                        $('.bs.next-btn a').addClass('cigna-bg-orange-dark');
                      });

                    if($("input[id$='paramInsurableInterestConfirmError']").val() != 'Agree' || 
                        $("input[id$='paramInsurableInterestConfirmError']").val() != 'Disagree'){
                            $('.bs.next-btn a').removeAttr('onclick', 'Cigna.ESales.nextStep()');
                            $('.bs.next-btn a').attr('disabled', true);
                            $('.bs.next-btn a').addClass('cigna-bg-gray-dark');
                            $('.bs.next-btn a').removeClass('cigna-bg-orange-dark');
                    }else{
                        $('.bs.next-btn a').attr('onclick', 'Cigna.ESales.nextStep()');
                    }
                    
                });
            </script>

            <script>
                if($("input[id$='paramInsurableInterestConfirmError']").val() == 'Agree'){
                    $("#insurableInterest-confirm-01").attr('checked','checked');
                    $('.bs.next-btn a').attr('onclick', 'Cigna.ESales.nextStep()');                                              
                    $('.bs.next-btn a').attr('disabled', false);
                    $('.bs.next-btn a').removeClass('cigna-bg-gray-dark');
                    $('.bs.next-btn a').addClass('cigna-bg-orange-dark');
                } else if ($("input[id$='paramInsurableInterestConfirmError']").val() == 'Disagree'){
                    $("#insurableInterest-confirm-02").attr('checked','checked');   
                    $('.bs.next-btn a').removeAttr('onclick', 'Cigna.ESales.nextStep()');
                    $('.bs.next-btn a').attr('disabled', true);
                    $('.bs.next-btn a').addClass('cigna-bg-gray-dark');
                    $('.bs.next-btn a').removeClass('cigna-bg-orange-dark');                              
                }

            //CR-56_Link_20220214
            $('input.cigna-question-radio').on("change",Cigna.ESales.onRadioChange);
            </script>
        </apex:outputPanel> 
        
        <!-- //add by Davon 18/10/2017 for InsurableInterest CR end -->
        
        
        <!-- Spouse -->
         <apex:outputPanel layout="block" rendered="{!currentStep == STEP_PERSONAL_DETAIL && txn.Number_of_Adult__c != null && (txn.Number_of_Adult__c > 1 || (!txn.PH_is_PI__c && txn.Number_of_Adult__c > 0)) && !isCustomerPortal}" styleClass="bs row">
            <div class="bs col-xs-12 cigna-fg-gray-dark cigna-form-section-header"><h4><!--{!$Label.eSales_Spouse}-->
            <apex:outputPanel rendered="{!IF(txn.Number_of_Adult__c != null && txn.Number_of_Adult__c > 1 && txn.Is_Adult_1_the_Policy_Holder__c, true, false)}">&nbsp;{!$Label.eSales_Adult_2}
            </apex:outputPanel><apex:outputPanel rendered="{!IF(txn.Number_of_Adult__c != null && txn.Number_of_Adult__c > 0 && !txn.Is_Adult_1_the_Policy_Holder__c, true, false)}">&nbsp;{!$Label.eSales_Adult_1}</apex:outputPanel></h4></div>
            <br/>
            <div class="bs col-xs-12 cigna-fg-gray-dark form-horizontal">
                 <apex:outputPanel rendered="{!!isCustomerPortal}">
                    <div class="bs col-xs-12 cigna-fg-gray-dark cigna-form-section-header"><h5>{!$Label.Personal_Detail}</h5></div>
                    <br/>
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.PI_First_Name__c.Label}" for="PH-Firstname-bk2"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:inputText id="PH-Firstname-bk2" value="{!txn.PI_First_Name__c}" styleClass="bs form-control" 
                                   html-placeholder="{!$ObjectType.ESales_Transaction__c.Fields.PI_First_Name__c.Label}"
                            />
                        </div>
                    </div>
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.PI_Last_Name__c.Label}" for="PH-Lastname-bk2"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:inputText id="PH-Lastname-bk2" value="{!txn.PI_Last_Name__c}" styleClass="bs form-control" 
                                   html-placeholder="{!$ObjectType.ESales_Transaction__c.Fields.PI_Last_Name__c.Label}"
                            />
                        </div>
                    </div>
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Gender_of_Adult_2__c.Label}" for="PH-Gender-bk2"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c == 'DMB'}">
                                <apex:inputField id="PH-Gender-bk2-DMB" value="{!txn.Gender_of_Adult_2__c}" styleClass="bs form-field-style-select" html-disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                            </apex:outputPanel>
                            <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c != 'DMB'}">
                                <apex:inputField id="PH-Gender-bk2" value="{!txn.Gender_of_Adult_2__c}" styleClass="bs form-field-style-select"/>
                            </apex:outputPanel>
                        </div>
                    </div>
                    <div class="bs form-group">
                         <div class="bs col-sm-3">
                              <apex:outputLabel value="{!$Label.Are_you_a_permanent_HK_ID_holder}" for="PH-isPermanentHKID2"/>
                         </div>
                         <div class="bs col-sm-9">
                              <apex:inputField id="PH-isPermanentHKID2" value="{!txn.Is_Permanent_HKID_Holder_PI__c}" styleClass="bs form-field-style-select" /> <!-- onchange="Cigna.ESales.isHKIDHolderChange(this, 'reasonpurchasePI'); return false;" -->
                              <!--<apex:inputField id="PH-isPermanentHKID" value="{!txn.Is_Permanent_HKID_Holder__c}" styleClass="bs form-field-style-select" />-->
                         </div>
                    </div>
                </apex:outputPanel>
                                
                <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <!--<apex:outputLabel value="{!IF(isCustomerPortal, $Label.HKID, $ObjectType.ESales_Transaction__c.Fields.HKID__c.Label)}" for="PH-HKID"/>-->
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.PI_HKID__c.Label}" for="PH-HKID2"/>
                        <apex:outputPanel rendered="{!!isCustomerPortal}"><i class="fa fa-info-circle" data-toggle="tooltip" data-placement="right" title="{!$Label.Quotation_hkid_tooltip}" aria-hidden="true"></i></apex:outputPanel>
                    </div>
                    <script>
                        $('[data-toggle="tooltip"]').tooltip();
                    </script>
                    <div id="input-ph-hkid" class="bs col-sm-9">
                        <apex:inputText id="PH-HKID2" value="{!txn.PI_HKID__c}" styleClass="bs form-control" />
                    </div>
                </div>
               
                <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Date_of_Birth_PI__c.Label}" for="PI-DOB"/>
                    </div>
                    <div class="bs col-sm-9">
                        <!--<apex:input id="PH-DOB-Day" type="tel" value="{!paramDOBPHDay}" 
                                               html-maxlength="2" 
                                               styleClass="bs form-control text-center dob-input dob-day"
                                               size="5"
                                               style="display: inline; width: auto;"
                                               html-placeholder="{!$Label.DD}" 
                                                onkeyup="getNextInput(this,1);"   
                                                onblur="getCheckDOB('PH day',this)"                                           
                        />-->
                        <apex:input id="Val-DOB-Day-PI" type="tel" value="{!paramDOBPIDay}" 
                                               html-maxlength="2" 
                                               styleClass="bs form-control text-center dob-input dob-day question-kid-age"
                                               size="5"
                                               style="display: inline; width: auto;"
                                               html-placeholder="{!$Label.DD}" 
                                               onkeyup="getNextInput(this,1);" 
                                               onblur="getCheckDOB('PI day',this)"    
                                               
                        />
                        <apex:input id="Val-DOB-Month-PI" type="tel" value="{!paramDOBPIMonth}" 
                                               html-maxlength="2" 
                                               styleClass="bs form-control text-center dob-input dob-month question-kid-age"
                                               size="5"
                                               style="display: inline; width: auto;"
                                               html-placeholder="{!$Label.MM}"
                                               onkeyup="getNextInput(this,2);"
                                               onblur="getCheckDOB('PI month',this)"  
                                               
                        />
                        <apex:input id="Val-DOB-Year-PI" type="tel" value="{!paramDOBPIYear}" 
                                               html-maxlength="4" 
                                               styleClass="bs form-control text-center dob-input dob-year question-kid-age"
                                               size="7"
                                               style="display: inline; width: auto;"
                                               html-placeholder="{!$Label.YYYY}"
                                               onkeyup="getNextInput(this,3);"
                                               onblur="getCheckDOB('PI year',this)"
                                               
                        />
                       
                    </div>
                    <div class="bs col-sm-offset-3 col-sm-9 col-xs-12" >
                        <apex:inputText id="PI-Day-DOB-Check" value="{!paramDOBPI}" Styleclass="hidden-input-field" Style="height:0px;width:0px;border:0px !important;webkit-appearance: none;" tabindex="-1" onfocus="hiddenonblur(this)" />
                       </div> 
                </div>
                          
                <!-- Rancho_IA_AML_Inspection_20211005: display place of birth for all products, change id for add jQuery validator -->
                <!-- <apex:outputPanel rendered="{!onlyHasLife}"> -->
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.PI_Place_of_Birth__c.Label}" for="PI-input-place-of-birth"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:selectList id="PI-input-place-of-birth" value="{!txn.PI_Place_of_Birth__c}" size="1" styleClass="bs form-field-style-select">
                            <apex:selectOptions value="{!resnationalityLIst}"/>
                        </apex:selectList>
                        </div>
                    </div>

                    <!-- comment by Jack for JR1641
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.PI_Nationality__c.Label}" for="PH-Nationality2"/>
                        </div>
                        <div id="input-ph-Nationality2" class="bs col-sm-9">
                            <apex:selectList id="PH-Nationality2" value="{!txn.PI_Nationality_Code__c}" size="1" styleClass="bs form-field-style-select">
                                <apex:selectOptions value="{!NationalityList}"/>
                            </apex:selectList>
                        </div>
                    </div-->
                <!-- </apex:outputPanel> -->
                
                <!-- JR1641 Jack add -->
                <!-- Rancho_IA_AML_Inspection_20211005: display nationality for all products, change id for add jQuery validator -->
                <!-- <apex:outputPanel rendered="{!onlyHasLife || txn.Basic_Plan_Code__c == 'NEL'}"> -->
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.PI_Nationality__c.Label}" for="PI-input-nationality"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:selectList id="PI-input-nationality" value="{!txn.PI_Nationality_Code__c}" size="1" styleClass="bs form-field-style-select">
                                <apex:selectOptions value="{!NationalityList}"/>
                            </apex:selectList>
                        </div>
                    </div>
                <!-- </apex:outputPanel> -->

                <!-- add by jack for place of res-->
                <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Place_of_Residence_PI__c.Label}" for="PI-input-place-of-res"></apex:outputLabel>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:selectList id="PI-input-place-of-res" value="{!txn.Place_of_Residence_PI__c}" size="1" styleClass="bs form-field-style-select">
                            <apex:selectOptions value="{!resnationalityLIst}"/>
                        </apex:selectList>
                    </div>
                </div>

                <!--apex:outputPanel rendered="{!txn.Basic_Plan_Code__c == 'NEL'}">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.PI_Residential_Address_Country__c.Label}" for="ResidentialAddressCountry2"></apex:outputLabel>2
                    </div>
                    <div id="input-ph-ResidentialAddressCountry2" class="bs col-sm-9">
                        <apex:inputField id="ResidentialAddressCountry2" value="{!txn.PI_Residential_Address_Country__c}" styleClass="bs form-field-style-select"></apex:inputField>
                    </div>
                </apex:outputPanel-->
                
                <apex:outputPanel rendered="{!!isCustomerPortal}">
                    <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$Label.eSales_Smoking_Habit}" for="PI-Smoker-bk"/>
                    </div>
                    <div class="bs col-sm-9">
                        <!--<apex:selectList id="PH-Smoker" styleClass="bs form-control aps-selection-box" size="1" value="{!SmokingHabit2}" multiselect="false">-->
                        <apex:selectList id="PI-Smoker-bk" styleClass="bs form-field-style-select" size="1" value="{!SmokingHabit2}" multiselect="false" disabled="{!txn.Basic_Plan_Code__c == 'DMB'}">
                            <apex:selectOptions value="{!SmokingHabitOption}"/>
                        </apex:selectList>
                        <!--<apex:inputField id="PH-Smoker" value="{!txn.Smoker_Status__c}" styleClass="bs form-field-style-select" />-->
                    </div>
                </div>
                
                </apex:outputPanel>
                
                <div class="bs form-group">
                    <div class="bs col-sm-3 col-xs-12">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.PI_Height__c.Label}" for="PI-Height"/>
                    </div>
                    <div class="bs col-sm-2 col-xs-5">
                        <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c == 'DMB'}">
                            <apex:inputField id="PI-Height-Unit-DMB" value="{!txn.PI_Height_Unit__c}" styleClass="bs form-field-style-select" onchange="onSelectPIHeightUnit(); return false;" 
                            html-disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                        </apex:outputPanel>
                        <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c != 'DMB'}">
                            <apex:inputField id="PI-Height-Unit" value="{!txn.PI_Height_Unit__c}" styleClass="bs form-field-style-select" onchange="onSelectPIHeightUnit(); return false;" />
                        </apex:outputPanel>
                    </div>
                    
                    <apex:outputPanel rendered="{!showcmHeight2}" id="showcmHeight2">
                        <div class="bs col-sm-7 col-xs-7">
                            <apex:input type="tel" id="PI-Height" value="{!paramHeight2}" styleClass="bs form-control" html-maxlength="6" disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                        </div>
                    </apex:outputPanel>
                    <apex:outputPanel rendered="{!showFTHeight2}" id="showFTHeight2">
                        <div class="bs col-sm-7 col-xs-7 row">
                            <div class="bs col-sm-6 col-xs-6">
                                <apex:input type="tel" id="PI-Height1" value="{!paramHeightFeet2}" styleClass="bs form-control" html-maxlength="6" disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                                <apex:outputText >{!$Label.eSales_Application_Feet}</apex:outputText>
                            </div>
                            <div class="bs col-sm-6 col-xs-7">
                                <apex:input type="tel" id="PI-Height2" value="{!paramHeightInch2}" styleClass="bs form-control" html-maxlength="6" disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                                <apex:outputText >{!$Label.eSales_Application_Inch}</apex:outputText>
                            </div>
                        </div>
                    </apex:outputPanel>
                        
                    
                </div>
                
                <div class="bs form-group">
                    <div class="bs col-sm-3 col-xs-12">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.PI_Weight__c.Label}" for="PI-Weight"/>
                    </div>
                    <div class="bs col-sm-2 col-xs-5">
                        <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c == 'DMB'}">
                            <apex:inputField id="PI-Weight-Unit-DMB" value="{!txn.PI_Weight_Unit__c}" styleClass="bs form-field-style-select" html-disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                        </apex:outputPanel>
                        <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c != 'DMB'}">
                            <apex:inputField id="PI-Weight-Unit" value="{!txn.PI_Weight_Unit__c}" styleClass="bs form-field-style-select"/>
                        </apex:outputPanel>
                    </div>
                    <div class="bs col-sm-7 col-xs-7">
                        <apex:input type="tel" id="PI-Weight" value="{!paramWeight2}" styleClass="bs form-control" html-maxlength="6" disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                    </div>
                    
                </div>
                
                <apex:outputPanel rendered="{!!isCustomerPortal}">
                    <div class="bs col-xs-12 cigna-fg-gray-dark cigna-form-section-header"><h5>{!$Label.Contact_Detail}</h5></div>
                    <br/>
                    <div class="bs col-sm-12" style="padding: 10px 0px 10px 0px;">
                        <p>
                            <input type="checkbox" id="PI-Residential-Address-checkbox" name="PI-Residential-Address-checkbox" class="bs cigna-question-checkbox"/>
                            <label for="PI-Residential-Address-checkbox" style="font-weight: normal;">{!$Label.Same_Residential_Address_as_Policy_Holder}</label>
                        </p>
                        <apex:inputHidden id="Same-Residential-Address-PH" value="{!paramSameResidentialAddressPH}"/>
                    </div>
                    
                    <script>
                        //CR-56_Link_20220214
                        $('input#PI-Residential-Address-checkbox').on("change",Cigna.ESales.onPIRAChange);
                    </script>
                    <apex:outputPanel layout="block" id="residential-address-part" html-data-id="residential-address-part">
                        <div class="bs form-group">
                            <div class="bs col-sm-3">
                                <apex:outputLabel value="{!$Label.eSales_Residential_Address_Line} 1" for="PI-Address-1-bk"/>
                            </div>
                            <div class="bs col-sm-9">
                                <apex:inputField id="PI-Address-1-bk" value="{!txn.PI_Residential_Address_1__c}" html-placeholder="{!$Label.eSales_Flat_Unit_Floor}" styleClass="bs form-control" />
                            </div>
                        </div>
                        <div class="bs form-group">
                            <div class="bs col-sm-3">
                                <apex:outputLabel value="{!$Label.eSales_Residential_Address_Line} 2" for="PI-Address-2-bk"/>
                            </div>
                            <div class="bs col-sm-9">
                                <apex:inputField id="PI-Address-2-bk" value="{!txn.PI_Residential_Address_2__c}" html-placeholder="{!$Label.eSales_Building_Estate}" styleClass="bs form-control" />
                            </div>
                        </div>
                        <div class="bs form-group">
                            <div class="bs col-sm-3">
                                <apex:outputLabel value="{!$Label.eSales_Residential_Address_Line} 3" for="PI-Address-3-bk"/>
                            </div>
                            <div class="bs col-sm-9">
                                <apex:inputField id="PI-Address-3-bk" value="{!txn.PI_Residential_Address_3__c}" html-placeholder="{!$Label.eSales_Street_District}" styleClass="bs form-control" />
                            </div>
                        </div>
                        <div class="bs form-group">
                            <div class="bs col-sm-3">
                                <apex:outputLabel value="{!$Label.eSales_Residential_Address_Line} 4" for="PI-Address-4-bk"/>
                            </div>
                            <div class="bs col-sm-9">
                                <apex:selectList id="PI-Address-4-bk" value="{!txn.PI_Residential_Address_4_Code__c}" size="1" styleClass="bs form-field-style-select">
                                    <apex:selectOptions value="{!CountryList}"/>
                                </apex:selectList>
                            </div>
                        </div>
                    </apex:outputPanel>
                    <!--remove permanent address
                    <apex:outputPanel rendered="{!onlyHasLife}">
                        <div class="bs col-sm-12 cigna-answer-wrapper-same-address" style="padding-left:0px !important;">
                            <p>
                                <input type="checkbox" id="PI-Permanent-Address-checkbox" name="PI-Permanent-Address-checkbox" class="bs cigna-question-checkbox"/>
                                <label for="PI-Permanent-Address-checkbox">{!$Label.Same_PermanentAddress_as_Policy_Holder}</label>
                            </p>
                            <apex:inputHidden id="Same-Permanent-Address-PH" value="{!paramSamePermanentAddressPH}"/>
                        </div>
                        <script>
                            $('input#PI-Permanent-Address-checkbox').change(Cigna.ESales.onPIPAChange);
                        </script>
                        <apex:outputPanel layout="block" id="permanent-address-part" html-data-id="permanent-address-part">
                            <div class="bs form-group">
                                <div class="bs col-sm-3">
                                    <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.PI_Permanent_Address_1__c.Label}" for="PI-Permanent-Address-1"/>
                                </div>
                                <div class="bs col-sm-9">
                                    <apex:inputField id="PI-Permanent-Address-1" value="{!txn.PI_Permanent_Address_1__c}" html-placeholder="{!$Label.eSales_Flat_Unit_Floor}" styleClass="bs form-control" onchange="Cigna.ESales.ValidatePermanentAddress();"/>
                                </div>
                            </div>
                            <div class="bs form-group">
                                <div class="bs col-sm-3">
                                    <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.PI_Permanent_Address_2__c.Label}" for="PI-Permanent-Address-2"/>
                                </div>
                                <div class="bs col-sm-9">
                                    <apex:inputField id="PI-Permanent-Address-2" value="{!txn.PI_Permanent_Address_2__c}" html-placeholder="{!$Label.eSales_Building_Estate}" styleClass="bs form-control" onchange="Cigna.ESales.ValidatePermanentAddress();"/>
                                </div>
                            </div>
                            <div class="bs form-group">
                                <div class="bs col-sm-3">
                                    <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Permanent_Address_Line3__c.Label}" for="PI-Permanent-Address-3"/>
                                </div>
                                <div class="bs col-sm-9">
                                    <apex:inputField id="PI-Permanent-Address-3" value="{!txn.PI_Permanent_Address_3__c}" html-placeholder="{!$Label.eSales_Street_District}" styleClass="bs form-control" onchange="Cigna.ESales.ValidatePermanentAddress();"/>
                                </div>
                            </div>
                            <div class="bs form-group">
                                <div class="bs col-sm-3">
                                    <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.PI_Permanent_Address_4__c.Label}" for="PI-Permanent-Address-4"/>
                                </div>
                                <div class="bs col-sm-9">
                                    <apex:inputField id="PI-Permanent-Address-4" value="{!txn.PI_Permanent_Address_4__c}" html-placeholder="{!$Label.eSales_Area}" styleClass="bs form-control" onchange="Cigna.ESales.ValidatePermanentAddress();"/>
                                </div>
                            </div>
                        </apex:outputPanel>
                    </apex:outputPanel>
                    -->
                    <div class="bs form-group">
                        <div class="bs col-sm-3 col-xs-12">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.PI_Contact_No__c.Label}" for="PI-ContactNo-bk"/>
                        </div>
                        <div class="bs col-sm-2 col-xs-4">
                            <apex:inputField id="PI-CountryCode-bk" value="{!txn.PI_Country_Code__c}" styleClass="bs form-control" 
                                             html-placeholder="{!$ObjectType.ESales_Transaction__c.Fields.PI_Country_Code__c.Label}"
                                              />
                        </div>
                        <div class="bs col-sm-7 col-xs-8">
                            <apex:input type="tel" id="PI-ContactNo-bk" value="{!paramContactNo2}" styleClass="bs form-control" />
                        </div>
                    </div>
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.PI_Email__c.Label}" for="PH-Email-bk2"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:inputField id="PH-Email-bk2" value="{!txn.PI_Email__c}" styleClass="bs form-control" />
                            <apex:outputText >{!$Label.eSales_email_comment}</apex:outputText>
                        </div>
                    </div>
                    
                    <apex:outputPanel rendered="{!onlyHasLife}">
                        <div class="bs col-xs-12 cigna-fg-gray-dark cigna-form-section-header"><h5>{!$Label.Beneficiary}</h5></div>
                        <br/>
                        
                        <div class="bs row form-group">
                            <div class="bs row listcontent-header hidden-xs">
                               <div class="bs col-sm-2"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.Fields.Beneficiary_Name__c.Label}"/></div>
                               <div class="bs col-sm-2"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.Fields.Beneficiary_Last_Name__c.Label}"/></div>
                               <div class="bs col-sm-2"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.HKID_Passport_Birth_Cert_No__c.Label}"/></div>
                               <div class="bs col-sm-2"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Gender__c.Label}"/></div>
                               <div class="bs col-sm-2"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Relationship_with_the_Proposed_Person__c.Label}"/></div>
                               <div class="bs col-sm-2"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Precentage_Share__c.Label}"/><br/>{!$Label.Total_Percentage}</div>
                               <div class="bs col-sm-1">&nbsp;</div>
                            </div>
                        
                            <apex:variable value="{!0}" var="rowNumPI"/>
                            <apex:repeat value="{!beneficiaryListPI}" var="benPI">
                                <div class="bs row listcontent">
                                    <div class="bs col-xs-offset-11 col-xs-1 visible-xs" >
                                        <span class="glyphicon glyphicon-minus-sign fa-lg onclick-pointer"  onclick="removeRowBeneficiaryPI({!rowNumPI},'{!benPI.Id}')" style="{!IF(beneficiaryListPI.size == 1, 'display:none;', 'display:block;')}"/>
                                    </div>
                                    <div class="bs col-xs-12 col-sm-2" style="padding:0px !important;">
                                       <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Beneficiary_Name__c.Label}"/></div>
                                       <div class="bs col-xs-12 col-sm-12 table-cell"><apex:inputField id="PI-Beneficiary-Firstname" value="{!benPI.Beneficiary_Name__c}" styleclass="bs form-control" /></div>
                                    </div>
                                    <div class="bs col-xs-12 col-sm-2" style="padding:0px !important;">
                                       <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Beneficiary_Last_Name__c.Label}"/></div>
                                       <div class="bs col-xs-12 col-sm-12 table-cell"><apex:inputField id="PI-Beneficiary-Lastname" value="{!benPI.Beneficiary_Last_Name__c}" styleclass="bs form-control" /></div>
                                    </div>
                                    <div class="bs col-xs-12 col-sm-2" style="padding:0px !important;">
                                       <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.HKID_Passport_Birth_Cert_No__c.Label}"/></div>
                                       <div class="bs col-xs-12 col-sm-12 table-cell"><apex:inputField id="PI-HKID-Birth-Cert-Passport-No" value="{!benPI.HKID_Passport_Birth_Cert_No__c}" styleclass="bs form-control" /></div>
                                    </div>
                                    <div class="bs col-xs-12 col-sm-2" style="padding:0px !important;">
                                       <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Gender__c.Label}"/></div>
                                       <div class="bs col-xs-12 col-sm-12 table-cell"><apex:inputField id="PI-Beneficiary-Gender" value="{!benPI.Gender__c}" styleclass="bs form-control" /></div>
                                    </div>

                                    <div class="bs col-xs-12 col-sm-2" style="padding:0px !important;">
                                       <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Relationship_with_the_Proposed_Person__c.Label}"/></div>
                                       <div class="bs col-xs-12 col-sm-12 table-cell"><apex:inputField id="PI-Relationship-with-Person-Insured" value="{!benPI.Relationship_with_the_Proposed_Person__c}" styleclass="bs form-control" /></div>
                                    </div>
                                    <!--<div class="bs col-xs-12 col-sm-1" style="padding:0px !important;">
                                       <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Precentage_Share__c.Label}"/></div>
                                       <div class="bs col-xs-12 col-sm-12 table-cell"><apex:inputField id="PI-Share-Percentage" value="{!benPI.Precentage_Share__c}" styleclass="bs form-control" /></div>
                                    </div>
                                    <div class="bs table-row col-xs-12 col-sm-1 hidden-xs" style="padding:0px !important;">
                                       <div class="bs col-sm-12 table-cell">
                                           <span class="glyphicon glyphicon-minus-sign fa-lg onclick-pointer" onclick="removeRowBeneficiaryPI({!rowNumPI},'{!benPI.Id}')" style="{!IF(beneficiaryListPI.size == 1, 'display:none;', 'display:block;')}" />
                                       </div>
                                    </div>-->
                                    <div class="bs col-xs-12 col-sm-2" style="padding:0px !important;">
                                       <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Precentage_Share__c.Label}"/></div>
                                       <div class="bs col-xs-12 col-sm-8 table-cell"><apex:inputField id="PI-Share-Percentage" value="{!benPI.Precentage_Share__c}" styleclass="bs form-control" /></div>
                                       <div class="bs col-sm-4 table-cell hidden-xs">
                                           <span class="glyphicon glyphicon-minus-sign fa-lg onclick-pointer" onclick="removeRowBeneficiaryPI({!rowNumPI},'{!benPI.Id}')" style="{!IF(beneficiaryListPI.size == 1, 'display:none;', 'display:block;')}" />
                                       </div>
                                    </div>
                                </div>
                                <apex:variable value="{!rowNumPI + 1}" var="rowNumPI"/>
                            </apex:repeat>
    
                            <div id="Share-Total-errMsg-PI" class="col-xs-offset-6 col-xs-6 col-sm-offset-8 col-sm-4 error" style="display:none; padding:10px;">
                                {!$Label.ErrMsg_total_100}
                            </div> 
                            <div class="bs col-sm-offset-10 col-sm-2 col-xs-offset-11 col-xs-1" style="padding:0px !important;">
                                <div class="bs col-sm-offset-8 col-sm-4">
                                    <span class="glyphicon glyphicon-plus-sign fa-lg onclick-pointer" onclick="addRowBeneficiaryPI()" style="{!IF(beneficiaryListPI.size == 3, 'display:none;', 'display:block;')}"/>
                                </div>
                            </div>
                        </div>
    
                    </apex:outputPanel>
                </apex:outputPanel>    
            </div>
            
        </apex:outputPanel>
        <!-- Children Info -->
        <apex:outputPanel id="child-01-info" styleClass="bs row cigna-form-section" rendered="{!currentStep == STEP_PERSONAL_DETAIL && txn.Cover_Child_1__c}" layout="block">
            <div class="bs col-xs-12 cigna-fg-gray-dark cigna-form-section-header"><h4>{!$Label.Child} 1</h4></div>
            <br/>
            <div class="bs col-xs-12 cigna-fg-gray-dark form-horizontal">
                <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Child_1_First_Name__c.Label}" for="CH1-Firstname"/>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:inputText id="CH1-Firstname" value="{!txn.Child_1_First_Name__c}" styleClass="bs form-control" 
                               html-placeholder="{!$ObjectType.ESales_Transaction__c.Fields.Child_1_First_Name__c.Label}"
                               
                        />
                    </div>
                </div>
                <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Child_1_Last_Name__c.Label}" for="CH1-Lastname"/>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:inputText id="CH1-Lastname" value="{!txn.Child_1_Last_Name__c}" styleClass="bs form-control" 
                               html-placeholder="{!$ObjectType.ESales_Transaction__c.Fields.Child_1_Last_Name__c.Label}"
                               
                        />
                    </div>
                </div>
                <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Child_1_Gender__c.Label}" for="CH1-Gender"/>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c == 'DMB'}">
                            <apex:inputField id="CH1-Gender-DMB" value="{!txn.Child_1_Gender__c}" styleClass="bs form-field-style-select" html-disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                        </apex:outputPanel>
                        <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c != 'DMB'}">
                            <apex:inputField id="CH1-Gender" value="{!txn.Child_1_Gender__c}" styleClass="bs form-field-style-select"/>
                        </apex:outputPanel>
                    </div>
                </div>
                <apex:outputPanel rendered="{!!isCustomerPortal}">
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Is_Permanent_HKID_Holder_C1__c.Label}" for="CH1-isPermanentHKID"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:inputField id="CH1-isPermanentHKID" value="{!txn.Is_Permanent_HKID_Holder_C1__c}" styleClass="bs form-field-style-select" /> <!-- onchange="Cigna.ESales.isHKIDHolderChange(this, 'reasonpurchaseC1'); return false;" -->
                        </div>
                    </div>
                </apex:outputPanel>

                <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.HKID_Child_1__c.Label}" for="CH1-HKID"/>
                        <apex:outputPanel rendered="{!!isCustomerPortal}"><i class="fa fa-info-circle" data-toggle="tooltip" data-placement="right" title="{!$Label.Quotation_Child_hkid_tooltip}" aria-hidden="true"></i></apex:outputPanel>
                    </div>
                    <script>
                        $('[data-toggle="tooltip"]').tooltip();
                    </script>
                    <div class="bs col-sm-9">
                        <apex:inputText id="CH1-HKID" value="{!txn.HKID_Child_1__c}" styleClass="bs form-control" />
 
                    </div>
                </div>
               
                <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Date_of_Birth_Child_1__c.Label}" for="CH1-DOB"/>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:input id="Val-DOB-Day-CH1" type="tel" value="{!paramDOBCH1Day}" 
                                               html-maxlength="2" 
                                               styleClass="bs form-control text-center dob-input dob-day question-kid-age"
                                               size="5"
                                               style="display: inline; width: auto;"
                                               html-placeholder="{!$Label.DD}"
                                               onkeyup="getNextInput(this,1);" 
                                               onblur="getCheckDOB('CH1 day',this)"
                                               
                        />
                        <apex:input id="Val-DOB-Month-CH1" type="tel" value="{!paramDOBCH1Month}" 
                                               html-maxlength="2" 
                                               styleClass="bs form-control text-center dob-input dob-month question-kid-age"
                                               size="5"
                                               style="display: inline; width: auto;"
                                               html-placeholder="{!$Label.MM}"
                                               onkeyup="getNextInput(this,2);"
                                               onblur="getCheckDOB('CH1 month',this)"
                                               
                        />
                        <apex:input id="Val-DOB-Year-CH1" type="tel" value="{!paramDOBCH1Year}" 
                                               html-maxlength="4" 
                                               styleClass="bs form-control text-center dob-input dob-year question-kid-age"
                                               size="7"
                                               style="display: inline; width: auto;"
                                               html-placeholder="{!$Label.YYYY}"
                                               onkeyup="getNextInput(this,3);"
                                               onblur="getCheckDOB('CH1 year',this)"
                                               
                        />
                    </div>
                    <div class="bs col-sm-offset-3 col-sm-9 col-xs-12" >
                        <apex:inputText id="CH1-Day-DOB-Check" value="{!paramDOBCH1}" Styleclass="hidden-input-field" Style="height:0px;width:0px;border:0px !important;webkit-appearance: none;" tabindex="-1" onfocus="hiddenonblur(this)" />
                    </div>
                </div>

                <!-- Rancho_IA_AML_Inspection_20211005: display below three fields for all products -->
                <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Child1_Place_of_Birth__c.Label}" for="CH1-input-place-of-birth"/>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:selectList id="CH1-input-place-of-birth" value="{!txn.Child1_Place_of_Birth__c}" size="1" styleClass="bs form-field-style-select">
                            <apex:selectOptions value="{!resnationalityLIst}"/>
                        </apex:selectList>
                    </div>
                </div>
                <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Child1_Nationality__c.Label}" for="CH1-input-nationality"/>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:selectList id="CH1-input-nationality" value="{!txn.Child_1_Nationality_Code__c}" size="1" styleClass="bs form-field-style-select">
                            <apex:selectOptions value="{!NationalityList}"/>
                        </apex:selectList>
                    </div>
                </div>
                <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Place_of_Residence_C1__c.Label}" for="CH1-input-place-of-res"></apex:outputLabel>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:selectList id="CH1-input-place-of-res" value="{!txn.Place_of_Residence_C1__c}" size="1" styleClass="bs form-field-style-select">
                            <apex:selectOptions value="{!resnationalityLIst}"/>
                        </apex:selectList>
                    </div>
                </div>
                
                <div class="bs form-group">
                    <div class="bs col-sm-3 col-xs-12">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Height_Child1__c.Label}" for="CH1-Height"/>
                    </div>
                    <div class="bs col-sm-2 col-xs-4">
                        <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c == 'DMB'}">
                            <apex:inputField id="CH1-Height-Unit-DMB" value="{!txn.Child_1_Height_Unit__c}" styleClass="bs form-field-style-select" onchange="onSelectC1HeightUnit(); return false;" 
                            html-disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                        </apex:outputPanel>
                        <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c != 'DMB'}">
                            <apex:inputField id="CH1-Height-Unit" value="{!txn.Child_1_Height_Unit__c}" styleClass="bs form-field-style-select" onchange="onSelectC1HeightUnit(); return false;" />
                        </apex:outputPanel>
                    </div>

                    <!--<div class="bs col-sm-7 col-xs-8 row">
                        <apex:outputPanel rendered="{!showC1cmHeight}" id="showC1cmHeight">
                            <apex:input type="tel" id="CH1-Height" value="{!paramChildHeight1}" styleClass="bs form-control" html-maxlength="6" />
                        </apex:outputPanel>
                        <apex:outputPanel rendered="{!showC1FTHeight}" id="showC1FTHeight">
                            <div class="bs col-sm-6 col-xs-6">
                                <apex:input type="tel" id="CH1-Height1" value="{!paramC1HeightFeet}" styleClass="bs form-control" html-maxlength="6" />
                                <apex:outputText >{!$Label.eSales_Application_Feet}</apex:outputText>
                            </div>
                            <div class="bs col-sm-6 col-xs-6">
                                <apex:input type="tel" id="CH1-Height2" value="{!paramC1HeightInch}" styleClass="bs form-control" html-maxlength="6" />
                                <apex:outputText >{!$Label.eSales_Application_Inch}</apex:outputText>
                            </div>

                        </apex:outputPanel>
                        
                    </div>-->
                    <apex:outputPanel rendered="{!showC1cmHeight}" id="showC1cmHeight">
                        <div class="bs col-sm-7 col-xs-8">
                            <apex:input type="tel" id="CH1-Height" value="{!paramChildHeight1}" styleClass="bs form-control" html-maxlength="6" disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                        </div>
                    </apex:outputPanel>
                    <apex:outputPanel rendered="{!showC1FTHeight}" id="showC1FTHeight">
                        <div class="bs col-sm-7 col-xs-8 row">
                            <div class="bs col-sm-6 col-xs-6">
                                <apex:input type="tel" id="CH1-Height1" value="{!paramC1HeightFeet}" styleClass="bs form-control" html-maxlength="6" disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                                <apex:outputText >{!$Label.eSales_Application_Feet}</apex:outputText>
                            </div>
                            <div class="bs col-sm-6 col-xs-7">
                                <apex:input type="tel" id="CH1-Height2" value="{!paramC1HeightInch}" styleClass="bs form-control" html-maxlength="6" disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                                <apex:outputText >{!$Label.eSales_Application_Inch}</apex:outputText>
                            </div>
                        </div>
                    </apex:outputPanel>
                </div>
                <div class="bs form-group">
                    <div class="bs col-sm-3 col-xs-12">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Weight_Child1__c.Label}" for="CH1-Weight"/>
                    </div>
                    <div class="bs col-sm-2 col-xs-4">
                        <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c == 'DMB'}">
                            <apex:inputField id="CH1-Weight-Unit-DMB" value="{!txn.Child_1_Weight_Unit__c}" styleClass="bs form-field-style-select" html-disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                        </apex:outputPanel>
                        <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c != 'DMB'}">
                            <apex:inputField id="CH1-Weight-Unit" value="{!txn.Child_1_Weight_Unit__c}" styleClass="bs form-field-style-select"/>
                        </apex:outputPanel>
                    </div>
                    <div class="bs col-sm-7 col-xs-8">
                        <apex:input type="tel" id="CH1-Weight" value="{!paramChildWeight1}" styleClass="bs form-control" html-maxlength="6" disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                    </div>
                    
                </div>

                <!-- add by jack for place of res-->
                <!-- Rancho_IA_AML_Inspection_20211005 -->
                <!-- <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Place_of_Residence_C1__c.Label}" for="CH1-PlaceOfRes"></apex:outputLabel>
                    </div>
                    <div id="input-CH1-PlaceOfRes" class="bs col-sm-9">
                        <apex:selectList id="CH1-PlaceOfRes" value="{!txn.Place_of_Residence_C1__c}" size="1" styleClass="bs form-field-style-select">
                            <apex:selectOptions value="{!resnationalityLIst}"/>
                        </apex:selectList>
                    </div>
                </div> -->

                <div id="reasonpurchaseC1" class="bs form-group" style="display: none">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$Label.Reason_for_purchasing_an_insurance_policy_in_Hong_Kong}" for="C1-reason-for-nonhk"/>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:inputTextarea rows="5" value="{!txn.Reason_for_purchasing_in_HK_C1__c}" style="Height: 60px" styleClass="bs form-control"/>
                    </div>
                </div>

                <script>
                    
                    var hkholderC1 = $("[id$='CH1-isPermanentHKID']").val();
                    if(hkholderC1 == 'No'){
                        $('#reasonpurchaseC1').show();
                    }else{
                        $('#reasonpurchaseC1').hide();
                    }
                </script>

            </div>
            <apex:outputPanel rendered="{!onlyHasLife}">
                <div class="bs col-xs-12 cigna-fg-gray-dark cigna-form-section-header"><h5>{!$Label.Beneficiary}</h5></div>
                <br/>
                
                <div class="bs row form-group">
                    <div class="bs row listcontent-header hidden-xs">
                       <div class="bs col-sm-2"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.Fields.Beneficiary_Name__c.Label}"/></div>
                       <div class="bs col-sm-2"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.Fields.Beneficiary_Last_Name__c.Label}"/></div>
                       <div class="bs col-sm-2"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.HKID_Passport_Birth_Cert_No__c.Label}"/></div>
                       <div class="bs col-sm-2"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Gender__c.Label}"/></div>
                       <div class="bs col-sm-2"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Relationship_with_the_Proposed_Person__c.Label}"/></div>
                       <div class="bs col-sm-2"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Precentage_Share__c.Label}"/><br/>{!$Label.Total_Percentage}</div>
                       <div class="bs col-sm-1">&nbsp;</div>
                    </div>
                
                    <apex:variable value="{!0}" var="rowNumC1"/>
                    <apex:repeat value="{!beneficiaryListC1}" var="benC1">
                        <div class="bs row listcontent">
                            <div class="bs col-xs-offset-11 col-xs-1 visible-xs" >
                                <span class="glyphicon glyphicon-minus-sign fa-lg onclick-pointer"  onclick="removeRowBeneficiaryC1({!rowNumC1},'{!benC1.Id}')" style="{!IF(beneficiaryListC1.size == 1, 'display:none;', 'display:block;')}"/>
                            </div>
                            <div class="bs col-xs-12 col-sm-2" style="padding:0px !important;">
                               <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Beneficiary_Name__c.Label}"/></div>
                               <div class="bs col-xs-12 col-sm-12 table-cell"><apex:inputField id="C1-Beneficiary-Firstname" value="{!benC1.Beneficiary_Name__c}" styleclass="bs form-control" /></div>
                            </div>
                            <div class="bs col-xs-12 col-sm-2" style="padding:0px !important;">
                               <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Beneficiary_Last_Name__c.Label}"/></div>
                               <div class="bs col-xs-12 col-sm-12 table-cell"><apex:inputField id="C1-Beneficiary-Lastname" value="{!benC1.Beneficiary_Last_Name__c}" styleclass="bs form-control" /></div>
                            </div>
                            <div class="bs col-xs-12 col-sm-2" style="padding:0px !important;">
                               <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.HKID_Passport_Birth_Cert_No__c.Label}"/></div>
                               <div class="bs col-xs-12 col-sm-12 table-cell"><apex:inputField id="C1-HKID-Birth-Cert-Passport-No" value="{!benC1.HKID_Passport_Birth_Cert_No__c}" styleclass="bs form-control" /></div>
                            </div>
                            <div class="bs col-xs-12 col-sm-2" style="padding:0px !important;">
                               <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Gender__c.Label}"/></div>
                               <div class="bs col-xs-12 col-sm-12 table-cell"><apex:inputField id="C1-Beneficiary-Gender" value="{!benC1.Gender__c}" styleclass="bs form-control" /></div>
                            </div>

                            <div class="bs col-xs-12 col-sm-2" style="padding:0px !important;">
                               <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Relationship_with_the_Proposed_Person__c.Label}"/></div>
                               <div class="bs col-xs-12 col-sm-12 table-cell"><apex:inputField id="C1-Relationship-with-Person-Insured" value="{!benC1.Relationship_with_the_Proposed_Person__c}" styleclass="bs form-control" /></div>
                            </div>
                            <!--<div class="bs col-xs-12 col-sm-1" style="padding:0px !important;">
                               <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Precentage_Share__c.Label}"/></div>
                               <div class="bs col-xs-12 col-sm-12 table-cell"><apex:inputField id="C1-Share-Percentage" value="{!benC1.Precentage_Share__c}" styleclass="bs form-control" /></div>
                            </div>
                            <div class="bs table-row col-xs-12 col-sm-1 hidden-xs" style="padding:0px !important;">
                               <div class="bs col-sm-12 table-cell">
                                   <span class="glyphicon glyphicon-minus-sign fa-lg onclick-pointer" onclick="removeRowBeneficiaryC1({!rowNumC1},'{!benC1.Id}')" style="{!IF(beneficiaryListC1.size == 1, 'display:none;', 'display:block;')}" />
                               </div>
                            </div>-->
                            <div class="bs col-xs-12 col-sm-2" style="padding:0px !important;">
                               <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Precentage_Share__c.Label}"/></div>
                               <div class="bs col-xs-12 col-sm-8 table-cell"><apex:inputField id="C1-Share-Percentage" value="{!benC1.Precentage_Share__c}" styleclass="bs form-control" /></div>
                               <div class="bs col-sm-4 table-cell hidden-xs">
                                   <span class="glyphicon glyphicon-minus-sign fa-lg onclick-pointer" onclick="removeRowBeneficiaryC1({!rowNumC1},'{!benC1.Id}')" style="{!IF(beneficiaryListC1.size == 1, 'display:none;', 'display:block;')}" />
                               </div>
                            </div>
                        </div>
                        <apex:variable value="{!rowNumC1 + 1}" var="rowNumC1"/>
                    </apex:repeat>

                    <div id="Share-Total-errMsg-C1" class="col-xs-offset-6 col-xs-6 col-sm-offset-8 col-sm-4 error" style="display:none; padding:10px;">
                        {!$Label.ErrMsg_total_100}
                    </div> 
                    <div class="bs col-sm-offset-10 col-sm-2 col-xs-offset-11 col-xs-1" style="padding:0px !important;">
                        <div class="bs col-sm-offset-8 col-sm-4">
                            <span class="glyphicon glyphicon-plus-sign fa-lg onclick-pointer" onclick="addRowBeneficiaryC1()" style="{!IF(beneficiaryListC1.size == 3, 'display:none;', 'display:block;')}"/>
                        </div>
                    </div>
                </div>

            </apex:outputPanel>

        </apex:outputPanel>
        <apex:outputPanel id="child-02-info" styleClass="bs row cigna-form-section" rendered="{!currentStep == STEP_PERSONAL_DETAIL && txn.Cover_Child_2__c}" layout="block">
            <div class="bs col-xs-12 cigna-fg-gray-dark cigna-form-section-header"><h4>{!$Label.Child} 2</h4></div>
            <br/>
            <div class="bs col-xs-12 cigna-fg-gray-dark form-horizontal">
                <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Child_2_First_Name__c.Label}" for="CH2-Firstname"/>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:inputText id="CH2-Firstname" value="{!txn.Child_2_First_Name__c}" styleClass="bs form-control" 
                               html-placeholder="{!$ObjectType.ESales_Transaction__c.Fields.Child_2_First_Name__c.Label}"
                               
                        />
                    </div>
                </div>
                <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Child_2_Last_Name__c.Label}" for="CH2-Lastname"/>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:inputText id="CH2-Lastname" value="{!txn.Child_2_Last_Name__c}" styleClass="bs form-control" 
                               html-placeholder="{!$ObjectType.ESales_Transaction__c.Fields.Child_2_Last_Name__c.Label}"
                               
                        />
                    </div>
                </div>
                <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Child_2_Gender__c.Label}" for="CH2-Gender"/>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c == 'DMB'}">
                            <apex:inputField id="CH2-Gender-DMB" value="{!txn.Child_2_Gender__c}" styleClass="bs form-field-style-select" html-disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                        </apex:outputPanel>
                        <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c != 'DMB'}">
                            <apex:inputField id="CH2-Gender" value="{!txn.Child_2_Gender__c}" styleClass="bs form-field-style-select"/>
                        </apex:outputPanel>
                    </div>
                </div>
                <apex:outputPanel rendered="{!!isCustomerPortal}">
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Is_Permanent_HKID_Holder_C2__c.Label}" for="CH2-isPermanentHKID"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:inputField id="CH2-isPermanentHKID" value="{!txn.Is_Permanent_HKID_Holder_C2__c}" styleClass="bs form-field-style-select" /> <!-- onchange="Cigna.ESales.isHKIDHolderChange(this, 'reasonpurchaseC2'); return false;" -->
                        </div>
                    </div>
                </apex:outputPanel>
                
                <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.HKID_Child_2__c.Label}" for="CH2-HKID"/>
                        <apex:outputPanel rendered="{!!isCustomerPortal}"><i class="fa fa-info-circle" data-toggle="tooltip" data-placement="right" title="{!$Label.Quotation_Child_hkid_tooltip}" aria-hidden="true"></i></apex:outputPanel>
                    </div>
                    <script>
                        $('[data-toggle="tooltip"]').tooltip();
                    </script>
                    <div class="bs col-sm-9">
                        <apex:inputText id="CH2-HKID" value="{!txn.HKID_Child_2__c}" styleClass="bs form-control" />
                    </div>
                </div>
                
                <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Date_of_Birth_Child_2__c.Label}" for="CH2-DOB"/>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:input id="Val-DOB-Day-CH2" type="tel" value="{!paramDOBCH2Day}" 
                                               html-maxlength="2" 
                                               styleClass="bs form-control text-center dob-input dob-day question-kid-age"
                                               size="5"
                                               style="display: inline; width: auto;"
                                               html-placeholder="{!$Label.DD}"
                                               onkeyup="getNextInput(this,1);"
                                               onblur="getCheckDOB('CH2 day',this)"
                                               
                        />
                        <apex:input id="Val-DOB-Month-CH2" type="tel" value="{!paramDOBCH2Month}" 
                                               html-maxlength="2" 
                                               styleClass="bs form-control text-center dob-input dob-month question-kid-age"
                                               size="5"
                                               style="display: inline; width: auto;"
                                               html-placeholder="{!$Label.MM}"
                                               onkeyup="getNextInput(this,2);"
                                               onblur="getCheckDOB('CH2 month',this)"
                                               
                        />
                        <apex:input id="Val-DOB-Year-CH2" type="tel" value="{!paramDOBCH2Year}" 
                                               html-maxlength="4" 
                                               styleClass="bs form-control text-center dob-input dob-year question-kid-age"
                                               size="7"
                                               style="display: inline; width: auto;"
                                               html-placeholder="{!$Label.YYYY}"
                                               onkeyup="getNextInput(this,3);"
                                               onblur="getCheckDOB('CH2 year',this)"
                                               
                                               
                        />
                    </div>
                    <div class="bs col-sm-offset-3 col-sm-9 col-xs-12" >
                        <apex:inputText id="CH2-Day-DOB-Check" value="{!paramDOBCH2}" Styleclass="hidden-input-field" Style="height:0px;width:0px;border:0px !important;webkit-appearance: none;" tabindex="-1" onfocus="hiddenonblur(this)" />
                    </div>
                </div>

                <!-- Rancho_IA_AML_Inspection_20211005: display below three fields for all products -->
                <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Child2_Place_of_Birth__c.Label}" for="CH2-input-place-of-birth"/>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:selectList id="CH2-input-place-of-birth" value="{!txn.Child2_Place_of_Birth__c}" size="1" styleClass="bs form-field-style-select">
                            <apex:selectOptions value="{!resnationalityLIst}"/>
                        </apex:selectList>
                    </div>
                </div>
                <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Child2_Nationality__c.Label}" for="CH2-input-nationality"/>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:selectList id="CH2-input-nationality" value="{!txn.Child_2_Nationality_Code__c}" size="1" styleClass="bs form-field-style-select">
                            <apex:selectOptions value="{!NationalityList}"/>
                        </apex:selectList>
                    </div>
                </div>
                <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Place_of_Residence_C2__c.Label}" for="CH2-input-place-of-res"></apex:outputLabel>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:selectList id="CH2-input-place-of-res" value="{!txn.Place_of_Residence_C2__c}" size="1" styleClass="bs form-field-style-select">
                            <apex:selectOptions value="{!resnationalityLIst}"/>
                        </apex:selectList>
                    </div>
                </div>
                
                <div class="bs form-group">
                    <div class="bs col-sm-3 col-xs-12">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Height_Child2__c.Label}" for="CH2-Height"/>
                    </div>
                    <div class="bs col-sm-2 col-xs-4">
                        <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c == 'DMB'}">
                            <apex:inputField id="CH2-Height-Unit-DMB" value="{!txn.Child_2_Height_Unit__c}" styleClass="bs form-field-style-select" onchange="onSelectC2HeightUnit(); return false;"
                            html-disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                        </apex:outputPanel>
                        <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c != 'DMB'}">
                            <apex:inputField id="CH2-Height-Unit" value="{!txn.Child_2_Height_Unit__c}" styleClass="bs form-field-style-select" onchange="onSelectC2HeightUnit(); return false;"/>
                        </apex:outputPanel>
                    </div>

                    <!--<div class="bs col-sm-7 col-xs-8 row">
                        <apex:outputPanel rendered="{!showC2cmHeight}" id="showC2cmHeight">
                            <apex:input type="tel" id="CH2-Height" value="{!paramChildHeight2}" styleClass="bs form-control" html-maxlength="6" />
                        </apex:outputPanel>
                        <apex:outputPanel rendered="{!showC2FTHeight}" id="showC2FTHeight">
                            <div class="bs col-sm-6 col-xs-6">
                                <apex:input type="tel" id="CH2-Height1" value="{!paramC2HeightFeet}" styleClass="bs form-control" html-maxlength="6" />
                                <apex:outputText >{!$Label.eSales_Application_Feet}</apex:outputText>
                            </div>
                            <div class="bs col-sm-6 col-xs-6">
                                <apex:input type="tel" id="CH2-Height2" value="{!paramC2HeightInch}" styleClass="bs form-control" html-maxlength="6" />
                                <apex:outputText >{!$Label.eSales_Application_Inch}</apex:outputText>
                            </div>

                        </apex:outputPanel>
                        
                    </div>-->
                    <apex:outputPanel rendered="{!showC2cmHeight}" id="showC2cmHeight">
                        <div class="bs col-sm-7 col-xs-8">
                            <apex:input type="tel" id="CH2-Height" value="{!paramChildHeight2}" styleClass="bs form-control" html-maxlength="6" disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                        </div>
                    </apex:outputPanel>
                    <apex:outputPanel rendered="{!showC2FTHeight}" id="showC2FTHeight">
                        <div class="bs col-sm-7 col-xs-8 row">
                            <div class="bs col-sm-6 col-xs-6">
                                <apex:input type="tel" id="CH2-Height1" value="{!paramC2HeightFeet}" styleClass="bs form-control" html-maxlength="6" disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                                <apex:outputText >{!$Label.eSales_Application_Feet}</apex:outputText>
                            </div>
                            <div class="bs col-sm-6 col-xs-7">
                                <apex:input type="tel" id="CH2-Height2" value="{!paramC2HeightInch}" styleClass="bs form-control" html-maxlength="6" disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                                <apex:outputText >{!$Label.eSales_Application_Inch}</apex:outputText>
                            </div>
                        </div>
                    </apex:outputPanel>
                </div>
                
                <div class="bs form-group">
                    <div class="bs col-sm-3 col-xs-12">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Weight_Child2__c.Label}" for="CH2-Weight"/>
                    </div>
                    <div class="bs col-sm-2 col-xs-4">
                        <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c == 'DMB'}">
                            <apex:inputField id="CH2-Weight-Unit-DMB" value="{!txn.Child_2_Weight_Unit__c}" styleClass="bs form-field-style-select" html-disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                        </apex:outputPanel>
                        <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c != 'DMB'}">
                            <apex:inputField id="CH2-Weight-Unit" value="{!txn.Child_2_Weight_Unit__c}" styleClass="bs form-field-style-select"/>
                        </apex:outputPanel>
                    </div>
                    <div class="bs col-sm-7 col-xs-8">
                        <apex:input type="tel" id="CH2-Weight" value="{!paramChildWeight2}" styleClass="bs form-control" html-maxlength="6" disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                    </div>
                    
                </div>

                <!-- add by jack for place of res-->
                <!-- Rancho_IA_AML_Inspection_20211005 -->
                <!-- <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Place_of_Residence_C2__c.Label}" for="CH2-PlaceOfRes"></apex:outputLabel>
                    </div>
                    <div id="input-CH2-PlaceOfRes" class="bs col-sm-9">
                        <apex:selectList id="CH2-PlaceOfRes" value="{!txn.Place_of_Residence_C2__c}" size="1" styleClass="bs form-field-style-select">
                            <apex:selectOptions value="{!resnationalityLIst}"/>
                        </apex:selectList>
                    </div>
                </div> -->

                <div id="reasonpurchaseC2" class="bs form-group" style="display: none">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$Label.Reason_for_purchasing_an_insurance_policy_in_Hong_Kong}" for="C2-reason-for-nonhk"/>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:inputTextarea rows="5" value="{!txn.Reason_for_purchasing_in_HK_C2__c}" style="Height: 60px" styleClass="bs form-control"/>
                    </div>
                </div>

                <script>
                    
                    var hkholderC2 = $("[id$='CH2-isPermanentHKID']").val();
                    if(hkholderC2 == 'No'){
                        $('#reasonpurchaseC2').show();
                    }else{
                        $('#reasonpurchaseC2').hide();
                    }
                </script>

            </div>
            <apex:outputPanel rendered="{!onlyHasLife}">
                <div class="bs col-xs-12 cigna-fg-gray-dark cigna-form-section-header"><h5>{!$Label.Beneficiary}</h5></div>
                <br/>
                
                <div class="bs row form-group">
                    <div class="bs row listcontent-header hidden-xs">
                       <div class="bs col-sm-2"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.Fields.Beneficiary_Name__c.Label}"/></div>
                       <div class="bs col-sm-2"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.Fields.Beneficiary_Last_Name__c.Label}"/></div>
                       <div class="bs col-sm-2"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.HKID_Passport_Birth_Cert_No__c.Label}"/></div>
                       <div class="bs col-sm-2"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Gender__c.Label}"/></div>
                       <div class="bs col-sm-2"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Relationship_with_the_Proposed_Person__c.Label}"/></div>
                       <div class="bs col-sm-2"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Precentage_Share__c.Label}"/><br/>{!$Label.Total_Percentage}</div>
                       <div class="bs col-sm-1">&nbsp;</div>
                    </div>
                
                    <apex:variable value="{!0}" var="rowNumC2"/>
                    <apex:repeat value="{!beneficiaryListC2}" var="benC2">
                        <div class="bs row listcontent">
                            <div class="bs col-xs-offset-11 col-xs-1 visible-xs" >
                                <span class="glyphicon glyphicon-minus-sign fa-lg onclick-pointer"  onclick="removeRowBeneficiaryC2({!rowNumC2},'{!benC2.Id}')" style="{!IF(beneficiaryListC2.size == 1, 'display:none;', 'display:block;')}"/>
                            </div>
                            <div class="bs col-xs-12 col-sm-2" style="padding:0px !important;">
                               <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Beneficiary_Name__c.Label}"/></div>
                               <div class="bs col-xs-12 col-sm-12 table-cell"><apex:inputField id="C2-Beneficiary-Firstname" value="{!benC2.Beneficiary_Name__c}" styleclass="bs form-control" /></div>
                            </div>
                            <div class="bs col-xs-12 col-sm-2" style="padding:0px !important;">
                               <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Beneficiary_Last_Name__c.Label}"/></div>
                               <div class="bs col-xs-12 col-sm-12 table-cell"><apex:inputField id="C2-Beneficiary-Lastname" value="{!benC2.Beneficiary_Last_Name__c}" styleclass="bs form-control" /></div>
                            </div>
                            <div class="bs col-xs-12 col-sm-2" style="padding:0px !important;">
                               <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.HKID_Passport_Birth_Cert_No__c.Label}"/></div>
                               <div class="bs col-xs-12 col-sm-12 table-cell"><apex:inputField id="C2-HKID-Birth-Cert-Passport-No" value="{!benC2.HKID_Passport_Birth_Cert_No__c}" styleclass="bs form-control" /></div>
                            </div>
                            <div class="bs col-xs-12 col-sm-2" style="padding:0px !important;">
                               <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Gender__c.Label}"/></div>
                               <div class="bs col-xs-12 col-sm-12 table-cell"><apex:inputField id="C2-Beneficiary-Gender" value="{!benC2.Gender__c}" styleclass="bs form-control" /></div>
                            </div>

                            <div class="bs col-xs-12 col-sm-2" style="padding:0px !important;">
                               <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Relationship_with_the_Proposed_Person__c.Label}"/></div>
                               <div class="bs col-xs-12 col-sm-12 table-cell"><apex:inputField id="C2-Relationship-with-Person-Insured" value="{!benC2.Relationship_with_the_Proposed_Person__c}" styleclass="bs form-control" /></div>
                            </div>
                            <!--<div class="bs col-xs-12 col-sm-1" style="padding:0px !important;">
                               <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Precentage_Share__c.Label}"/></div>
                               <div class="bs col-xs-12 col-sm-12 table-cell"><apex:inputField id="C2-Share-Percentage" value="{!benC2.Precentage_Share__c}" styleclass="bs form-control" /></div>
                            </div>
                            <div class="bs table-row col-xs-12 col-sm-1 hidden-xs" style="padding:0px !important;">
                               <div class="bs col-sm-12 table-cell">
                                   <span class="glyphicon glyphicon-minus-sign fa-lg onclick-pointer" onclick="removeRowBeneficiaryC2({!rowNumC2},'{!benC2.Id}')" style="{!IF(beneficiaryListC2.size == 1, 'display:none;', 'display:block;')}" />
                               </div>
                            </div>-->
                            <div class="bs col-xs-12 col-sm-2" style="padding:0px !important;">
                               <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Precentage_Share__c.Label}"/></div>
                               <div class="bs col-xs-12 col-sm-8 table-cell"><apex:inputField id="C2-Share-Percentage" value="{!benC2.Precentage_Share__c}" styleclass="bs form-control" /></div>
                               <div class="bs col-sm-4 table-cell hidden-xs">
                                   <span class="glyphicon glyphicon-minus-sign fa-lg onclick-pointer" onclick="removeRowBeneficiaryC2({!rowNumC2},'{!benC2.Id}')" style="{!IF(beneficiaryListC2.size == 1, 'display:none;', 'display:block;')}" />
                               </div>
                            </div>
                        </div>
                        <apex:variable value="{!rowNumC2 + 1}" var="rowNumC2"/>
                    </apex:repeat>

                    <div id="Share-Total-errMsg-C2" class="col-xs-offset-6 col-xs-6 col-sm-offset-8 col-sm-4 error" style="display:none; padding:10px;">
                        {!$Label.ErrMsg_total_100}
                    </div> 
                    <div class="bs col-sm-offset-10 col-sm-2 col-xs-offset-11 col-xs-1" style="padding:0px !important;">
                        <div class="bs col-sm-offset-8 col-sm-4">
                            <span class="glyphicon glyphicon-plus-sign fa-lg onclick-pointer" onclick="addRowBeneficiaryC2()" style="{!IF(beneficiaryListC2.size == 3, 'display:none;', 'display:block;')}"/>
                        </div>
                    </div>
                </div>

            </apex:outputPanel>
        </apex:outputPanel>
        <apex:outputPanel id="child-03-info" styleClass="bs row cigna-form-section" rendered="{!currentStep == STEP_PERSONAL_DETAIL && txn.Cover_Child_3__c}" layout="block">
            <div class="bs col-xs-12 cigna-fg-gray-dark cigna-form-section-header"><h4>{!$Label.Child} 3</h4></div>
            <br/>
            <div class="bs col-xs-12 cigna-fg-gray-dark form-horizontal">
                <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Child_3_First_Name__c.Label}" for="CH3-Firstname"/>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:inputText id="CH3-Firstname" value="{!txn.Child_3_First_Name__c}" styleClass="bs form-control" 
                               html-placeholder="{!$ObjectType.ESales_Transaction__c.Fields.Child_3_First_Name__c.Label}"
                               
                        />
                    </div>
                </div>
                <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Child_3_Last_Name__c.Label}" for="CH3-Lastname"/>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:inputText id="CH3-Lastname" value="{!txn.Child_3_Last_Name__c}" styleClass="bs form-control" 
                               html-placeholder="{!$ObjectType.ESales_Transaction__c.Fields.Child_3_Last_Name__c.Label}"
                               
                        />
                    </div>
                </div>
                <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Child_3_Gender__c.Label}" for="CH3-Gender"/>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c == 'DMB'}">
                            <apex:inputField id="CH3-Gender-DMB" value="{!txn.Child_3_Gender__c}" styleClass="bs form-field-style-select" html-disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                        </apex:outputPanel>
                        <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c != 'DMB'}">
                            <apex:inputField id="CH3-Gender" value="{!txn.Child_3_Gender__c}" styleClass="bs form-field-style-select"/>
                        </apex:outputPanel>
                    </div>
                </div>
                <apex:outputPanel rendered="{!!isCustomerPortal}">
                    <div class="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Is_Permanent_HKID_Holder_C3__c.Label}" for="CH3-isPermanentHKID"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:inputField id="CH3-isPermanentHKID" value="{!txn.Is_Permanent_HKID_Holder_C3__c}" styleClass="bs form-field-style-select" /> <!-- onchange="Cigna.ESales.isHKIDHolderChange(this, 'reasonpurchaseC3'); return false;" -->
                        </div>
                    </div>
                </apex:outputPanel>
                
                <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.HKID_Child_3__c.Label}" for="CH3-HKID"/>
                        <apex:outputPanel rendered="{!!isCustomerPortal}"><i class="fa fa-info-circle" data-toggle="tooltip" data-placement="right" title="{!$Label.Quotation_Child_hkid_tooltip}" aria-hidden="true"></i></apex:outputPanel>
                    </div>
                    <script>
                        $('[data-toggle="tooltip"]').tooltip();
                    </script>
                    <div class="bs col-sm-9">
                        <apex:inputText id="CH3-HKID" value="{!txn.HKID_Child_3__c}" styleClass="bs form-control" />
                    </div>
                </div>
                
                <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Date_of_Birth_Child_3__c.Label}" for="CH3-DOB"/>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:input id="Val-DOB-Day-CH3" type="tel" value="{!paramDOBCH3Day}" 
                                               html-maxlength="2" 
                                               styleClass="bs form-control text-center dob-input dob-day question-kid-age"
                                               size="5"
                                               style="display: inline; width: auto;"
                                               html-placeholder="{!$Label.DD}"
                                               onkeyup="getNextInput(this,1);"
                                               onblur="getCheckDOB('CH3 day',this)"

                        />
                        <apex:input id="Val-DOB-Month-CH3" type="tel" value="{!paramDOBCH3Month}" 
                                               html-maxlength="2" 
                                               styleClass="bs form-control text-center dob-input dob-month question-kid-age"
                                               size="5"
                                               style="display: inline; width: auto;"
                                               html-placeholder="{!$Label.MM}"
                                               onkeyup="getNextInput(this,2);"
                                               onblur="getCheckDOB('CH3 month',this)"
                        />
                        <apex:input id="Val-DOB-Year-CH3" type="tel" value="{!paramDOBCH3Year}" 
                                               html-maxlength="4" 
                                               styleClass="bs form-control text-center dob-input dob-year question-kid-age"
                                               size="7"
                                               style="display: inline; width: auto;"
                                               html-placeholder="{!$Label.YYYY}"
                                               onkeyup="getNextInput(this,3);"
                                               onblur="getCheckDOB('CH3 year',this)"
                        />
                    </div>
                    <div class="bs col-sm-offset-3 col-sm-9 col-xs-12" >
                        <apex:inputText id="CH3-Day-DOB-Check" value="{!paramDOBCH3}" Styleclass="hidden-input-field" Style="height:0px;width:0px;border:0px !important;webkit-appearance: none;" tabindex="-1" onfocus="hiddenonblur(this)" />
                    </div>
                </div>
                
                <!-- Rancho_IA_AML_Inspection_20211005: display below three fields for all products on customer portal -->
                <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Child3_Place_of_Birth__c.Label}" for="CH3-input-place-of-birth"/>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:selectList id="CH3-input-place-of-birth" value="{!txn.Child3_Place_of_Birth__c}" size="1" styleClass="bs form-field-style-select">
                            <apex:selectOptions value="{!resnationalityLIst}"/>
                        </apex:selectList>
                    </div>
                </div>
                <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Child3_Nationality__c.Label}" for="CH3-input-nationality"/>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:selectList id="CH3-input-nationality" value="{!txn.Child_3_Nationality_Code__c}" size="1" styleClass="bs form-field-style-select">
                            <apex:selectOptions value="{!NationalityList}"/>
                        </apex:selectList>
                    </div>
                </div>
                <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Place_of_Residence_C3__c.Label}" for="CH3-input-place-of-res"></apex:outputLabel>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:selectList id="CH3-input-place-of-res" value="{!txn.Place_of_Residence_C3__c}" size="1" styleClass="bs form-field-style-select">
                            <apex:selectOptions value="{!resnationalityLIst}"/>
                        </apex:selectList>
                    </div>
                </div>
                
                <div class="bs form-group">
                    <div class="bs col-sm-3 col-xs-12">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Height_Child3__c.Label}" for="CH3-Height"/>
                    </div>
                    <div class="bs col-sm-2 col-xs-4">
                        <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c == 'DMB'}">
                            <apex:inputField id="CH3-Height-Unit-DMB" value="{!txn.Child_3_Height_Unit__c}" styleClass="bs form-field-style-select" onchange="onSelectC3HeightUnit(); return false;"
                            html-disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                        </apex:outputPanel>
                        <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c != 'DMB'}">
                            <apex:inputField id="CH3-Height-Unit" value="{!txn.Child_3_Height_Unit__c}" styleClass="bs form-field-style-select" onchange="onSelectC3HeightUnit(); return false;"/>
                        </apex:outputPanel>
                    </div>

                    <!--<div class="bs col-sm-7 col-xs-8 row">
                        <apex:outputPanel rendered="{!showC3cmHeight}" id="showC3cmHeight">
                            <apex:input type="tel" id="CH3-Height" value="{!paramChildHeight3}" styleClass="bs form-control" html-maxlength="6" />
                        </apex:outputPanel>
                        <apex:outputPanel rendered="{!showC3FTHeight}" id="showC3FTHeight">
                            <div class="bs col-sm-6 col-xs-6">
                                <apex:input type="tel" id="CH3-Height1" value="{!paramC3HeightFeet}" styleClass="bs form-control" html-maxlength="6" />
                                <apex:outputText >{!$Label.eSales_Application_Feet}</apex:outputText>
                            </div>
                            <div class="bs col-sm-6 col-xs-6">
                                <apex:input type="tel" id="CH3-Height2" value="{!paramC3HeightInch}" styleClass="bs form-control" html-maxlength="6" />
                                <apex:outputText >{!$Label.eSales_Application_Inch}</apex:outputText>
                            </div>

                        </apex:outputPanel>
                        
                    </div>-->
                    <apex:outputPanel rendered="{!showC3cmHeight}" id="showC3cmHeight">
                        <div class="bs col-sm-7 col-xs-8">
                            <apex:input type="tel" id="CH3-Height" value="{!paramChildHeight3}" styleClass="bs form-control" html-maxlength="6" disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                        </div>
                    </apex:outputPanel>
                    <apex:outputPanel rendered="{!showC3FTHeight}" id="showC3FTHeight">
                        <div class="bs col-sm-7 col-xs-8 row">
                            <div class="bs col-sm-6 col-xs-6">
                                <apex:input type="tel" id="CH3-Height1" value="{!paramC3HeightFeet}" styleClass="bs form-control" html-maxlength="6" disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                                <apex:outputText >{!$Label.eSales_Application_Feet}</apex:outputText>
                            </div>
                            <div class="bs col-sm-6 col-xs-7">
                                <apex:input type="tel" id="CH3-Height2" value="{!paramC3HeightInch}" styleClass="bs form-control" html-maxlength="6" disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                                <apex:outputText >{!$Label.eSales_Application_Inch}</apex:outputText>
                            </div>
                        </div>
                    </apex:outputPanel>
                </div>
                <div class="bs form-group">
                    <div class="bs col-sm-3 col-xs-12">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Weight_Child3__c.Label}" for="CH3-Weight"/>
                    </div>
                    <div class="bs col-sm-2 col-xs-4">
                        <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c == 'DMB'}">
                            <apex:inputField id="CH3-Weight-Unit-DMB" value="{!txn.Child_3_Weight_Unit__c}" styleClass="bs form-field-style-select" html-disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                        </apex:outputPanel>
                        <apex:outputPanel rendered="{!txn.Basic_Plan_Code__c != 'DMB'}">
                            <apex:inputField id="CH3-Weight-Unit" value="{!txn.Child_3_Weight_Unit__c}" styleClass="bs form-field-style-select"/>
                        </apex:outputPanel>
                    </div>
                    <div class="bs col-sm-7 col-xs-8">
                        <apex:input type="tel" id="CH3-Weight" value="{!paramChildWeight3}" styleClass="bs form-control" html-maxlength="6" disabled="{!txn.Basic_Plan_Code__c == 'DMB'}"/>
                    </div>
                    
                </div>

                <!-- add by jack for place of res-->
                <!-- Rancho_IA_AML_Inspection_20211005 -->
                <!-- <div class="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Place_of_Residence_C3__c.Label}" for="CH3-PlaceOfRes"></apex:outputLabel>
                    </div>
                    <div id="input-CH3-PlaceOfRes" class="bs col-sm-9">
                        <apex:selectList id="CH3-PlaceOfRes" value="{!txn.Place_of_Residence_C3__c}" size="1" styleClass="bs form-field-style-select">
                            <apex:selectOptions value="{!resnationalityLIst}"/>
                        </apex:selectList>
                    </div>
                </div> -->
                
                <div id="reasonpurchaseC3" class="bs form-group" style="display: none">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$Label.Reason_for_purchasing_an_insurance_policy_in_Hong_Kong}" for="C3-reason-for-nonhk"/>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:inputTextarea rows="5" value="{!txn.Reason_for_purchasing_in_HK_C3__c}" style="Height: 60px" styleClass="bs form-control"/>
                    </div>
                </div>

                <script>
                    
                    var hkholderC3 = $("[id$='CH3-isPermanentHKID']").val();
                    if(hkholderC3 == 'No'){
                        $('#reasonpurchaseC3').show();
                    }else{
                        $('#reasonpurchaseC3').hide();
                    }
                </script>
            </div>
            <apex:outputPanel rendered="{!onlyHasLife}">
                <div class="bs col-xs-12 cigna-fg-gray-dark cigna-form-section-header"><h5>{!$Label.Beneficiary}</h5></div>
                <br/>
                
                <div class="bs row form-group">
                    <div class="bs row listcontent-header hidden-xs">
                       <div class="bs col-sm-2"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.Fields.Beneficiary_Name__c.Label}"/></div>
                       <div class="bs col-sm-2"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.Fields.Beneficiary_Last_Name__c.Label}"/></div>
                       <div class="bs col-sm-2"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.HKID_Passport_Birth_Cert_No__c.Label}"/></div>
                       <div class="bs col-sm-2"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Gender__c.Label}"/></div>
                       <div class="bs col-sm-2"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Relationship_with_the_Proposed_Person__c.Label}"/></div>
                       <div class="bs col-sm-2"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Precentage_Share__c.Label}"/><br/>{!$Label.Total_Percentage}</div>
                       <div class="bs col-sm-1">&nbsp;</div>
                    </div>
                
                    <apex:variable value="{!0}" var="rowNumC3"/>
                    <apex:repeat value="{!beneficiaryListC3}" var="benC3">
                        <div class="bs row listcontent">
                            <div class="bs col-xs-offset-11 col-xs-1 visible-xs" >
                                <span class="glyphicon glyphicon-minus-sign fa-lg onclick-pointer"  onclick="removeRowBeneficiaryC3({!rowNumC3},'{!benC3.Id}')" style="{!IF(beneficiaryListC3.size == 1, 'display:none;', 'display:block;')}"/>
                            </div>
                            <div class="bs col-xs-12 col-sm-2" style="padding:0px !important;">
                               <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Beneficiary_Name__c.Label}"/></div>
                               <div class="bs col-xs-12 col-sm-12 table-cell"><apex:inputField id="C3-Beneficiary-Firstname" value="{!benC3.Beneficiary_Name__c}" styleclass="bs form-control" /></div>
                            </div>
                            <div class="bs col-xs-12 col-sm-2" style="padding:0px !important;">
                               <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Beneficiary_Last_Name__c.Label}"/></div>
                               <div class="bs col-xs-12 col-sm-12 table-cell"><apex:inputField id="C3-Beneficiary-Lastname" value="{!benC3.Beneficiary_Last_Name__c}" styleclass="bs form-control" /></div>
                            </div>
                            <div class="bs col-xs-12 col-sm-2" style="padding:0px !important;">
                               <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.HKID_Passport_Birth_Cert_No__c.Label}"/></div>
                               <div class="bs col-xs-12 col-sm-12 table-cell"><apex:inputField id="C3-HKID-Birth-Cert-Passport-No" value="{!benC3.HKID_Passport_Birth_Cert_No__c}" styleclass="bs form-control" /></div>
                            </div>
                            <div class="bs col-xs-12 col-sm-2" style="padding:0px !important;">
                               <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Gender__c.Label}"/></div>
                               <div class="bs col-xs-12 col-sm-12 table-cell"><apex:inputField id="C3-Beneficiary-Gender" value="{!benC3.Gender__c}" styleclass="bs form-control" /></div>
                            </div>

                            <div class="bs col-xs-12 col-sm-2" style="padding:0px !important;">
                               <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Relationship_with_the_Proposed_Person__c.Label}"/></div>
                               <div class="bs col-xs-12 col-sm-12 table-cell"><apex:inputField id="C3-Relationship-with-Person-Insured" value="{!benC3.Relationship_with_the_Proposed_Person__c}" styleclass="bs form-control" /></div>
                            </div>
                            <!--<div class="bs col-xs-12 col-sm-1" style="padding:0px !important;">
                               <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Precentage_Share__c.Label}"/></div>
                               <div class="bs col-xs-12 col-sm-12 table-cell"><apex:inputField id="C3-Share-Percentage" value="{!benC3.Precentage_Share__c}" styleclass="bs form-control" /></div>
                            </div>
                            <div class="bs table-row col-xs-12 col-sm-1 hidden-xs" style="padding:0px !important;">
                               <div class="bs col-sm-12 table-cell">
                                   <span class="glyphicon glyphicon-minus-sign fa-lg onclick-pointer" onclick="removeRowBeneficiaryC3({!rowNumC3},'{!benC3.Id}')" style="{!IF(beneficiaryListC3.size == 1, 'display:none;', 'display:block;')}" />
                               </div>
                            </div>-->
                            <div class="bs col-xs-12 col-sm-2" style="padding:0px !important;">
                               <div class="bs col-xs-12 visible-xs table-cell"><apex:outputLabel value="{!$ObjectType.E_Sales_Beneficiary__c.fields.Precentage_Share__c.Label}"/></div>
                               <div class="bs col-xs-12 col-sm-8 table-cell"><apex:inputField id="C3-Share-Percentage" value="{!benC3.Precentage_Share__c}" styleclass="bs form-control" /></div>
                               <div class="bs col-sm-4 table-cell hidden-xs">
                                   <span class="glyphicon glyphicon-minus-sign fa-lg onclick-pointer" onclick="removeRowBeneficiaryC3({!rowNumC3},'{!benC3.Id}')" style="{!IF(beneficiaryListC3.size == 1, 'display:none;', 'display:block;')}" />
                               </div>
                            </div>
                        </div>
                        <apex:variable value="{!rowNumC3 + 1}" var="rowNumC3"/>
                    </apex:repeat>

                    <div id="Share-Total-errMsg-C3" class="col-xs-offset-6 col-xs-6 col-sm-offset-8 col-sm-4 error" style="display:none; padding:10px;">
                        {!$Label.ErrMsg_total_100}
                    </div> 
                    <div class="bs col-sm-offset-10 col-sm-2 col-xs-offset-11 col-xs-1" style="padding:0px !important;">
                        <div class="bs col-sm-offset-8 col-sm-4">
                            <span class="glyphicon glyphicon-plus-sign fa-lg onclick-pointer" onclick="addRowBeneficiaryC3()" style="{!IF(beneficiaryListC3.size == 3, 'display:none;', 'display:block;')}"/>
                        </div>
                    </div>
                </div>

            </apex:outputPanel>
        </apex:outputPanel>
        
        <!-- 20200427 - minghua - PolicyReplacement -->
        <apex:outputPanel id="need-declaration-section" rendered="{!currentStep == STEP_PERSONAL_DETAIL && onlyHasLife}" styleClass="bs row cigna-form-section" layout="block">
        <div class="bs col-xs-12 cigna-fg-gray-dark cigna-form-section-header"><h4>{!$Label.eSales_replacement_declaration}</h4></div>
        <div class="bs col-xs-12">
            <p>
                {!transField['policyRQ1'][$Label.Header_Language_Code_Current]} {!transField['policyRQ2'][$Label.Header_Language_Code_Current]}
            </p>
            <p>
                {!transField['policyRQa'][$Label.Header_Language_Code_Current]}
            </p>
            <p>
                {!transField['policyRQb'][$Label.Header_Language_Code_Current]}
            </p>
            <p>
                {!transField['policyRQc'][$Label.Header_Language_Code_Current]}
            </p>
            <p>
                {!transField['policyRQd'][$Label.Header_Language_Code_Current]}
            </p>
            <p>
                {!transField['policyRQe'][$Label.Header_Language_Code_Current]}
            </p>
            <div class="bs col-sm-2 col-xs-5">
                <apex:inputField id="Policy-Replacement" value="{!txn.PolicyReplacement__c}" styleClass="bs form-field-style-select" />
            </div>
            <div id="showtncforNO" class="bs col-xs-12" style="padding-left: 0px;padding-top: 50px;font-weight: 1000;">
                <p>
                    <span>{!transField['Policy_Replacement_Warning_1'][$Label.Header_Language_Code_Current]} </span>
                    <span style="text-decoration: underline;">{!transField['Policy_Replacement_Warning_2'][$Label.Header_Language_Code_Current]} </span>
                    <span>{!transField['Policy_Replacement_Warning_3'][$Label.Header_Language_Code_Current]} </span>
                    <span>{!transField['Policy_Replacement_Warning_4'][$Label.Header_Language_Code_Current]} </span>
                </p>
                <P>
                    <span>{!transField['Policy_Replacement_Warning_p2'][$Label.Header_Language_Code_Current]}</span>
                </p>
            </div>
        </div>
            <!--<div class="bs col-xs-12 cigna-fg-gray-dark cigna-form-section-header"><h4>{!$Label.eSales_replacement_declaration}</h4></div>
            <br/>
            <div class="bs col-xs-12 cigna-fg-gray-dark form-horizontal">

                <div class="bs form-group">
                    <div class="bs col-xs-12">
                        <apex:outputText escape="false" value="{!$Label.eSales_cpd_q1}"/>
                    </div>
                </div>
                <div class="bs col-xs-12 cigna-answer-wrapper">
                    <p>
                    <div class="bs col-sm-6 cigna-answer-wrapper">
                    
                        <input type="radio" id="replacement-declaration-last-01" value="Yes" name="replacement-declaration-last" class="bs cigna-question-radio" />
                        <label for="replacement-declaration-last-01">{!$Label.Yes}</label>
                    
                    </div>
                    <div class="bs col-sm-6 cigna-answer-wrapper">
                    
                        <input type="radio" id="replacement-declaration-last-02" value="No" name="replacement-declaration-last" class="bs cigna-question-radio" />
                        <label for="replacement-declaration-last-02">{!$Label.No}</label>
                    
                    </div>
                    </p>
                    <apex:inputHidden value="{!txn.Replacement_Declaration_Last__c}" id="paramReplacementDeclarationLast"
                                      html-class="cigna-validation"
                                      html-data-msg-required="{!$Label.eSales_cpd_required}" />
                </div>

                <div class="bs form-group">
                    <div class="bs col-xs-12">
                        <apex:outputText escape="false" value="{!$Label.eSales_cpd_q2}"/>
                    </div>
                </div>
                <div class="bs col-xs-12 cigna-answer-wrapper">
                    <p>
                    <div class="bs col-sm-6 cigna-answer-wrapper">
                        
                        <input type="radio" id="replacement-declaration-next-01" value="Yes" name="replacement-declaration-next" class="bs cigna-question-radio" />
                        <label for="replacement-declaration-next-01">{!$Label.Yes}</label>
                    
                    </div>
                    <div class="bs col-sm-6 cigna-answer-wrapper">
                        <input type="radio" id="replacement-declaration-next-02" value="No" name="replacement-declaration-next" class="bs cigna-question-radio" />
                        <label for="replacement-declaration-next-02">{!$Label.No}</label>
                    </div>
                    </p>
                    <apex:inputHidden value="{!txn.Replacement_Declaration_Next__c}" id="paramReplacementDeclarationNext"
                                      html-class="cigna-validation"
                                      html-data-msg-required="{!$Label.eSales_cpd_required}" />
                </div>
                
                <div id="showtncforNO" class="bs col-xs-12" style="padding-left: 0px;font-size: 0.8em;padding-top: 50px;font-weight: bold;">
                    <apex:outputText escape="false" value="{!$Label.eSales_Replacement_tnc_N1}"/>
                    <br/>
                    <apex:outputText escape="false" value="{!$Label.eSales_Replacement_tnc_N2}"/>
                    <br/>
                    <apex:outputText escape="false" value="{!$Label.eSales_Replacement_tnc_N3}"/>
                    <br/>
                    <br/>
                    <apex:outputText escape="false" value="{!$Label.eSales_CPD_tnc}"/>
                </div>
                <!--
                <div style="padding-left: 0px;font-size: 0.8em;padding-top: 50px;" class="bs col-xs-12">
                    <apex:outputText escape="false" value="{!$Label.eSales_CPD_tnc}"/>
                </div>
                --><!--
                <br/>
            </div>

            <script>
                if($("input[id$='paramReplacementDeclarationLast']").val() == 'Yes'){
                    $("#replacement-declaration-last-01").attr('checked','checked');
                } else if ($("input[id$='paramReplacementDeclarationLast']").val() == 'No'){
                    $("#replacement-declaration-last-02").attr('checked','checked');
                }

                if($("input[id$='paramReplacementDeclarationNext']").val() == 'Yes'){
                    $("#replacement-declaration-next-01").attr('checked','checked');
                } else if ($("input[id$='paramReplacementDeclarationNext']").val() == 'No'){
                    $("#replacement-declaration-next-02").attr('checked','checked');
                }

                $('input.cigna-question-radio').change(Cigna.ESales.onRadioChange);
            </script>
            -->
        </apex:outputPanel>
        <!--
        <apex:outputPanel id="pics-section" rendered="{!currentStep == STEP_PERSONAL_DETAIL && !isCustomerPortal && ISBLANK(txn.Customer_Id__c)}" styleClass="bs row" layout="block">
            <div class="bs col-xs-12">
                <p>{!$Label.ESales_DM}</p>
            </div>
            <div class="bs col-xs-12">
                <div class="bs cigna-answer-wrapper">  
                    <p>
                        <input type="checkbox" id="dm-consent" name="dm-consent" class="bs cigna-question-checkbox" />
                        <label for="dm-consent">{!$Label.ESales_DM_Accept}</label>
                        <apex:inputHidden value="{!paramDMConsent}" id="paramDMConsent" />
                    </p>
                </div>
            </div>
            <script>
                $('input#dm-consent').change(Cigna.ESales.onCheckboxChange);
            </script>
        </apex:outputPanel>
        -->
        <apex:outputPanel rendered="{!currentStep == STEP_PERSONAL_DETAIL}" layout="none">
        <script>
            //CR-56_Link_20220214
            $('.dob-input').on("keyup",function(evt) {
                if (this.value.length == this.maxLength && evt.keyCode >= 48 && evt.keyCode <= 57) {
                    var $next = $(this).nextAll('.dob-input');
                    if ($next.length){
                        $(this).nextAll('.dob-input')[0].focus();
                    } else {
                        //CR-56_Link_20220214
                        $(this).trigger("blur");
                    }
                } else if (this.value.length == 0 && evt.keyCode == 8) {
                    // Backspace
                    var $prev = $(this).prevAll('.dob-input');
                    if ($prev.length){
                        $(this).prevAll('.dob-input')[0].focus();
                    } else {
                        //CR-56_Link_20220214
                        $(this).trigger("blur");
                    }
                }
            });
            
        </script>
        </apex:outputPanel>
        <!-- Rancho_BPE57_03_20210518 replace isSalesforce1 by isSalesforce1AUW -->
        <apex:outputPanel id="underwriting-section" rendered="{!currentStep == STEP_UNDERWRITING && !isSalesforce1AUW && documentloadReady}" styleClass="bs row" layout="block">
            <div class="bs col-xs-12">
                <apex:outputPanel >
                    <div class="uw-person-name bs col-xs-12 cigna-fg-gray-dark cigna-form-section-header"><h4><center>{!txn.Policy_Holder_First_Name__c} {!txn.Policy_Holder_Last_Name__c}</center></h4></div>
                    <br/>
                </apex:outputPanel>
                <!-- change by minghua -->
                <!-- Rancho_PI38_20210803 all safari are pop-up windows -->
                <!-- <apex:outputPanel styleClass="wrap-iframe-third-party" rendered="{!!isIOSChrome}"> -->
                <apex:outputPanel styleClass="wrap-iframe-third-party" rendered="{!!isIOSChrome && !(isCustomerPortal && isSafari && !isCustomerApp)}">
                    <apex:iframe src="{!phURL}" height="1024px" scrolling="true"/>
                    <script>
                        console.log('iframe');
                        Cigna.ESales.setUWStatusPolling();
                        //Ray Update : Add the pop-up to check the window for macbook safari
                        //Rancho_PI38_20210803: add !Cigna.Util.checkWebView()
                        if(!Cigna.Util.checkWebView() && !Cigna.Util.isIOS() && !!navigator.userAgent.match(/Version\/[\d\.]+.*Safari/) && '{!phURL}'!='') {
                            var language = window.navigator.userLanguage || window.navigator.language;                          
                            if(language == 'zh-TW'||language == 'zh-CH'){
                                alert("請先確保於Safari設置中容許Cookies - 請到 [Safari] -> [偏好設定⋯] -> [隱私權] -> 在「Cookie 和網站資料」選擇 [總是允許], 然後按以下[關閉]繼續。");   
                            }else{
                                alert("Please make sure to always allow cookies in Safari settings by going to [Safari] -> [Preferences...] -> [Privacy] -> Select [Always Allow] option under “Cookies and website data”, then press [Close] below to proceed.");                      
                            }
                        }

                        // Rancho_PI38_20210803
                        if(Cigna.Util.isCustomerPortal() && Cigna.Util.isIOS() && Cigna.Util.checkWebView() && '{!phURL}'!=''){
                            alert("{!$Label.Allow_Cross_Website_Tracking}");
                        }

                        //Ray Update: End       
                        $('div.header-bar').hide();
                        $('div.desktopProgressBar').css('margin-top','50px'); //Ray Update
                        //$('br').hide();
                        
                        if (Cigna.Util.isSalesforce1() && Cigna.Util.isIOS()) {
                            var $frame = $('.wrap-iframe-third-party iframe').first();
                            $($frame).height((window.screen.height - 44 - 20 - 64) * 0.95 + 'px');
                        } else {
                            var $frame = $('.wrap-iframe-third-party iframe').first();
                            $($frame).height(($(window).height() - $($frame).offset().top) * 0.95);
                        }
                    </script>
                        <!-- Add by Manuel to test the AUW iframe url 1 -->
                        <!--iframe id="ifmHide" style="display:none"></iframe
                        <apex:iframe src="https://autouwqa.cigna.com.hk/cigna-asia/screens/view/full/case/72032/entity/72032_632268/page/YOUR_HEALTH_HISTORY/basequestions" height="1024px" scrolling="true"/>
                        -->
                </apex:outputPanel>

                <!-- add by minghua -->
                <!-- Rancho_PI38_20210803 -->
                <!-- <apex:outputPanel rendered="{!isIOSChrome}"> -->
                <apex:outputPanel rendered="{!isIOSChrome || (isCustomerPortal && isSafari && !isCustomerApp)}">
                    <script>
                        Cigna.ESales.autoShowAuw('{!phURL}');
                        Cigna.ESales.mobileChromeSetUWStatusPolling();
                    </script>
                </apex:outputPanel>
            </div>
        </apex:outputPanel>
        <!-- Rancho_BPE57_03_20210518 replace isSalesforce1 by isSalesforce1AUW -->
        <apex:outputPanel id="underwriting-sectionPI" rendered="{!currentStep == STEP_UNDERWRITING_PI && !isSalesforce1AUW && documentloadReady}" styleClass="bs row" layout="block">
            <div class="bs col-xs-12">
                <apex:outputPanel >
                    <div class="bs col-xs-12 cigna-fg-gray-dark cigna-form-section-header"><h4><center>{!txn.PI_First_Name__c} {!txn.PI_Last_Name__c}</center></h4></div>
                    <br/>
                </apex:outputPanel>
                <!-- change by minghua -->
                <!-- Rancho_PI38_20210803 all safari are pop-up windows -->
                <!-- <apex:outputPanel styleClass="wrap-iframe-third-party" rendered="{!!isIOSChrome}"> -->
                <apex:outputPanel styleClass="wrap-iframe-third-party" rendered="{!!isIOSChrome && !(isCustomerPortal && isSafari && !isCustomerApp)}">
                    <apex:iframe src="{!piURL}" height="1024px" scrolling="true"/>
                    <!-- Add by Manuel to test the AUW iframe url 2 -->
                    <!-- <apex:iframe src="https://autouwqa.cigna.com.hk/cigna-asia/screens/view/full/case/72032/entity/72032_632268/page/YOUR_HEALTH_HISTORY/basequestions" height="1024px" scrolling="true" /> -->
                    <script>
                        Cigna.ESales.setUWStatusPolling();
                        //Ray Update : Add the pop-up to check the window for macbook safari 
                        //Rancho_PI38_20210803: add !Cigna.Util.checkWebView()
                        if(!Cigna.Util.checkWebView() && !Cigna.Util.isIOS() && !!navigator.userAgent.match(/Version\/[\d\.]+.*Safari/) && '{!piURL}' !='' && '{!txn.Number_of_Adult__c}' == 1 && '{!txn.PH_is_PI__c}'=='false' ){
                            var language = window.navigator.userLanguage || window.navigator.language;                          
                            if(language == 'zh-TW'||language == 'zh-CH'){
                                alert("請先確保於Safari設置中容許Cookies - 請到 [Safari] -> [偏好設定⋯] -> [隱私權] -> 在「Cookie 和網站資料」選擇 [總是允許], 然後按以下[關閉]繼續。");   
                            }else{
                                alert("Please make sure to always allow cookies in Safari settings by going to [Safari] -> [Preferences...] -> [Privacy] -> Select [Always Allow] option under “Cookies and website data”, then press [Close] below to proceed.");                      
                            }
                        }

                        // Rancho_PI38_20210803
                        if(Cigna.Util.isCustomerPortal() && Cigna.Util.isIOS() && Cigna.Util.checkWebView() && '{!piURL}' !='' && '{!txn.Number_of_Adult__c}' == 1 && '{!txn.PH_is_PI__c}'=='false'){
                            alert("{!$Label.Allow_Cross_Website_Tracking}");
                        }

                        //Ray Update: End
                        $('div.desktopProgressBar').css('margin-top','50px'); //Ray's Update
                        var $frame = $('.wrap-iframe-third-party iframe').first();
                        $($frame).height(($(window).height() - $($frame).offset().top) * 0.95);
                    </script>
                </apex:outputPanel>

                <!-- add by minghua -->
                <!-- Rancho_PI38_20210803 -->
                <!-- <apex:outputPanel rendered="{!isIOSChrome}"> -->
                <apex:outputPanel rendered="{!isIOSChrome || (isCustomerPortal && isSafari && !isCustomerApp)}">
                    <script>
                        Cigna.ESales.autoShowAuw('{!piURL}');
                        Cigna.ESales.mobileChromeSetUWStatusPolling();
                    </script>
                </apex:outputPanel>
            </div>
        </apex:outputPanel>
        <!-- Rancho_BPE57_03_20210518 replace isSalesforce1 by isSalesforce1AUW -->
        <apex:outputPanel id="underwriting-section1" rendered="{!currentStep == STEP_UNDERWRITING_C1 && !isSalesforce1AUW && documentloadReady}" styleClass="bs row" layout="block">
            <div class="bs col-xs-12">
                <apex:outputPanel >
                    <div class="bs col-xs-12 cigna-fg-gray-dark cigna-form-section-header"><h4><center>{!txn.Child_1_First_Name__c} {!txn.Child_1_Last_Name__c}</center></h4></div>
                    <br/>
                </apex:outputPanel>
                <!-- change by minghua -->
                <!-- Rancho_PI38_20210803 all safari are pop-up windows -->
                <!-- <apex:outputPanel styleClass="wrap-iframe-third-party" rendered="{!!isIOSChrome}"> -->
                <apex:outputPanel styleClass="wrap-iframe-third-party" rendered="{!!isIOSChrome && !(isCustomerPortal && isSafari && !isCustomerApp)}">
                    <apex:iframe src="{!C1URL}" height="1024px" scrolling="true"/>
                    <script>
                        Cigna.ESales.setUWStatusPolling();

                        // Rancho_PI38_20210803 DMB may not contain Adult
                        if(Cigna.Util.isCustomerPortal() && Cigna.Util.isIOS() && Cigna.Util.checkWebView() && '{!C1URL}' !='' && '{!txn.Number_of_Adult__c}' == 0){
                            alert("{!$Label.Allow_Cross_Website_Tracking}");
                        }

                        $('div.desktopProgressBar').css('margin-top','50px'); //Ray's Update
                        var $frame = $('.wrap-iframe-third-party iframe').first();
                        $($frame).height(($(window).height() - $($frame).offset().top) * 0.95);
                    </script>
                    <!-- Add by Manuel to test the AUW iframe url 3 -->
                    <!-- <apex:iframe src="https://autouwqa.cigna.com.hk/cigna-asia/screens/view/full/case/72032/entity/72032_632268/page/YOUR_HEALTH_HISTORY/basequestions" height="1024px" scrolling="true" /> -->
                </apex:outputPanel>

                <!-- add by minghua -->
                <!-- Rancho_PI38_20210803 -->
                <!-- <apex:outputPanel rendered="{!isIOSChrome}"> -->
                <apex:outputPanel rendered="{!isIOSChrome || (isCustomerPortal && isSafari && !isCustomerApp)}">
                    <script>
                        Cigna.ESales.autoShowAuw('{!C1URL}');
                        Cigna.ESales.mobileChromeSetUWStatusPolling();
                    </script>
                </apex:outputPanel>
            </div>
        </apex:outputPanel>
        <!-- Rancho_BPE57_03_20210518 replace isSalesforce1 by isSalesforce1AUW -->
        <apex:outputPanel id="underwriting-section2" rendered="{!currentStep == STEP_UNDERWRITING_C2 && !isSalesforce1AUW && documentloadReady}" styleClass="bs row" layout="block">
            <div class="bs col-xs-12">
                <apex:outputPanel >
                    <div class="bs col-xs-12 cigna-fg-gray-dark cigna-form-section-header"><h4><center>{!txn.Child_2_First_Name__c} {!txn.Child_2_Last_Name__c}</center></h4></div>
                    <br/>
                </apex:outputPanel>
                <!-- change by minghua -->
                <!-- Rancho_PI38_20210803 all safari are pop-up windows -->
                <!-- <apex:outputPanel styleClass="wrap-iframe-third-party" rendered="{!!isIOSChrome}"> -->
                <apex:outputPanel styleClass="wrap-iframe-third-party" rendered="{!!isIOSChrome && !(isCustomerPortal && isSafari && !isCustomerApp)}">
                    <apex:iframe src="{!C2URL}" height="1024px" scrolling="true"/>
                    <script>
                        Cigna.ESales.setUWStatusPolling();
                        $('div.desktopProgressBar').css('margin-top','50px'); //Ray's Update
                        var $frame = $('.wrap-iframe-third-party iframe').first();
                        $($frame).height(($(window).height() - $($frame).offset().top) * 0.95);
                    </script>
                        <!--apex:iframe src="{!C2URL}" height="1024px" scrolling="true" /-->
                        <!-- Add by Manuel to test the AUW iframe url 4 -->
                        <!-- <apex:iframe src="https://autouwqa.cigna.com.hk/cigna-asia/screens/view/full/case/72032/entity/72032_632268/page/YOUR_HEALTH_HISTORY/basequestions" height="1024px" scrolling="true" /> -->
                </apex:outputPanel>

                <!-- add by minghua -->
                <!-- Rancho_PI38_20210803 -->
                <!-- <apex:outputPanel rendered="{!isIOSChrome}"> -->
                <apex:outputPanel rendered="{!isIOSChrome || (isCustomerPortal && isSafari && !isCustomerApp)}">
                    <script>
                        Cigna.ESales.autoShowAuw('{!C2URL}');
                        Cigna.ESales.mobileChromeSetUWStatusPolling();
                    </script>
                </apex:outputPanel>
            </div>
        </apex:outputPanel>
        <!-- Rancho_BPE57_03_20210518 replace isSalesforce1 by isSalesforce1AUW -->
        <apex:outputPanel id="underwriting-section3" rendered="{!currentStep == STEP_UNDERWRITING_C3 && !isSalesforce1AUW && documentloadReady}" styleClass="bs row" layout="block">
            <div class="bs col-xs-12">
                <apex:outputPanel >
                    <div class="bs col-xs-12 cigna-fg-gray-dark cigna-form-section-header"><h4><center>{!txn.Child_3_First_Name__c} {!txn.Child_3_Last_Name__c}</center></h4></div>
                    <br/>
                </apex:outputPanel>
                <!-- change by minghua -->
                <!-- Rancho_PI38_20210803 all safari are pop-up windows -->
                <!-- <apex:outputPanel styleClass="wrap-iframe-third-party" rendered="{!!isIOSChrome}"> -->
                <apex:outputPanel styleClass="wrap-iframe-third-party" rendered="{!!isIOSChrome && !(isCustomerPortal && isSafari && !isCustomerApp)}">
                    <apex:iframe src="{!C3URL}" height="1024px" scrolling="true"/>
                        <!--apex:iframe src="{!C3URL}" height="1024px" scrolling="true" /-->
                        <!-- Add by Manuel to test the AUW iframe url 5 -->
                        <!-- <apex:iframe src="https://autouwqa.cigna.com.hk/cigna-asia/screens/view/full/case/72032/entity/72032_632268/page/YOUR_HEALTH_HISTORY/basequestions" height="1024px" scrolling="true" /> -->
                    <script>
                        Cigna.ESales.setUWStatusPolling();
                        $('div.desktopProgressBar').css('margin-top','50px'); //Ray's Update
                        var $frame = $('.wrap-iframe-third-party iframe').first();
                        $($frame).height(($(window).height() - $($frame).offset().top) * 0.95);
                    </script>
                </apex:outputPanel>

                <!-- add by minghua -->
                <!-- Rancho_PI38_20210803 -->
                <!-- <apex:outputPanel rendered="{!isIOSChrome}"> -->
                <apex:outputPanel rendered="{!isIOSChrome || (isCustomerPortal && isSafari && !isCustomerApp)}">
                    <script>
                        Cigna.ESales.autoShowAuw('{!C3URL}');
                        Cigna.ESales.mobileChromeSetUWStatusPolling();
                    </script>
                </apex:outputPanel>
            </div>
        </apex:outputPanel>
        
        <!--for mobile version AUW -->
        <apex:inputHidden id="esales-isCompleteAUW" value="{!isCompleteAUW}" />
        <!-- Rancho_BPE57_03_20210518 replace isSalesforce1 by isSalesforce1AUW --> 
        <apex:outputPanel id="underwriting-section11" rendered="{!currentStep == STEP_UNDERWRITING && isSalesforce1AUW && isCompleteAUW != 'true'}" styleClass="bs row" layout="block">
            <!-- <script>Cigna.ESales.hideLoadingIcon('loader-icon');</script> -->
            <div class="bs col-xs-12 show-in-center">
                <apex:outputPanel >
                    <br/>
                    <br/>
                    <div class="bs col-xs-12" style="margin-top:50px"><br/><br/><h4><center>{!$Label.eSales_Generating_underwriting_questions_for} {!txn.Policy_Holder_First_Name__c} {!txn.Policy_Holder_Last_Name__c}{!$Label.eSales_Generating_underwriting_questions_for_2}
                    </center></h4></div>
                    <br/>
                </apex:outputPanel>
                <input type="hidden" id="auw-url" value="{!auwURL}" />
            </div>
            <!-- add by minghua -->
            <apex:outputPanel rendered="{!isIOSChrome}">
                <script>
                    Cigna.ESales.autoShowAuw('{!phURL}');
                    Cigna.ESales.mobileChromeSetUWStatusPolling();
                </script>
            </apex:outputPanel>
            <apex:outputPanel rendered="{!!isIOSChrome}">
                <script>Cigna.ESales.autoShowAuw('{!phURL}');</script>
                <script>
                    Cigna.ESales.mobileSetUWStatusPolling();
                    $('div.header-bar').hide();
                    if (Cigna.Util.isSalesforce1() && Cigna.Util.isIOS()) {
                        var $frame = $('.wrap-iframe-third-party iframe').first();
                        $($frame).height((window.screen.height - 44 - 20 - 64) * 0.95 + 'px');
                    } else {
                        var $frame = $('.wrap-iframe-third-party iframe').first();
                        $($frame).height(($(window).height() - $($frame).offset().top) * 0.95);
                    }
                </script>
            </apex:outputPanel>
        </apex:outputPanel>
        <!-- Rancho_BPE57_03_20210518 replace isSalesforce1 by isSalesforce1AUW -->
        <apex:outputPanel id="underwriting-sectionPI2" rendered="{!currentStep == STEP_UNDERWRITING_PI && isSalesforce1AUW && isCompleteAUW != 'true'}" styleClass="bs row" layout="block">
            <!-- <script>Cigna.ESales.hideLoadingIcon('loader-icon');</script> -->
            <div class="bs col-xs-12 show-in-center">
                <apex:outputPanel >
                    <br/>
                    <br/>
                    <div class="bs col-xs-12" style="margin-top:50px"><br/><br/><h4><center>{!$Label.eSales_Generating_underwriting_questions_for} {!txn.PI_First_Name__c} {!txn.PI_Last_Name__c} {!$Label.eSales_Generating_underwriting_questions_for_2}
                    </center></h4></div>
                    <br/>
                </apex:outputPanel>
                <input type="hidden" id="auw-url" value="{!auwURL}" />

            </div>
            <!-- add by minghua -->
            <apex:outputPanel rendered="{!isIOSChrome}">
                <script>
                    Cigna.ESales.autoShowAuw('{!piURL}');
                    Cigna.ESales.mobileChromeSetUWStatusPolling();
                </script>
            </apex:outputPanel>
            <apex:outputPanel rendered="{!!isIOSChrome}">
                <script>Cigna.ESales.autoShowAuw('{!piURL}');</script>        
                <script>
                    Cigna.ESales.mobileSetUWStatusPolling();
                    var $frame = $('.wrap-iframe-third-party iframe').first();
                    $($frame).height(($(window).height() - $($frame).offset().top) * 0.95);
                </script>
            </apex:outputPanel>
        </apex:outputPanel>
        <!-- Rancho_BPE57_03_20210518 replace isSalesforce1 by isSalesforce1AUW -->
        <apex:outputPanel id="underwriting-section12" rendered="{!currentStep == STEP_UNDERWRITING_C1 && isSalesforce1AUW && isCompleteAUW != 'true'}" styleClass="bs row" layout="block">
            <!-- <script>Cigna.ESales.hideLoadingIcon('loader-icon');</script> -->
            <div class="bs col-xs-12 show-in-center">
                <apex:outputPanel >
                    <br/>
                    <br/>
                    <div class="bs col-xs-12" style="margin-top:50px"><br/><br/><h4><center>{!$Label.eSales_Generating_underwriting_questions_for} {!txn.Child_1_First_Name__c} {!txn.Child_1_Last_Name__c} {!$Label.eSales_Generating_underwriting_questions_for_2}
                    </center></h4></div>
                    <br/>
                </apex:outputPanel>
                <input type="hidden" id="auw-url" value="{!auwURL}" />
            </div>
            <!-- add by minghua -->
            <apex:outputPanel rendered="{!isIOSChrome}">
                <script>
                    Cigna.ESales.autoShowAuw('{!C1URL}');
                    Cigna.ESales.mobileChromeSetUWStatusPolling();
                </script>
            </apex:outputPanel>
            <apex:outputPanel rendered="{!!isIOSChrome}">
                <script>Cigna.ESales.autoShowAuw('{!C1URL}');</script>        
                <script>
                    Cigna.ESales.mobileSetUWStatusPolling();
                    var $frame = $('.wrap-iframe-third-party iframe').first();
                    $($frame).height(($(window).height() - $($frame).offset().top) * 0.95);
                </script>
            </apex:outputPanel>
        </apex:outputPanel>
        <!-- Rancho_BPE57_03_20210518 replace isSalesforce1 by isSalesforce1AUW -->
        <apex:outputPanel id="underwriting-section13" rendered="{!currentStep == STEP_UNDERWRITING_C2 && isSalesforce1AUW && isCompleteAUW != 'true'}" styleClass="bs row" layout="block">
            <!-- <script>Cigna.ESales.hideLoadingIcon('loader-icon');</script> -->
            <div class="bs col-xs-12 show-in-center">
                <apex:outputPanel >
                    <br/>
                    <br/>
                    <div class="bs col-xs-12" style="margin-top:50px"><br/><br/><h4><center>{!$Label.eSales_Generating_underwriting_questions_for} {!txn.Child_2_First_Name__c} {!txn.Child_2_Last_Name__c}{!$Label.eSales_Generating_underwriting_questions_for_2}
                    </center></h4></div>
                    <br/>
                </apex:outputPanel>
                <input type="hidden" id="auw-url" value="{!auwURL}" />
            </div>
            <!-- add by minghua -->
            <apex:outputPanel rendered="{!isIOSChrome}">
                <script>
                    Cigna.ESales.autoShowAuw('{!C2URL}');
                    Cigna.ESales.mobileChromeSetUWStatusPolling();
                </script>
            </apex:outputPanel>
            <apex:outputPanel rendered="{!!isIOSChrome}">
                <script>Cigna.ESales.autoShowAuw('{!C2URL}');</script> 
                <script>
                    Cigna.ESales.mobileSetUWStatusPolling();
                    
                    var $frame = $('.wrap-iframe-third-party iframe').first();
                    $($frame).height(($(window).height() - $($frame).offset().top) * 0.95);
                </script>
            </apex:outputPanel>
        </apex:outputPanel>
        <!-- Rancho_BPE57_03_20210518 replace isSalesforce1 by isSalesforce1AUW -->
        <apex:outputPanel id="underwriting-section14" rendered="{!currentStep == STEP_UNDERWRITING_C3 && isSalesforce1AUW && isCompleteAUW != 'true'}" styleClass="bs row" layout="block">
            <!-- <script>Cigna.ESales.hideLoadingIcon('loader-icon');</script> -->
            <div class="bs col-xs-12 show-in-center">
                <apex:outputPanel >
                    <br/>
                    <br/>
                    <div class="bs col-xs-12" style="margin-top:50px"><br/><br/><h4><center>{!$Label.eSales_Generating_underwriting_questions_for} {!txn.Child_3_First_Name__c} {!txn.Child_3_Last_Name__c} {!$Label.eSales_Generating_underwriting_questions_for_2}
                    </center></h4></div>
                    <br/>
                </apex:outputPanel>
                <input type="hidden" id="auw-url" value="{!auwURL}" />

            </div>
            <!-- add by minghua -->
            <apex:outputPanel rendered="{!isIOSChrome}">
                <script>
                    Cigna.ESales.autoShowAuw('{!C3URL}');
                    Cigna.ESales.mobileChromeSetUWStatusPolling();
                </script>
            </apex:outputPanel>
            <apex:outputPanel rendered="{!!isIOSChrome}">
                <script>Cigna.ESales.autoShowAuw('{!C3URL}');</script>
                <script>
                    Cigna.ESales.mobileSetUWStatusPolling();
                    var $frame = $('.wrap-iframe-third-party iframe').first();
                    $($frame).height(($(window).height() - $($frame).offset().top) * 0.95);
                </script>
            </apex:outputPanel>
        </apex:outputPanel>
        
        <!-- for loading image after auw complete -->
        <apex:outputPanel id="underwriting-section15" rendered="{!isCompleteAUW == 'true' && isSalesforce1 && (currentStep == STEP_UNDERWRITING || currentStep == STEP_UNDERWRITING_PI || currentStep == STEP_UNDERWRITING_C1 ||currentStep == STEP_UNDERWRITING_C2 ||currentStep == STEP_UNDERWRITING_C3)}" styleClass="bs row" layout="block">
            <div class="bs col-xs-12 show-in-center">
                <apex:outputPanel >
                    <!--
                    <div class="aps-loading-div">
                        
                            <div class="bs col-xs-12 col-lg-12 loading-sp" style="padding: 0px;">
                                <span class="loading-helper"></span>
                                <i class="spinner-icon fa fa-spinner fa-pulse fa-3x fa-fw"></i>
                                <span class="sr-only">Loading...</span>
                            </div>
                        
                    </div>
                    -->
                </apex:outputPanel>
            </div>

            <script>
                Cigna.ESales.mobileSetUWStatusPolling();
                
                var $frame = $('.wrap-iframe-third-party iframe').first();
                $($frame).height(($(window).height() - $($frame).offset().top) * 0.95);
            </script>
        </apex:outputPanel>
        <!-- end for mobile version AUW -->
        <!--
        <apex:outputPanel id="confirmation-section" rendered="{!currentStep == STEP_CONFIRMATION}" styleClass="bs row" layout="block">
            <script>
                Cigna.ESales.clearUWStatusPolling();
                $('div.header-bar').show();
                window.scrollTo(0, 0);
            </script>
            <apex:inputHidden id="remove-child-id" value="{!removeChildId}" />
            <apex:inputHidden id="remove-rider-code" value="{!removeRiderCode}" />
            <apex:include pageName="EsalesConfirmationFormVFP"/>

        </apex:outputPanel>
        -->
        <apex:outputPanel id="show-uploadDoc-section" rendered="{!currentStep == STEP_UPLOADDOC}" styleClass="bs row" layout="block">

            <div class="snd-loading-div">
                <span id="snd-loading-phurl" style="display: none;">
                    <div class="bs col-xs-12 col-lg-12 loading-div">
                        <span class="loading-helper"></span>
                        <i class="spinner-icon fa fa-spinner fa-pulse fa-3x fa-fw"></i>
                        <span class="sr-only">Loading...</span>
                    </div>
                </span>
            </div>

            <apex:outputPanel layout="block" rendered="{!needCPD}">
                <div id="CPDPanel" class="bs col-xs-12 form-horizontal">

                    <div class="bs" style="padding: 20px 0px;">
                        <h4 class="bs cigna-fg-blue-medium">{!$Label.eSales_CPD_Download}</h4>
                    </div>

                    <div class="bs form-group">
                        <div class="bs col-xs-12">
                            <p>{!$Label.eSales_CPD_Download_title}</p>
                        </div>

                        <div class="bs col-xs-12 onclick-pointer form-field"> 
                            <a id="real-download" href="{!CPDFormUrl}" target="_blank">
                                {!$Label.eSales_CPD_Download_form}
                                <i class="ci-hk-inbox content-icon" aria-hidden="true"></i>
                            </a>
                        </div>

                    </div>

                    <div class="bs col-xs-12"><hr/></div>
                </div>
            </apex:outputPanel>

            <div class="bs col-xs-12 form-horizontal">
                <div class="bs" style="padding: 20px 0px;">
                    <h4 class="bs cigna-fg-blue-medium">{!$Label.eSales_upload_attachments}</h4>
                </div>

                <div id="errFileSize" class="alert alert-danger" role="alert" style="display:none;">
                    <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                    {!$Label.File_size_exceeds_10M}
                </div>
                <div id="errFileType" class="alert alert-danger" role="alert" style="display:none;">
                    <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                    {!$Label.Please_upload_a_valid_file} (i.e. .docx/.doc/.pdf/.jpeg/.png/.tiff)
                </div>
                <div id="errNoFile" class="alert alert-danger" role="alert" style="display:none;">
                    <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                    {!$Label.ErrMasg_Upload_Att}
                </div>
                <div id="errUpdateAllFile" class="alert alert-danger" role="alert" style="display:none;">
                    <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                    {!$Label.eSales_uploadfile_required}
                </div>
                <div id="errUpdateCPDFile" class="alert alert-danger" role="alert" style="display:none;">
                    <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                    {!$Label.eSales_uploadfile_CPD_required}
                </div>

                <apex:outputPanel id="uploadatt">
                    <script>
                        //CR-56_Link_20220214
                        $('[data-toggle="tooltip"]').tooltip();
                    </script>
                    
                    <!--HKID Attachment-->
                    <div class="bs row content-choice">
                        <div class="col-xs-2 col-sm-1">
                            <input id="HKIDAttPH" type="file" class="fileInput cigna-validation" onchange="Cigna.ESales.uploadFile('{!paramESalesTxnId}','HKIDAttPH');" style="display:none;"/>
                            <label for="HKIDAttPH"><i class="ci-hk-outbox content-icon onclick-pointer" aria-hidden="true"/></label>
                        </div>
                        <div class="col-xs-8 col-sm-10">{!txn.Policy_Holder_Last_Name__c}&nbsp;{!txn.Policy_Holder_First_Name__c}'s {!$Label.eSales_id_copy}</div>
                        <div class="col-xs-2 col-sm-1"><i class="ci-hk-help helptext-icon pull-right" data-toggle="tooltip" title="{!$Label.Upload_Tooltip}" aria-hidden="true"></i></div>
                        <div class="col-xs-12 col-sm-12" style="padding-bottom:10px;"></div>
                        <div style="padding:20px;">
                            <apex:outputPanel id="hkidlist">
                                <apex:repeat value="{!IDAttList}" var="idAtt">
                                    <div att-type="HKIDAttPH" class="col-xs-12 col-sm-12 uploaded-filelist">
                                    {!idAtt.Name}
                                    <i class="ci-hk-x pull-right onclick-pointer" onclick="removeAttachment('{!idAtt}');" aria-hidden="true"></i></div>
                                    <div class="col-xs-12 col-sm-12" style="padding-bottom:5px;"></div>
                                </apex:repeat>
                            </apex:outputPanel>
                        </div>
                    </div>
                    <apex:outputPanel rendered="{!(txn.Number_of_Adult__c > 1 || (!txn.PH_is_PI__c && txn.Number_of_Adult__c > 0)) && txn.AUW_Result_PI__c != 'Decline'}">
                        <div class="bs row content-choice">
                            <div class="col-xs-2 col-sm-1">
                                <input id="HKIDAttPI" type="file" class="fileInput cigna-validation" onchange="Cigna.ESales.uploadFile('{!paramESalesTxnId}','HKIDAttPI');" style="display:none;"/>
                                <label for="HKIDAttPI"><i class="ci-hk-outbox content-icon onclick-pointer" aria-hidden="true"/></label>
                            </div>
                            <div class="col-xs-8 col-sm-10">{!txn.PI_Last_Name__c}&nbsp;{!txn.PI_First_Name__c}'s {!$Label.eSales_id_copy}</div>
                            <div class="col-xs-2 col-sm-1"><i class="ci-hk-help helptext-icon pull-right" data-toggle="tooltip" title="{!$Label.Upload_Tooltip}" aria-hidden="true"></i></div>
                            <div class="col-xs-12 col-sm-12" style="padding-bottom:10px;"></div>
                            <div style="padding:20px;">
                                <apex:outputPanel id="hkidPIlist">
                                    <apex:repeat value="{!IDAttPIList}" var="idAtt">
                                        <div att-type="HKIDAttPI" class="col-xs-12 col-sm-12 uploaded-filelist">
                                        {!idAtt.Name}
                                        <i class="ci-hk-x pull-right onclick-pointer" onclick="removeAttachment('{!idAtt}');" aria-hidden="true"></i></div>
                                        <div class="col-xs-12 col-sm-12" style="padding-bottom:5px;"></div>
                                    </apex:repeat>
                                </apex:outputPanel>
                            </div>
                        </div>
                    </apex:outputPanel>
                    <apex:outputPanel rendered="{!txn.Cover_Child_1__c}">
                        <div class="bs row content-choice">
                            <div class="col-xs-2 col-sm-1">
                                <input id="HKIDAttC1" type="file" class="fileInput cigna-validation" onchange="Cigna.ESales.uploadFile('{!paramESalesTxnId}','HKIDAttC1');" style="display:none;"/>
                                <label for="HKIDAttC1"><i class="ci-hk-outbox content-icon onclick-pointer" aria-hidden="true"/></label>
                            </div>
                            <div class="col-xs-8 col-sm-10">{!txn.Child_1_Last_Name__c}&nbsp;{!txn.Child_1_First_Name__c}'s {!$Label.eSales_id_copy}</div>
                            <div class="col-xs-2 col-sm-1"><i class="ci-hk-help helptext-icon pull-right" data-toggle="tooltip" title="{!$Label.Upload_Tooltip}" aria-hidden="true"></i></div>
                            <div class="col-xs-12 col-sm-12" style="padding-bottom:10px;"></div>
                            <div style="padding:20px;">
                                <apex:outputPanel id="hkidC1list">
                                    <apex:repeat value="{!IDAttC1List}" var="idAtt">
                                        <div att-type="HKIDAttC1" class="col-xs-12 col-sm-12 uploaded-filelist">
                                        {!idAtt.Name}
                                        <i class="ci-hk-x pull-right onclick-pointer" onclick="removeAttachment('{!idAtt}');" aria-hidden="true"></i></div>
                                        <div class="col-xs-12 col-sm-12" style="padding-bottom:5px;"></div>
                                    </apex:repeat>
                                </apex:outputPanel>
                            </div>
                        </div>
                    </apex:outputPanel>
                    <apex:outputPanel rendered="{!txn.Cover_Child_2__c}">
                        <div class="bs row content-choice">
                            <div class="col-xs-2 col-sm-1">
                                <input id="HKIDAttC2" type="file" class="fileInput cigna-validation" onchange="Cigna.ESales.uploadFile('{!paramESalesTxnId}','HKIDAttC2');" style="display:none;"/>
                                <label for="HKIDAttC2"><i class="ci-hk-outbox content-icon onclick-pointer" aria-hidden="true"/></label>
                            </div>
                            <div class="col-xs-8 col-sm-10">{!txn.Child_2_Last_Name__c}&nbsp;{!txn.Child_2_First_Name__c}'s {!$Label.eSales_id_copy}</div>
                            <div class="col-xs-2 col-sm-1"><i class="ci-hk-help helptext-icon pull-right" data-toggle="tooltip" title="{!$Label.Upload_Tooltip}" aria-hidden="true"></i></div>
                            <div class="col-xs-12 col-sm-12" style="padding-bottom:10px;"></div>
                            <div style="padding:20px;">
                                <apex:outputPanel id="hkidC2list">
                                    <apex:repeat value="{!IDAttC2List}" var="idAtt">
                                        <div att-type="HKIDAttC2" class="col-xs-12 col-sm-12 uploaded-filelist">
                                        {!idAtt.Name}
                                        <i class="ci-hk-x pull-right onclick-pointer" onclick="removeAttachment('{!idAtt}');" aria-hidden="true"></i></div>
                                        <div class="col-xs-12 col-sm-12" style="padding-bottom:5px;"></div>
                                    </apex:repeat>
                                </apex:outputPanel>
                            </div>
                        </div>
                    </apex:outputPanel>
                    <apex:outputPanel rendered="{!txn.Cover_Child_3__c}">
                        <div class="bs row content-choice">
                            <div class="col-xs-2 col-sm-1">
                                <input id="HKIDAttC3" type="file" class="fileInput cigna-validation" onchange="Cigna.ESales.uploadFile('{!paramESalesTxnId}','HKIDAttC3');" style="display:none;"/>
                                <label for="HKIDAttC3"><i class="ci-hk-outbox content-icon onclick-pointer" aria-hidden="true"/></label>
                            </div>
                            <div class="col-xs-8 col-sm-10">{!txn.Child_3_Last_Name__c}&nbsp;{!txn.Child_3_First_Name__c}'s {!$Label.eSales_id_copy}</div>
                            <div class="col-xs-2 col-sm-1"><i class="ci-hk-help helptext-icon pull-right" data-toggle="tooltip" title="{!$Label.Upload_Tooltip}" aria-hidden="true"></i></div>
                            <div class="col-xs-12 col-sm-12" style="padding-bottom:10px;"></div>
                            <div style="padding:20px;">
                                <apex:outputPanel id="hkidC3list">
                                    <apex:repeat value="{!IDAttC3List}" var="idAtt">
                                        <div att-type="HKIDAttC3" class="col-xs-12 col-sm-12 uploaded-filelist">
                                        {!idAtt.Name}
                                        <i class="ci-hk-x pull-right onclick-pointer" onclick="removeAttachment('{!idAtt}');" aria-hidden="true"></i></div>
                                        <div class="col-xs-12 col-sm-12" style="padding-bottom:5px;"></div>
                                    </apex:repeat>
                                </apex:outputPanel>
                            </div>
                        </div>
                    </apex:outputPanel>
                    <apex:outputPanel rendered="{!isThirdParty}">
                        <div class="bs row content-choice">
                            <div class="col-xs-2 col-sm-1">
                                <input id="HKIDAttTP" type="file" class="fileInput cigna-validation" onchange="Cigna.ESales.uploadFile('{!paramESalesTxnId}','HKIDAttTP');" style="display:none;"/>
                                <label for="HKIDAttTP"><i class="ci-hk-outbox content-icon onclick-pointer" aria-hidden="true"/></label>
                            </div>
                            <div class="col-xs-8 col-sm-10">{!txn.Third_Party_Payer_Full_Name__c}&nbsp;{!$Label.eSales_id_copy}</div>
                            <div class="col-xs-2 col-sm-1"><i class="ci-hk-help helptext-icon pull-right" data-toggle="tooltip" title="{!$Label.Upload_Tooltip}" aria-hidden="true"></i></div>
                            <div class="col-xs-12 col-sm-12" style="padding-bottom:10px;"></div>
                            <div style="padding:20px;">
                                <apex:outputPanel id="hkidTPlist">
                                    <apex:repeat value="{!IDAttTPList}" var="idAtt">
                                        <div att-type="HKIDAttTP" class="col-xs-12 col-sm-12 uploaded-filelist">
                                        {!idAtt.Name}
                                        <i class="ci-hk-x pull-right onclick-pointer" onclick="removeAttachment('{!idAtt}');" aria-hidden="true"></i></div>
                                        <div class="col-xs-12 col-sm-12" style="padding-bottom:5px;"></div>
                                    </apex:repeat>
                                </apex:outputPanel>
                            </div>
                        </div>
                    </apex:outputPanel>
                    <apex:outputPanel rendered="{!txn.Is_Permanent_HKID_Holder__c == 'No' && onlyHasLife}">
                        <div class="bs row content-choice">
                            <div class="col-xs-2 col-sm-1">
                                <input id="PassportAtt" type="file" class="fileInput cigna-validation" onchange="Cigna.ESales.uploadFile('{!paramESalesTxnId}','PassportAtt');" style="display:none;"/>
                                <label for="PassportAtt"><i class="ci-hk-outbox content-icon onclick-pointer" aria-hidden="true"/></label>
                            </div>
                            <div class="col-xs-8 col-sm-10">{!$Label.Esales_Policy_Holder_s_Passport_Copy}</div>
                            <div class="col-xs-2 col-sm-1"><i class="ci-hk-help helptext-icon pull-right" data-toggle="tooltip" title="{!$Label.Upload_Tooltip}" aria-hidden="true"></i></div>
                            <div class="col-xs-12 col-sm-12" style="padding-bottom:10px;"></div>
                            <div style="padding:20px;">
                                <apex:outputPanel id="PassportAttlist">
                                    <apex:repeat value="{!PassportAttList}" var="idAtt">
                                        <div att-type="PassportAtt" class="col-xs-12 col-sm-12 uploaded-filelist">
                                        {!idAtt.Name}
                                        <i class="ci-hk-x pull-right onclick-pointer" onclick="removeAttachment('{!idAtt}');" aria-hidden="true"></i></div>
                                        <div class="col-xs-12 col-sm-12" style="padding-bottom:5px;"></div>
                                    </apex:repeat>
                                </apex:outputPanel>
                            </div>
                        </div>
                    </apex:outputPanel>


                    <!--Address Attachment-->
                    <!--remove by thirdparty signature CR 
                    <apex:outputPanel layout="block" rendered="{!onlyHasLife}">
                        <div class="bs row content-choice">
                            <div class="col-xs-2 col-sm-1">
                                <input id="AddressAtt" type="file" class="fileInput" onchange="Cigna.ESales.uploadFile('{!paramESalesTxnId}','AddressAtt');" style="display:none;"/>
                                <label for="AddressAtt"><i class="ci-hk-outbox content-icon onclick-pointer" aria-hidden="true"/></label>
                            </div>
                            <div class="col-xs-8 col-sm-10">{!$Label.eSales_address_proof}</div>
                            <div class="col-xs-2 col-sm-1"><i class="ci-hk-help helptext-icon pull-right" data-toggle="tooltip" title="{!$Label.Upload_Tooltip}" aria-hidden="true"></i></div>
                            <div class="col-xs-12 col-sm-12" style="padding-bottom:10px;"></div>
                            <div style="padding:20px;">
                                <apex:outputPanel id="addresslist">
                                    <apex:repeat value="{!AddressAttList}" var="addressAtt">
                                        <div att-type="AddressAtt" class="col-xs-12 col-sm-12 uploaded-filelist">{!addressAtt.Name}<i class="ci-hk-x pull-right onclick-pointer" onclick="removeAttachment('{!addressAtt}');" aria-hidden="true"></i></div>
                                        <div class="col-xs-12 col-sm-12" style="padding-bottom:5px;"></div>
                                    </apex:repeat>
                                </apex:outputPanel>
                            </div>
                        </div>
                    </apex:outputPanel>
                    -->

                    <apex:outputPanel layout="block" rendered="{!needCPD}"> 
                        <!--Customer Protection Declaration-->
                        <div id="CPDUpload" class="bs row content-choice">
                            <div class="col-xs-2 col-sm-1">
                                <input id="CPDAtt" type="file" class="fileInput" onchange="Cigna.ESales.uploadFile('{!paramESalesTxnId}','CPDAtt');" style="display:none;"/>
                                <label for="CPDAtt"><i class="ci-hk-outbox content-icon onclick-pointer" aria-hidden="true"/></label>
                            </div>
                            <!-- 20200427 - minghua - PolicyReplacement -->
                            <div class="col-xs-8 col-sm-10">{!transField['Customer_Declaration'][$Label.Header_Language_Code_Current]}</div>
                            <div class="col-xs-2 col-sm-1"><i class="ci-hk-help helptext-icon pull-right" data-toggle="tooltip" title="{!$Label.Upload_Tooltip}" aria-hidden="true"></i></div>
                            <div class="col-xs-12 col-sm-12" style="padding-bottom:10px;"></div>
                            <div style="padding:20px;">
                                <apex:outputPanel id="CPDlist">
                                    
                                    <apex:repeat value="{!CPDAttList}" var="CPDAtt">
                                        <div att-type="CPDAtt" class="col-xs-12 col-sm-12 uploaded-filelist">{!CPDAtt.Name}<i class="ci-hk-x pull-right onclick-pointer" onclick="removeAttachment('{!CPDAtt}');" aria-hidden="true"></i></div>
                                        <div class="col-xs-12 col-sm-12" style="padding-bottom:5px;"></div>
                                    </apex:repeat>
                                    
                                </apex:outputPanel>
                            </div>
                        </div>
                    </apex:outputPanel> 
                </apex:outputPanel>

                <div class="bs">
                    <div class="bs cigna-answer-wrapper">  
                        <p>
                            <input type="checkbox" id="hkid-certified" name="hkid-certified" class="bs cigna-question-checkbox" />
                            <label style="margin-left: 0px;padding-left: 0px;" for="hkid-certified">{!$Label.eSales_certify_id}</label>
                            <apex:inputHidden value="{!hkidCertified}" 
                                    id="hkidCertified"
                                    html-class="cigna-validation"
                                    html-data-msg-required="{!$Label.eSales_certify_id_required}"/>
                        </p>
                    </div>
                </div>
            </div>

            <script>
                if($('input[type="hidden"][id$="hkidCertified"]').val() == 'true'){
                    $("#hkid-certified").prop("checked", true);
                }else{
                    $("#hkid-certified").prop("checked", false);
                }

               //CR-56_Link_20220214
               $('input.cigna-question-checkbox').on("change",Cigna.ESales.onCheckboxChange);
            </script>
        </apex:outputPanel>
        
        <apex:outputPanel id="payment-method-section" rendered="{!currentStep == STEP_PAYMENT_METHOD}" styleClass="bs row" layout="block">
             <!-- update render condition by David 08/11/2017 for ThirdPartyPayment CR -->
            <apex:outputPanel rendered="{! (txn.Basic_Plan_Code__c == 'DMB' && txn.AUW_Overall_Result__c != 'Accept') || (onlyHasLife && (txn.Is_Making_1st_Payment__c == 'No' || txn.Is_Paying_Subsequent_Payment__c == 'No'))}">
            <div class="bs col-xs-12 form-horizontal">
                <div class="bs form-group">
                    <div class="bs col-xs-12">
                        <p>{!$Label.eSales_do_you_provide_payment_information}</p>
                    </div>
                </div>
                <div class="bs col-xs-12 cigna-answer-wrapper">
                    <p>
                        <input type="radio" id="payment-info-question-yes" value="Yes" name="payment-info-question" class="bs cigna-question-radio" />
                        <label for="payment-info-question-yes">{!$Label.Yes}</label>
                    </p>           
                    <p>
                        <input type="radio" id="payment-info-question-no" value="No" name="payment-info-question" class="bs cigna-question-radio" />
                        <label for="payment-info-question-no">{!$Label.No}</label>
                    </p>
                    
                    <apex:inputHidden value="{!txn.Provide_Payment_Info__c}" id="paramProvidePaymentInfo"
                                      html-class="cigna-validation"
                                      html-data-msg-required="{!$Label.Error_Please_choose_a_payment_method}" />
                    <hr/>
                </div>
            </div>
            </apex:outputPanel>

            <!-- add a div by David 08/11/2017 for ThirdPartyPayment CR start -->
            <div id="payment-div">
                <div id="firstPaymentDiv" class="bs col-xs-12 form-horizontal" style="display:none">
                    <div class="bs form-group">
                        <apex:outputPanel rendered="{!showPremium}">
                            <div class="bs col-xs-12">
                                <!--<p>{!$Label.Choose_the_payment_method_for_the_1st_payment}({!IF(txn.Payment_Mode__c=='Annually', $Label.Annually, $Label.Monthly)} - {!$Label.HKD} {!txn.Amount__c}):</p>-->
                                <!-- Rancho_Levy_20201124 -->
                                <p>{!$Label.Choose_the_payment_method_for_the_1st_payment}
                                    <apex:outputPanel rendered="{!txn.Payment_Mode__c=='Annually'}">
                                        <sup>1</sup>
                                    </apex:outputPanel>{!IF(txn.Payment_Mode__c=='Annually', '(' + $Label.Annually + ' - ' + $Label.HKD, ': ' + $Label.HKD + ' ')} 
                                <!--Nicole_Levy II_20200630-->
                                <apex:outputText value="{0, Number,#,###.00}">
                                            <apex:param value="{!IF(txn.Payment_Mode__c=='Annually',txn.Quote_Amount_Annually__c+txn.Levy_Annually__c,(txn.Quote_Amount_Monthly__c+txn.Levy_Monthly__c)*2)}"/>
                                </apex:outputText>{!IF(txn.Payment_Mode__c=='Annually', ')', ' *:')}
                                </p>
                            </div>
                        </apex:outputPanel>
                        <apex:outputPanel rendered="{!!showPremium}">
                            <div class="bs col-xs-12">
                                <p>{!$Label.Choose_the_payment_method_for_the_1st_payment}</p>
                            </div>
                        </apex:outputPanel>

                    </div>
                    <div class="bs col-xs-12 cigna-answer-wrapper">
                        <p>
                            <input type="radio" id="payment-method-first-01" value="Credit Card" name="payment-method-first" class="bs cigna-question-radio" />
                            <label for="payment-method-first-01">{!$Label.Credit_Card}</label>
                        </p>
                        <p>
                            <input type="radio" id="payment-method-first-02" value="Cheque" name="payment-method-first" class="bs cigna-question-radio" />
                            <label for="payment-method-first-02">{!$Label.Cheque}</label>
                        </p>
                        <p id="cheque-number" style="display: none; background: #fff;">
                            <apex:inputText id="cheque-number" value="{!txn.Cheque_Number_1st_Paymet__c}" styleClass="bs form-control" 
                                            html-placeholder="{!$Label.eSales_Cheque_Number}"
                            />
                            <br/>
                            <!--<apex:outputText style="padding-left: 0px;font-size: 0.8em;padding-top: 50px;">{!$Label.eSales_Cheque_Message}</apex:outputText>-->
                            <apex:outputText style="padding-left: 0px;font-size: 0.8em;padding-top: 50px;" rendered="{!onlyHasLife}">{!$Label.eSales_Cheque_Message_Life}</apex:outputText>
                            <apex:outputText style="padding-left: 0px;font-size: 0.8em;padding-top: 50px;" rendered="{!!onlyHasLife}">{!$Label.eSales_Cheque_Message_GI}</apex:outputText>
                        </p>
                        <apex:inputHidden value="{!txn.Payment_Method_1st_Payment__c}" id="paramPaymentMethod"
                                          html-class="cigna-validation"
                                          html-data-msg-required="{!$Label.Error_Please_choose_a_payment_method}" />
                    </div>
                    <!-- Rancho_Levy_20201124 -->
                    <apex:outputText rendered="{!txn.Payment_Mode__c=='Monthly'}">                               
                        <div class="bs col-xs-12 form-group" style="padding-top:15px;">
                            <p>                                    
                                {!$Label.Monthly_Payment_Note_1}                                 
                            </p>
                        </div>
                    </apex:outputText>
                </div>
                <div id="subsequentPaymentDiv" class="bs col-xs-12 form-horizontal" style="display:none">
                    <div class="bs col-xs-12"><hr /></div>
                    <div class="bs form-group">
                        <apex:outputPanel rendered="{!showPremium}">
                            <div class="bs col-xs-12">
                                <!--<p>{!$Label.Choose_the_payment_method_for_the_subsequent_payment}({!IF(txn.Payment_Mode__c=='Annually', $Label.Annually, $Label.Monthly)} - {!$Label.HKD} {!txn.Amount__c}):</p>-->
                                <!-- Rancho_Levy_20201124 -->
                                <p>{!$Label.Choose_the_payment_method_for_the_subsequent_payment}
                                    <apex:outputPanel rendered="{!txn.Payment_Mode__c=='Annually'}">
                                        <sup>1</sup>
                                    </apex:outputPanel>{!IF(txn.Payment_Mode__c=='Annually', '(' + $Label.Annually + ' - '+ $Label.HKD, ': ' + $Label.Monthly + ' ' + $Label.HKD + ' ')} 
                                    <!--Nicole_Levy II_20200630-->
                                    <apex:outputText value="{0, Number,#,###.00}">
                                                <apex:param value="{!IF(txn.Payment_Mode__c=='Annually',txn.Quote_Amount_Annually__c+txn.Levy_Annually__c,txn.Quote_Amount_Monthly__c)}"/>
                                    </apex:outputText>{!IF(txn.Payment_Mode__c=='Annually', ')', ' ' + $Label.Plus_Levy + ':')}
                                    <apex:outputPanel rendered="{!txn.Payment_Mode__c=='Annually'}">
                                        <sup>2</sup>
                                    </apex:outputPanel>
                                </p>
                            </div>
                        </apex:outputPanel>
                        <apex:outputPanel rendered="{!!showPremium}">
                            <div class="bs col-xs-12">
                                <p>{!$Label.Choose_the_payment_method_for_the_subsequent_payment}</p>
                            </div>
                        </apex:outputPanel>

                    </div>
                    <div class="bs col-xs-12 cigna-answer-wrapper">
                        <p>
                            <input type="checkbox" id="payment-method-subseq-01" value="Credit Card" name="payment-method-subseq" class="bs cigna-question-checkbox" />
                            <label for="payment-method-subseq-01">{!$Label.Credit_Card}</label>
                        </p>
                        <p>
                            <input type="checkbox" id="payment-method-subseq-02" value="Savings" name="payment-method-subseq" class="bs cigna-question-checkbox" />
                            <label for="payment-method-subseq-02">{!$Label.Savings_Current_Account}</label>
                        </p>
                        <apex:inputHidden value="{!txn.Payment_Method_Subsequent_Payment__c}" id="paramPaymentMethodSubseq"
                                          html-class="cigna-validation"
                                          html-data-msg-required="{!$Label.Error_Please_choose_a_payment_method}" />
                    </div>
                    <!-- Rancho_Levy_20201124 -->
                    <apex:outputText rendered="{!txn.Payment_Mode__c=='Annually'}">                               
                        <div class="bs col-xs-12 form-group" style="padding-top:15px;">
                            <p>                                    
                                <sup>1</sup>{!$Label.Annual_Premium_Note_1}                                
                            </p>
                            <p>                                    
                                <sup>2</sup>{!$Label.Annual_Premium_Note_2}                                 
                            </p>
                        </div>
                    </apex:outputText>
                </div>
            </div>
            <!-- add a div by David 08/11/2017 for ThirdPartyPayment CR end -->
            <script>
                //CR-56_Link_20220214
                $('input.cigna-question-radio').on("change",Cigna.ESales.onRadioChange);
                $('input.cigna-question-checkbox').on("change",Cigna.ESales.onCheckboxChange);

                var provideinfo = $('input[type="hidden"][id$="paramProvidePaymentInfo"]').val();

                console.log('yes' + !{! (onlyHasLife && (txn.Is_Making_1st_Payment__c == 'No' || txn.Is_Paying_Subsequent_Payment__c == 'No'))});

                if((provideinfo == 'Yes' || '{!txn.Basic_Plan_Code__c}' != 'DMB' || '{!txn.AUW_Overall_Result__c}' == 'Accept') && ! {! (onlyHasLife && (txn.Is_Making_1st_Payment__c == 'No' || txn.Is_Paying_Subsequent_Payment__c == 'No'))}){
                    $('#firstPaymentDiv').show();
                    $('#subsequentPaymentDiv').show();
                }else{
                    $('#firstPaymentDiv').hide();
                    $('#subsequentPaymentDiv').hide();
                }

                if(provideinfo == 'Yes'){
                    $("#payment-info-question-yes").prop("checked", true);
                    $("#payment-info-question-no").prop("checked", false);
                }else if(provideinfo == 'No'){
                    $("#payment-info-question-yes").prop("checked", false);
                    $("#payment-info-question-no").prop("checked", true);
                }

                var firstMethod = $("input[id$='paramPaymentMethod']").val();
                if(firstMethod == 'Credit Card'){
                    $("#payment-method-first-01").prop("checked", true);
                    $("#payment-method-first-02").prop("checked", false);
                }else if(firstMethod == 'Cheque'){
                    $("#payment-method-first-01").prop("checked", false);
                    $("#payment-method-first-02").prop("checked", true);
                }

                if ($('#payment-method-first-02').is(':checked')) {
                    $('#cheque-number').show();
                } else {
                    $('#cheque-number').hide();
                }

                var subseqMethod = $("input[id$='paramPaymentMethodSubseq']").val();
                if(subseqMethod == 'Credit Card'){
                    $("#payment-method-subseq-01").prop("checked", true);
                    $("#payment-method-subseq-02").prop("checked", false);
                }else if(subseqMethod == 'Savings'){
                    $("#payment-method-subseq-01").prop("checked", false);
                    $("#payment-method-subseq-02").prop("checked", true);
                }
                

            </script>
        </apex:outputPanel>
        
        <apex:outputPanel id="payment-dda-section" rendered="{!currentStep == STEP_PAYMENT_DDA}" styleClass="bs row" layout="block">

            <div class="bs col-xs-12 cigna-fg-gray-dark cigna-form-section-header"><h4>{!$Label.Direct_Debit_Authorization}</h4></div>
            <br/>
            
                <apex:outputPanel rendered="{!txn.Payment_Method_1st_Payment__c == 'Credit Card' && (txn.AUW_Overall_Result__c == 'Referred' || onlyHasLife) && isBrokerPortal}">

                <div class="bs col-xs-12 cigna-fg-gray-dark cigna-form-section-header">
                    <h5>{!$Label.eSales_First_Payment}</h5>
                </div>
                <br/>

                <div class="bs col-xs-12 form-horizontal">
                    <apex:outputPanel layout="block" styleClass="bs form-group" >
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.First_Pay_Credit_Card_Holder_Full_Name__c.Label}" for="DDA-Credit-Card-Holder1"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:inputText id="DDA-Credit-Card-Holder1" value="{!txn.First_Pay_Credit_Card_Holder_Full_Name__c}" styleClass="bs form-control" />
                        </div>
                    </apex:outputPanel>
                    <apex:outputPanel layout="block" styleClass="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.First_Pay_Name_of_Card_Issuing_Bank__c.Label}" for="DDA-Card-Issuing-Bank1"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:inputText id="DDA-Card-Issuing-Bank1" value="{!txn.First_Pay_Name_of_Card_Issuing_Bank__c}" styleClass="bs form-control" />
                        </div>
                    </apex:outputPanel>
                    <apex:outputPanel layout="block" styleClass="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$Label.Credit_Card_Number_VISA_MasterCard}" for="DDA-Credit-Card-Number1"/>
                        </div>
                       <script>
                          function getNextInputField(resour,index){
                                resour.parentNode.children[index].focus();
                          }

                       </script>

                        <div class="bs col-sm-9">
                            <apex:input type="tel" value="{!paramCardNum1}" 
                                                   html-maxlength="4" 
                                                   styleClass="bs form-control text-center credit-card-box1"
                                                   size="6"
                                                   style="display: inline; width: auto;padding:3px;"
                                                   id="paramCreditCardNum1"
                                                   onblur="Cigna.ESales.getCreditCardNo1();getNextInputField(this,2);"
                            />
                            <span>-&nbsp;</span>
                            <apex:input type="tel" value="{!paramCardNum2}" 
                                                   html-maxlength="4" 
                                                   styleClass="bs form-control text-center credit-card-box1"
                                                   size="6"
                                                   style="display: inline; width: auto;padding:3px;"
                                                   id="paramCreditCardNum2"
                                                   onblur="Cigna.ESales.getCreditCardNo1();getNextInputField(this,4);"
                            />
                            <span>-&nbsp;</span>
                            <apex:input type="tel" value="{!paramCardNum3}" 
                                                   html-maxlength="4" 
                                                   styleClass="bs form-control text-center credit-card-box1"
                                                   size="6"
                                                   style="display: inline; width: auto;padding:3px;"
                                                   id="paramCreditCardNum3"
                                                   onblur="Cigna.ESales.getCreditCardNo1();getNextInputField(this,6);"
                            />
                            <span>-&nbsp;</span>
                            <apex:input type="tel" value="{!paramCardNum4}" 
                                                   html-maxlength="4" 
                                                   styleClass="bs form-control text-center credit-card-box1"
                                                   size="6"
                                                   style="display: inline; width: auto;padding:3px;"
                                                   id="paramCreditCardNum4"
                                                   onblur="Cigna.ESales.getCreditCardNo1();"
                            />
                            
                        </div>
                         <script>
                           function hiddenonblur(element){
                                //CR-56_Link_20220214
                                $(element).trigger("blur");
                            }
                         </script>

                        <div class="bs col-sm-offset-3 col-sm-9 col-xs-12">
                            <apex:inputText id="Credit-Card-Number1" 
                                            style="height:1px; width:1px; border:0px !important; color:#fff ; -webkit-appearance: none" 
                                            onfocus="hiddenonblur(this)" tabindex="-1"/>
                        </div>
                        
                        <script>
                            //CR-56_Link_20220214
                            $('input.credit-card-box1').on("keyup",function(evt) {
                                if (this.value.length == this.maxLength && evt.keyCode >= 48 && evt.keyCode <= 57) {
                                    var $next = $(this).nextAll('.credit-card-box1');
                                    if ($next.length > 0){
                                        $(this).nextAll('.credit-card-box1')[0].focus();
                                    } else {
                                        $(this).trigger("blur");
                                    }
                                } else if (this.value.length == 0 && evt.keyCode == 8) {
                                    // Backspace
                                    var $prev = $(this).prevAll('.credit-card-box1');
                                    if ($prev.length > 0){
                                        $(this).prevAll('.credit-card-box1')[0].focus();
                                    } else {
                                        $(this).trigger("blur");
                                    }
                                }
                            });
                            
                        </script>
                    </apex:outputPanel>
                    <apex:outputPanel layout="block" styleClass="bs form-group">
                        <div class="bs col-sm-3">
                            <apex:outputLabel value="{!$Label.Credit_Card_Expiry_Date_MM_YYYY}" for="DDA-Credit-Card-Expiry"/>
                        </div>
                        <div class="bs col-sm-9">
                            <apex:inputText id="card-expiry-month1" value="{!txn.First_Pay_Credit_Card_Expiry_Date_Month__c}" 
                                                 maxlength="2" 
                                                 html-placeholder="{!$Label.MM}"
                                                 size="4"
                                                 styleClass="bs form-control text-center credit-card-expiry"
                                                 style="display: inline; width: auto;"
                            />
                            <span>&nbsp;/&nbsp;</span>
                            <apex:inputText id="card-expiry-year1" value="{!txn.First_Pay_Credit_Card_Expiry_Date_Year__c}" 
                                             maxlength="4" 
                                             html-placeholder="{!$Label.YYYY}" 
                                             styleClass="bs form-control text-center credit-card-expiry"
                                             size="6"
                                             style="display: inline; width: auto;"
                            />
                        </div>
                        <div class="bs col-sm-offset-3 col-sm-9 col-xs-12">
                            <apex:inputText id="Credit-Card-Expiry-Date1" 
                                            style="height:1px; width:1px; border:0px !important; color:#fff ; -webkit-appearance: none" 
                                            onfocus="hiddenonblur(this)" tabindex="-1"/>
                        </div>

                        <script>
                            //CR-56_Link_20220214
                            $('input.credit-card-expiry').on("keyup",function(evt) {
                                if (this.value.length == this.maxLength && evt.keyCode >= 48 && evt.keyCode <= 57) {
                                    var $next = $(this).nextAll('.credit-card-expiry');
                                    if ($next.length > 0){
                                        $(this).nextAll('.credit-card-expiry')[0].focus();
                                    } else {
                                        $(this).trigger("blur");
                                    }
                                } else if (this.value.length == 0 && evt.keyCode == 8) {
                                    // Backspace
                                    var $prev = $(this).prevAll('.credit-card-expiry');
                                    if ($prev.length > 0){
                                        $(this).prevAll('.credit-card-expiry')[0].focus();
                                    } else {
                                        $(this).trigger("blur");
                                    }
                                }
                            });
                        </script>
                    </apex:outputPanel>
                </div>
                </apex:outputPanel>
                
                <apex:outputPanel rendered="{!txn.Payment_Method_1st_Payment__c == 'Credit Card' && (txn.AUW_Overall_Result__c == 'Referred' || onlyHasLife) && isBrokerPortal && txn.Payment_Method_Subsequent_Payment__c != null}">
                    <div class="bs col-xs-12 cigna-fg-gray-dark cigna-form-section-header">
                            <h5>{!$Label.eSales_Subsequent_Payment}</h5>
                    </div>
                    <apex:outputPanel rendered="{!txn.Payment_Method_Subsequent_Payment__c == 'Credit Card'}">
                        <div class="bs col-xs-12 cigna-answer-wrapper">
                            <p>
                                <input type="checkbox" id="getCopy" name="getCopy" class="bs cigna-question-checkbox" />
                                <label for="getCopy">{!$Label.eSales_Auto_copy_from_First_Payment}</label>
                            </p>
                        </div>
                        <script>
                            //CR-56_Link_20220214
                            $('input#getCopy').on("change",Cigna.ESales.onselectToCopy);
                        </script>
                    </apex:outputPanel>
                </apex:outputPanel>

                <br/>

                <div class="bs col-xs-12 form-horizontal">
                <apex:outputPanel rendered="{!txn.Payment_Method_Subsequent_Payment__c == 'Credit Card'}" layout="block" styleClass="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Credit_Card_Holder_Full_Name__c.Label}" for="DDA-Credit-Card-Holder"/>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:inputText id="DDA-Credit-Card-Holder" value="{!txn.Credit_Card_Holder_Full_Name__c}" styleClass="bs form-control" />
                    </div>
                    
                </apex:outputPanel>

                <apex:outputPanel rendered="{!txn.Payment_Method_Subsequent_Payment__c == 'Credit Card'}" layout="block" styleClass="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Name_of_Card_Issuing_Bank__c.Label}" for="DDA-Card-Issuing-Bank"/>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:inputText id="DDA-Card-Issuing-Bank" value="{!txn.Name_of_Card_Issuing_Bank__c}" styleClass="bs form-control" />
                    </div>
                </apex:outputPanel>
                <apex:outputPanel rendered="{!txn.Payment_Method_Subsequent_Payment__c == 'Credit Card'}" layout="block" styleClass="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$Label.Credit_Card_Number_VISA_MasterCard}" for="DDA-Credit-Card-Number"/>
                    </div>
                        <script>
                          function getNextInputField(resour,index){
                                resour.parentNode.children[index].focus();
                          }
                        </script>
                    <div class="bs col-sm-9">
                        <apex:input type="tel" value="{!paramCreditCardNum1}" 
                                               html-maxlength="4" 
                                               styleClass="bs form-control text-center credit-card-box"
                                               size="6"
                                               style="display: inline; width: auto;padding: 3px;"
                                               id="creditCardNum1"
                                               onblur="Cigna.ESales.getCreditCardNo();getNextInputField(this,2);"
                        />
                        <span>-&nbsp;</span>
                        <apex:input type="tel" value="{!paramCreditCardNum2}" 
                                               html-maxlength="4" 
                                               styleClass="bs form-control text-center credit-card-box"
                                               size="6"
                                               style="display: inline; width: auto;padding: 3px;"
                                               id="creditCardNum2"
                                               onblur="Cigna.ESales.getCreditCardNo();getNextInputField(this,4);"
                        />
                        <span>-&nbsp;</span>
                        <apex:input type="tel" value="{!paramCreditCardNum3}" 
                                               html-maxlength="4" 
                                               styleClass="bs form-control text-center credit-card-box"
                                               size="6"
                                               style="display: inline; width: auto;padding: 3px;"
                                               id="creditCardNum3"
                                               onblur="Cigna.ESales.getCreditCardNo();getNextInputField(this,6);"
                        />
                        <span>-&nbsp;</span>
                        <apex:input type="tel" value="{!paramCreditCardNum4}" 
                                               html-maxlength="4" 
                                               styleClass="bs form-control text-center credit-card-box"
                                               size="6"
                                               style="display: inline; width: auto;padding: 3px;"
                                               id="creditCardNum4"
                                               onblur="Cigna.ESales.getCreditCardNo()"
                        />
                       
                    </div>
                     <script>
               function hiddenonblur(element){
                   //CR-56_Link_20220214
                    $(element).trigger("blur");
                }
             </script>
                    <div class="bs col-sm-offset-3 col-sm-9 col-xs-12">
                        <apex:inputText id="Credit-Card-Number" 
                                        style="height:1px; width:1px; border:0px !important; color:#fff ; -webkit-appearance: none" 
                                        onfocus="hiddenonblur(this)" tabindex="-1"/>
                    </div>
                    
                    <script>
                        //CR-56_Link_20220214
                        $('input.credit-card-box').on("keyup",function(evt) {
                            if (this.value.length == this.maxLength && evt.keyCode >= 48 && evt.keyCode <= 57) {
                                var $next = $(this).nextAll('.credit-card-box');
                                if ($next.length > 0){
                                    $(this).nextAll('.credit-card-box')[0].focus();
                                } else {
                                    //CR-56_Link_20220214
                                    $(this).trigger("blur");
                                }
                            } else if (this.value.length == 0 && evt.keyCode == 8) {
                                // Backspace
                                var $prev = $(this).prevAll('.credit-card-box');
                                if ($prev.length > 0){
                                    $(this).prevAll('.credit-card-box')[0].focus();
                                } else {
                                    //CR-56_Link_20220214
                                    $(this).trigger("blur");
                                }
                            }
                        });
                        
                        //$('input.credit-card-box').change(Cigna.ESales.getCreditCardNo);

                    </script>
                </apex:outputPanel>
                <apex:outputPanel rendered="{!txn.Payment_Method_Subsequent_Payment__c == 'Credit Card'}" layout="block" styleClass="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$Label.Credit_Card_Expiry_Date_MM_YYYY}" for="DDA-Credit-Card-Expiry"/>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:inputText id="card-expiry-month" value="{!txn.Credit_Card_Expiry_Date_Month__c}" 
                                             maxlength="2" 
                                             html-placeholder="{!$Label.MM}"
                                             size="4"
                                             styleClass="bs form-control text-center credit-card-expiry"
                                             style="display: inline; width: auto;"
                        />
                        <span>&nbsp;/&nbsp;</span>
                        <apex:inputText id="card-expiry-year" value="{!txn.Credit_Card_Expiry_Date_Year__c}" 
                                         maxlength="4" 
                                         html-placeholder="{!$Label.YYYY}" 
                                         styleClass="bs form-control text-center credit-card-expiry"
                                         size="6"
                                         style="display: inline; width: auto;"
                        />
                    </div>
                    <div class="bs col-sm-offset-3 col-sm-9 col-xs-12">
                        <apex:inputText id="Credit-Card-Expiry-Date" 
                                        style="height:1px; width:1px; border:0px !important; color:#fff ; -webkit-appearance: none" 
                                        onfocus="hiddenonblur(this)" tabindex="-1"/>
                    </div>

                    <script>
                        //CR-56_Link_20220214
                        $('input.credit-card-expiry').on("keyup",function(evt) {
                            if (this.value.length == this.maxLength && evt.keyCode >= 48 && evt.keyCode <= 57) {
                                var $next = $(this).nextAll('.credit-card-expiry');
                                if ($next.length > 0){
                                    $(this).nextAll('.credit-card-expiry')[0].focus();
                                } else {
                                    $(this).trigger("blur");
                                }
                            } else if (this.value.length == 0 && evt.keyCode == 8) {
                                // Backspace
                                var $prev = $(this).prevAll('.credit-card-expiry');
                                if ($prev.length > 0){
                                    $(this).prevAll('.credit-card-expiry')[0].focus();
                                } else {
                                    $(this).trigger("blur");
                                }
                            }
                        });
                    </script>
                </apex:outputPanel>


                <apex:outputPanel id="firstHolder" rendered="{!txn.Payment_Method_Subsequent_Payment__c == 'Savings'}" layout="block" styleClass="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Name_of_Account_Holder_in_English__c.Label}" for="DDA-Account-Holder-Name"/>
                    </div>
                    <div class="bs col-sm-8">
                        <apex:inputField id="DDA-Account-Holder-Name" value="{!txn.Name_of_Account_Holder_in_English__c}" styleClass="bs form-control" />
                    </div>
                    <div class="bs col-sm-1">
                        <apex:commandLink styleClass="glyphicon glyphicon-plus-sign fa-lg" onclick="addHolderForJointAccount();return false;" rendered="{!showAddHolder}" style="text-decoration: none;color:rgb(88, 89, 91) !important;"/>&nbsp;&nbsp;&nbsp;&nbsp;
                        <apex:commandLink styleClass="glyphicon glyphicon-minus-sign fa-lg onclick-pointer" onclick="minusHolderForJointAccount();return false;" rendered="{!showMinusHolder}" style="text-decoration: none;color:rgb(88, 89, 91) !important;"/>
                    </div>
                </apex:outputPanel>

                <apex:outputPanel id="secondHolder" rendered="{!txn.Payment_Method_Subsequent_Payment__c == 'Savings' && showSecondHolder}" layout="block" styleClass="bs form-group">
                    
                    <!--for joint account hanlding -->
                    <div class="bs col-sm-3" id="secondHolderLabel">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Credit_Card_Second_Holder_Full_Name__c.Label}" for="DDA-Account-Holder-Name2"/>
                    </div>
                    <div class="bs col-sm-9" id="secondHolderValue">
                        <apex:inputText id="DDA-Account-Holder-Name2" value="{!txn.Credit_Card_Second_Holder_Full_Name__c}" styleClass="bs form-control" />
                    </div>
                    
                </apex:outputPanel>
                
                <apex:outputPanel id="thirdHolder" rendered="{!txn.Payment_Method_Subsequent_Payment__c == 'Savings' && showThirdHolder}" layout="block" styleClass="bs form-group">
                    
                    <!--for joint account hanlding -->
                    <div class="bs col-sm-3" id="thirdHolderLabel">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Credit_Card_Third_Holder_Full_Name__c.Label}" for="DDA-Account-Holder-Name3"/>
                    </div>
                    <div class="bs col-sm-9" id="thirdHolderValue">
                        <apex:inputText id="DDA-Account-Holder-Name3" value="{!txn.Credit_Card_Third_Holder_Full_Name__c}" styleClass="bs form-control" />
                    </div>
                </apex:outputPanel>

                <apex:outputPanel rendered="{!txn.Payment_Method_Subsequent_Payment__c == 'Savings'}" layout="block" styleClass="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Bank_Name__c.Label}" for="DDA-Bank-Name"/>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:inputField id="DDA-Bank-Name" value="{!txn.Bank_Name__c}" styleClass="bs form-control" />
                    </div>
                </apex:outputPanel>
                <apex:outputPanel rendered="{!txn.Payment_Method_Subsequent_Payment__c == 'Savings'}" layout="block" styleClass="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Branch_Name__c.Label}" for="DDA-Branch-Name"/>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:inputField id="DDA-Branch-Name" value="{!txn.Branch_Name__c}" styleClass="bs form-control" />
                    </div>
                </apex:outputPanel>
                <apex:outputPanel rendered="{!txn.Payment_Method_Subsequent_Payment__c == 'Savings'}" layout="block" styleClass="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$ObjectType.ESales_Transaction__c.Fields.Bank_Account_No__c.Label}" for="DDA-Bank-Acct-No"/>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:input id="bank-code" type="tel" value="{!paramBankCode}" 
                                               html-maxlength="3" 
                                               styleClass="bs form-control text-center bank-acc-no"
                                               size="4"
                                               style="display: inline; width: auto;"
                                               onblur="Cigna.ESales.getBankAccNo();"
                        />
                        <span>&nbsp;-&nbsp;</span>
                        <apex:input id="branch-code" type="tel" value="{!paramBranchCode}" 
                                               html-maxlength="3" 
                                               styleClass="bs form-control text-center bank-acc-no"
                                               size="4"
                                               style="display: inline; width: auto;"
                                               onblur="Cigna.ESales.getBankAccNo();"
                        />
                        <span>&nbsp;-&nbsp;</span>
                        <apex:input id="bank-account-code" type="tel" value="{!paramBankAcctCode}" 
                                               html-maxlength="9" 
                                               styleClass="bs form-control text-center bank-acc-no"
                                               size="10"
                                               style="display: inline; width: auto;"
                                               onblur="Cigna.ESales.getBankAccNo();"
                        />

                    </div>

                    <script>
                       function hiddenonblur(element){
                            //CR-56_Link_20220214
                            $(element).trigger("blur");
                        }
                    </script>
                    <div class="bs col-sm-offset-3 col-sm-9 col-xs-12">
                        <apex:inputText id="Bank-Account-Number" 
                                        style="height:1px; width:1px; border:0px !important; color:#fff ; -webkit-appearance: none" 
                                        onfocus="hiddenonblur(this)" tabindex="-1"/>
                    </div>
                    
                    <script>
                        //CR-56_Link_20220214
                        $('input.bank-acc-no').on("keyup",function(evt) {
                            if (this.value.length == this.maxLength && evt.keyCode >= 48 && evt.keyCode <= 57) {
                                var $next = $(this).nextAll('.bank-acc-no');
                                if ($next.length > 0){
                                    $(this).nextAll('.bank-acc-no')[0].focus();
                                } else {
                                    //CR-56_Link_20220214
                                    $(this).trigger("blur");
                                }
                            } else if (this.value.length == 0 && evt.keyCode == 8) {
                                // Backspace
                                var $prev = $(this).prevAll('.bank-acc-no');
                                if ($prev.length > 0){
                                    $(this).prevAll('.bank-acc-no')[0].focus();
                                } else {
                                    //CR-56_Link_20220214
                                    $(this).trigger("blur");
                                }
                            }
                        });
                            
                    </script>

                </apex:outputPanel>
                <apex:outputPanel rendered="{!txn.Payment_Method_Subsequent_Payment__c == 'Savings'}" layout="block" styleClass="bs form-group">
                    <div class="bs col-sm-3">
                        <apex:outputLabel value="{!$Label.Effective_Month_of_the_First_Debit}" for="DDA-Effective-Month"/>
                    </div>
                    <div class="bs col-sm-9">
                        <apex:selectList value="{!txn.DDA_Effective_Month__c}" multiselect="false" size="1" styleClass="bs form-control">
                            <apex:selectOptions value="{!monthValues}"/>
                        </apex:selectList>
                    </div>
                </apex:outputPanel>
            </div>
        </apex:outputPanel>
        
        <script>
            var step = $('#esales-current-step').val();
            var signatureDiv = document.getElementById('signatureDiv');
            if(step == '{!STEP_ESIGNATURE}'){
                if(signatureDiv.style.display == "none"){
                    signatureDiv.style.display = "block";
                    $('#signatureDiv').css('padding-bottom', '130px');
                }
            }
            
        </script>
        
        <div id="signatureDiv" style="display:none;"> 
        <apex:outputPanel id="payment-esignature-section" rendered="{!currentStep == STEP_ESIGNATURE}" styleClass="bs row" layout="block">
        
        <apex:outputPanel id="esignature-section">
            <div id="overlay" style="display:none;">
                   <div id="specialBox">
                        <a><div id="closeOverlay" class="onclick-pointer ci-hk-x" onclick="toggleOverlay();"></div></a>
                        <h4>{!$Label.Terms_And_Conditions}</h4>
                        <div style="padding-bottom:10px; border-top: 1px solid #f2f2f2;"></div>
                        <div id="tccontent">
                            <apex:outputPanel rendered="{!$Label.Header_Language_Code == 'en_US'}">
                                   <b>聲明及授權</b><br/><br/>
                                            1.  本人聲明，據本人所知為本申請提供的陳述及答案, 均完全屬實無訛<br/><br/>
                                            2.  本人確認本人及所有受保人士均為持有有效香港身份證及於香港居住。<br/><br/>
                                            <!--Comment by Shengt for JOBR-235--> 
                                            <!-- 3.  本人確認已閱讀及明白<a href="{!PersonalInformationCollectionStatement_chi}" target="_blank" style="text-decoration: underline;">信諾環球之個人資料收集聲明</a>及<a href="{!$Setup.Portal_Settings__c.File_Download_URL__c}{!Privacy_statement_chi}" target="_blank" style="text-decoration: underline;">私隱聲明</a>。本人同意信諾環球可根據信諾環球之個人資料收集聲明，使用及/或披露本人(申請人)的個人資料。本人明白本人有權在空格上加上「✓」號或根據信諾環球之個人資料收集聲明，表示拒絕使用本人的個人資料作直接促銷用途。然而，本人也明白選擇拒絕使用本人的個人資料作直接促銷，即導致將來本人不能從信諾環球處收到任何針對性或特別優惠的直接促銷。<br/><br/> -->

                                            3.  本人確認已閱讀及明白<a href="{!PersonalInformationCollectionStatement_chi}" target="_blank" style="text-decoration: underline;">信諾環球之個人資料收集聲明</a>及<a href="{!Privacy_statement_chi}" target="_blank" style="text-decoration: underline;">私隱聲明</a>。本人同意信諾環球可根據信諾環球之個人資料收集聲明，使用及/或披露本人(申請人)的個人資料。本人明白本人有權在空格上加上「✓」號或根據信諾環球之個人資料收集聲明，表示拒絕使用本人的個人資料作直接促銷用途。然而，本人也明白選擇拒絕使用本人的個人資料作直接促銷，即導致將來本人不能從信諾環球處收到任何針對性或特別優惠的直接促銷。<br/><br/>
                                            4.  本人同意本保單之保障範圍，由保單承保表內所列之生效日起生效。<br/><br/>
                                            5.  本人同意接受本申請而發出的任何保單即等於接納保單内的條款，同時追認信諾環球在保單上所作的任何更改。<br/><br/>
                                            6.  本人授權，而且確認準受保人已授權，凡存有關本人或準受保人健康狀況任何紀錄或得悉此方面資料的任何持牌醫師、醫生、醫院、診所或者其他醫療或與相關的設施、保險公司或其他組織、機構或個人，可向信諾環球及其再保險公司提供有關資料，以評估本保險申請或日後根據本申請書簽發的本保單下提出任何的保險索償。此授權書的複印本與正本同樣有效。<br/><br/>
                                            7.  <b>取消保單權利及發還保費：本人明白本人有權以書面通知取消保單並取回已繳保費。但是本人必須簽署該通知，並確保信諾環球保險有限公司(位於{!$Label.Cigna_Address_zh})於以下時段內直接收到該通知：保單交付本人或本人的代表後或《通知書》發予本人或本人的代表後起計的30日，以較先者為準。</b><br/><br/>
                           </apex:outputPanel>
                           <apex:outputPanel rendered="{!$Label.Header_Language_Code == 'zh_TW'}">
                                         <b>Declaration and Authorization</b><br/><br/>
                                            1.  I declare that the above statements and answers provided for this application are true and complete to the best of my knowledge.<br/><br/>
                                            2.  I confirm that I and all the persons insured are Hong Kong residents with a valid Hong Kong Identity Card and residency in Hong Kong.<br/><br/>
                                            <!--Comment by Shengt for JOBR-235--> 
                                            <!-- 3.  I confirm that I have read and understood the <a href="{!PersonalInformationCollectionStatement_eng}" target="_blank" style="text-decoration: underline;">Personal Information Collection Statement</a> ("PICS") and <a href="{!$Setup.Portal_Settings__c.File_Download_URL__c}{!Privacy_statement_eng}" target="_blank" style="text-decoration: underline;">Privacy Statement</a> of Cigna Healthcare. I agree that Cigna Healthcare may use and/or disclose my (the Applicant's) personal information in accordance with the PICS. I understand that I have the right to opt out of the use of my personal information for direct marketing purposes by ticking the box below or in accordance with the PICS. I understand that opting out will mean that Cigna Healthcare will not be able to send me any direct marketing, targeted or special offers in the future.<br/><br/> -->
                                            
                                            3.  I confirm that I have read and understood the <a href="{!PersonalInformationCollectionStatement_eng}" target="_blank" style="text-decoration: underline;">Personal Information Collection Statement</a> ("PICS") and <a href="{!Privacy_statement_eng}" target="_blank" style="text-decoration: underline;">Privacy Statement</a> of Cigna Healthcare. I agree that Cigna Healthcare may use and/or disclose my (the Applicant's) personal information in accordance with the PICS. I understand that I have the right to opt out of the use of my personal information for direct marketing purposes by ticking the box below or in accordance with the PICS. I understand that opting out will mean that Cigna Healthcare will not be able to send me any direct marketing, targeted or special offers in the future.<br/><br/>
                                            4.  I agree that the insurance coverage applied for shall only take effect from the Commencement Date as specified in the Policy Schedule.<br/><br/>
                                            5.  I agree that acceptance of any policy issued on this application will constitute an agreement to its terms and condition as well as notifications of any changes specified by Cigna Healthcare in this policy.<br/><br/>
                                            6.  I hereby authorize, and confirm that Proposed Person(s) Insured has / have authorized, any licensed physician, medical practitioner, hospital, clinic or other medical or medically related facility, insurance company or other organization, institution or person, that has any records or knowledge of my or the Proposed Person(s) Insured's health to give to Cigna Healthcare and its reinsurers any such information for the purpose of assessment of this insurance proposal or subsequent assessment of any insurance claim under the policy that may be issued pursuant to this application. A photographic copy of this authorization shall be as valid as the original.<br/><br/>
                                            7.  <b>Cancellation Rights and Refund of Premium(s): I understand that I have the right to cancel and obtain a refund of any premium(s) paid by giving written notice. Such notice must be signed by me and received directly by Cigna Worldwide General Insurance Company Limited which is located at {!$Label.Cigna_Address_en} within 30 days after the delivery of the policy or issue of a Notice to the policyholder or the policyholder's representative, whichever is the earlier.</b><br/><br/>
                           </apex:outputPanel>
                        </div>
                    </div>
            </div>
                
            <apex:actionFunction action="{!saveSignature}" name="saveSignature" namespace="ServerESales" reRender="false" oncomplete="ServerESales.nextStep();">
                <apex:param name="imgDataParam" assignTo="{!imgData}" value=""/>
                <apex:param name="imgDataParam2" assignTo="{!imgData2}" value=""/>
                <!-- add by David 17/10/2017 for ThirdParty CR start -->
                <apex:param name="imgDataParam3" assignTo="{!imgData3}" value=""/>
                <!-- add by David 17/10/2017 for InsurableInterest CR end -->
            </apex:actionFunction>

            <!-- add by David 20/10/2017 for ThirdParty CR start -->
            <apex:actionFunction action="{!SendThirdPartyPayerEmail}" name="SendThirdPartyPayerEmail" namespace="ServerESales" reRender="false" oncomplete="">
                <apex:param name="thirdPartyPayerEmailParam" assignTo="{!thirdPartyPayerEmail}" value=""/>
            </apex:actionFunction>
            <!-- add by David 20/10/2017 for InsurableInterest CR end -->

            <!--<apex:actionFunction action="{!sendEmail}" name="sendEmail" namespace="ServerESales" />-->
            <!--
            <div id="errEmptySignature" class="bs alert alert-danger" role="alert" style="display:none;">
                <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                {!$Label.e_signature_empty_err_msg}
            </div>
            <div id="errNotAcceptTNC" class="bs alert alert-danger" role="alert" style="display:none;">
                <span class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
                {!$Label.e_signature_tc_err_msg}
            </div>
            -->            
            <div class="bs col-xs-12 cigna-fg-gray-dark cigna-form-section-header"><h4>{!$Label.E_Signature}</h4></div>

            <!--
            <c:eSignatureCompWithoutEmail emailAddress="{!txn.Email_Address__c}" 
                              displayPICS="false"
                              displayTC="true"
                              tcMessage="{!$Label.ESales_PICS_Accept}"
                              sendEmailMessage="{!$Label.An_email_with_the_E_Signature_access_link_can_be_sent_to}"
                              signNow="true" 
            />
            -->
            <!-- add by David 23/10/2017 for ThirdParty CR start -->
            <!-- add an attribute eSalesThirdPary -->
            <!-- add three attribute eSalesThirdPary (names)-->
            <c:eSignatureComp emailAddress="{!txn.Email_Address__c}" 
                              displayPICS="false"
                              displayTC="true"
                              tcMessage="{!$Label.ESales_PICS_Accept}"
                              sendEmailMessage="{!$Label.An_email_with_the_E_Signature_access_link_can_be_sent_to}"
                              signNow="true"
                              BrokerScenarios="EsignatureSign"
                              isBroker="true"
                              PICSLink="{!PersonalInfoCollectionStatementURL}"
                              isEsales="true"
                              hasTwoAdults="{!(txn.Number_of_Adult__c > 1 || (!txn.PH_is_PI__c && txn.Number_of_Adult__c > 0)) && txn.AUW_Result_PI__c != "Decline"}"
                              eSalesThirdParty="{!(onlyHasLife && (txn.Is_Making_1st_Payment__c == 'No' || txn.Is_Paying_Subsequent_Payment__c == 'No'))}"
                              eSalesApplicantInfo = "({!txn.Policy_Holder_Last_Name__c} {!txn.Policy_Holder_First_Name__c})"
                              eSalesSpouseInfo = "({!txn.PI_Last_Name__c} {!txn.PI_First_Name__c})"
                              eSalesTPPInfo = "({!IF(txn.Third_Party_Payer__c == 'Company Institute',txn.ThirdParty_Name_of_Company__c,txn.Third_Party_Payer_Full_Name__c)})"
            />
            <!-- add by David 23/10/2017 for ThirdParty CR end -->



            <script>
                if({!IF(txn.Number_of_Adult__c != null && txn.Number_of_Adult__c > 0 && !txn.Is_Adult_1_the_Policy_Holder__c, true, false)}){
                    $("#adult1Div").show();
                    $("#adult2Div").hide();
                }else{
                    $("#adult1Div").hide();
                    $("#adult2Div").show();
                }
                
                // add by David 20/10/2017 for ThirdParty CR start
                var isSent = false;
                function emailValidator(emailAddress) {
                    var re = /^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
                    return emailAddress.length != 0 && re.test(emailAddress);
                }

                Cigna.ESignatureComp.sendEmail = function() {
                    var emailAdd = $("#thirdPartpayer-email").val().trim();
                    if (emailValidator(emailAdd)) {
                        $("#errEmailFormat").hide();
                        $("#errorEmptyAll").hide();
                        ServerESales.SendThirdPartyPayerEmail(emailAdd);
                        $("#emailSent").show();
                        isSent = true;
                        return true;
                    }
                    $("#errEmailFormat").show();
                    $("#errorEmptyAll").hide();
                    return false;
                }

                // add by David 20/10/2017 for ThirdParty CR end

                Cigna.ESignatureComp.saveSignature = function() {
                    
                    if($('#esignature-sign-div #esignature-pics').is(':checked') == false){
                        $("#errNotAcceptTNC1").show();
                        return;
                    } else {
                        $("#errNotAcceptTNC1").hide();
                    }
                    
                    if(Cigna.ESignatureComp.isEmptyCanvas(1)){
                        $("#errEmptySignature1").show();
                        return;
                    } else {
                        $("#errEmptySignature1").hide();
                    }
                    
                    var signature2Image = '';
                    if({!(txn.Number_of_Adult__c > 1 || (!txn.PH_is_PI__c && txn.Number_of_Adult__c > 0)) && txn.AUW_Result_PI__c != "Decline"}){
                        if(Cigna.ESignatureComp.isEmptyCanvas(2)){
                            $("#errEmptySignature2").show();
                            return;
                        } else {
                            $("#errEmptySignature2").hide();
                        }
                        signature2Image = Cigna.ESignatureComp.getSignatureImage(2);
                    }

                    // add by David 18/10/2017 for ThirdParty CR start
                    var signature3Image = '';
                    if ({!(onlyHasLife && (txn.Is_Making_1st_Payment__c == 'No' || txn.Is_Paying_Subsequent_Payment__c == 'No'))}) {
                        var isSignatureEmpty = Cigna.ESignatureComp.isEmptyCanvas(3);
                        var isEmailaddressEmpty = $("#thirdPartpayer-email").val().trim().length == 0;
                        if (isSignatureEmpty && isEmailaddressEmpty) {
                            $("#errorEmptyAll").show();
                            return;
                        }
                        if (!isSignatureEmpty) {
                            signature3Image = Cigna.ESignatureComp.getSignatureImage(3);
                        } else if (!isEmailaddressEmpty) {
                            // email is not sent and email address is invalid
                            if (!isSent) {
                                if (!Cigna.ESignatureComp.sendEmail()) {
                                    return;
                                }
                            }
                        }
                    }
                    // add by David 18/10/2017 for ThirdParty CR end

                    // David Update: add one more parameter
                    ServerESales.saveSignature(Cigna.ESignatureComp.getSignatureImage(1), signature2Image, signature3Image);
                    // David Update: End


                    //Ray Update: Auto Scroll to Top
                    $("html, body").animate({ scrollTop: 0 }, "fast"); 
                    //Ray Update: End
                }
                
                Cigna.ESignatureComp.forceResizeCanvas();
                
                function toggleOverlay(){
                    var overlay = document.getElementById('overlay');
                    var specialBox = document.getElementById('specialBox');
                    overlay.style.opacity = .95;
                    if(overlay.style.display == "block"){
                        overlay.style.display = "none";
                        specialBox.style.display = "none";
                    } else {
                        overlay.style.display = "block";
                        specialBox.style.display = "block";
                    }
               }
                

                Cigna.ESales.refreshEsignatrueButton();
                
            </script>

        </apex:outputPanel>

        </apex:outputPanel>
        </div>

        <!--payment process-->
        <apex:outputPanel rendered="{!currentStep == STEP_PAYMENT}" styleClass="bs row" layout="block">
        
            <apex:outputPanel styleClass="wrap-iframe-third-party">
                <script>
                
                //Quick fix for IPad, avoid duplicate event trigger -- Kenneth Wong
                var already_run = false;
                $(window).on("message onmessage", function(evt){
                    console.log('evt', evt);
                    console.log(evt.originalEvent);
                    var event = evt.originalEvent;
                    if(!already_run){
                        if (event.origin != null && event.origin.toLowerCase() == window.location.origin) {
                            already_run = true;
                            console.log("tid: ", event.data);
                            Cigna.Util.navigateToVFP("ESalesVFP?afterPay=true&tid=" + event.data, null, null, true);
                        }
                    }
                });
                </script>
                <apex:iframe src="{!paymenturl}" height="1024px" scrolling="true" />
                <!--<apex:iframe src="eSalesPayment?merchantReference=SFDC334222Test&paymentAmount=99222000" height="1024px" scrolling="true"/>-->
                <!--<apex:include pageName="{!epaymentPage}" />-->
            </apex:outputPanel>
            
        </apex:outputPanel>

    </apex:form>
    </div>

        <apex:outputPanel id="confirmation-section" rendered="{!currentStep == STEP_CONFIRMATION}" styleClass="bs row" layout="block">
            <script>
                Cigna.ESales.clearUWStatusPolling();
                $('div.header-bar').show();
                window.scrollTo(0, 0);
            </script>
            
            <apex:include pageName="EsalesConfirmationFormVFP"/>

        </apex:outputPanel>

        <apex:outputPanel id="third-party-payment" rendered="{!currentStep == STEP_THIRD_PARTY_PAYMENT}" styleClass="bs row" layout="block">
            
            <apex:include pageName="EsalesThirdPartyPaymentVFP"/>
        </apex:outputPanel>

        <apex:outputPanel id="convoy-fna-message" rendered="{!currentStep > STEP_PAYMENT && NOT( ISNULL(fnaMessage))}" styleClass="bs row" layout="block">
            <div class="bs col-xs-12 col-sm-8 col-sm-offset-2" style="text-align:center;">
                <p><strong style="font-size: large;color: red;">{!fnaMessage}</strong></p>
            </div>
        </apex:outputPanel>

        <apex:outputPanel id="payment-gateway-section" rendered="{!currentStep > STEP_PAYMENT && isCustomerPortal && paymentResult != 'Failed' && txn.AUW_Overall_Result__c != 'Referred'  && !hasLoading}" styleClass="bs row" layout="block"><!--accept case with loading = referred 2021/11/19 Connor SUQ-->
            <!--
            <div class="bs col-xs-12 col-sm-8 col-sm-offset-2">
                <p class="bs text-center cigna-fg-gray-dark">{!$Label.Payment_Gateway_Redirection_Message}</p>
                <p class="bs text-center"><img class="bs" src="{!URLFOR($Resource.Spinners, 'slds_spinner.gif')}" width="80px" /></p>
            </div>
            -->
            <div class="bs col-xs-12 col-sm-8 col-sm-offset-2" style="text-align:center;">
                <i class="fa fa-check-circle-o content-active cigna-fg-green-medium" style="font-size:50px;" aria-hidden="true"></i>
            </div>
            <div class="bs col-xs-12 col-sm-8 col-sm-offset-2" style="text-align:center;">
                <p>{!$Label.Payment_Confirmation}</p>
            </div>
            <!---add by TM -->
            <apex:outputPanel rendered="{!submitdateAfter28}">
                <div class="bs col-xs-12 col-sm-8 col-sm-offset-2" style="text-align:center;">
                    <p>{!$Label.The_policy_effective_date_will_be_auto_adjusted_to_28}</p>
                </div>
            </apex:outputPanel>
            <!---add by TM -->
        </apex:outputPanel>
        
        <apex:outputPanel id="payment-gateway-section2" rendered="{!currentStep > STEP_PAYMENT && paymentResult == 'Failed' && txn.AUW_Overall_Result__c != 'Referred'}" styleClass="bs row" layout="block">
            
            <div class="bs col-xs-12 col-sm-8 col-sm-offset-2" style="text-align:center;">
                <i class="bs cigna-fg-red-alert fa fa-times-circle fg-lg" style="font-size:50px;" aria-hidden="true"></i>
            </div>
            <div class="bs col-xs-12 col-sm-8 col-sm-offset-2" style="text-align:center;">
                <!--changed by Stripe CR 
                <p>{!$Label.Payment_Failed}{!txn.Payment_PSPReference__c}{!$Label.Payment_Failed_2}</p>-->
                <p>{!$Label.Payment_Failed}{!txn.Payment_PSPReference__c}{!$Label.Payment_Failed_2}</p>
                <br/>
            </div>
            <br/>
            <!-- 20190624 - David Zhang - Temp Fix to hide pervious button -->
            <!-- 20201021 - minghua - payment error -->
            <!-- <div id="action-bar-desktop" class="bs hidden-xs text-center" style="padding-bottom: 100px;display:none"> -->
            <div id="action-bar-desktop" class="bs hidden-xs text-center" style="padding-bottom: 100px;">
                <a id="eSales-previous-btn-desktop"  class="bs btn action-btn cigna-fg-white cigna-bg-orange-dark cigna-btn-desktop" 
                    role="button" onclick="Cigna.ESales.returnToPreviousPage();">
                    {!$Label.Return_to_previous_page}
                </a> 
            </div>
            <!-- 20190624 - David Zhang - Temp Fix to hide pervious button -->
            <!-- 20201021 - minghua - payment error -->
            <!-- <apex:outputPanel rendered="{!false && isCustomerPortal}"> -->
            <apex:outputPanel rendered="{!isCustomerPortal}">
                <div id="action-bar" class="bs cigna-floating-bottom-panel visible-xs">
                    <div class="bs cigna-action-btn-group cigna-fg-white cigna-bg-orange-dark">
                        <a id="eSales-previous-btn" class="action-btn cigna-fg-white" 
                            role="button" onclick="Cigna.ESales.returnToPreviousPage();">
                            <i class="ci-hk-arrow-29" aria-hidden="true"></i><br/>{!$Label.Return_to_previous_page} 
                        </a>    
                    </div>
                </div>
            </apex:outputPanel>
        </apex:outputPanel>
        
        <apex:outputPanel id="payment-gateway-section3" rendered="{!currentStep > STEP_PAYMENT && isCustomerPortal && (txn.AUW_Overall_Result__c == 'Referred' || (txn.AUW_Overall_Result__c == 'Accept' && hasLoading) )}" styleClass="bs row" layout="block">
            
            <div class="bs col-xs-12 col-sm-8 col-sm-offset-2" style="text-align:center;">
                <i class="fa fa-check-circle-o content-active cigna-fg-green-medium" style="font-size:50px;" aria-hidden="true"></i>
            </div>
            <div class="bs col-xs-12 col-sm-8 col-sm-offset-2" style="text-align:center;">
                <p>{!$Label.Payment_Confirmation_Plus}</p>
            </div>
        </apex:outputPanel>
        
        <div id="web-app-padding" class="bs row" style="padding-bottom: 50px;">
            <div class="bs col-xs-12"></div>
        </div>
        <div id="mobile-app-padding" class="bs row" style="display: none; padding-bottom: 120px;">
            <div class="bs col-xs-12"></div>
        </div>
        
        <apex:outputPanel id="showNextButton" rendered="{!currentStep < STEP_PAYMENT && currentStep != STEP_UNDERWRITING && currentStep != STEP_UNDERWRITING_PI && currentStep != STEP_UNDERWRITING_C1 && currentStep != STEP_UNDERWRITING_C2 && currentStep != STEP_UNDERWRITING_C3}" styleClass="bs row" layout="block">
            <!-- GL31 jack add -->
            <apex:outputPanel rendered="{!currentStep == STEP_ASSESSMENT_QUESTION && !displayWarningMessage}">
                <div id="action-bar-desktop" class="bs visible-sm visible-md hidden-xs text-center next-btn" style="padding-bottom: 300px;">
                    <a class="bs btn action-btn cigna-fg-white cigna-bg-orange-dark cigna-btn-desktop" role="button" onclick="submitAssessmentQuestoin();"><!-- GL31 jack add -->
                        {!$Label.Next}
                    </a> 
                </div>
                <div id="action-bar-desktop" class="bs hidden-sm hidden-xs hidden-md text-center next-btn" style="padding-bottom: 100px;">
                    <a class="bs btn action-btn cigna-fg-white cigna-bg-orange-dark cigna-btn-desktop" role="button" onclick="submitAssessmentQuestoin();"><!-- GL31 jack add -->
                        {!$Label.Next}
                    </a> 
                </div>
                <apex:outputPanel rendered="{!isCustomerPortal}">
                    <div id="action-bar" class="bs cigna-floating-bottom-panel visible-xs next-btn">
                        <div class="bs cigna-action-btn-group cigna-fg-white cigna-bg-orange-dark">
                            <a class="action-btn cigna-fg-white" role="button" onclick="submitAssessmentQuestoin();"><!-- GL31 jack add -->
                                <i class="ci-hk-arrow-31" aria-hidden="true"></i><br/>{!$Label.Next} 
                            </a>    
                        </div>
                    </div>
                </apex:outputPanel>
            </apex:outputPanel>
            <!-- GL31 jack add -->

            <apex:outputPanel rendered="{!currentStep < STEP_CONFIRMATION && currentStep != STEP_ASSESSMENT_QUESTION}"><!-- GL31 jack add -->
                <div id="action-bar-desktop" class="bs visible-sm visible-md hidden-xs text-center next-btn" style="padding-bottom: 300px;">
                    <a class="bs btn action-btn cigna-fg-white cigna-bg-orange-dark cigna-btn-desktop" role="button" onclick="Cigna.ESales.nextStep();">
                        {!$Label.Next}
                    </a> 
                </div>
                <div id="action-bar-desktop" class="bs hidden-sm hidden-xs hidden-md text-center next-btn" style="padding-bottom: 100px;">
                    <a class="bs btn action-btn cigna-fg-white cigna-bg-orange-dark cigna-btn-desktop" role="button" onclick="Cigna.ESales.nextStep();">
                        {!$Label.Next}
                    </a> 
                </div>
                <apex:outputPanel rendered="{!isCustomerPortal}">
                    <div id="action-bar" class="bs cigna-floating-bottom-panel visible-xs next-btn">
                        <div class="bs cigna-action-btn-group cigna-fg-white cigna-bg-orange-dark">
                            <a class="action-btn cigna-fg-white" role="button" onclick="Cigna.ESales.nextStep();">
                                <i class="ci-hk-arrow-31" aria-hidden="true"></i><br/>{!$Label.Next} 
                            </a>    
                        </div>
                    </div>
                </apex:outputPanel>
            </apex:outputPanel>
            <apex:outputPanel rendered="{!currentStep == STEP_CONFIRMATION && txn.Basic_Plan_Code__c != 'DMB' && ((!isBrokerPortal && txn.AUW_Overall_Result__c !='Decline') || (isBrokerPortal && (isAppealYes || (isAppealNo && txn.AUW_Overall_Result__c != 'Decline') || (txn.AUW_Overall_Result__c =='Accept' && !hasExclusion && !hasDecline) || txn.AUW_Overall_Result__c =='Referred')))}">
                <div id="action-bar-desktop" class="bs visible-sm visible-md text-center" style="padding-bottom: 300px;">
                    <a class="bs btn action-btn cigna-fg-white cigna-bg-orange-dark cigna-btn-desktop" role="button" onclick="Cigna.ESales.nextStep();">
                        {!$Label.Next}
                    </a>
                </div>
                <div id="action-bar-desktop" class="bs hidden-sm hidden-xs hidden-md text-center" style="padding-bottom: 150px;">
                    <a class="bs btn action-btn cigna-fg-white cigna-bg-orange-dark cigna-btn-desktop" role="button" onclick="Cigna.ESales.nextStep();">
                        {!$Label.Next}
                    </a> 
                    
                </div>
                <apex:outputPanel rendered="{!isCustomerPortal}">
                    <div id="action-bar" class="bs cigna-floating-bottom-panel visible-xs">
                        <div class="bs cigna-action-btn-group cigna-fg-white cigna-bg-orange-dark">
                            <a class="action-btn cigna-fg-white" role="button" onclick="Cigna.ESales.nextStep();">
                                <i class="ci-hk-arrow-31" aria-hidden="true"></i><br/>{!$Label.Next} 
                            </a>    
                        </div>
                        
                    </div>
                </apex:outputPanel>
            </apex:outputPanel>

            <apex:outputPanel rendered="{!currentStep == STEP_CONFIRMATION && txn.Basic_Plan_Code__c == 'DMB' && ((!isBrokerPortal && txn.AUW_Overall_Result__c !='Decline') || (isBrokerPortal && (isAppealYes || (isAppealNo && txn.AUW_Overall_Result__c != 'Decline') || (txn.AUW_Overall_Result__c =='Accept' && !hasExclusion && !hasDecline) || txn.AUW_Overall_Result__c =='Referred')))}">

                <apex:outputPanel rendered="{!isBrokerPortal && txn.AUW_Overall_Result__c =='Accept' && ((!hasExclusion && !hasDecline) || isAppealNo) }">
                    <div id="action-bar-desktop" class="bs visible-sm visible-md text-center" style="padding-bottom: 300px;">
                        <a id="eSales-email-quote-btn" class="bs btn action-btn cigna-fg-white cigna-bg-orange-dark cigna-btn-desktop" role="button" onclick="Cigna.ESales.redirectToSendEmail(); return false;">
                            {!$Label.Email_Quote}
                        </a>  
                        <a class="bs btn action-btn cigna-fg-white cigna-bg-orange-dark cigna-btn-desktop" role="button" onclick="Cigna.ESales.nextStep();">
                            {!$Label.Buy_Now}
                        </a> 
                    </div>
                    <div id="action-bar-desktop" class="bs hidden-sm hidden-xs hidden-md text-center" style="padding-bottom: 100px;">
                        <a id="eSales-email-quote-btn2" class="bs btn action-btn cigna-fg-white cigna-bg-orange-dark cigna-btn-desktop" role="button" onclick="Cigna.ESales.redirectToSendEmail(); return false;">
                            {!$Label.Email_Quote}
                        </a>  
                        <a class="bs btn action-btn cigna-fg-white cigna-bg-orange-dark cigna-btn-desktop" role="button" onclick="Cigna.ESales.nextStep();">
                            {!$Label.Buy_Now}
                        </a> 
                        
                    </div>
                </apex:outputPanel>
                <apex:outputPanel rendered="{!!isBrokerPortal || (isBrokerPortal && (txn.AUW_Overall_Result__c !='Accept' || isAppealYes))}">
                    <div id="action-bar-desktop" class="bs visible-sm visible-md text-center" style="padding-bottom: 330px;">
                        <apex:outputText rendered="{!isCustomerPortal}">
                            <a class="bs btn action-btn cigna-fg-white cigna-bg-orange-dark cigna-btn-desktop" role="button" onclick="Cigna.ESales.contactMe();return false;">{!$Label.Contact_Me}</a>
                        </apex:outputText>

                        <a class="bs btn action-btn cigna-fg-white cigna-bg-orange-dark cigna-btn-desktop" role="button" onclick="Cigna.ESales.nextStep();">
                            {!IF(!isBrokerPortal && txn.AUW_Overall_Result__c =='Accept' && !hasLoading,$Label.Buy_Now,$Label.eSales_Submit_Application)}<!--Added !hasLoading for DMB SUQ Connor 2021/11/12-->
                        </a> 
                    </div>
                    <div id="action-bar-desktop" class="bs hidden-sm hidden-xs hidden-md text-center" style="padding-bottom: 100px;">
                        <apex:outputText rendered="{!isCustomerPortal}">
                            <a class="bs btn action-btn cigna-fg-white cigna-bg-orange-dark cigna-btn-desktop" role="button" onclick="Cigna.ESales.contactMe();return false;">{!$Label.Contact_Me}</a>
                        </apex:outputText>

                        <a class="bs btn action-btn cigna-fg-white cigna-bg-orange-dark cigna-btn-desktop" role="button" onclick="Cigna.ESales.nextStep();">
                            {!IF(!isBrokerPortal && txn.AUW_Overall_Result__c =='Accept' && !hasLoading,$Label.Buy_Now,$Label.eSales_Submit_Application)}<!--Added !hasLoading for DMB SUQ Connor 2021/11/12-->
                        </a> 
                        
                    </div>
                </apex:outputPanel>

                <apex:outputPanel rendered="{!isCustomerPortal}">
                    <div id="action-bar" class="bs cigna-floating-bottom-panel visible-xs">
                        <div class="bs cigna-action-btn-group cigna-fg-white cigna-bg-orange-dark">
                            <a class="action-btn cigna-fg-white" role="button" onclick="Cigna.ESales.contactMe();return false;"><span class="ci-hk-phone" aria-hidden="true"></span><br/>{!$Label.Contact_Me}</a>
                            <a class="action-btn cigna-fg-white" role="button" onclick="Cigna.ESales.nextStep();">
                                <i class="ci-hk-creditcard" aria-hidden="true"></i><br/>{!IF(!isBrokerPortal && txn.AUW_Overall_Result__c =='Accept' && !hasLoading,$Label.Buy_Now,$Label.eSales_Submit_Application)} <!--Added !hasLoading for DMB SUQ Connor 2021/11/12-->
                            </a>    
                        </div>
                        
                    </div>
                </apex:outputPanel>
            </apex:outputPanel>

            
            <apex:outputPanel rendered="{!currentStep > STEP_CONFIRMATION && currentStep != STEP_ESIGNATURE}">
                <div id="action-bar-desktop" class="bs visible-sm visible-md text-center" style="padding-bottom: 400px;">
                    <a class="bs btn action-btn cigna-fg-white cigna-bg-orange-dark cigna-btn-desktop" role="button" onclick="Cigna.ESales.nextStep();">
                        {!$Label.Next}
                    </a> 
                </div>
                <div id="action-bar-desktop" class="bs hidden-sm hidden-xs hidden-md text-center" style="padding-bottom: 100px;">
                    <a class="bs btn action-btn cigna-fg-white cigna-bg-orange-dark cigna-btn-desktop" role="button" onclick="Cigna.ESales.nextStep();">
                        {!$Label.Next}
                    </a> 
                </div>
                <apex:outputPanel rendered="{!isCustomerPortal}">
                    <div id="action-bar" class="bs cigna-floating-bottom-panel visible-xs">
                        <div class="bs cigna-action-btn-group cigna-fg-white cigna-bg-orange-dark">
                            <a class="action-btn cigna-fg-white" role="button" onclick="Cigna.ESales.nextStep();">
                                <i class="ci-hk-arrow-31" aria-hidden="true"></i><br/>{!$Label.Next} 
                            </a>    
                        </div>
                    </div>
                 </apex:outputPanel>
            </apex:outputPanel>
            
            <script>
                if (Cigna.Util.isIOS() && Cigna.Util.isSalesforce1() && Cigna.Util.isBrokerPortal()) {
                    //$('#action-bar').css('position', 'absolute');
                    $('#mobile-app-padding').css('display', 'block');
                    /*
                    var targetHeight = window.screen.height;
                    var sfOneHeaderHeight = 44 + 20;
                    
                    if($(window).width() > $(window).height()){
                        targetHeight = window.screen.width;   
                    }
                    
                    $('body').css('height', (targetHeight - sfOneHeaderHeight) + 'px');
                    $('body').bind('touchmove', function(e){$('#action-bar').css('opacity', '0');});
                    $('body').bind('touchend', function(e){setTimeout(function(){$('#action-bar').css('opacity', '1');}, 700);});
                    
                    $('html').css('position', 'fixed').css('overflow', 'auto').css('width', '100%').css('height', '100%');
                    $('body').css('position', 'fixed').css('overflow-x', 'scroll').css('width', '100%').css('height', '100%');*/
                }

            </script>
        </apex:outputPanel>
            
        <apex:outputPanel rendered="{!currentStep > STEP_PAYMENT && !isCustomerPortal && paymentResult != 'Failed' && !hideAcknowledgement}" styleClass="bs row" layout="block">
        
            <div class="bs col-xs-12 col-sm-8 col-sm-offset-2" style="text-align:center;">
                <i class="fa fa-check-circle-o content-active cigna-fg-green-medium" style="font-size:50px;" aria-hidden="true"></i>
            </div>
            <apex:outputPanel rendered="{!onlyHasLife && txn.AUW_Overall_Result__c == 'Accept' && (txn.Is_Making_1st_Payment__c == 'Yes' && txn.Is_Paying_Subsequent_Payment__c == 'Yes')}">
                <div class="bs col-xs-12 col-sm-8 col-sm-offset-2" style="text-align:center;">
                    <p>{!$Label.eSales_Acknowledgement_Life_Accept}</p>
                </div>
            </apex:outputPanel>

            <!-- add by David 23/10/2017 for ThirdParty CR start -->
            <!--<apex:outputPanel rendered="{!onlyHasLife && txn.AUW_Overall_Result__c == 'Accept' && isEmailSentToThirdPartyPayer && (txn.Is_Making_1st_Payment__c == 'No' || txn.Is_Paying_Subsequent_Payment__c == 'No')}">-->
            <apex:outputPanel rendered="{!onlyHasLife && txn.AUW_Overall_Result__c == 'Accept' && txn.Status__c == 'Waiting for Third Party Payor Signature' && (txn.Is_Making_1st_Payment__c == 'No' || txn.Is_Paying_Subsequent_Payment__c == 'No')}">
            
                <div class="bs col-xs-12 col-sm-8 col-sm-offset-2" style="text-align:center;">
                    <p>{!$Label.eSales_Acknowledgement_Wait_For_Third_Party_Payer}</p>
                </div>
            </apex:outputPanel>

            <!--<apex:outputPanel rendered="{!onlyHasLife && txn.AUW_Overall_Result__c == 'Accept' && !isEmailSentToThirdPartyPayer && (txn.Is_Making_1st_Payment__c == 'No' || txn.Is_Paying_Subsequent_Payment__c == 'No')}">-->

            <apex:outputPanel rendered="{!onlyHasLife && txn.AUW_Overall_Result__c == 'Accept' && txn.Status__c != 'Waiting for Third Party Payor Signature' && (txn.Is_Making_1st_Payment__c == 'No' || txn.Is_Paying_Subsequent_Payment__c == 'No')}">
                <div class="bs col-xs-12 col-sm-8 col-sm-offset-2" style="text-align:center;">
                    <p>{!$Label.eSales_Acknowledgement_With_Third_Party_Payer}</p>
                </div>
            </apex:outputPanel>
            <!-- add by David 23/10/2017 for ThirdParty CR end -->


            <apex:outputPanel rendered="{!!onlyHasLife && txn.AUW_Overall_Result__c == 'Accept'}">
                <div class="bs col-xs-12 col-sm-8 col-sm-offset-2" style="text-align:center;">       
                    <apex:outputText escape="false" value="{!$Label.eSales_Acknowledgement_GI_Accept}"/>
                </div>
            </apex:outputPanel>

            <apex:outputPanel rendered="{!txn.AUW_Overall_Result__c == 'Referred'}">
                <div class="bs col-xs-12 col-sm-8 col-sm-offset-2" style="text-align:center;">
                    <p>{!$Label.eSales_Acknowledgement_Refer}</p>
                </div>
            </apex:outputPanel>
            
            <script>
                if (Cigna.Util.isIOS() && Cigna.Util.isSalesforce1() && Cigna.Util.isBrokerPortal()) {
                    //$('#action-bar').css('position', 'absolute');
                    //$('#mobile-app-padding').css('display', 'block');
                    /*
                    var targetHeight = window.screen.height;
                    var sfOneHeaderHeight = 44 + 20;
                    
                    if($(window).width() > $(window).height()){
                        targetHeight = window.screen.width;   
                    }
                    
                    $('body').css('height', (targetHeight - sfOneHeaderHeight) + 'px');
                    $('body').bind('touchmove', function(e){$('#action-bar').css('opacity', '0');});
                    $('body').bind('touchend', function(e){setTimeout(function(){$('#action-bar').css('opacity', '1');}, 700);});
                    */
                    $('html').css('position', 'fixed').css('overflow', 'auto').css('width', '100%').css('height', '100%');
                    $('body').css('position', 'fixed').css('overflow-x', 'scroll').css('width', '100%').css('height', '100%');
                }
            </script>
        </apex:outputPanel>
            
        <apex:outputPanel rendered="{!currentStep > STEP_PAYMENT && paymentResult != 'Failed'}" styleClass="bs row" layout="block">
            <div id="action-bar-desktop" class="bs hidden-xs text-center">
                <a id="eSales-view-plans-btn2" class="bs btn action-btn cigna-fg-white cigna-bg-orange-dark cigna-btn-desktop" 
                   role="button" onclick="Cigna.ESales.viewOtherPlans();">
                    {!$Label.View_Other_Plans}
                </a>
                <a id="eSales-home-btn2" class="bs btn action-btn cigna-fg-white cigna-bg-orange-dark cigna-btn-desktop" 
                    role="button" onclick="Cigna.ESales.goHome();">
                    {!$Label.Home}
                </a>
            </div>
            <apex:outputPanel rendered="{!isCustomerPortal}">
                <div id="action-bar" class="bs cigna-floating-bottom-panel visible-xs">
                    <div class="bs cigna-action-btn-group cigna-fg-white cigna-bg-orange-dark">
                        <a id="eSales-view-plans-btn" href="javascript:void(0);" class="action-btn cigna-fg-white" role="button"
                           onclick="Cigna.ESales.viewOtherPlans();">
                           <i class="ci-hk-modify" aria-hidden="true"></i><br/>
                            {!$Label.View_Other_Plans}
                        </a>
                        <a id="eSales-home-btn" href="javascript:void(0);" class="action-btn cigna-fg-white" role="button" 
                           onclick="Cigna.ESales.goHome();">
                           <i class="ci-hk-home" aria-hidden="true"></i><br/>
                            {!$Label.Home}
                        </a> 
                    </div>
                </div>
            </apex:outputPanel>
        </apex:outputPanel>

        <apex:outputPanel id="validationRulePanel">
        <script>
        
            var paramSameResidentialAddressPH = "{!paramSameResidentialAddressPH}";
            if(paramSameResidentialAddressPH == 'true'){
                $("#PI-Residential-Address-checkbox").attr('checked','checked');
                $('div[data-id="residential-address-part"]').hide(0);
            }
            /*remove permanent address
            var paramSamePermanentAddressPH = "{!paramSamePermanentAddressPH}";
            if(paramSamePermanentAddressPH =='true'){
                $("#PI-Permanent-Address-checkbox").attr('checked','checked');
                $('div[data-id="permanent-address-part"]').hide(0);
            }
            */
            function getNextInput(resour,index){       

              if(index==3){if(resour.value.length==resour.maxLength){resour.blur();}}
              else if(resour.value.length==resour.maxLength)
              {
                resour.parentNode.getElementsByClassName('form-control')[index].focus();
              }
            }
            function checkdate(resour){
         
                //var container=resour.parentNode.getElementsByClassName('form-control');
                var container=resour.parentNode.getElementsByClassName('hidden-input-field');
                var adate=new Date(container[2].value,container[1].value-1,container[0].value);    
                var thedate=new Date();

                var nowYear=thedate.getFullYear();
                var nowMonth=thedate.getMonth()+1;
                var nowday=thedate.getDate();

                var age=nowYear-container[2].value;
                if(nowMonth<=container[1].value){
                    
                    if(nowMonth==container[1].value){
                        
                        if(nowday<container[0].value){
                            
                            age--;
                             
                        }

                    }else{
                        age--;
                    }
                }

                var dis=thedate-adate;
                
                var day = parseInt(dis/1000 / 3600 / 24);
                
                 if(thedate<adate){
                    return false;
                 }
                 else if(container[1].value==2&&container[0].value>30){
                 console.log('feb > 30');
                    return false;
                 }else if(container[1].value==2&&container[0].value>28){
                    console.log('Feb >28');
                           if(container[2].value%4==0 && container[2].value%100!=0 || container[2].value%400==0){
                                
                                if(container[0].value<=29){
                                    console.log('Feb =29');
                                    return true;
                                }
                                else{console.log('Feb >29');
                                    return false;}
                           }
                           else{
                            return false;
                           }
                 }
                 else if(container[1].value==1 || container[1].value==3 || container[1].value==5 || container[1].value==7 || container[1].value==8 || container[1].value==10 || container[1].value==12){
                                console.log('1 3 5 7 8 10 12 yue');
                               if(container[0].value<=31){return true;}
                               else{return false;}
                 }else if(container[1].value==4 || container[1].value==6 || container[1].value==9 || container[1].value==11){
                               console.log('4 6 9 11 yue')
                               if(container[0].value<=30){return true;}
                               else{return false;}

                 }
                 else{
                    return true;
                 }
                
            }

            function checkage(resour){
            console.log('check age');
                //var container=resour.parentNode.getElementsByClassName('form-control');
                var container=resour.parentNode.getElementsByClassName('hidden-input-field');
                var adate=new Date(container[2].value,container[1].value-1,container[0].value);    
                var thedate=new Date();

                var nowYear=thedate.getFullYear();
                var nowMonth=thedate.getMonth()+1;
                var nowday=thedate.getDate();

                // console.log(nowMonth==container[1].value);
                // console.log('now'+nowMonth);
                // console.log(container[1].value);

                var age=nowYear-container[2].value;
                if(nowMonth<=container[1].value){
                    
                    if(nowMonth==container[1].value){
                        
                        if(nowday<container[0].value){
                            
                            age--;
                             
                        }

                    }else{
                        age--;
                    }
                }

                var dis=thedate-adate;
                
                var day = parseInt(dis/1000 / 3600 / 24);
               console.log(age);
                
                if(day<15&&day>0){
                    console.log('less than 15');
                    return false;
                 }else if(age>=18&&age!=nowYear){
                      console.log("age>=18");
                    return false;

                 }
                 
                 else{
                    return true;
                 }
                
            }
            
            
            function checkageBig(resour){
            console.log('check age');
                //var container=resour.parentNode.getElementsByClassName('form-control');
                var container=resour.parentNode.getElementsByClassName('hidden-input-field');
                var adate=new Date(container[2].value,container[1].value-1,container[0].value);   
                console.log('adate'+adate);
                var thedate=new Date();

                var nowYear=thedate.getFullYear();
                var nowMonth=thedate.getMonth()+1;
                var nowday=thedate.getDate();

                // console.log(nowMonth==container[1].value);
                // console.log('now'+nowMonth);
                // console.log(container[1].value);

                var age=nowYear-container[2].value;
                if(nowMonth<=container[1].value){
                    
                    if(nowMonth==container[1].value){
                        
                        if(nowday<container[0].value){
                            
                            age--;
                             
                        }

                    }else{
                        age--;
                    }
                }

                var dis=thedate-adate;
                
                var day = parseInt(dis/1000 / 3600 / 24);
               console.log(age);
                
                 if(age<18){
                      console.log("age<18");
                    return false;

                 }
                 
                 else{
                    return true;
                 }
                
            }
            
            function isNumberKey(charCode, min, max) {
                if ((charCode >= 48 && charCode <= 57) || 
                    $.inArray(charCode, [8, 127]) !== -1) {
                    if (!isNaN(min) && !isNaN(max) && typeof min != undefined && typeof max != undefined) {
                        if ((charCode - 48) >= min && (charCode - 48) <= max) {
                            return true;
                        } else {
                            return false;
                        }
                    } else {
                        return true;
                    }
                } else {
                    return false;
                }
            }
            
            function onKidAgeChange(evt) {
                return isNumberKey(evt.charCode);
            }
            //CR-56_Link_20220214
            $('.question-kid-age').on("keypress",onKidAgeChange);
                                
            function hiddenonblur(input){
                var InputId = input.id;
                //CR-56_Link_20220214
                $("input[id*='" + InputId + "']").trigger("blur");
            }                    
            function getCheckDOB(datetype , input){
                var InputId = input.id;
                var InputVal = $("input[id*='" + InputId  + "']").val();
                
                var oncheckRole = 'PH';
                if(datetype.indexOf("PI") >= 0 ) oncheckRole = 'PI';
                if(datetype.indexOf("CH1") >= 0 ) oncheckRole = 'CH1';
                if(datetype.indexOf("CH2") >= 0 ) oncheckRole = 'CH2';
                if(datetype.indexOf("CH3") >= 0 ) oncheckRole = 'CH3';
                
                $("input[id*='" + oncheckRole + "-Day-DOB-Check']").val('');
                var DOBDate = $("input[id*='Val-DOB-Day-" + oncheckRole + "']").val();
                var DOBMonth = $("input[id*='Val-DOB-Month-" + oncheckRole + "']").val();
                var DOBYear = $("input[id*='Val-DOB-Year-" + oncheckRole + "']").val();
                if((DOBDate!=null && DOBDate!='')
                    && (DOBMonth!=null && DOBMonth!='')
                    && (DOBYear!=null && DOBYear!='')){
                        $("input[id*='" + oncheckRole + "-Day-DOB-Check']").val(DOBDate+'/'+DOBMonth+'/'+DOBYear);
                        //CR-56_Link_20220214
                        $("input[id*='" + oncheckRole + "-Day-DOB-Check']").trigger("focus");
                }
            }
                            
            function validateDOB(resour){
            
                var checkId = resour.getAttribute("id");
                var onCheckRole = 'PH';
                if(checkId.indexOf("PI") >= 0 )  onCheckRole = 'PI';
                if(checkId.indexOf("CH1") >= 0 )  onCheckRole = 'CH1';
                if(checkId.indexOf("CH2") >= 0 )  onCheckRole = 'CH2';
                if(checkId.indexOf("CH3") >= 0 )  onCheckRole = 'CH3';
                
                var day = $("input[id*='Val-DOB-Day-" + onCheckRole + "']").val();
                console.log(day);
                var month = $("input[id*='Val-DOB-Month-" + onCheckRole + "']").val();
                console.log(month);
                var year = $("input[id*='Val-DOB-Year-" + onCheckRole + "']").val();
                console.log(year);
                
                if(day!='' && month!='' && year!='' ){
                    if(day==0 || day>31){
                         return false;
                    }
                    
                    if(month==2){
                        if(day>29) return false;
                        if(day == 29){
                            console.log('Feb'+year%4);
                            if(year%4!=0) return false;
                        }
                    }
                    
                    if(month==4 || month==6 || month==9 || month==11){
                        if(day>30) return false;
                    }
                    
                    if(month==0 || month>12){
                         return false;
                    }
                                        
                    var adate=new Date(year,month-1,day);   
                    console.log('adate '+adate);
                    var thedate=new Date();
                    console.log('thedate '+thedate);
                    
                    var nowYear=thedate.getFullYear();
                    var nowMonth=thedate.getMonth()+1;
                    var nowday=thedate.getDate();
                    
                    if(year<1900 || year>nowYear){
                         return false;
                    }
                    
                    var age=nowYear-year;
                    if(nowMonth<=month){
                        if(nowMonth==month){
                            if(nowday<day){
                                age--;
                                
                            }
                        }else{
                            age--;
                        }
                    }
                    console.log(age);
                    var dis=thedate-adate;
                    var vday = parseInt(dis/1000 / 3600 / 24);
                    if(vday>=0){
                        vday++;
                    }
                    console.log('vday'+vday);
                    console.log('onCheckRole'+onCheckRole );
                    if(onCheckRole == 'PH' || onCheckRole == 'PI'){    
                        /* add one condition for wonder wonman ({!txn.Basic_Plan_Code__c == 'LPC'} && age > 65)*/
                        if(age<18 || age>75 || ({!txn.Basic_Plan_Code__c == 'LPC'} && age > 65)){
                                console.log("age<18");
                                return false;
                            
                        }
                    } else{
                        
                        if((vday<15&&vday>0) || vday<=0){
                            console.log('less than 15 or 0');
                            return false;
                        }else if((age>=18&&age!=nowYear) || age<0){
                            console.log("age>=18 or less than 0");
                            return false;
                        }
                    }
                }
                return true;
            }
                             
            jQuery.extend(jQuery.validator.messages, {
                    required: "{!$Label.ESales_Required_Field_Error_Message}"
            });

            jQuery.validator.addMethod("validateDOB", function(value, element) {
                   return validateDOB(element);
            }, "{!$Label.ESales_Invalid_DOB}");
            jQuery.validator.addMethod("validateAge", function(value, element) {
                   return checkage(element);
            }, "{!$Label.ESales_under_18_years_or_beyond_15_days}");
            jQuery.validator.addMethod("validateAgeBig", function(value, element) {
                   return checkageBig(element);
            }, "{!$Label.ESales_You_must_be_18_or_above}");


            $("form[id*='frmApplication']").validate({
                ignore: ':hidden:not(.cigna-validation)'
            });
            jQuery.validator.addMethod("emailStrict", function(value, element) {
                return this.optional(element) || Cigna.ValidationUtil.isValidEmail(value);
            }, "{!$Label.eSales_Your_Email_Address_is_invalid}");
            jQuery.validator.addMethod("isAccept", function(value, element) {
                return Cigna.ESales.checkIsAccept();
            }, "{!$Label.ESales_Terms_and_Conditions_Warning}");

            jQuery.validator.addMethod("checkChinese", function(value, element) {
                   return Cigna.ESales.checkChinese(value);
            }, "{!$Label.eSales_Cannot_input_Chinese}");
            
             //add by Davon 18/10/2017 for InsurableInterest CR start  
            jQuery.validator.addMethod("checkInsurableInterestConfirm", function(value, element) {
                   return Cigna.ESales.checkInsurableInterestConfirm(value);
            }, "{!$Label.Error_Message_InsurableInterest_Confirm_Disagree}");
            //add by Davon 18/10/2017 for InsurableInterest CR end

            jQuery.validator.addMethod("checkHKID", function(value, element) {
                   return Cigna.ESales.checkHKID(value);
            }, "{!$Label.eSales_Only_Allow_Eng_Num}");
            
            jQuery.validator.addMethod("checkContactNoLength", function(value, element) {
                   return Cigna.ESales.checkContactNoLength(value);
            }, "{!$Label.eSales_Exceed_Max_Length} 20 {!$Label.eSales_Exceed_Max_Length_2}");
            
            <apex:outputPanel rendered="{!currentStep == STEP_PERSONAL_DETAIL}" layout="none">

            jQuery.validator.addMethod("checkFirstCharacter", function(value, element) {
                   return Cigna.ESales.checkFirstCharacter(value);
            }, "{!$Label.eSales_Cannot_space_in_first_Character}");
            
            jQuery.validator.addMethod("validateLength42", function(value, element) {
                   return Cigna.ESales.validateLength(value, 42);
            }, "{!$Label.eSales_Exceed_Max_Length} 42 {!$Label.eSales_Exceed_Max_Length_2}");

            jQuery.validator.addMethod("validateLength10", function(value, element) {
                   return Cigna.ESales.validateLength(value, 10);
            }, "{!$Label.eSales_Exceed_Max_Length} 10 {!$Label.eSales_Exceed_Max_Length_2}");

            jQuery.validator.addMethod("validateLength50", function(value, element) {
                   return Cigna.ESales.validateLength(value, 50);
            }, "{!$Label.eSales_Exceed_Max_Length} 50 {!$Label.eSales_Exceed_Max_Length_2}");

            jQuery.validator.addMethod("validateLength60", function(value, element) {
                   return Cigna.ESales.validateLength(value, 60);
            }, "{!$Label.eSales_Exceed_Max_Length} 60 {!$Label.eSales_Exceed_Max_Length_2}");

            jQuery.validator.addMethod("validateLength48", function(value, element) {
                   return Cigna.ESales.validateLength(value, 48);
            }, "{!$Label.eSales_Exceed_Max_Length} 48 {!$Label.eSales_Exceed_Max_Length_2}");
            
            jQuery.validator.addMethod("validateLength15", function(value, element) {
                   return Cigna.ESales.validateLength(value, 15);
            }, "{!$Label.eSales_Exceed_Max_Length} 15 {!$Label.eSales_Exceed_Max_Length_2}");
            
            jQuery.validator.addMethod("validateLength8", function(value, element) {
                return Cigna.ESales.validateLength(value, 8);
            }, "{!$Label.eSales_Exceed_Max_Length} 8 {!$Label.eSales_Exceed_Max_Length_2}");

            // Owen_20230213_JORB299 to limit address length 40
            jQuery.validator.addMethod("validateLength40", function(value, element) {
                return Cigna.ESales.validateLength(value, 40);
            }, "{!$Label.eSales_Exceed_Max_Length} 40 {!$Label.eSales_Exceed_Max_Length_2}");
            
            // Rancho_IA_AML_Inspection_20211005
            jQuery.validator.addMethod("validateNationality", function(value, element) {
                return Cigna.ESales.checkNationality(value);
            }, "{!$Label.Sanctioned_Jurisdiction_Message_Nationality}");

            jQuery.validator.addMethod("validateCountry", function(value, element) {
                return Cigna.ESales.checkCountry(value);
            }, "{!$Label.Sanctioned_Jurisdiction_Message_Country}");

            jQuery.validator.addMethod("validateBirthPlace", function(value, element) {
                return Cigna.ESales.checkCountry(value); 
            }, "{!$Label.Sanctioned_Jurisdiction_Message_Birth_Place}");

            $("input[id$='paramInsurableInterestConfirmError']").rules("add", {
                    checkInsurableInterestConfirm : true
                });

            $("input[id*='PH-']").each(function(idx, elem){
                if (elem.id.indexOf('Address-2') > -1 || elem.id.indexOf('Address-4') > -1 ||
                    elem.id.indexOf('Address-3') > -1) {

                    $(elem).rules("add", {
                        checkChinese : true
                    });
                } else {
                    $(elem).rules("add", {
                        required: true,
                        checkChinese : true
                    });
                }
            });
            $("input[id*='PI-']").each(function(idx, elem){
                if (elem.id.indexOf('Address-1') > -1) {

                    $(elem).rules("add", {
                        required: true
                    });
                } 
            });
            
            $("select[id*='PH-']").each(function(idx, elem){
                $(elem).rules("add", {
                    required: true
                });
            });
            
            $("select[id*='PI-']").each(function(idx, elem){
                $(elem).rules("add", {
                    required: true
                });
            });

            $("input[id*='CH1-']").each(function(idx, elem){
                $(elem).rules("add", {
                    required: true,
                    checkChinese : true
                });
            });
            $("select[id*='CH1-']").each(function(idx, elem){
                $(elem).rules("add", {
                    required: true
                });
            });
            $("input[id*='CH2-']").each(function(idx, elem){
                $(elem).rules("add", {
                    required: true,
                    checkChinese : true
                });
            });
            $("select[id*='CH2-']").each(function(idx, elem){
                $(elem).rules("add", {
                    required: true
                });
            });
            $("input[id*='CH3-']").each(function(idx, elem){
                $(elem).rules("add", {
                    required: true,
                    checkChinese : true
                });
            });
            $("select[id*='CH3-']").each(function(idx, elem){
                $(elem).rules("add", {
                    required: true
                });
            });

            $("input[id*='-Firstname']").each(function(idx, elem){
                $(elem).rules("add", {
                    checkFirstCharacter : true,
                    validateLength42 : true
                });
            });
            $("input[id*='-Lastname']").each(function(idx, elem){
                $(elem).rules("add", {
                    checkFirstCharacter : true,
                    validateLength42 : true
                });
            });
            $("input[id*='-HKID']").each(function(idx, elem){
                $(elem).rules("add", {
                    
                    checkHKID : true,
                    validateLength8 : true
                });
            });
            /* 
            $("input[id*='Address-']").each(function(idx, elem){
                if (elem.id.indexOf('Address-1') > -1 || elem.id.indexOf('Address-2') > -1) {
                    $(elem).rules("add", {
                        validateLength60 : true
                    });
                } else {
                    $(elem).rules("add", {
                        validateLength48 : true
                    });
                }
            }); 
            */
            // Owen_20230213_JORB299 to limit address length 40
            $("input[id*='Address-']").each(function(idx, elem){
                $(elem).rules("add", {
                    validateLength40 : true
                });
            });
            
            $("input[id*='Relationship-with-Person-Insured']").each(function(idx, elem){
                $(elem).rules("add", {
                    validateLength10 : true
                });
            });
            
            $("input[id*='PH-Email']").rules("add", {
                emailStrict: true,
                checkChinese : true,
                validateLength50 : true
            });
            
            $("input[id*='PI-ContactNo-bk']").rules("add", {
                required: true,
                digits: true,
                checkContactNoLength : true
            });
            
            $("input[id*='PH-Email-bk2']").rules("add", {
                emailStrict: true,
                checkChinese : true,
                validateLength50 : true
            });
            
            $("input[id*='PI-Email']").rules("add", {
                emailStrict: true,
                checkChinese : true,
                validateLength50 : true
            });
            
            $("input[id*='-Height']").each(function(idx, elem){
                $(elem).rules("add", {
                    required: true,
                    digits: true,
                    min: 1,
                    max: 999
                });
            });
            
            $("input[id*='-Height1']").each(function(idx, elem){
                $(elem).rules("add", {
                    required: true,
                    digits: true,
                    min: 1,
                    max: 999
                });
            });
            
            $("input[id*='-Height2']").each(function(idx, elem){
                $(elem).rules("add", {
                    required: true,
                    digits: true,
                    min: 0,
                    max: 11
                });
            });
            
            $("input[id*='-Weight']").each(function(idx, elem){
                $(elem).rules("add", {
                    required: true,
                    digits: true,
                    min: 1,
                    max: 999
                });  
            });                     
            
            $("input[id*='PH-monthly-income']").rules("add", {
                number: true
            });
           
            $("input[id*='PH-ContactNo']").rules("add", {
                digits: true,
                checkContactNoLength : true
            });
            
            $("input[id*='PH-Day-DOB-Check']").rules("add", {
                validateDOB:true
            });
            
            $("input[id*='PI-Day-DOB-Check']").rules("add", {
                required: true,
                validateDOB:true
            });
           
            
            $("input[id*='CH1-Day-DOB-Check']").rules("add", {
                validateDOB:true
            });
            
            $("input[id*='CH2-Day-DOB-Check']").rules("add", {
                validateDOB:true
            });
            
            $("input[id*='CH3-Day-DOB-Check']").rules("add", {
                validateDOB:true
            });
            
            $("input[id*='PH-EducationLevel']").rules("add", {
                validateLength15:true
            });
            
            $("input[id*='PH-means-income']").rules("add", {
                validateLength15:true
            });

            // Rancho_IA_AML_Inspection_20211005: validate if selected area is Sanctioned Jurisdiction
            $("[id*='input-nationality']").each(function(idx, elem){
                $(elem).rules("add", {
                    validateNationality:true
                });
            });

            $("[id*='input-place-of-res']").each(function(idx, elem){
                $(elem).rules("add", {
                    validateCountry:true
                });
            });

            $("[id*='input-place-of-birth']").each(function(idx, elem){
                $(elem).rules("add", {
                    validateBirthPlace:true
                });
            });
            </apex:outputPanel>
            
            <apex:outputPanel rendered="{!currentStep == STEP_PERSONAL_DETAIL && onlyHasLife}" layout="none">
                console.log('before policy Replacement');
                $("[id*='Policy-Replacement']").each(function(idx, elem){
                    console.log('begin to add rules');
                    $(elem).rules("add", {
                        required: true
                    });
                });
                console.log('after policy Replacement');

                $("input[id$='paramReplacementDeclarationLast']").rules("add", {
                    required: true
                });

                $("input[id$='paramReplacementDeclarationNext']").rules("add", {
                    required: true
                });
                
                $("input[id$='paramInsurableInterestConfirm']").rules("add", {
                    required: true
                });
                
            </apex:outputPanel>

            <apex:outputPanel rendered="{!currentStep == STEP_UPLOADDOC}" layout="none">
                $("input[id$='hkidCertified']").rules("add", {
                    required: true
                });
            </apex:outputPanel>

            <apex:outputPanel rendered="{!currentStep == STEP_CONFIRMATION}" layout="none">
            $("input[id$='payment-mode']").rules("add", {
                required: true
            });
            
            $("input[id$='accept']").rules("add",{
                     isAccept: true
            });
            </apex:outputPanel>

            <apex:outputPanel rendered="{!currentStep == STEP_PAYMENT_METHOD}" layout="none">
            $("input[id$='paramPaymentMethod']").rules("add", {
                required: function(element) {
                    return $("input[id$='paramProvidePaymentInfo']").val() != 'No';
                }
            });
            
            
            $("input[id$='cheque-number']").rules("add", {
                required: function(element) {
                    return ($("input[id$='paramPaymentMethod']").val() == 'Cheque' && ({!txn.Basic_Plan_Code__c != 'DMB'} || ({!txn.Basic_Plan_Code__c == 'DMB'}&&{!showPremium})));
                },
                digits: true
            });
            </apex:outputPanel>
            <apex:outputPanel rendered="{!currentStep == STEP_PAYMENT_DDA}" layout="none">
            
            jQuery.validator.addMethod("checklength", function(value, element) {
                return Cigna.ESales.checkBankAcctLength();
            }, "{!$Label.eSales_bankcode_length}");

            jQuery.validator.addMethod("creditCard", function(value, element) {
                return this.optional(element) || Cigna.ValidationUtil.isValidCreditCard(value) || Cigna.ESales.isSavedCreditCardValue1(value) || Cigna.ESales.isSavedCreditCardValue(value);
            }, "{!$Label.Error_Message_Invalid_Credit_Card_No}");

            jQuery.validator.addMethod("creditExpiryDate", function(value, element) {
                   return Cigna.ESales.validateExpiryDate(element);
            }, "{!$Label.eSales_Expiry_date_not_valid}");
            
            jQuery.validator.addMethod("maskedCreditCard1", function(value, element) {
                return this.optional(element) || Cigna.ESales.isSavedCreditCardValue1(value) || /^([0-9]*)$/.test(value); 
            }, "{!$Label.Err_Msg_invalid_saved_credit_card}");
            
            jQuery.validator.addMethod("maskedCreditCard", function(value, element) {
                return this.optional(element) || Cigna.ESales.isSavedCreditCardValue(value) || /^([0-9]*)$/.test(value); 
            }, "{!$Label.Err_Msg_invalid_saved_credit_card}");
            
            $("form[id*='frmApplication'] input").each(function(idx, elem){
                if (elem.id.indexOf('bank-code') > -1 || elem.id.indexOf('branch-code') > -1 ||
                    elem.id.indexOf('bank-account-code') > -1 || elem.id.indexOf('creditCardNum1') > -1
                    || elem.id.indexOf('creditCardNum2') > -1 || elem.id.indexOf('creditCardNum3') > -1
                    || elem.id.indexOf('creditCardNum4') > -1 || elem.id.indexOf('paramCreditCardNum1') > -1
                    || elem.id.indexOf('paramCreditCardNum2') > -1 || elem.id.indexOf('paramCreditCardNum3') > -1
                    || elem.id.indexOf('paramCreditCardNum4') > -1 || elem.id.indexOf('Credit-Card-Expiry-Date') > -1
                    || elem.id.indexOf('Credit-Card-Expiry-Date1') > -1) {
                    // do nth
                } else {

                    $(elem).rules("add", {
                        required: true
                    });
                }
            });
            
            $("form[id*='frmApplication'] input[id$='card-expiry-month1']").each(function(idx, elem){
                $(elem).rules("add", {
                    digits: true,
                    minlength: 2,
                    maxlength: 2,
                    range: [01, 12]
                });
            });
            $("form[id*='frmApplication'] input[id$='card-expiry-year1']").each(function(idx, elem){
                $(elem).rules("add", {
                    digits: true,
                    minlength: 4,
                    maxlength: 4,
                    range: [1900, 2999]
                });
            });

            $("form[id*='frmApplication'] input[id$='card-expiry-month']").each(function(idx, elem){
                $(elem).rules("add", {
                    digits: true,
                    minlength: 2,
                    maxlength: 2,
                    range: [01, 12]
                });
            });
            $("form[id*='frmApplication'] input[id$='card-expiry-year']").each(function(idx, elem){
                $(elem).rules("add", {
                    digits: true,
                    minlength: 4,
                    maxlength: 4,
                    range: [1900, 2999]
                });
            });

            $("form[id*='frmApplication'] input[id$='Credit-Card-Expiry-Date']").each(function(idx, elem){
                $(elem).rules("add", {
                    creditExpiryDate : true
                });
            });
            $("form[id*='frmApplication'] input[id$='Credit-Card-Expiry-Date1']").each(function(idx, elem){
                $(elem).rules("add", {
                    creditExpiryDate : true
                });
            });

            </apex:outputPanel>
            
        </script>
        <script>
            
            if (Cigna.Util.isIOS() && Cigna.Util.isCustomerPortal() && $(window).width() < 768) {
                //CR-56_Link_20220214
                $('.bs input[type="text"], .bs input[type="tel"], .bs input[type="date"], .bs select').on("focus",function(evt){
                    if ($('#action-bar').is(':visible')) {
                        $('#action-bar').addClass('hidden-xs').removeClass('visible-xs');
                    }
                });
                
                $('.bs input[type="text"], .bs input[type="tel"], .bs input[type="date"], .bs select').on("blur",function(evt){
                    if ($('#action-bar').hasClass('hidden-xs')) {
                        $('#action-bar').addClass('visible-xs').removeClass('hidden-xs');
                    }
                });
            }
            
            if (Cigna.Util.isSalesforce1()) { 
                 $("a").attr("target","");
            }
            
            //Ray Update: For Andorid Mobile, Scroll the input field to the top
            //CR-56_Link_20220214
            if (Cigna.Util.isBrokerPortal()&& Cigna.Util.isAndroid()&& $(window).width() < 768) {
                $('.bs input[type="tel"],.bs input[type="text"],.bs textarea').on("focus",function(evt){
                    $("html, body").animate({ scrollTop: $(this).offset().top - 25 }, "fast");
                });                     
            }
            
        </script>
        </apex:outputPanel>
    </apex:outputPanel>
</apex:page>