<apex:page Controller="TMReportCBMSCampaignProgressLookupCtrl" tabStyle="User" sidebar="false" id="pageId" showHeader="false">
   <script type="text/javascript" src="{!URLFOR($Resource.DD_Demo, 'js/jquery.min.js')}"></script>
   <style>
    .outerdiv {
        background-repeat: repeat-x;
        background-position: left top;
        background: white url('/img/alohaSkin/lookup_bg.png') repeat-x;
        padding-left: 10px;
        height: 100%;
    }
     
    .innerdiv {
        background-image: url('/img/sprites/master.png');
        background-position: 0px -1202px;
        width: 32px;
        height: 32px;
    }  
    
    </style>
    <apex:form id="mainFormId">
        
        <div class="outerdiv">
            <br/>
            <input type="button" value="Close Window" style="float:right;" onclick="onClose();"/>
            <div class="innerdiv"></div>
                <div style="float: left; width: 50px; margin-top: -20px; margin-left: 40px">
                    <h1>Lookup</h1>
                </div>
                <apex:pageMessages id="msgId"/>                
            <div class="pbBody">      
                 <b>Search:&nbsp;&nbsp;</b><apex:inputText value="{!cname}" /><div class='btn' onclick="onSearch();">Search</div>
                 <!--
                <table class="list" border="0" id="tblData" cellspacing="0" cellpadding="0" style="border: #DDD 1px solid;width:50%;">
                     
                    <tr>
                        <td>
                            <b>Search:</b>
                        </td>
                        <td>
                            <apex:inputText value="{!cname}" />
                                               
                        </td> 
                                                                                      
                    </tr>
                </table>
            -->
            </div>
            <br/>
            <div class="pbBody">
                <h2 style="padding-bottom: 5px; padding-top: 5px;"> </h2>
            </div>    
            <div style="margin:0px;padding: 10px 0px 10px 0px;text-align: center;">
                <input type="button" value="OK"  onclick="fillIn();onClose();" />
            </div>  
            <apex:pageblock >
                <apex:outputPanel id="tblId">
                    <apex:pageBlockSection columns="1">
                         <apex:pageBlockTable value="{!camplist}" var="e">
                            <apex:column headerValue="" width="10%"> 
                               <input type="checkbox" class='sel' data-rid="{!e.id}" data-cname="{!e.name}"/>
                            </apex:column>

                             <apex:column headerValue="Name" width="30%"> 
                                 <span style="cursor: pointer;"  >{!e.name}</span>
                             </apex:column>
                             <apex:column headerValue="Business Partner" width="30%"> 
                                 <span >{!e.business_partner__r.name}</span>
                             </apex:column>
                             <apex:column headerValue="Campaign Code" width="20%"> 
                                 <span >{!e.campaign_code__c}</span>
                             </apex:column>
                             <apex:column headerValue="Split No." width="10%"> 
                                 <span ><apex:outputPanel rendered="{!e.Split_No__c!=null && e.Split_No__c>10}">{!e.Split_No__c}</apex:outputPanel>
                                    <apex:outputPanel rendered="{!e.Split_No__c!=null && e.Split_No__c<10}">0{!e.Split_No__c}</apex:outputPanel></span>
                             </apex:column>

                         </apex:pageBlockTable>
                    </apex:pageBlockSection>
                </apex:outputPanel>
            </apex:pageblock>
            <div style="margin:0px;padding: 0px 0px 30px 0px;text-align: center;">
                <input type="button" value="OK"  onclick="fillIn();onClose();" />
            </div>
            <apex:actionFunction name="onSearch" action="{!Search}" rerender="mainFormId "  />
        </div>
         
        <script>
            function fillIn( ){   
                var winMain1 = window.opener;
                if (null == winMain1){
                     winMain1=window.parent.opener;
                }         
                var strCName = '';
                var strCID = '';
                $(".sel").each(function(){
                    if ( $(this).prop('checked') ){                        
                        var cname = $(this).data('cname');
                        var cid = $(this).data('rid');
                        strCName += cname+';';
                        strCID += cid+';';
                    }

                });
                var cnameEle = winMain1.document.getElementById('TMReportCBMSCampaignProgressVFP:j_id3:form:j_id6:Target2'); 
                        
                var cidEle = winMain1.document.getElementById('TMReportCBMSCampaignProgressVFP:j_id3:form:j_id6:campid');    

                cnameEle.value = strCName;
                cidEle.value=strCID;    
/*
                var cname = $(obj).data('cname');
                var cnameEle = winMain1.document.getElementById('TMReportCBMSCampaignProgressVFP:j_id3:form:j_id6:Target2');     
                var cid = $(obj).data('rid');
                var cidEle = winMain1.document.getElementById('TMReportCBMSCampaignProgressVFP:j_id3:form:j_id6:campid');    
                cnameEle.value = cname;
                cidEle.value=cid;
                */

            }
            function onClose(){
              var winMain=window.opener;
              if (null==winMain)
              {
                 winMain=window.parent.opener;
              }
              winMain.closeLookupPopup();
           }          
           /*
           //To select All
           function selectAll(src){           
               if(src.checked){ 
                   $('.case').attr('checked', true);
               }else{
                   $('.case').removeAttr("checked");
               }
               fillIn();
           }
           */
        </script>
        
    </apex:form>
</apex:page>