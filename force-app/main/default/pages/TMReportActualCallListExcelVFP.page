<apex:page controller="TMReportActualCallListCtrl" contentType="txt/xml#ActualCallList.xls" cache="true" readOnly="true" id="TMReportActualCallListExcelVFP">
<apex:outputText value="{!xlsHeader}"/>
    <Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"
    xmlns:o="urn:schemas-microsoft-com:office:office"
    xmlns:x="urn:schemas-microsoft-com:office:excel"
    xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"
    xmlns:html="http://www.w3.org/TR/REC-html40">
  <Styles>
  <Style ss:ID="Default" ss:Name="Normal">
   <Alignment ss:Vertical="Bottom"/>
   <Borders/>
   <Font ss:FontName="Calibri" x:Family="Swiss" ss:Size="11" ss:Color="#000000"/>
   <Interior/>
   <NumberFormat/>
   <Protection/>
  </Style>
  <Style ss:ID="m123">
   <Alignment ss:Horizontal="Center" ss:Vertical="Top" ss:ReadingOrder="LeftToRight"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
   </Borders>
   <Font ss:FontName="Arial" x:Family="Swiss" ss:Size="9" ss:Color="#000000"/>
   <Interior/>
   <NumberFormat/>
  </Style>

<Style ss:ID="s62">
   <Borders/>
   <Font ss:FontName="Calibri" x:Family="Swiss" ss:Size="11"/>
   <Interior/>
  </Style>
  <Style ss:ID="s64">
   <Alignment ss:Vertical="Top" ss:ReadingOrder="LeftToRight" ss:WrapText="1"/>
   <Borders/>
   <Font ss:FontName="Verdana" x:Family="Swiss" ss:Size="9" ss:Color="#000000"/>
   <Interior/>
   <NumberFormat/>
  </Style>
  
  <Style ss:ID="stitle">
   <Alignment ss:Vertical="Top" ss:ReadingOrder="LeftToRight" ss:WrapText="1"/>
   <Borders/>
   <Font ss:FontName="Arial" x:Family="Swiss" ss:Size="16" ss:Color="#000000" ss:Bold="1"/>
   <Interior/>
   <NumberFormat/>
  </Style>
 </Styles>
 
 <Worksheet ss:Name="Sheet1">
   
  <Table ss:ExpandedColumnCount="60"  x:FullColumns="1"
   x:FullRows="1" ss:StyleID="s62" ss:DefaultRowHeight="14.55">
  
<!-- actual call list web view version.-->
<!--
   <Row ss:AutoFitHeight="0" ss:Height="18">
   		<Cell ss:MergeAcross="3" ss:StyleID="stitle"><Data ss:Type="String"><apex:outputText value="{0,date,yyyy}"><apex:Param value="{!targetDate}"/></apex:outputText> Overall Result</Data></Cell>
   </Row>
   <Row ss:AutoFitHeight="0"></Row>

	<Row ss:AutoFitHeight="0" ss:Height="18">
		<Cell ss:StyleID="m123"><Data ss:Type="String">Year</Data></Cell>
		<Cell ss:StyleID="m123"><Data ss:Type="String"><apex:outputText value="{0,date,yyyy}"><apex:Param value="{!targetDate}"/></apex:outputText></Data></Cell>
	</Row>
	<Row ss:AutoFitHeight="0" ss:Height="18">
		<Cell ss:StyleID="m123"><Data ss:Type="String">Data Type</Data></Cell>
		<Cell ss:StyleID="m123"><Data ss:Type="String">ALL</Data></Cell>
	</Row>
	<Row ss:AutoFitHeight="0" ss:Height="18">
		<Cell ss:StyleID="m123"><Data ss:Type="String">Channel</Data></Cell>
		<Cell ss:StyleID="m123"><Data ss:Type="String">ALL</Data></Cell>
		 <Cell  ss:StyleID="Default"><Data ss:Type="String">Print Date:  <apex:outputText value="{0,date,dd/MM/yyyy}">
        <apex:Param value="{!Now()}"/>
    	</apex:outputText></Data></Cell>
	</Row>
  -->
  <!-- actual call list reviewed version.-->
  <Row ss:AutoFitHeight="0" ss:Height="18">
     <Cell  ss:StyleID="Default"><Data ss:Type="String">Print Date:  <apex:outputText value="{0,date,dd/MM/yyyy}">
        <apex:Param value="{!Now()}"/>
      </apex:outputText></Data></Cell>
  </Row>
  -->
   
    <Row ss:AutoFitHeight="0"></Row>
<apex:variable var="mon" value="{!targetIntMonth}" />
<!-- actual call list web view version.-->
<!--
   <Row ss:AutoFitHeight="0" ss:Height="18">
   	<Cell ss:MergeDown="2" ss:StyleID="m123"><Data ss:Type="String">Base</Data></Cell>
   	<Cell ss:MergeAcross="{!targetIntMonth-1}" ss:StyleID="m123"><Data ss:Type="String"><apex:outputText value="{0,date,yyyy}"><apex:Param value="{!targetDate}"/></apex:outputText></Data></Cell>
   </Row>

   
   <Row ss:AutoFitHeight="0" ss:Height="18">
   	<Cell ss:Index="2" ss:MergeAcross="{!if(mon-1>2, 2,mon-1) }" ss:StyleID="m123"><Data ss:Type="String">Quarter 1</Data></Cell>
   	<apex:outputPanel layout="none" rendered="{!mon>3}">
   		<Cell ss:Index="5" ss:MergeAcross="{!if(mon-1>4, 2,mon-4) }" ss:StyleID="m123"><Data ss:Type="String">Quarter 2</Data></Cell>
   	</apex:outputPanel>
   	<apex:outputPanel layout="none" rendered="{!mon>6}">
   		<Cell ss:Index="8" ss:MergeAcross="{!if(mon-1>7, 2,mon-7) }" ss:StyleID="m123"><Data ss:Type="String">Quarter 3</Data></Cell>
   	</apex:outputPanel>
   	<apex:outputPanel layout="none" rendered="{!mon>9}">
   		<Cell ss:Index="11" ss:MergeAcross="{!if(mon-1>10, 2,mon-10) }" ss:StyleID="m123"><Data ss:Type="String">Quarter 4</Data></Cell>
   	</apex:outputPanel>
   </Row>
    -->
<!-- actual call list reviewed version.-->
   <Row ss:AutoFitHeight="0" ss:Height="18">
    <Cell ss:MergeDown="1" ss:StyleID="m123"><Data ss:Type="String">Base</Data></Cell>
    <Cell ss:Index="2" ss:MergeAcross="2" ss:StyleID="m123"><Data ss:Type="String">Quarter {!numOfQuarter}</Data></Cell>    
   </Row>






   <Row ss:AutoFitHeight="0" ss:Height="18">
   		<apex:variable var="mon" value="{!1}" />
   		<apex:repeat var="monText" value="{!monthList}">
   			<Cell ss:Index="{!mon+1}" ss:StyleID="m123"><Data ss:Type="String">{!monText}</Data></Cell>
   		<apex:variable var="mon" value="{!mon+1}" />
   		</apex:repeat>
   </Row>

   <Row ss:AutoFitHeight="0" ss:Height="18">
   		<Cell ss:StyleID="m123"><Data ss:Type="String">Campaign</Data></Cell>
   		<apex:repeat var="monText" value="{!monthList}">
   			<Cell ss:StyleID="m123"><Data ss:Type="String">Actual</Data></Cell>
   		</apex:repeat>
   </Row>
    <apex:repeat var="row" value="{!rowData}">
    	<Row ss:AutoFitHeight="0" ss:Height="18">
	   		<Cell ss:StyleID="m123"><Data ss:Type="String">{!row.campaign}</Data></Cell>
	   		<apex:repeat var="dist" value="{!row.CallDistributionList}">
	   			<Cell ss:StyleID="m123"><Data ss:Type="String">{!dist}</Data></Cell>
	   		</apex:repeat>
	   </Row>

 	</apex:repeat>
     </Table>
                                                            
 </Worksheet>
 
</Workbook>


</apex:page>