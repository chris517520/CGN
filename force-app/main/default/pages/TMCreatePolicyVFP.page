<apex:page standardController="Policy_Transaction__c" extensions="TMCreatePolicyCtrl"  title="New Policy" tabStyle="Opportunity" docType="html-5.0">
    <link rel="stylesheet" type="text/css" href="{!URLFOR($Resource.DD_Demo, 'css/bootstrap_ns.css')}" />
 
    <script type="text/javascript" src="{!URLFOR($Resource.DD_Demo, 'js/jquery.min.js')}"></script>
    <script type="text/javascript" src="{!URLFOR($Resource.DD_Demo, 'js/bootstrap.min.js')}"></script>
    <apex:include pageName="CignaUtilJS"/>
    <apex:includeScript value="/support/console/33.0/integration.js"/>
    <style>
        .locationError { color: red; font-weight: bold;}
        .personInsuredLabel{margin-right: 60px;}        
        .amlRisk{color:red;font-weight:1000;}
        .cigna-progress-bar {
            display: table;
            table-layout: fixed;
            width: 100%;
            border-collapse: separate;
            border-spacing: 5px;
        }
        .cigna-progress-bar-inner{
            display: table-row;
        }
        .cigna-progress-bar-inner > div {
            display: table-cell;
            border-bottom: 2px solid #D9D9D6;
            color: #D9D9D6;
            text-transform: uppercase;
            font-family: "Gotham SSm A", "Gotham SSm B", "Microsoft Jhenghei", "LiHei Pro", "Heiti TC", Arial, Helvetica, sans-serif;
            font-style: normal;
            font-weight: 400;
            text-align: center;
            vertical-align: middle;
            padding: 5px 0 5px 0;
        }
        .cigna-progress-bar {
            counter-reset: step;
        }
        .cigna-progress-bar-inner > div::before {
            counter-increment: step;
            content: counter(step) ". ";
        }
        .cigna-progress-bar-inner > div.active {
            border-bottom: 2px solid #004986;
            color: #004986;
        }
        
        input::placeholder { color:#DC143C;font-size:0.8em; }

        /*AM project coupon jack add */
         .couponSection .dataCol {
            width: 50% !important;
        } 
        /* Rancho_HKITSFDC398_20250909 - 2025Q4 CX Campaign -  */
        .discountPanel .dataCol {
            width: 50% !important;
        } 
    </style>
    
    <script type="text/javascript">
        //sforce.console.setTabTitle('New Policy');    
        
        var Cigna = Cigna || {};
        Cigna.NewPolicy = function(){
            
            function init(){
                /**
                Server.beneficiaryLevelAndRiderInitialize();
                Server.discount12Initialize();
                Server.paymentFrequencyInitialize();
                Server.paymentMethodInitialize();
                Server.bankInitialize();
                **/
                Server.pickListInitialize();
            }
            
            function nextStep(evt){
                var currentStep = $('#current-step').val();
                Server.nextStep();
            }
            
            var uwPollingId, isPolling;
            
            function setUWStatusPolling() {
                if (uwPollingId == null || typeof uwPollingId == undefined) {
                    uwPollingId = setInterval(pollUWStatus, 3000);
                }
            }
        
            function resetPollingFlag() {
                isPolling = false;
                clearUWStatusPolling();
                nextStep();
            }
            
            function clearUWStatusPolling() {
                clearInterval(uwPollingId);
                uwPollingId = null;
            }
            
            function pollUWStatus() {
                console.log('pollUWStatus...');
                if (!isPolling) {
                    isPolling = true;
                    Visualforce.remoting.Manager.invokeAction(
                        '{!$RemoteAction.TMCreatePolicyCtrl.getUWStatus}',
                        document.getElementById("application-id2").value,
                        document.getElementById("lastModifiedDate").value,
                        function(result, event){
                            if (event.status && result) {
                                resetPollingFlag();
                            } else {
                                isPolling = false;
                            }
                        }, 
                        {escape: true}
                    );
                }
            }
            
            function removeFirstCopyHodlerBtn(){
                $(".pi-copy-holder-btn").not(":first").remove();
            }
            
            function removeFirstCopyAboveBtn(){
                $("[name='above0']").hide();
                //$(".copy-Above-Bene").not(":first").remove();
                $("input[id^='aboveBtn'][id!='aboveBtn0']").hide();
                $("input[id='removeBenefitBtn0']").hide();
            }
            
            return {
                init : init,
                nextStep : nextStep,
                setUWStatusPolling : setUWStatusPolling,
                clearUWStatusPolling : clearUWStatusPolling,
                resetPollingFlag : resetPollingFlag,
                removeFirstCopyHodlerBtn : removeFirstCopyHodlerBtn,
                removeFirstCopyAboveBtn : removeFirstCopyAboveBtn
            }
        }();
    
        function navigation(){
            if('{!isSubmitted}' == 'true' || {!isAllowToRead} == true){
                sforce.console.getEnclosingPrimaryTabObjectId(function(resultA){
                    console.log('resultA',resultA);
                    var transactionId = '{!policyTransaction.id}';
                    if(transactionId.indexOf(resultA.id) >= 0){
                        sforce.console.getEnclosingPrimaryTabId(function(result){
                            sforce.console.openPrimaryTab(result.id,'/'+'{!policyTransaction.id}'+'?nooverride=1',true,'Policy Transaction Details');                        
                        });                        
                    }else{
                        sforce.console.getFocusedSubtabId(function(resultA){
                            var focusId = resultA.id;
                            sforce.console.getEnclosingPrimaryTabId(function(result){
                                sforce.console.openSubtab(result.id,'/'+'{!policyTransaction.id}'+'?nooverride=1',true,'Policy Transaction Details',focusId);
                            });
                        });                    
                    }                
                });
            }else{
                console.log('debugger');
                sforce.console.getFocusedSubtabId(function(result) {
                    sforce.console.setTabTitle('New Policy',result.id);                
                });                
            }            
        }
            
        $(function(){
            console.log('ready');
            Cigna.NewPolicy.init();             
            navigation();
        });
    
        function isAMLShow(isShow){
            //console.log(isShow);
            if(isShow=="true"){
                $("#AMLLabel").removeAttr("hidden");
                $("#AMLLabel2").removeAttr("hidden");
            }
        } 
        
        function changeStyle(){
            //step2
            if($('.businessNature')){ 
                $('.businessNature').parent().attr('colspan','3');
            }
            //every step
            if($('.required')){
                $('.required').children().each(function(){
                    if(($(this).is("input") || $(this).is("select")) && (null == $(this).prev() || "require" != $(this).prev().attr('name'))){
                        $(this).before("<div name='require' class='requiredBlock' style='left:6px;bottom:4px;top:4px'></div>");
                    }else if($(this).is("span")){
                        $(this).children().each(function(){
                            if( ($(this).is("input") || $(this).is("select")) && (null == $(this).prev() || "require" != $(this).prev().attr('name')) ){
                                $(this).before("<div name='require' class='requiredBlock' style='left:6px;bottom:4px;top:4px'></div>");
                            }
                        });
                    }
                });                              
            }
            //step4, step 6
            if($('.nullValue')){
                var reg = new RegExp("null","g");
                $('.nullValue').children().each(function(){
                    //console.log($(this).text().indexOf('null'));
                    if(null==$.trim($(this).text()) || ''==$.trim($(this).text())){
                        $(this).text('-');
                    }else if($(this).text().indexOf('null') != -1){
                        $(this).text('-'); //$(this).text().replace('null','-') .substring(0,$(this).text().length-1);
                    }                
                });
            }
            
            if($('.Unit')){//style="display:inline" margin-left: 10px;height: 20px;
                $('.Unit').parent().css('display','inline');
                $('.Unit').css('margin-left','10px');
                $('.Unit').css('height','21px');
            }
            
            if($('.number')){//style="display:inline" margin-left: 10px;
                $('.number').parent().css('display','inline');
            }
        }    
            
        function fieldValidation(isSuccessToNext){
            console.log(isSuccessToNext);
            if($('.required') && isSuccessToNext == 'false'){
                $('.required').children().each(function(){
                    if( ($(this).is("input") || $(this).is("select")) && (null == $(this).next() || 'requireLable' != $(this).next().attr("name"))  && ($(this).val() == "" || null == $(this).val())
                         && this.id.indexOf("companyAddressLookup") < 0
                    ){
                        $(this).addClass("error");
                        $(this).after('<div name="requireLable" class="errorMsg"><strong>Error:</strong> You must enter a value</div>');
                    }else if($(this).is("span")){
                        if(null != $(this).attr("id") && $(this).attr("id").indexOf("thePIEmail") >= 0 ){
                            var isNoEmailChecked = false;
                            var isEmailNull = false;
                            var emailField;                            
                            $(this).children().each(function(){
                                if($(this).is("input") && (null == $(this).next() || 'requireLable' != $(this).next().attr("name")) && $(this).attr("name").indexOf("PIEmail") >= 0 && ($(this).val() == "" || null == $(this).val()) ){
                                    isEmailNull = true;
                                    emailField = $(this);
                                }
                                if($(this).is("input") && (null == $(this).next() || 'requireLable' != $(this).next().attr("name")) && $(this).attr("name").indexOf("PIEmailCheck") >= 0 && $(this).prop('checked') == true ){
                                    isNoEmailChecked = true;
                                }
                            });
                            if(isNoEmailChecked == false && isEmailNull == true){
                                emailField.addClass("error");
                                emailField.after('<div name="requireLable" class="errorMsg"><strong>Error:</strong> You must enter a value</div>');
                            }
                        }else if(null != $(this).attr("id") && $(this).attr("id").indexOf("theEmail") >= 0 ){
                            var isNoEmailChecked = false;
                            var isEmailNull = false;
                            var emailField;                            
                            $(this).children().each(function(){
                                if($(this).is("input") && (null == $(this).next() || 'requireLable' != $(this).next().attr("name")) && $(this).attr("name").indexOf("Email") >= 0 && ($(this).val() == "" || null == $(this).val()) ){
                                    isEmailNull = true;
                                    emailField = $(this);
                                }
                                if($(this).is("input") && (null == $(this).next() || 'requireLable' != $(this).next().attr("name")) && $(this).attr("name").indexOf("EmailCheck") >= 0 && $(this).prop('checked') == true ){
                                    isNoEmailChecked = true;
                                }
                            });
                            if(isNoEmailChecked == false && isEmailNull == true){
                                emailField.addClass("error");
                                emailField.after('<div name="requireLable" class="errorMsg"><strong>Error:</strong> You must enter a value</div>');
                            }
                        }else if(null != $(this).attr("id") && ($(this).attr("id").indexOf("theWeight") >= 0 || $(this).attr("id").indexOf("theHeight") >= 0) ){
                            var oneOfIsNull = false;
                            var numberFormatError = false;
                            var unitField;
                            var inchUnitExists = false;
                            var heightUnit;
                            var heightInchVal;
                            $(this).children().each(function(){
                                if($(this).hasClass("Unit") && inchUnitExists == false){                                    
                                    unitField = $(this);
                                }
                                if($(this).hasClass('inchUnit')){
                                    unitField = $(this);
                                    inchUnitExists = true;
                                }
                                if($(this).hasClass('Unit')){
                                    heightUnit = $(this).val();
                                }
                                if($(this).hasClass('heightInchValue')){
                                    heightInchVal = $(this).val();
                                }
                                if( ($(this).is("input") || $(this).is("select")) && (null == $(this).next() || 'requireLable' != $(this).next().attr("name")) && ($(this).val() == "" || null == $(this).val()) ){
                                    oneOfIsNull = true;
                                    $(this).addClass("error");                                    
                                }else if( $(this).is("input") && (null == $(this).next() || 'numberFormat' != $(this).next().attr("name")) && String($(this).val()).indexOf('.') >= 0 ){
                                    numberFormatError = true;
                                    $(this).addClass("error");
                                }
                            });
                            if(oneOfIsNull && null != unitField){
                                if(heightUnit == 'ft'){
                                    if(heightInchVal == null || heightInchVal == '')
                                        unitField.after('<div name="requireLable" class="errorMsg"><strong>Error:</strong> You must enter a value</div>');
                                }else if(heightUnit == 'cm'){
                                    if(!(heightInchVal == null || heightInchVal == ''))
                                        unitField.after('<div name="requireLable" class="errorMsg"><strong>Error:</strong> You must enter a value</div>');
                                }
                            }else if(numberFormatError && null != unitField){
                                unitField.after('<div name="numberFormat" class="errorMsg"><strong>Error:</strong> Please enter only digits.</div>');
                            }
                        }else{
                            $(this).children().each(function(){
                                if( ($(this).is("input") || $(this).is("select")) && (null == $(this).next() || 'requireLable' != $(this).next().attr("name")) && ($(this).val() == "" || null == $(this).val()) ){
                                    if(null != $(this).attr("name") && $(this).attr("name").indexOf("PIDateOfBirth") >= 0 ){
                                        $(this).addClass("error");
                                        $(this).next().after('<div name="requireLable" class="errorMsg"><strong>Error:</strong> You must enter a value</div>')
                                    }else{
                                        $(this).addClass("error");
                                        $(this).after('<div name="requireLable" class="errorMsg"><strong>Error:</strong> You must enter a value</div>');
                                    }
                                }                            
                            });
                        }                        
                    }
                });
            }//end required validation
            /**
            if($('.number')){
                $('.number').each(function(){
                    if(null != $(this).val() && String($(this).val()).indexOf('.') >= 0 && 'requireLable' != $(this).next().attr("name")){
                        $(this).after('<div name="numberFormat" class="errorMsg"><strong>Error:</strong> Please enter only digits.</div>');
                    }
                });
            }
            **/
        }
                
        function showWarningIcon(selectedName,id,type){
            if(null!=selectedName && null!=id && null!=document.getElementById(id)){
                var label = document.createElement("lable");                        
                label.style.cssText = "color:red;font-weight:1000";
                label.innerHTML = "AML High Risk";
                label.name = "AMLLable";
                var tr = document.getElementById(id).parentNode;
                var isAML = 0;
                var checkList;
                if(type == "country"){                                
                    checkList = JSON.parse('{!countryListJson}');
                    for(var i=0;i<checkList.length;i++){
                        if(selectedName == checkList[i].Name && checkList[i].Aml_Highrisk__c == true){
                            isAML =1;
                            break;
                        }
                    }
                }else if(type == "businessNature"){
                    checkList = JSON.parse('{!businessNatureJson}');
                    for(var i=0;i<checkList.length;i++){
                        if(selectedName == checkList[i].Description__c && checkList[i].Aml_Highrisk__c == true){
                            isAML =1;
                            break;
                        }
                    }
                }
                
                if(isAML == 1){
                    var add = true;
                    var select;
                    $(tr).children().each(function(){
                        if($(this).is("select")){
                            select = $(this);
                        }
                        if('AMLLable' == $(this).attr("name")){
                            add = false;
                        }
                    });
                    
                    if(add){
                        select.after('<lable name="AMLLable" style="color: red; font-weight: 1000;">AML High Risk</lable>');
                    }
                }else{
                    $(tr).children().each(function(){
                        if('AMLLable' == $(this).attr("name")){
                            $(this).remove();
                        }
                    });
                }
            }
        }
    
        function displayAppeal(appealFromCtrl,type,piNo){
            if(type=='presales'){
                if(appealFromCtrl == 'Appeal' && null != document.getElementById("preSaleAppealYes"+piNo)){
                    document.getElementById("preSaleAppealYes"+piNo).checked = true;
                    //$("input[id='appealYes']").attr("checked",true);
                }else if(appealFromCtrl == 'Accept' && null != document.getElementById("preSaleAppealNo"+piNo).checked){
                    document.getElementById("preSaleAppealNo"+piNo).checked = true;
                    //$("input[id='appealNo']").attr("checked",true);
                }
            }else if(type == 'uwresults'){
                console.log("appealFromCtrl="+appealFromCtrl);
                console.log("piNo="+piNo);
                if(appealFromCtrl == 'Appeal'){
                    if(null != document.getElementById("uwResultAppealYes"+piNo))
                        document.getElementById("uwResultAppealYes"+piNo).checked = true;
                    if(null != document.getElementById("uwResultAppealNo"+piNo))
                        document.getElementById("uwResultAppealNo"+piNo).checked = false;
                    if(null != document.getElementById("uwResultAppealWithdraw"+piNo))
                        document.getElementById("uwResultAppealWithdraw"+piNo).checked = false;
                    //$("input[id='appealYes2']").attr("checked",true);
                }else if(appealFromCtrl == 'Accept'){
                    if(null != document.getElementById("uwResultAppealNo"+piNo))
                        document.getElementById("uwResultAppealNo"+piNo).checked = true;
                    if(null != document.getElementById("uwResultAppealYes"+piNo))
                        document.getElementById("uwResultAppealYes"+piNo).checked = false;
                    if(null != document.getElementById("uwResultAppealWithdraw"+piNo))
                        document.getElementById("uwResultAppealWithdraw"+piNo).checked = false;
                    //$("input[id='appealNo2']").attr("checked",true);
                }else if(appealFromCtrl == 'Withdrawn'){
                    if(null != document.getElementById("uwResultAppealNo"+piNo))
                        document.getElementById("uwResultAppealNo"+piNo).checked = false;
                    if(null != document.getElementById("uwResultAppealYes"+piNo))
                        document.getElementById("uwResultAppealYes"+piNo).checked = false;
                    if(null != document.getElementById("uwResultAppealWithdraw"+piNo))
                        document.getElementById("uwResultAppealWithdraw"+piNo).checked = true;
                }
            }            
        }

    
        function loading(){
            var iframe = document.getElementById("iframe"); 
            var loading = document.getElementById("loader-icon");
            iframe.style.cssText = 'position:absolute;z-index:100;';
        }
    
        function showTaxResidentWarning(selectedName,id){
            var component = document.getElementById(id);
            if(null!=selectedName && ""!=selectedName && ""!=id && null!=id && null!=component){
                //var label = document.createElement("lable");                        
                //label.style.cssText = "color:red;font-weight:600;display: block;";                
                var checkList = JSON.parse('{!countryListJson}');
                var isAML = 0;
                var tr = component.parentNode;
                for(var i=0;i<checkList.length;i++){
                    if(selectedName == checkList[i].Name && checkList[i].Crs_Ind__c == true){
                        isAML =1;
                        break;
                    }
                }
                
                var select;
                var toRemove;
                $(tr).children().each(function(){
                    if($(this).is("select")){
                        select = $(this);
                    }
                    if('CRSLable' == $(this).attr("name")){
                        toRemove = $(this);
                    }
                });
                
                if(isAML == 1){
                    if(null != toRemove){
                        toRemove.remove();
                    }
                    select.after('<lable name="CRSLable" style="color:red;font-weight:600;display: block;">Please be informed that the selected country is a CRS reportable jurisdiction.</lable>');
                    //label.innerHTML = "Please be informed that the selected country is a CRS reportable jurisdiction.";
                }else{
                    if(null != toRemove){
                        toRemove.remove();
                    }
                    select.after('<lable name="CRSLable" style="color:red;font-weight:600;display: block;">Please be informed that the selected country is NOT a CRS reportable jurisdiction. The TIN is not required.</lable>');
                    //label.innerHTML = "Please be informed that the selected country is NOT a CRS reportable jurisdiction. The TIN is not required.";
                }
            }
        }
    
        function defaultParentPIId(piIndex,prefix){
            piIndex = parseInt(piIndex) - 2;
            // console.log('defaultParentPIId() piIndex:'+piIndex);
            // console.log(prefix);
            // console.log(prefix+":PIPageBlock:theParentPIId:parentPIId");
            var parentPIId = document.getElementById(prefix+":PIPageBlock:theParentPIId:parentPIId");/* add by Jack on 2022-04-08 for project: IA AML issue fix */
            var parentPIId2 = document.getElementById(prefix+":PIPageBlock:theParentPIId2:parentPIId");/* add by Jack on 2022-04-08 for project: IA AML issue fix */
            // console.log('defaultParentPIId() parentPIId:'+parentPIId);
            // console.log('defaultParentPIId() parentPIId2:'+parentPIId2);
            if(null != parentPIId && (null == parentPIId.value || '' == parentPIId.value)){
                parentPIId.value = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.thePersonalId.personalId}").value;
            }else if(null != parentPIId2 && (null == parentPIId2.value || '' == parentPIId2.value)){
                parentPIId2.value = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.thePersonalId.personalId}").value;
            }
            
        }
        
        //Add by Manuel for VHIS products
        function defaultSpousePIId(piIndex,prefix){
            piIndex = parseInt(piIndex) - 2;
            var spousePIId = document.getElementById(prefix+":PIPageBlock:theSpousePIId:spousePIId");
            if(null != spousePIId && (null == spousePIId.value || '' == spousePIId.value)){
                spousePIId.value = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.thePersonalId.personalId}").value;
            }
        }
        
        function displayEducationInfo(value){
            var educationInfo = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theEducationInfo.educationInfo}");
            if('Others' == value){
                displayEducationInfoToCtrl();
            }else if(null != educationInfo){
                displayEducationInfoToCtrl();            
            }
        }
    
        function displayMeansOfIncomeInfo(value){
            var otherMeansOfIncome = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theMeansInfo.meansInfo}");
            if('Others' == value){
                displayOtherSourceOfFundToCtrl();
            }else if(null != otherMeansOfIncome){
                displayOtherSourceOfFundToCtrl();
            }
        }
    
        function displayPurposeOfInsurance(value){
            var otherPurIns = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theOtherPurIns.purposeOfInsuranceOthers}");
            if('Others' == value){
                displayPurposeOfInsuranceToCtrl();
            }else if(null != otherPurIns){
                displayPurposeOfInsuranceToCtrl();
            }
        }
    
        function displayOtherSourceOfFund(value){
            var otherSourceOfFund = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theOtherSourceOfFund.otherSourceOfFund}");
            if('06 - Other (Please specify)' == value){
                displayOtherSourceOfFundToCtrl();
            }else if(null != otherSourceOfFund){
                displayOtherSourceOfFundToCtrl();
            }
        }
    
        function checkIsSmoke(isSmoke,piIndex){
            
            if("yes" == isSmoke){
                document.getElementById("smokeNoRadios"+ piIndex).checked = false;
            }else if("no" == isSmoke){
                document.getElementById("smokeYesRadios"+ piIndex).checked = false;
            }
            piIndex -= 1;
            // Rancho_IA AML_20220120: add element id
            document.getElementById("{!$Component.theForm1.detail.PersonInsuredInformation.personInsuredList}:" + piIndex + ":PIPageBlock:thePISmoke:PISmoke").value = isSmoke;
        }
    
        function displaySmoke(isSmoke, piIndex){
            console.log('piIndex='+piIndex);
            piIndex -= 1;
            var piIndex2 = piIndex -1;
            if("" == isSmoke && null != document.getElementById("{!$Component.theForm1.detail.PersonInsuredInformation.personInsuredList}:" + piIndex2 + ":PIPageBlock:thePISmoke:PISmoke")){/* add by Jack on 2022-04-08 for project: IA AML issue fix */
                isSmoke = document.getElementById("{!$Component.theForm1.detail.PersonInsuredInformation.personInsuredList}:" + piIndex2 + ":PIPageBlock:thePISmoke:PISmoke").value;/* add by Jack on 2022-04-08 for project: IA AML issue fix */
            }
            if("yes" == isSmoke && null != document.getElementById("smokeYesRadios"+ piIndex)){
                document.getElementById("smokeYesRadios"+ piIndex).checked = true;
            }else if("no" == isSmoke && null != document.getElementById("smokeNoRadios"+ piIndex)){
                document.getElementById("smokeNoRadios"+ piIndex).checked = true;
            }
        }
    
        function hidenZero(){
            $('.hidenZero').each(function(){               
                if(this.innerText == 0 || this.innerText == '0')
                    this.innerText = '-';
            });
        }
    
        function displayInchInput(pinum, heightUnit, afterPinumIncrease){
            console.log(pinum);
            if(afterPinumIncrease){
                pinum = pinum - 2;
            }else{
                pinum = pinum - 1;
            }     
            /* add by Jack on 2022-04-08 for project: IA AML issue fix */       
            var attr = '{!$Component.theForm1.detail.PersonInsuredInformation.personInsuredList}:';
            if(null != document.getElementById(attr+ pinum +':PIPageBlock:theHeight:heightInch') && null != document.getElementById(attr+ pinum +':PIPageBlock:theHeight:heightInchUnit')){
                if(heightUnit == 'ft'){
                    document.getElementById(attr+ pinum +':PIPageBlock:theHeight:heightInch').style.cssText = 'width: 50px;margin-left: 10px;';
                    document.getElementById(attr+ pinum +':PIPageBlock:theHeight:heightInchUnit').style.cssText = 'margin-left: 10px;';
                }else{
                    document.getElementById(attr+ pinum +':PIPageBlock:theHeight:heightInch').style.cssText = 'width: 50px;margin-left: 10px;display:none;';
                    document.getElementById(attr+ pinum +':PIPageBlock:theHeight:heightInchUnit').style.cssText = 'margin-left: 10px;display:none;';
                }
            }
        }
    
        function checkBenefitCompare(isCheck,piIndex){
            
            if("yes" == isCheck){
                document.getElementById("benefitCompareNo"+ piIndex).checked = false;
            }else if("no" == isCheck){
                document.getElementById("benefitCompareYes"+ piIndex).checked = false;
            }
            piIndex -= 1;
            document.getElementById("{!$Component.theForm1.detail.PersonInsuredInformation.personInsuredList}:" + piIndex + ":PIPageBlock:thePIBenefitCompare:PIBenefitCompare").value = isCheck;/* add by Jack on 2022-04-08 for project: IA AML issue fix */
            showBMIforSpecialProduct();
        }
    
        function displayBenefitCompare(isCheck, piIndex){
            console.log('piIndex='+piIndex);
            piIndex -= 1;
            var piIndex2 = piIndex -1;
            if("" == isCheck){
                isCheck = document.getElementById("{!$Component.theForm1.detail.PersonInsuredInformation.personInsuredList}:" + piIndex2 + ":PIPageBlock:thePIBenefitCompare:PIBenefitCompare").value;/* add by Jack on 2022-04-08 for project: IA AML issue fix */
            }
            if("yes" == isCheck && null != document.getElementById("benefitCompareYes"+ piIndex)){
                document.getElementById("benefitCompareYes"+ piIndex).checked = true;
            }else if("no" == isCheck && null != document.getElementById("benefitCompareNo"+ piIndex)){
                document.getElementById("benefitCompareNo"+ piIndex).checked = true;
            }
        }
        
        //Add by Manuel for VHIS product Place of Residence handling
        function changePoR(phPoR){
            for(var i=0; i<12; i++){
                var idAttrN = "{!$Component.theForm1.detail.PersonInsuredInformation.personInsuredList}:"+i+":PIPageBlock:thePIPlaceOfResidenceVHIS:piPlaceOfResidence";/* add by Jack on 2022-04-08 for project: IA AML issue fix */
                if(document.getElementById(idAttrN)!=null){
                    document.getElementById(idAttrN).value = phPoR;
                }
            }
        }
        
      
        
        //add by haoli for tm address
        var newWin=null;
        function openSearchTab(id,name){
            var address  = $("input[id$='TMResidentialAddress']").val();
            // window.open('/apex/TMsearchAddressVFP?tmaddress='+address,'height=20,width=20,top=0,left=0,toolbar=no,menubar=no,scrollbars=yes, resizable=no,location=no, status=no');
            newWin=window.open('/apex/TMsearchAddressVFP?tmaddress='+address+'&addressId='+id+'&addressName='+name+'&type=Residential','Popup','height=500,width=600,left=100,top=100,resizable=no,scrollbars=yes,toolbar=no,status=no');
             if (window.focus) 
                  {
                   newWin.focus();
                  }
                    
                     return false;

        }

        function closeLookupPopup()
         {
            if (null!=newWin)
            {
               newWin.close();
            }  
         }

        var newWin1=null;
        function openSearchTab1(id,name){
            var address1  = $("input[id$='TMCorrespondingAddress']").val();
            // window.open('/apex/TMsearchAddressVFP?tmaddress='+address,'height=20,width=20,top=0,left=0,toolbar=no,menubar=no,scrollbars=yes, resizable=no,location=no, status=no');
            newWin1=window.open('/apex/TMsearchAddressVFP?tmaddress='+address1+'&addressId='+id+'&addressName='+name+'&type=Corresponding','Popup','height=500,width=600,left=100,top=100,resizable=no,scrollbars=yes,toolbar=no,status=no');
             if (window.focus) 
                  {
                   newWin1.focus();
                  }
                    
                     return false;

        }

        function closeLookupPopup1()
         {
            if (null!=newWin1)
            {
               newWin1.close();
            }  
         }
        //end
        
        //Nicole_20200407_CDD
        var newWin_company=null;
        function openSearchTab_company(id,name){
            var address1  = $("input[id$='companyAddress']").val();
            newWin_company=window.open('/apex/TMsearchAddressVFP?tmaddress='+address1+'&addressId='+id+'&addressName='+name+'&type=Company','Popup','height=500,width=600,left=100,top=100,resizable=no,scrollbars=yes,toolbar=no,status=no');
             if (window.focus) 
                  {
                   newWin_company.focus();
                  }
                    
                     return false;

        }

        function closeLookupPopup_company()
         {
            if (null!=newWin_company)
            {
               newWin_company.close();
            }  
         }
    
        function disablebutton(){
            debugger
            $(".btn").attr('disabled','true');
        }
        
        function enablebutton(){
            debugger
            $(".btn").removeAttr("disabled");
        }
        function autoPopulateAvailableProduct(){
            autoPopulateAvailableProduct();
        }

        <!-- Owen_20221010_JORB217 -->/* add by Jack on 2022-10-12 for project: JOBR-217 Enhance Asiamiles membership info validation */
        function displaySectionItem(){
            var phRes = document.querySelector('.PhAsiaMilesMembershipNumInput');
            // var piRes = document.querySelector('.PiAsiaMilesMembershipNumInput');
            var phTempRes = phRes.value;
            // var piTempRes = piRes.value;
            console.log('1142341' , phTempRes);
            var firstName = $('input[id$="AsiaMilesMembershipFirstNameCX"]');
            var lastName = $('input[id$="AsiaMilesMembershipLastNameCX"]');
            var firstNameLabel = $('label[for$="AsiaMilesMembershipFirstNameCX"]');
            var lastNameLabel = $('label[for$="AsiaMilesMembershipLastNameCX"]');
            if(phTempRes == '' || phTempRes == '0000000000'){
                firstName.parent().children().css('visibility','hidden');
                firstName.parent().removeAttr('class');
                lastName.parent().children().css('visibility','hidden');
                lastName.parent().removeAttr('class'); 
                firstNameLabel.css('visibility','hidden');
                lastNameLabel.css('visibility','hidden'); 
                firstName.val('');
                lastName.val('');
            }else{
                firstName.parent().children().css('visibility','visible');
                firstName.parent().attr('class','dataCol last requiredInput required');
                lastName.parent().children().css('visibility','visible');
                lastName.parent().attr('class','dataCol last requiredInput required'); 
                firstNameLabel.css('visibility','visible');
                lastNameLabel.css('visibility','visible'); 
            }
        }
        function displayPISectionItem(pinum,afterPinumIncrease){
            // var piRes = document.querySelector('.PiAsiaMilesMembershipNumInput');
            if(afterPinumIncrease){
                pinum = pinum - 2;
            }else{
                pinum = pinum - 1;
            } 
            var attr = '{!$Component.theForm1.detail.PersonInsuredInformation.personInsuredList}:';
            var amNumid = attr+pinum+':PIPageBlock:theAsiaMilesMembershipNumCX:AsiaMilesMembershipNumCXpi';
            console.log('amNumid',amNumid);
            var piRes = $('input[id="'+amNumid+'"]');
            var piTempRes = piRes.val();
            console.log('piTempRes',piTempRes);
            var amfirstNameid = attr+pinum+':PIPageBlock:theAsiaMilesMembershipFirstNameCX:AsiaMilesMembershipFirstNameCXpi';
            var amlastNameid = attr+pinum+':PIPageBlock:theAsiaMilesMembershipLastNameCX:AsiaMilesMembershipLastNameCXpi';
            var firstName = $('input[id="'+amfirstNameid+'"]');
            var lastName = $('input[id="'+amlastNameid+'"]');
            var firstNameLabel = $('label[for="'+amfirstNameid+'"]');;
            var lastNameLabel = $('label[for="'+amlastNameid+'"]');
            if(piTempRes == '' || piTempRes == '0000000000'){
                console.log('empty pi num');
                firstName.parent().children().css('visibility','hidden');
                firstName.parent().removeAttr('class');
                lastName.parent().children().css('visibility','hidden');
                lastName.parent().removeAttr('class'); 
                firstNameLabel.css('visibility','hidden');
                lastNameLabel.css('visibility','hidden'); 
                firstName.val('');
                lastName.val('');
            }else{
                firstName.parent().children().css('visibility','visible');
                firstName.parent().attr('class','dataCol last requiredInput required');
                lastName.parent().children().css('visibility','visible');
                lastName.parent().attr('class','dataCol last requiredInput required'); 
                firstNameLabel.css('visibility','visible');
                lastNameLabel.css('visibility','visible'); 
            }
        }
    </script>
    
    <div class="container">
    <apex:outputPanel id="theWholePagePanel">
        <apex:outputPanel styleClass="cigna-progress-bar" layout="block" id="progress-bar" rendered="{!isSubmitted != true && isAllowToRead == false}">
            <div class="cigna-progress-bar-inner">
                <div style="font-weight:bold" class="{!IF(currentStep == 1, 'active', '')}">{!$Label.TM_Create_Policy_Step_1_POLICY_INFORMATION}</div>
                <div style="font-weight:bold" class="{!IF(currentStep == 2, 'active', '')}">{!$Label.TM_Create_Policy_Step_2_PH_PI_INFORMATION}</div>
                <div style="font-weight:bold" class="{!IF(currentStep == 3, 'active', '')}">{!$Label.TM_Create_Policy_Step_3_BENEFICIARY_INFORMATION}</div>
                <div style="font-weight:bold" class="{!IF(currentStep == 4 || currentStep == 5, 'active', '')}">{!$Label.TM_Create_Policy_Step_4_UW_INFORMATION}</div>
                <div style="font-weight:bold" class="{!IF(currentStep == 6, 'active', '')}">{!$Label.TM_Create_Policy_Step_5_CONFIRMATION_PAYMENT}</div>
            </div>
        </apex:outputPanel>
         
        <apex:form id="theForm1">
            <apex:actionStatus id="loader-icon">
                <apex:facet name="start">
                    <div style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; opacity: 0.25; z-index: 1000; background-color: black;">
                        
                    </div>
                    <div style="position: fixed; left: 0; top: 0; bottom: 0; right: 0; z-index: 1001; margin: 15% 48%">
                        <div style="display: inline-block; padding: 2px; background-color: #fff; width: 125px;">
                            <img src="/img/loading.gif" style="float: left; margin: 8px;" />
                            <span style="display: inline-block; padding: 10px 0px;">Please Wait...</span>
                        </div>
                    </div>
                </apex:facet>
            </apex:actionStatus>
            
<!----------------------------------------------------actionFunction-------------------------------------------------->
                        <!-- add by Hao Li for TM address -->
            <apex:actionFunction name="TMResidentialAddressChange" action="{!TMResidentialAddressChange}" reRender="ResidentialAddress2,ResidentialAddress3,ResidentialAddress4"/>
           <apex:actionFunction name="TMCorrespondingAddressChange" action="{!TMCorrespondingAddressChange}" reRender="correspondingAddress2,correspondingAddress3,correspondingAddress4"/>
           <!-- end -->
           
            <!--Nicole_20200407_CDD-->
            <apex:actionFunction name="companyAddressChange" action="{!companyAddressChange}" status="loader-icon" reRender="companyAddress1Panel,companyAddress2Panel,companyAddress3Panel,companyAddress4Panel"/>                                   
            <apex:actionFunction name="onJobTitleChange" action="{!onJobTitleChange}" status="loader-icon" reRender="theWholePagePanel" />
            <apex:actionFunction name="onLCAssessedChange" status="loader-icon" reRender="theWholePagePanel" />
            <apex:actionFunction name="onChangeMissingCDD" action="{!onchangeMissingCDD}" status="loader-icon" reRender="theWholePagePanel" />
            
            <apex:actionFunction name="nextStep" action="{!nextStep}" namespace="Server" status="loader-icon" reRender="theWholePagePanel" oncomplete="fieldValidation('{!canSave}')"/>
            
            <apex:actionFunction name="previousStep" action="{!previousStep}" namespace="Server" status="loader-icon" reRender="theWholePagePanel" />
            
            <apex:actionFunction name="backToPaymentStatus" action="{!backToPaymentStatus}" status="loader-icon" reRender="theWholePagePanel"></apex:actionFunction>
            <!--            
            <apex:actionFunction name="AppealToCtrl" action="{!updateAppeal}" reRender="theUWInformation">
                <apex:param name="isCheckAppeal" value="" assignTo="{!isCheckAppeal}"/>
            </apex:actionFunction>
            
            <apex:actionFunction name="AppealToCtrl2" action="{!updateAppeal2}" reRender="theConfirmationPayment">
                <apex:param name="isCheckAppeal2" value="" assignTo="{!isCheckAppeal2}"/>
            </apex:actionFunction>
            -->
            <apex:actionFunction name="addBeneficiaryToCtrl" action="{!addBenefit}" reRender="BeneficiaryInformation" oncomplete="hideFirstCopyAboveButton();" status="loader-icon">
                <apex:param name="benefitId" value="" assignTo="{!selectedPINoBNNum}"/>
            </apex:actionFunction>
            
            <apex:actionFunction name="removeBeneficiaryToCtrl" action="{!removeBenefit}" reRender="BeneficiaryInformation" oncomplete="hideFirstCopyAboveButton();" status="loader-icon">
                <apex:param name="selectedPIAndBN" value="" assignTo="{!selectedPINoBNNum}"/>
            </apex:actionFunction>
            
            <!-- oncomplete="getPaymentPremium()" -->
            <apex:actionRegion >
                <apex:actionFunction name="pickListInitialize" action="{!pickListInitialize}" namespace="Server" status="loader-icon" rerender="detail" />
            </apex:actionRegion>
            <!-- TM Work from home: 09042020 -->
            <apex:actionFunction name="getPaymentPremium" action="{!getPaymentPremium}" rerender="discountSection,thePremuimTabel,thePaymentInfo,theBankRelatedField,theCreditCardField,submitButton,refreshButton,couponPannel" status="loader-icon" /><!-- AM project coupon jack add rerender Coupon Pannel -->
                                                                                                                                
            <!--<apex:actionFunction name="presales" action="{!preSalesOnPage}" rerender="detail" status="loader-icon" oncomplete="UWPresalesComplete()"/>-->            
            
            <apex:actionFunction name="copyAboveBene" action="{!copyAboveBeneficiary}" reRender="BeneficiaryInformation">
                <apex:param name="PINoOfStep3" value="" assignTo="{!PINoOfStep3}"/>
            </apex:actionFunction>
            
            <apex:actionFunction name="displayCompanyPositon" action="{!displayCompanyPosition}" reRender="policyHolderInformation" >
                <apex:param name="selectedBusinessNature" value="" assignTo="{!selectedBusinessNature}"/>
            </apex:actionFunction>
            <!-- AM project coupon jack add Coupon Pannel -->
            <apex:actionFunction name="deleteCoupon" action="{!deleteCoupon}" reRender="couponPannel,pageMessage,paymentInfoPanel" status="loader-icon" >
                <apex:param value="" name="policyId"/>
                <apex:param value="" name="couponNumber"/>
            </apex:actionFunction>
                
            <apex:actionFunction name="displayEducationInfoToCtrl" action="{!displayEducationInfo}" reRender="policyHolderInformation" />
            
            <apex:actionFunction name="displayMeansOfIncomeInfoToCtrl" action="{!displayMeansOfIncomeInfo}" reRender="policyHolderInformation" />
        
            <apex:actionFunction name="displayPIResidenceAddIdToCtrl" action="{!displayPIResidenceAddId}" reRender="PersonInsuredInformation" />
            
            <apex:actionFunction name="displayPurposeOfInsuranceToCtrl" action="{!displayPurposeOfInsurance}" reRender="policyHolderInformation" />
            
            <apex:actionFunction name="displayOtherSourceOfFundToCtrl" action="{!displayOtherSourceOfFund}" reRender="policyHolderInformation" />
            
            <apex:actionFunction name="displayAppealForPresalesToCtrl" action="{!displayAppealForPresales}" reRender="actionButton"/>
            
            <apex:actionFunction name="autoCalculateAgeToCtrl" action="{!autoCalculateAge}" reRender="PersonInsuredInformation" status="loader-icon" oncomplete="showBMIforSpecialProduct()"/>
            
            <apex:actionFunction name="autoGenerateInsureType" action="{!autoGenerateInsureType}" reRender="PersonInsuredInformation" status="loader-icon" oncomplete="showBMIforSpecialProduct()"/>
            
            <apex:actionFunction name="autoCalculatePHAgeToCtrl" action="{!autoCalculatePHAge}" reRender="PHAge" status="loader-icon" />
            
            <apex:actionFunction name="selectUWAppeal" action="{!selectUWAppeal}" reRender="paymentInfoPanel,theConfirmationPayment" status="loader-icon"/>
            
            <!-- ADD by andy for credit card function begin-->
            <!-- TM work from home: 090420201 -->
            <apex:actionFunction name="editBankNumber" action="{!editBankNumber}" reRender="theBankRelatedField, refreshButton" status="loader-icon"/>
            <!-- TM work from home: 090420201 -->
            <apex:actionFunction name="editCrerditCardNumber" action="{!editCrerditCardNumber}" reRender="theCreditCardField, refreshButton" status="loader-icon"/>
            <!-- ADD by andy for credit card function end-->
            
            <!-- ADD by andy for remove invalid PI function begin-->
            <apex:actionFunction name="removePI" action="{!removeInvalidPI}" reRender="theConfirmationPayment"  status="loader-icon">
                <apex:param name="removePolicyNo" value="" assignTo="{!removePolicyNumber}"/>
            </apex:actionFunction>
            <apex:actionFunction name="cancelRemovePI" action="{!cancelRemoveInvalidPI}" reRender="theConfirmationPayment"  status="loader-icon">
                <apex:param name="cancelRemovePolicyNo" value="" assignTo="{!cancelRemovePolicyNumber}"/>
            </apex:actionFunction>
            <!-- ADD by andy for remove invalid PI function end-->
            
            <!--Add by kermit for special product BMI change-->
            <apex:actionFunction name="showBMIforSpecialProduct" action="{!showBMIforSpecialProduct}" reRender="PersonInsuredInformation" status="loader-icon">
            </apex:actionFunction>
            <!--Add by kermit for special product BMI change end-->
            
            <!--DO NOT DEPLOY-->
            <!-- <apex:actionFunction name="createTestCase" action="{!createTestCase}" status="loader-icon" reRender="theWholePagePanel" oncomplete="Server.pickListInitialize()"/> -->
            
            <!--Add by jack for JR1829-->
            <apex:actionFunction name="refreshEvent" rerender="PersonInsuredInformation" status="loader-icon"/>
                        
            <!--Add by jack for JR1641-->
            <apex:actionFunction name="detectCorAddressChange" action="{!detectCorAddressChange}" status="loader-icon"></apex:actionFunction>
            
            <apex:actionFunction action="{!save}" name="save" namespace="Server" reRender="theWholePagePanel" oncomplete="enablebutton();"></apex:actionFunction>
            
            <!--TM Work From Home_20200827-->
            <apex:actionFunction action="{!refreshPaymentInformation}" name="refreshPaymentInformation" namespace="Server" reRender="theBankRelatedField,theCreditCardField" status="loader-icon" />
                      
            <!-- <apex:actionFunction action="{!onCheckIsGA}" name="onCheckIsGA" reRender="PersonInsuredInformation" status="loader-icon"/> -->
            <apex:actionFunction action="{!autoPopulateAvailableProduct}" name="autoPopulateAvailableProduct" reRender="availPro" status="loader-icon"/>
<!----------------------------------------------------actionFunction---------------------------------------------------->
            
            <input type="hidden" id="current-step" value="{!currentStep}" />
            
            <apex:pageBlock rendered="{!currentStep == 0}">
                <apex:pageblockSection collapsible="false" columns="1" >
                    {!$Label.TM_NO_PERMISSION_TO_CREATE_POLICY}
                </apex:pageblockSection>
            </apex:pageBlock>
            
            <apex:pageBlock rendered="{!currentStep == -1}">
                <apex:pageMessages /> 
            </apex:pageBlock>
            
            <apex:pageBlock rendered="{!newPolicy.Unexpected__c}">
                <apex:pageMessage strength="2" severity="warning" title="This Policy {!newPolicy.Policy_No__c} Transaction is created unexpectedly" summary="Please ignore it"></apex:pageMessage>
            </apex:pageBlock>
            
            <apex:pageBlock mode="detail" id="detail" rendered="{!IF(currentStep > 0 && isSubmitted != true && isAllowToRead == false, true, false)}">
                <apex:input id="toSaveTaxNum" style="display:none"/>
                <apex:pageMessages id="pageMessage" />
                <apex:pageBlockButtons location="bottom" >
                    <apex:outputPanel rendered="{!IF(currentStep > 1 && currentStep!=5, true, false)}">
                        <input class="btn" type="button" value="Back" name="Back" onclick="Server.previousStep()" />
                    </apex:outputPanel>
                    <!--<apex:commandButton value="Save" action="{!save}" rendered="{!IF(currentStep == 5,false,true) }" reRender="theWholePagePanel"/>-->
                    <apex:outputPanel id="saveButton">
                        <apex:outputPanel rendered="{!IF(currentStep == 5,false,true) }">
                            <input class="btn" type="button" value="Save" name="Save" onclick="Server.save();disablebutton();"/>
                        </apex:outputPanel>
                    </apex:outputPanel>
                    <apex:outputPanel id="actionButton">
                        <apex:outputPanel rendered="{!IF(currentStep < 6 && currentStep!=5 && isWSError == false && !newPolicy.Unexpected__c, true, false)}">
                            <input class="btn" type="button" value="Next" name="Next" onclick="Server.nextStep()" />
                        </apex:outputPanel>
                    </apex:outputPanel>
                    <apex:outputPanel id="submitButton">
                        <apex:outputPanel rendered="{!currentStep == 6 && isPaymentButtonClicked == true}">
                            <input class="btn" type="button" value="Submit" name="Submit" onclick="Server.nextStep()" />
                        </apex:outputPanel>
                    </apex:outputPanel>
                    <apex:outputPanel rendered="{!IF(currentStep == 6 && isComplete == true, true, false)}">
                        <input class="btn" type="button" value="Cancel" name="Cancel" onclick="backToPaymentStatus()" />                    
                    </apex:outputPanel>
                    <!--<apex:outputPanel id="testCaseButton">
                        <apex:outputPanel rendered="{!IF(currentStep == 1,true,false)}">
                            <input class="btn" type="button" value="Test" name="Test" onclick="createTestCase()" />
                        </apex:outputPanel>
                    </apex:outputPanel>-->
                </apex:pageBlockButtons>
    <!-- Product Information -->
                <apex:pageblockSection title="{!$Label.TM_Product_Information}" collapsible="false" columns="1" rendered="{!currentStep == 1}">
                     
                    <apex:pageblockSectionItem dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Product_Name__c.Label}" for="productLookup"></apex:outputLabel>
                        <apex:selectList size="1" value="{!newPolicy.Product__c}" multiselect="false" required="true" >
                            <apex:selectOptions value="{!productOptions}"/>
                            <apex:actionSupport event="onchange" action="{!onProductChange}" rerender="productCode,policyReplacement" status="loader-icon" oncomplete="Cigna.NewPolicy.init()"/><!-- add rerender by jack for policy replacement -->
                        </apex:selectList>
                    </apex:pageblockSectionItem>
                    <apex:pageblockSectionItem >
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Product_Code__c.Label}" for="productCode"></apex:outputLabel>
                        <apex:outputText value="{!newPolicy.Product_Code__c}" id="productCode"></apex:outputText> 
                    </apex:pageblockSectionItem>  
                    <!--GL31 TOVID ADD -->
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="{!$ObjectType.Opportunity.Fields.Assessment_Question_1__c.Label}" for="question1"></apex:outputLabel>
                        <apex:outputText value="{!opp.Assessment_Question_1__c}"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="{!$ObjectType.Policy_Transaction__c.Fields.Objectives_Question__c.Label}" for="question1"></apex:outputLabel>
                        <apex:inputField value="{!policyTransaction.Objectives_Question__c}" onchange="autoPopulateAvailableProduct();" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="{!$ObjectType.Opportunity.Fields.Assessment_Questoin_2__c.Label}" for="question1"></apex:outputLabel>
                        <apex:outputText value="{!opp.Assessment_Questoin_2__c}"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="{!$ObjectType.Policy_Transaction__c.Fields.Which_type_s_of_medical_insurance__c.Label}" for="question2"></apex:outputLabel>
                        <apex:inputField value="{!policyTransaction.Which_type_s_of_medical_insurance__c}" onchange="autoPopulateAvailableProduct();" />
                    </apex:pageBlockSectionItem>    
                    <!-- GL31 jack add -->
                    <apex:pageblockSectionItem >
                        <apex:outputLabel value="{!$ObjectType.Policy_Transaction__c.Fields.Available_Product_Name_For_Assessment__c.Label}" for="availPro"></apex:outputLabel>
                        <apex:outputField value="{!policyTransaction.Available_Product_Name_For_Assessment__c}" id="availPro"></apex:outputField>
                    </apex:pageblockSectionItem>                  
                    <apex:pageblockSectionItem >
                        <apex:outputLabel value="{!$Label.TM_Number_of_Person_Insured}" for="numberOfPI"></apex:outputLabel>
                        <apex:selectList size="1" value="{!amountOfPI}" multiselect="false" required="true">
                            <apex:selectOptions value="{!amountOfPIOptions}"/>
                            <apex:actionSupport event="onchange" action="{!onAmountOfPIChange}" rerender="detail" status="loader-icon"/>
                        </apex:selectList>
                    </apex:pageblockSectionItem>
                    
                    <!-- 20200427 - minghua - PolicyReplacement -->
                    <apex:pageBlockSectionItem rendered="{!showPolicyReplacement}" dataStyleClass="requiredInput required" id="policyReplacement">
                    <!--<apex:pageBlockSectionItem dataStyleClass="requiredInput required"> -->
                        <apex:outputLabel value="{!transField['policyRTM'][$Label.Header_Language_Code_Current]}" for="PolicyReplacement"></apex:outputLabel>
                        <apex:inputField value="{!policyTransaction.PolicyReplacement__c}" styleClass="bs form-field-style-select" id="PolicyReplacement" />
                    </apex:pageBlockSectionItem>
                    
                    <script type="text/javascript">
                        changeStyle();
                    </script>
                </apex:pageblockSection>
                
    <!-- Policy Holder Information -->
                <apex:pageblockSection title="{!selectedProduct.Name}" collapsible="false" columns="2" rendered="{!currentStep == 2}">
                </apex:pageblockSection>
                <apex:pageblockSection title="{!$Label.TM_Policy_Holder_Information}" collapsible="false" columns="2" rendered="{!currentStep == 2}" id="policyHolderInformation">
                    <apex:pageblockSectionItem id="theFirstName" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Policy_Holder_First_Name__c.Label}" for="policyHolderFirstName"></apex:outputLabel>
                        <apex:inputField id="policyHolderFirstName" value="{!newPolicy.Policy_Holder_First_Name__c}"/>
                    </apex:pageblockSectionItem>
                    <apex:pageblockSectionItem id="theLastName" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Policy_Holder_Last_Name__c.Label}" for="policyHolderLastName"></apex:outputLabel>
                        <apex:inputField id="policyHolderLastName" value="{!newPolicy.Policy_Holder_Last_Name__c}" ></apex:inputField>
                    </apex:pageblockSectionItem>
                    <!--
                    <apex:pageblockSectionItem id="theChiName" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Policy_Holder_Name_Chi__c.Label}" for="policyHolderNameChi"></apex:outputLabel>
                        <apex:inputField id="policyHolderNameChi" value="{!newPolicy.Policy_Holder_Name_Chi__c}" ></apex:inputField>
                    </apex:pageblockSectionItem>
                    -->
                    <!-- comment by Andy
                    <apex:pageblockSectionItem id="theRelationShip" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Relationship__c.Label}" for="relationship"></apex:outputLabel>
                        <apex:inputField id="relationship" value="{!newPolicy.Relationship__c}"></apex:inputField>
                    </apex:pageblockSectionItem>  
                    -->
                    <!-- comment by Jack for 
                     to move the empty block
                    <apex:pageblockSectionItem >
                    </apex:pageblockSectionItem-->
                    <apex:pageBlockSectionItem id="theGender" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Gender__c.Label}" for="gender"></apex:outputLabel>
                        <apex:inputField id="gender" value="{!newPolicy.Gender__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    
                    <!-- Change rendered by Jack JR1641 -->
                    <apex:pageBlockSectionItem id="theNationality" dataStyleClass="requiredInput required"><!-- add by Jack on 2021-12-14 for project: IA AML nationality mandatory -->
                    <!-- <apex:pageBlockSectionItem id="theNationality" rendered="{!isShow == 1 || newPolicy.Product_Code__c == '@NELG' || newPolicy.Product_Code__c == '@NESG'}" dataStyleClass="{!IF(isShow == 1,'requiredInput required','')}"> -->
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Nationality__c.Label}" for="nationality"></apex:outputLabel>
                        <apex:inputField id="nationality" value="{!newPolicy.Nationality__c}" onchange="showWarningIcon(this.value,this.id,'country')"></apex:inputField>                        
                    </apex:pageBlockSectionItem>
                    
                    <!--Nicole_20200408_CDD-->
                    <apex:pageBlockSectionItem id="themissingCDDInfo" rendered="{!IF(isShow == 1, true, false)}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Missing_CDD_Info__c.Label}" for="missingCDDInfo"></apex:outputLabel>
                        <apex:inputField id="missingCDDInfo" value="{!newPolicy.Missing_CDD_Info__c}" onchange="onChangeMissingCDD();"></apex:inputField>
                    </apex:pageBlockSectionItem>
                    
                    <!--
                    <apex:pageBlockSectionItem id="thePlaceOfBirth1" rendered="{!IF(isShow == 1 && isShowCRSField ==1, true, false)}" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Place_of_Birth__c.Label}" for="placeOfBirth"></apex:outputLabel>
                        <apex:inputField id="placeOfBirth" value="{!newPolicy.Place_of_Birth__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem id="thePlaceOfBirth2" rendered="{!IF(isShow == 1 && isShowCRSField !=1, true, false)}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Place_of_Birth__c.Label}" for="placeOfBirth"></apex:outputLabel>
                        <apex:inputField id="placeOfBirth" value="{!newPolicy.Place_of_Birth__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    -->
                    <!-- <apex:pageBlockSectionItem rendered="{!IF(isShow == 1 && isShowCRSField == 0, true, false)}">
                    </apex:pageBlockSectionItem> -->
                    <apex:pageBlockSectionItem id="thePlaceOfBirth" dataStyleClass="requiredInput required"><!-- add by Jack on 2021-12-14 for project: IA AML nationality mandatory -->
                    <!-- <apex:pageBlockSectionItem id="thePlaceOfBirth" rendered="{!isShowCRSField == 1}" dataStyleClass="requiredInput required"> -->
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Place_of_Birth__c.Label}" for="placeOfBirth"></apex:outputLabel>
                        <apex:inputField id="placeOfBirth" value="{!newPolicy.Place_of_Birth__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <!-- <apex:pageBlockSectionItem rendered="{!IF(isShow == 0 && isShowCRSField == 1, true, false)}"> -->
                    <apex:pageBlockSectionItem >
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem id="theDateOfBirth" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Date_of_Birth__c.Label}" for="dateOfBirth"></apex:outputLabel>
                        <apex:inputField id="dateOfBirth" value="{!newPolicy.Date_of_Birth__c}" onchange="autoCalculatePHAgeToCtrl()"></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem id="thePHAge">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Age__c.Label}" for="PHAge"></apex:outputLabel>
                        <apex:outputText id="PHAge" value="{!newPolicy.Age__c}" ></apex:outputText>
                    </apex:pageBlockSectionItem>               
                    <apex:pageBlockSectionItem id="thePersonalId" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Personal_ID__c.Label}" for="personalId"></apex:outputLabel>
                        <apex:inputField id="personalId" value="{!newPolicy.Personal_ID__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <!--
                    <apex:pageBlockSectionItem >
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.ID_Expiry_Date__c.Label}" for="idExpiryDate"></apex:outputLabel>
                        <apex:inputField id="idExpiryDate" value="{!newPolicy.ID_Expiry_Date__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    -->                    
                    <apex:pageBlockSectionItem id="theIDType" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.ID_Type__c.Label}" for="idType"></apex:outputLabel>
                        <apex:inputField id="idType" value="{!newPolicy.ID_Type__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem id="theMobilePhone" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Mobile_Phone__c.Label}" for="mobilePhone"></apex:outputLabel>
                        <apex:inputField id="mobilePhone" value="{!newPolicy.Mobile_Phone__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem id="theOfficePhone">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Office_Phone__c.Label}" for="officePhone"></apex:outputLabel>
                        <apex:inputField id="officePhone" value="{!newPolicy.Office_Phone__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>                    
                    <apex:pageBlockSectionItem id="theHomePhone">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Home_Phone__c.Label}" for="homePhone"></apex:outputLabel>
                        <apex:inputField id="homePhone" value="{!newPolicy.Home_Phone__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>  
                    <apex:pageBlockSectionItem id="theEmail" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Email__c.Label}" for="Email"></apex:outputLabel>
                        <apex:outputPanel >
                            <apex:inputField id="Email" value="{!newPolicy.Policy_Holder_Email_Address__c}" ></apex:inputField>
                            <apex:inputField id="EmailCheck" value="{!newPolicy.Is_Email_Needed__c}" ></apex:inputField>
                            <apex:outputLabel value="No Email"></apex:outputLabel>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>

                    <!--Nicole_20200408_CDD-->
                    <!--add by Jack for JR1641 to move empty block
                    <apex:pageblockSectionItem rendered="{!NOT(newPolicy.Product_Code__c == '@NELG'|| newPolicy.Product_Code__c == '@NESG')}">
                    </apex:pageblockSectionItem>-->
                    <apex:pageblockSectionItem rendered="{!IF(newPolicy.Product_Code__c != '@NELG'&& newPolicy.Product_Code__c != '@NESG' && isShow!=1, true, false)}">
                    </apex:pageblockSectionItem>

                    <!--add by hao li for tm address  -->
                    <!-- add by owen for address limit 40 ，20230213-->
                    <apex:pageBlockSectionItem >
                            <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.TM_Residential_Address__c.Label}" for="TMResidentialAddress"></apex:outputLabel>
                            <apex:outputPanel >
                                <apex:inputHidden id="TMResidentialAddressLookup" value="{!TMResidentialAddress}"/>
                                <apex:inputField id="TMResidentialAddress" value="{!newPolicy.Residential_address__c}" html-maxlength="40"/>
                                <a onclick="openSearchTab('{!$component.TMResidentialAddressLookup}','{!$component.TMResidentialAddress}');return false;" target="_top">
                                <img src="/img/s.gif" alt="TM Residential Address Lookup (New Window)" class="lookupIcon" onblur="this.className = 'lookupIcon';" onfocus="this.className = 'lookupIconOn';" onmouseout="this.className = 'lookupIcon';this.className = 'lookupIcon';" onmouseover="this.className = 'lookupIconOn';this.className = 'lookupIconOn';" title="TM Residential Address Lookup (New Window)"/>
                                </a>
                            </apex:outputPanel>   
                    </apex:pageBlockSectionItem> 
                     <apex:pageBlockSectionItem >
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.TM_Corresponding_address__c.Label}" for="TMCorrespondingAddress" ></apex:outputLabel>
                        <apex:outputPanel >
                            <apex:inputHidden id="TMCorrespondingAddressLookup" value="{!TMCorrespondingAddress}"/>
                            <apex:inputField id="TMCorrespondingAddress" value="{!newPolicy.Corresponding_address__c}" html-maxlength="40"></apex:inputField>
                            <a onclick="openSearchTab1('{!$component.TMCorrespondingAddressLookup}','{!$component.TMCorrespondingAddress}');return false;" target="_top">
                            <img src="/img/s.gif" alt="TM Corresponding Address Lookup (New Window)" class="lookupIcon" onblur="this.className = 'lookupIcon';" onfocus="this.className = 'lookupIconOn';" onmouseout="this.className = 'lookupIcon';this.className = 'lookupIcon';" onmouseover="this.className = 'lookupIconOn';this.className = 'lookupIconOn';" title="TM Corresponding Address Lookup (New Window)"/>
                            </a>
                        </apex:outputPanel>   
                    </apex:pageBlockSectionItem>
                    <!-- end -->
                    
                    <apex:pageBlockSectionItem id="theResiAdd1" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Residential_Address_1__c.Label}" for="ResidentialAddress1"></apex:outputLabel>
                        <apex:inputField id="ResidentialAddress1" value="{!newPolicy.Residential_Address_1__c}" html-maxlength="40"></apex:inputField>                            
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem id="theCorre11">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Corresponding_Address_1__c.Label}" for="correspondingAddress1"></apex:outputLabel>
                        <apex:outputPanel >
                            <apex:inputField id="correspondingAddress1" value="{!newPolicy.Corresponding_Address_1__c}" html-placeholder="only English input is allowed" html-maxlength="40"></apex:inputField>
                            <!--<apex:outputLabel value="If different from Residential Address" style="display:block;font-weight:bold;"></apex:outputLabel>-->
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    
            
                    <apex:pageBlockSectionItem id="theResiAdd2">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Residential_Address_2__c.Label}" for="ResidentialAddress2"></apex:outputLabel>
                        <apex:inputField id="ResidentialAddress2" value="{!newPolicy.Residential_Address_2__c}" html-maxlength="40"></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem id="theCorre21">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Corresponding_Address_2__c.Label}" for="correspondingAddress2"></apex:outputLabel>
                        <apex:outputPanel >
                            <apex:inputField id="correspondingAddress2" value="{!newPolicy.Corresponding_Address_2__c}" html-placeholder="only English input is allowed" html-maxlength="40"></apex:inputField>
                            <!--<apex:outputLabel value="If different from Residential Address" style="display:block;font-weight:bold;"></apex:outputLabel>-->
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    
                    <apex:pageBlockSectionItem id="theResiAdd3">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Residential_Address_3__c.Label}" for="ResidentialAddress3"></apex:outputLabel>
                        <apex:inputField id="ResidentialAddress3" value="{!newPolicy.Residential_Address_3__c}" html-maxlength="40"></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem id="theCorre31">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Corresponding_Address_3__c.Label}" for="correspondingAddress3"></apex:outputLabel>
                        <apex:outputPanel >
                            <apex:inputField id="correspondingAddress3" value="{!newPolicy.Corresponding_Address_3__c}" html-placeholder="only English input is allowed" html-maxlength="40"></apex:inputField>
                            <!--<apex:outputLabel value="If different from Residential Address" style="display:block;font-weight:bold;"></apex:outputLabel>-->
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    
                    <apex:pageBlockSectionItem id="theResiAdd4">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Residential_Address_4__c.Label}" for="ResidentialAddress4"></apex:outputLabel>
                        <apex:inputField id="ResidentialAddress4" value="{!newPolicy.Residential_Address_4__c}" html-maxlength="40"></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem id="theCorre41" >
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Corresponding_Address_4__c.Label}" for="correspondingAddress4"></apex:outputLabel>
                        <apex:outputPanel >
                            <apex:inputField id="correspondingAddress4" value="{!newPolicy.Corresponding_Address_4__c}" html-placeholder="only English input is allowed" html-maxlength="40"></apex:inputField>
                            <!--<apex:outputLabel value="If different from Residential Address" style="display:block;font-weight:bold;"></apex:outputLabel>-->
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    
                    <!-- Change dataStyleClass by Jack JR1641 -->
                    <apex:pageBlockSectionItem id="theResiCountry" dataStyleClass="requiredInput required"><!-- add by Jack on 2021-12-14 for project: IA AML nationality mandatory -->
                    <!-- <apex:pageBlockSectionItem id="theResiCountry" dataStyleClass="{!IF(newPolicy.Product_Code__c == '@NELG' || newPolicy.Product_Code__c == '@NESG',IF(isShow == 1,'requiredInput required',''),'')}"> -->
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Residential_Address_Country__c.Label}" for="ResidentialAddressCountry"></apex:outputLabel>
                        <apex:inputField id="ResidentialAddressCountry" value="{!newPolicy.Residential_Address_Country__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    
                    <apex:pageBlockSectionItem id="theCorreCountry">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Corresponding_Address_Country__c.Label}" for="correspondingAddressCountry"></apex:outputLabel>
                        <apex:inputField id="correspondingAddressCountry" value="{!newPolicy.Corresponding_Address_Country__c}" onchange="showWarningIcon(this.value,this.id,'country');detectCorAddressChange();"></apex:inputField><!--jack add onchange function for JR1641 -->                                                
                    </apex:pageBlockSectionItem>
                    
                    <!-- Add by Manuel for VHIS products place start -->
                    <!-- add by Jack on 2022-01-14 for project: IA AML -->
                    <!-- <apex:pageBlockSectionItem id="thePHPlaceOfResidenceVHIS" dataStyleClass="requiredInput required" rendered="{!IF(newPolicy.Product_Code__c=='VSTDG'||newPolicy.Product_Code__c=='VSMMG'||newPolicy.Product_Code__c=='VSUPG', true, false)}">
                        <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Place_of_Residence_picklist__c.Label}" ></apex:outputLabel>
                        <apex:inputField id="phPlaceOfResidence" value="{!newPolicy.Place_of_Residence_picklist__c}" onchange="changePoR(this.value)"></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!IF(newPolicy.Product_Code__c=='VSTDG'||newPolicy.Product_Code__c=='VSMMG'||newPolicy.Product_Code__c=='VSUPG', true, false)}">
                    </apex:pageBlockSectionItem> -->
                    <!-- add by Jack on 2022-01-14 for project: IA AML -->
                    <!-- Add by Manuel for VHIS products place stop -->
                    
                    <apex:pageBlockSectionItem rendered="{!isShow == 1}">
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!isShow == 1}">
                        <apex:outputLabel value=""></apex:outputLabel>
                        <input value="Copy Address" class="btn" onclick="copyCorrespondingAddress()" type="button" />
                    </apex:pageBlockSectionItem>
                    
                    <apex:pageBlockSectionItem id="theTaxResidence11" rendered="{!IF(isShowCRSField == 1,true,false)}" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Tax_Residence_1__c.Label}" for="taxResidence1"></apex:outputLabel>
                        <apex:inputField id="taxResidence1" value="{!newPolicy.Tax_Residence_1__c}" onChange="changeTaxNum(this.value,this.id);showTaxResidentWarning(this.value,this.id)"></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!IF(isShowCRSField == 1,true,false)}" id="theTaxNum1">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Tax_Num_1__c.Label}" for="tin1"></apex:outputLabel>
                        <apex:inputField id="tin1" value="{!newPolicy.Tax_Num_1__c}" ></apex:inputField>  
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!IF(isShowCRSField == 1,true,false)}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Tax_Residence_2__c.Label}" for="taxResidence2"></apex:outputLabel>
                        <apex:inputField id="taxResidence2" value="{!newPolicy.Tax_Residence_2__c}" onChange="changeTaxNum(this.value,this.id);showTaxResidentWarning(this.value,this.id)"></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!IF(isShowCRSField == 1,true,false)}" id="theTaxNum2">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Tax_Num_2__c.Label}" for="tin2"></apex:outputLabel>
                        <apex:inputField id="tin2" value="{!newPolicy.Tax_Num_2__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!IF(isShowCRSField == 1,true,false)}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Tax_Residence_3__c.Label}" for="taxResidence3"></apex:outputLabel>
                        <apex:inputField id="taxResidence3" value="{!newPolicy.Tax_Residence_3__c}" onChange="changeTaxNum(this.value,this.id);showTaxResidentWarning(this.value,this.id)"></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!IF(isShowCRSField == 1,true,false)}" id="theTaxNum3">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Tax_Num_3__c.Label}" for="tin3"></apex:outputLabel>
                        <apex:inputField id="tin3" value="{!newPolicy.Tax_Num_3__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    
                    <apex:pageBlockSectionItem rendered="{!isShow == 1}" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Source_of_Fund__c.Label}" for="sourceOfFund"></apex:outputLabel>
                        <apex:inputField id="sourceOfFund" value="{!newPolicy.Source_of_Fund__c}" onchange="displayOtherSourceOfFund(this.value)"></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem id="theOtherSourceOfFund" dataStyleClass="requiredInput required" rendered="{!IF(isShow == 1 && newPolicy.Source_of_Fund__c == '06 - Other (Please specify)', true, false)}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Other_Source_of_Fund__c.Label}" for="otherSourceOfFund"></apex:outputLabel>
                        <apex:inputField id="otherSourceOfFund" value="{!newPolicy.Other_Source_of_Fund__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!IF(isShow == 1 && newPolicy.Source_of_Fund__c != '06 - Other (Please specify)', true, false)}">
                    </apex:pageBlockSectionItem>
                    <!--
                    <apex:pageBlockSectionItem rendered="{!IF(isShow == 1 && IF(CONTAINS(newPolicy.Source_of_Fund__c, '06 - Other (Please specify)'), false, true), true, false)}">
                    </apex:pageBlockSectionItem>
                    -->
                    
                    <apex:pageBlockSectionItem rendered="{!isShow == 1}" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Means_of_Income__c.Label}" for="meansOfIncome"></apex:outputLabel>
                        <apex:inputField id="meansOfIncome" value="{!newPolicy.Means_of_Income__c}" onchange="displayMeansOfIncomeInfo(this.value)"></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem id="theMeansInfo" dataStyleClass="requiredInput required" rendered="{!IF(isShow == 1 && newPolicy.Means_of_Income__c == 'Others', true, false)}" >
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Means_of_Income_Additional_Information__c.Label}"></apex:outputLabel>
                        <apex:inputField id="meansInfo" value="{!newPolicy.Means_of_Income_Additional_Information__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!IF(isShow == 1 && newPolicy.Means_of_Income__c != 'Others', true, false)}">
                    </apex:pageBlockSectionItem>
                    <!--
                    <apex:pageBlockSectionItem rendered="{!IF(isShow == 1 && CONTAINS(newPolicy.Means_of_Income__c, 'Others'), false, true)}">
                    </apex:pageBlockSectionItem>
                    -->
                    
                    <apex:pageBlockSectionItem rendered="{!isShow == 1}" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Income_HKD__c.Label}"></apex:outputLabel>
                        <apex:inputField value="{!newPolicy.Income_HKD__c}"/>
                    </apex:pageBlockSectionItem>
                    <!--
                    <apex:pageBlockSectionItem rendered="{!isShow == 1 && selectedProduct.Is_AML__c == false}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Income_HKD__c.Label}"></apex:outputLabel>
                        <apex:inputField value="{!newPolicy.Income_HKD__c}"/>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!isShow == 1 && selectedProduct.Is_AML__c == true}" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Income_HKD__c.Label}"></apex:outputLabel>
                        <apex:inputField value="{!newPolicy.Income_HKD__c}"/>
                    </apex:pageBlockSectionItem>
                    -->
                    <apex:pageBlockSectionItem rendered="{!isShow == 1}">
                    </apex:pageBlockSectionItem>
                    
                    <apex:pageBlockSectionItem rendered="{!isShow == 1}" id="theBusinessNature" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Business_Nature__c.Label}" for="businessNature"></apex:outputLabel><!---->
                        <apex:inputField id="businessNature" styleClass="businessNature" value="{!newPolicy.Business_Nature__c}" onchange="displayCompanyPositon(this.value);showWarningIcon(this.value,this.id,'businessNature');"></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!isShow == 1}">
                    </apex:pageBlockSectionItem>
                    
                    <!--Nicole_20200407_CDD-->
                    <apex:pageBlockSectionItem rendered="{!IF(isIndustryEnable == true && isShow == 1, true, false)}" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Industry__c.Label}" for="industry"></apex:outputLabel>
                        <apex:inputField id="industry" value="{!newPolicy.Industry__c}"></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!IF(isIndustryEnable == true && isShow == 1, true, false)}" />
                    
                    <!--Nicole_20200407_CDD
                    <apex:pageBlockSectionItem rendered="{!IF(displayCompanyPosition == true && isShow == 1, true, false)}" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Company__c.Label}" for="company"></apex:outputLabel>
                        <apex:inputField id="company" value="{!newPolicy.Company__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!IF(displayCompanyPosition == false && isShow == 1, true, false)}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Company__c.Label}" for="company"></apex:outputLabel>
                        <apex:inputField id="company" value="{!newPolicy.Company__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>-->
                    <apex:pageBlockSectionItem id="theCompany" rendered="{!IF(isShow == 1, true, false)}" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Company__c.Label}" for="company"></apex:outputLabel>
                        <apex:inputField id="company" value="{!newPolicy.Company__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    
                    <!--Nicole_20200407_CDD
                    <apex:pageBlockSectionItem rendered="{!IF(displayCompanyPosition == true && isShow == 1, true, false)}" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Position__c.Label}" for="position"></apex:outputLabel>
                        <apex:inputField id="position" value="{!newPolicy.Position__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!IF(displayCompanyPosition == false && isShow == 1, true, false)}"> 
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Position__c.Label}" for="position"></apex:outputLabel>
                        <apex:inputField id="position" value="{!newPolicy.Position__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>-->
                    <apex:pageBlockSectionItem rendered="{!IF(isShow == 1, true, false)}" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Position__c.Label}" for="position"></apex:outputLabel>
                        <apex:selectList id="position" value="{!newPolicy.Position__c}" size="1" onChange="onJobTitleChange();">
                                <apex:selectOptions value="{!jobTitleList}"/>
                        </apex:selectList>
                    </apex:pageBlockSectionItem>
                    
                    <!--Nicole_20200407_CDD-->
                    <apex:pageBlockSectionItem rendered="{!IF(isShow == 1, true, false)}" >
                            <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Company_Address__c.Label}" for="companyAddress"></apex:outputLabel>
                            <apex:outputPanel >
                                <apex:inputHidden id="companyAddressLookup" value="{!companyAddressLookUp}"/>
                                <apex:inputText id="companyAddress" value="{!companyAddress}"/>
                                <a onclick="openSearchTab_company('{!$component.companyAddressLookup}','{!$component.companyAddress}');return false;" target="_top">
                                <img src="/img/s.gif" alt="TM Residential Address Lookup (New Window)" class="lookupIcon" onblur="this.className = 'lookupIcon';" onfocus="this.className = 'lookupIconOn';" onmouseout="this.className = 'lookupIcon';this.className = 'lookupIcon';" onmouseover="this.className = 'lookupIconOn';this.className = 'lookupIconOn';" title="TM Residential Address Lookup (New Window)"/>
                                </a>
                            </apex:outputPanel>   
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!IF(isShow == 1 && !isOtherJobEnable, true, false)}" />
                    <apex:pageBlockSectionItem rendered="{!IF(isShow == 1 && isOtherJobEnable , true, false)}" dataStyleClass="requiredInput required">
                            <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Other_Job__c.Label}" for="otherJob"></apex:outputLabel>
                            <apex:inputField id="otherJob" value="{!newPolicy.Other_Job__c}"></apex:inputField>                           
                    </apex:pageBlockSectionItem>
                    
                    <apex:pageBlockSectionItem rendered="{!IF(isShow == 1, true, false)}" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Company_Address_1__c.Label}" for="companyAddress1"></apex:outputLabel>
                        <apex:outputPanel id="companyAddress1Panel"><apex:inputField id="companyAddress1" value="{!newPolicy.Company_Address_1__c}"></apex:inputField></apex:outputPanel>                            
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!IF(isShow == 1, true, false)}" />
                    
                    <apex:pageBlockSectionItem rendered="{!IF(isShow == 1, true, false)}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Company_Address_2__c.Label}" for="companyAddress2"></apex:outputLabel>
                        <apex:outputPanel id="companyAddress2Panel"><apex:inputField id="companyAddress2" value="{!newPolicy.Company_Address_2__c}"></apex:inputField></apex:outputPanel>                             
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!IF(isShow == 1, true, false)}" />
                    
                    <apex:pageBlockSectionItem rendered="{!IF(isShow == 1, true, false)}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Company_Address_3__c.Label}" for="companyAddress3"></apex:outputLabel>
                        <apex:outputPanel id="companyAddress3Panel"><apex:inputField id="companyAddress3" value="{!newPolicy.Company_Address_3__c}"></apex:inputField></apex:outputPanel>                             
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!IF(isShow == 1, true, false)}" />
                    
                    <apex:pageBlockSectionItem rendered="{!IF(isShow == 1, true, false)}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Company_Address_4__c.Label}" for="companyAddress4"></apex:outputLabel>
                        <apex:outputPanel id="companyAddress4Panel"><apex:inputField id="companyAddress4" value="{!newPolicy.Company_Address_4__c}"></apex:inputField></apex:outputPanel>                             
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!IF(isShow == 1, true, false)}" />
                    
                    <!-- add by andy for DPSP-767 begin --><!--
                    <apex:pageBlockSectionItem rendered="{!IF(displayCompanyPosition == true && isShow == 1, true, false)}" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Company_Address_1__c.Label}" for="position"></apex:outputLabel>
                        <apex:inputField id="position" value="{!newPolicy.Company_Address_1__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!IF(displayCompanyPosition == false && isShow == 1, true, false)}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Company_Address_1__c.Label}" for="position"></apex:outputLabel>
                        <apex:inputField id="position" value="{!newPolicy.Company_Address_1__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    
                    <apex:pageBlockSectionItem rendered="{!IF(displayCompanyPosition == true && isShow == 1, true, false)}" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Company_Address_2__c.Label}" for="position"></apex:outputLabel>
                        <apex:inputField id="position" value="{!newPolicy.Company_Address_2__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!IF(displayCompanyPosition == false && isShow == 1, true, false)}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Company_Address_2__c.Label}" for="position"></apex:outputLabel>
                        <apex:inputField id="position" value="{!newPolicy.Company_Address_2__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    
                    <apex:pageBlockSectionItem rendered="{!IF(displayCompanyPosition == true && isShow == 1, true, false)}" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Company_Address_3__c.Label}" for="position"></apex:outputLabel>
                        <apex:inputField id="position" value="{!newPolicy.Company_Address_3__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!IF(displayCompanyPosition == false && isShow == 1, true, false)}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Company_Address_3__c.Label}" for="position"></apex:outputLabel>
                        <apex:inputField id="position" value="{!newPolicy.Company_Address_3__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    
                    <apex:pageBlockSectionItem rendered="{!IF(displayCompanyPosition == true && isShow == 1, true, false)}" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Company_Address_4__c.Label}" for="position"></apex:outputLabel>
                        <apex:inputField id="position" value="{!newPolicy.Company_Address_4__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!IF(displayCompanyPosition == false && isShow == 1, true, false)}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Company_Address_4__c.Label}" for="position"></apex:outputLabel>
                        <apex:inputField id="position" value="{!newPolicy.Company_Address_4__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    --><!-- add by andy for DPSP-767 end -->
                    
                    <apex:pageBlockSectionItem rendered="{!IF(displayCompanyPosition == true && isShow == 1, true, false)}" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="Company Country" for="country"></apex:outputLabel>
                        <apex:inputField id="country" value="{!newPolicy.Country__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!IF(displayCompanyPosition == false && isShow == 1, true, false)}" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="Company Country" for="country"></apex:outputLabel>
                        <apex:inputField id="country" value="{!newPolicy.Country__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                    </apex:pageBlockSectionItem>
                    
                    <apex:pageBlockSectionItem id="theEducationLevel" rendered="{!isShow == 1}" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Education_Level__c.Label}" for="educationLevel"></apex:outputLabel>
                        <apex:inputField id="educationLevel" value="{!newPolicy.Education_Level__c}" onchange="displayEducationInfo(this.value)"></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem id="theEducationInfo" dataStyleClass="requiredInput required" rendered="{!IF(isShow == 1 && newPolicy.Education_Level__c == 'Others', true, false)}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Education_Level_Additional_Information__c.Label}"></apex:outputLabel>
                        <apex:inputField id="educationInfo" value="{!newPolicy.Education_Level_Additional_Information__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!IF(isShow == 1 && newPolicy.Education_Level__c != 'Others', true, false)}">
                    </apex:pageBlockSectionItem>
                    
                    <apex:pageBlockSectionItem rendered="{!isShow == 1}" dataStyleClass="requiredInput required">                   
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Purpose_of_Insurance__c.Label}" for="purposeOfInsurance"></apex:outputLabel>
                        <apex:inputField id="purposeOfInsurance" value="{!newPolicy.Purpose_of_Insurance__c}" onchange="displayPurposeOfInsurance(this.value)"></apex:inputField>                    
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem id="theOtherPurIns" dataStyleClass="requiredInput required" rendered="{!IF(isShow == 1 && 'Others' == newPolicy.Purpose_of_Insurance__c, true, false)}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Purpose_of_Insurance_Others__c.Label}" for="purposeOfInsuranceOthers"></apex:outputLabel>
                        <apex:inputField id="purposeOfInsuranceOthers" value="{!newPolicy.Purpose_of_Insurance_Others__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!IF(isShow == 1 && 'Others' != newPolicy.Purpose_of_Insurance__c, true, false)}">
                    </apex:pageBlockSectionItem>
                    
                    
                    <!--
                    <apex:pageBlockSectionItem rendered="{!IF(displayCompanyPosition == true && isShow == 1, true, false)}" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Company_Address_1__c.Label}"></apex:outputLabel>
                        <apex:inputField value="{!newPolicy.Company_Address_1__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!IF(displayCompanyPosition == false && isShow == 1, true, false)}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Company_Address_1__c.Label}"></apex:outputLabel>
                        <apex:inputField value="{!newPolicy.Company_Address_1__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!IF(displayCompanyPosition == true && isShow == 1, true, false)}" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Company_Address_2__c.Label}"></apex:outputLabel>
                        <apex:inputField value="{!newPolicy.Company_Address_2__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!IF(displayCompanyPosition == false && isShow == 1, true, false)}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Company_Address_2__c.Label}"></apex:outputLabel>
                        <apex:inputField value="{!newPolicy.Company_Address_2__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!IF(displayCompanyPosition == true && isShow == 1, true, false)}" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Company_Address_3__c.Label}"></apex:outputLabel>
                        <apex:inputField value="{!newPolicy.Company_Address_3__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!IF(displayCompanyPosition == false && isShow == 1, true, false)}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Company_Address_3__c.Label}"></apex:outputLabel>
                        <apex:inputField value="{!newPolicy.Company_Address_3__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!IF(displayCompanyPosition == true && isShow == 1, true, false)}" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Company_Address_4__c.Label}"></apex:outputLabel>
                        <apex:inputField value="{!newPolicy.Company_Address_4__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!IF(displayCompanyPosition == false && isShow == 1, true, false)}" >
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Company_Address_4__c.Label}"></apex:outputLabel>
                        <apex:inputField value="{!newPolicy.Company_Address_4__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    -->
                    <!--
                    <apex:pageBlockSectionItem id="theTaxResidence11" rendered="{!IF(isShow == 1 && isShowCRSField != 1,true,false)}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Tax_Residence_1__c.Label}" for="taxResidence1"></apex:outputLabel>
                        <apex:inputField id="taxResidence1" value="{!newPolicy.Tax_Residence_1__c}" onChange="changeTaxNum(this.value,this.id);showTaxResidentWarning(this.value,this.id)"></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem id="theTaxResidence12" rendered="{!IF(isShow != 1 && isShowCRSField == 1,true,false)}" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Tax_Residence_1__c.Label}" for="taxResidence1"></apex:outputLabel>
                        <apex:inputField id="taxResidence1" value="{!newPolicy.Tax_Residence_1__c}" onChange="changeTaxNum(this.value,this.id);showTaxResidentWarning(this.value,this.id)"></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem id="theTaxResidence13" rendered="{!IF(isShow == 1 && isShowCRSField == 1,true,false)}" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Tax_Residence_1__c.Label}" for="taxResidence1"></apex:outputLabel>
                        <apex:inputField id="taxResidence1" value="{!newPolicy.Tax_Residence_1__c}" onChange="changeTaxNum(this.value,this.id);showTaxResidentWarning(this.value,this.id)"></apex:inputField>
                    </apex:pageBlockSectionItem>
                    -->                    
                    
                    
                    
                    <apex:pageBlockSectionItem rendered="{!isShow == 1}">
                        <apex:outputLabel value="Reason for purchasing an insurance; policy in HK (applicable to non-HK residents)" for="reasonInHK"></apex:outputLabel>
                        <apex:inputField id="reasonInHK" value="{!newPolicy.Reason_In_HK__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!IF(isShow == 1 && CONTAINS(newPolicy.Means_of_Income__c, 'Others'), true, false)}">
                    </apex:pageBlockSectionItem>
                    <!--
                    <apex:pageBlockSectionItem rendered="{!isShow == 0}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Permanent_Address_1__c.Label}" for="PermanentAddress1"></apex:outputLabel>
                        <apex:inputField id="PermanentAddress1" value="{!newPolicy.Permanent_Address_1__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!isShow == 0}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Permanent_Address_2__c.Label}" for="PermanentAddress2"></apex:outputLabel>
                        <apex:inputField id="PermanentAddress2" value="{!newPolicy.Permanent_Address_2__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!isShow == 0}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Permanent_Address_3__c.Label}" for="PermanentAddress3"></apex:outputLabel>
                        <apex:inputField id="PermanentAddress3" value="{!newPolicy.Permanent_Address_3__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!isShow == 0}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Permanent_Address_4__c.Label}" for="PermanentAddress4"></apex:outputLabel>
                        <apex:inputField id="PermanentAddress4" value="{!newPolicy.Permanent_Address_4__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!isShow == 0}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Permanent_Address_Country__c.Label}" for="PermanentAddressCountry"></apex:outputLabel>
                        <apex:inputField id="PermanentAddressCountry" value="{!newPolicy.Permanent_Address_Country__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem rendered="{!isShow == 0}">
                    </apex:pageBlockSectionItem>
                    -->
                    
                    <!-- Wellness CI -->
                    <apex:pageBlockSectionItem rendered="{!IF(newPolicy.Product_Code__c == '15R6L' || newPolicy.Product_Code__c = '25R6L' || newPolicy.Product_Code__c = '15C6L' || newPolicy.Product_Code__c = '25C6L' || newPolicy.Product_Code__c = '15C8L' || newPolicy.Product_Code__c = '25C8L' || newPolicy.Product_Code__c = '15C1L' || newPolicy.Product_Code__c = '25C1L',true,false)}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Personal_Choice_Policy_Number__c.Label}"></apex:outputLabel>
                        <apex:inputField id="personalChoicePolNo" value="{!newPolicy.Personal_Choice_Policy_Number__c}"></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <!--<apex:pageBlockSectionItem rendered="{!IF(newPolicy.Product_Code__c == '15R6L' || newPolicy.Product_Code__c = '25R6L' || newPolicy.Product_Code__c = '15C6L' || newPolicy.Product_Code__c = '25C6L' || newPolicy.Product_Code__c = '15C8L' || newPolicy.Product_Code__c = '25C8L' || newPolicy.Product_Code__c = '15C1L' || newPolicy.Product_Code__c = '25C1L',true,false)}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Cigna_Staff__c.Label}"></apex:outputLabel>
                        <apex:inputField id="cignaStaff" value="{!newPolicy.Cigna_Staff__c}"></apex:inputField>
                    </apex:pageBlockSectionItem>-->
                    <!-- Wellness CI -->

                    <!-- AM project AM info jack add -->
                    <!-- add by Jack on 2022-10-12 for project: JOBR-217 Enhance Asiamiles membership info validation -->
                    <!-- CXagent -->
                    <apex:pageBlockSectionItem id="theAsiaMilesMembershipNumCX" dataStyleClass="requiredInput required "   rendered="{!isCXagent}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Asia_Miles_Membership_Num__c.Label}" for="AsiaMilesMembershipNumCX"></apex:outputLabel>
                        <apex:inputField id="AsiaMilesMembershipNumCX" value="{!newPolicy.Asia_Miles_Membership_Num__c}" styleClass="PhAsiaMilesMembershipNumInput" onchange="displaySectionItem()"></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem id="theAsiaMilesMembershipFirstNameCX" dataStyleClass="requiredInput required " labelStyleClass="phFirstNameCX" rendered="{!isCXagent}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Asia_Miles_Membership_First_Name__c.Label}" for="AsiaMilesMembershipFirstNameCX"></apex:outputLabel>
                        <apex:inputField id="AsiaMilesMembershipFirstNameCX" value="{!newPolicy.Asia_Miles_Membership_First_Name__c}"></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem id="theAsiaMilesMembershipLastNameCX" dataStyleClass="requiredInput required" labelStyleClass="phLastNameCX" rendered="{!isCXagent}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Asia_Miles_Membership_Last_Name__c.Label}" for="AsiaMilesMembershipLastNameCX"></apex:outputLabel>
                        <apex:inputField id="AsiaMilesMembershipLastNameCX" value="{!newPolicy.Asia_Miles_Membership_Last_Name__c}"></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <!-- NOT CXagent -->
                    <apex:pageBlockSectionItem id="theAsiaMilesMembershipNum" rendered="{! !isCXagent}" >
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Asia_Miles_Membership_Num__c.Label}" for="AsiaMilesMembershipNum"></apex:outputLabel>
                        <apex:inputField id="AsiaMilesMembershipNum" value="{!newPolicy.Asia_Miles_Membership_Num__c}" ></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem id="theAsiaMilesMembershipFirstName" rendered="{! !isCXagent}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Asia_Miles_Membership_First_Name__c.Label}" for="AsiaMilesMembershipFirstName"></apex:outputLabel>
                        <apex:inputField id="AsiaMilesMembershipFirstName" value="{!newPolicy.Asia_Miles_Membership_First_Name__c}"></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem id="theAsiaMilesMembershipLastName"  rendered="{! !isCXagent}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Asia_Miles_Membership_Last_Name__c.Label}" for="AsiaMilesMembershipLastName"></apex:outputLabel>
                        <apex:inputField id="AsiaMilesMembershipLastName" value="{!newPolicy.Asia_Miles_Membership_Last_Name__c}"></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <!-- add by Jack on 2022-10-12 for project: JOBR-217 Enhance Asiamiles membership info validation -->
                    <!-- AM project AM info jack add -->

                    <script type="text/javascript">
                        showWarningIcon("{!newPolicy.Nationality__c}","{!$Component.theForm1.detail.policyHolderInformation.theNationality.nationality}","country");
                        showWarningIcon("{!newPolicy.Corresponding_Address_Country__c}","{!$Component.theForm1.detail.policyHolderInformation.theCorreCountry.correspondingAddressCountry}","country");
                        if({!isShow == 1}){
                            showWarningIcon("{!newPolicy.Business_Nature__c}","{!$Component.theForm1.detail.policyHolderInformation.theBusinessNature.businessNature}","businessNature");      
                        }
                        var taxResidenceId = "{!$Component.theForm1.detail.policyHolderInformation.theTaxResidence11.taxResidence1}";
                        showTaxResidentWarning("{!newPolicy.Tax_Residence_1__c}",taxResidenceId);
                        changeStyle();
                        autoCalculatePHAgeToCtrl();
                        if({!isCXagent}){
                            displaySectionItem();/* add by Jack on 2022-10-12 for project: JOBR-217 Enhance Asiamiles membership info validation */
                        }
                    </script>                     
                </apex:pageblockSection>
                
    <!--Person Insured Information -->
                
                <apex:pageblockSection id="PersonInsuredInformation" title="{!$Label.TM_Person_Insured_Information}" collapsible="false" columns="1" rendered="{!currentStep == 2}">  
                    <apex:variable var="pinum" value="{!1}"/>
                    <apex:pageBlockSectionItem ></apex:pageBlockSectionItem>
                    <apex:repeat value="{!personInsuredStructureList}" var="PIS" id="personInsuredList">
                        <apex:pageblockSection id="PIPageBlock"><!-- add by Jack on 2022-01-28 for project: IA AML -->
                        <!-- TM Work at Home 13082020 -->
                        <!-- SPS-567 -->
                        <apex:pageBlockSectionItem dataStyle="display:none">
                            <apex:inputHidden value="{!PIS.isCopyHolder}" id="isCopyHolder" html-data-hidden-id="isCopyHolder{!pinum-1}"/>
                            <apex:inputHidden value="{!PIS.isCopyCrspdAddress}" id="isCopyCrspdAddress" html-data-hidden-id="isCopyCrspdAddress{!pinum-1}"/>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem dataStyle="display:none">
                            <apex:inputHidden value="{!PIS.iscopyHlderAddress}" id="iscopyHlderAddress" html-data-hidden-id="iscopyHlderAddress{!pinum-1}"/>
                        </apex:pageBlockSectionItem>
                        
                        <!-- TM Work at Home 13082020 -->
                        <apex:pageBlockSectionItem >
                            <apex:outputPanel >
                                <apex:outputLabel value="Person Insured No. {!pinum}" styleClass="personInsuredLabel"></apex:outputLabel>
                                <br/>
                                <!--<apex:outputLabel value="( Policy Number : {!PIS.policyNumber} )"></apex:outputLabel>-->
                                <apex:outputLabel value="( Policy Number : {!PIS.piPolicy.Policy_No__c} )"></apex:outputLabel>
                            </apex:outputPanel>                            
                            <input type="button" class="btn pi-copy-holder-btn" value="Copy Holder" onclick="copyHolderInfo()" name="copyHolderBtn{!pinum}" />
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                        </apex:pageBlockSectionItem>

                        <!--apex:pageBlockSectionItem id="theRider" rendered="{! IF(CONTAINS(SPECIAL_RIDER_PRODUCTCODE_FOR_PAGE,selectedProduct.product_code__c) || CONTAINS(SPECIAL_RIDER_PRODUCTCODE_FOR_PAGE2,selectedProduct.product_code__c), false, true)}"-->
                        <!-- Add by Manuel for VHIS products to hide -->
                        <apex:pageBlockSectionItem id="theRider" rendered="{! IF(CONTAINS(SPECIAL_RIDER_PRODUCTCODE_FOR_PAGE,selectedProduct.product_code__c) || CONTAINS(SPECIAL_RIDER_PRODUCTCODE_FOR_PAGE2,selectedProduct.product_code__c) || newPolicy.Product_Code__c=='VSTDG'||newPolicy.Product_Code__c=='VSMMG'||newPolicy.Product_Code__c=='VSUPG' || CONTAINS(DisplayNoRider,newPolicy.product_code__c), false, true)}">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Rider__c.Label}"></apex:outputLabel>
                            <apex:outputPanel styleClass="duelingListBox">
                                <table class="multiSelectPicklistTable">
                                    <tbody>
                                        <tr class="multiSelectPicklistRow">
                                            <td class="selectCell">
                                                <apex:outputPanel layout="block" styleClass="selectTitle">    
                                                    <apex:outputLabel value="Available Riders"/>
                                                </apex:outputPanel>
                                                <apex:selectList value="{!PIS.selectedRiderCodes}" multiselect="true" size="5" id="availabelBlock">
                                                    <apex:selectOptions value="{!PIS.availableRiders}"/>
                                                </apex:selectList>
                                            </td>
                                            <td class="multiSelectPicklistCell">
                                                <apex:outputPanel layout="block" styleClass="text">
                                                    <apex:commandLink action="{!PIS.addRiderBtn}" rerender="availabelBlock,selectedBlock" id="btnRight">
                                                        <apex:image value="/s.gif" alt="Add" styleClass="rightArrowIcon" title="Add" />
                                                    </apex:commandLink>
                                                </apex:outputPanel>
                                                <br/>
                                                <apex:outputPanel layout="block" styleClass="text">
                                                    <apex:commandLink action="{!PIS.removeRiderBtn}" rerender="availabelBlock,selectedBlock" id="btnLeft">
                                                        <apex:image value="/s.gif" alt="Remove" styleClass="leftArrowIcon" title="Remove" />
                                                    </apex:commandLink>
                                                </apex:outputPanel>
                                            </td>
                                            <td class="selectCell">
                                                <apex:outputPanel layout="block" styleClass="selectTitle"> 
                                                    <apex:outputLabel value="Selected Riders"/>
                                                </apex:outputPanel>
                                                <apex:selectList value="{!PIS.removedRiderCodes}" multiselect="true" size="5" id="selectedBlock">
                                                    <apex:selectOptions value="{!PIS.selectedRiders}"/>
                                                </apex:selectList>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>                                
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>
                        <!--apex:pageBlockSectionItem rendered="{!IF(CONTAINS(SPECIAL_RIDER_PRODUCTCODE_FOR_PAGE,selectedProduct.Product_Code__c) || CONTAINS(SPECIAL_RIDER_PRODUCTCODE_FOR_PAGE2,selectedProduct.Product_Code__c), false, true)}"-->
                        <!-- Add by Manuel for VHIS products to hide -->
                        <apex:pageBlockSectionItem rendered="{!IF(CONTAINS(SPECIAL_RIDER_PRODUCTCODE_FOR_PAGE,selectedProduct.Product_Code__c) || CONTAINS(SPECIAL_RIDER_PRODUCTCODE_FOR_PAGE2,selectedProduct.Product_Code__c) || newPolicy.Product_Code__c=='VSTDG'||newPolicy.Product_Code__c=='VSMMG'||newPolicy.Product_Code__c=='VSUPG'|| CONTAINS(DisplayNoRider,newPolicy.Product_Code__c), false, true)}">    
                        </apex:pageBlockSectionItem>
                        
                        <apex:repeat value="{!PIS.availableRiderBenefitlevelItemList}" var="ai" id="theBenefitRider" rendered="{!IF(CONTAINS(SPECIAL_RIDER_PRODUCTCODE_FOR_PAGE,selectedProduct.Product_Code__c) || CONTAINS(SPECIAL_RIDER_PRODUCTCODE_FOR_PAGE2,selectedProduct.Product_Code__c), true, false)}">
                            <apex:pageBlockSectionItem > 
                                <apex:outputLabel value="Available Rider"></apex:outputLabel>
                                <apex:outputLabel value="{!ai.riderName}"></apex:outputLabel>
                            </apex:pageBlockSectionItem>                            
                            <apex:pageBlockSectionItem >
                                <apex:outputLabel value="Rider Plan Level"></apex:outputLabel>
                                <!-- Combo declaration: remove selected rider level if declaration = No -->
                                <apex:selectList value="{!ai.benefitlevel}" multiselect="false" size="1" disabled="{!ai.disableSelct}">
                                    <apex:selectOptions value="{!ai.benefitLevelOption}"/>
                                    <apex:actionSupport event="onchange" action="{!PIS.selectAvailableRider}" reRender="{!IF(newPolicy.Product_Code__c=='@CBOG','PersonInsuredInformation','dummyvalue')}" status="loader-icon"></apex:actionSupport>
                                </apex:selectList>
                            </apex:pageBlockSectionItem>                            
                        </apex:repeat>
                        
                        <apex:pageBlockSectionItem id="theInsuredType" >
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Insured_Type__c.Label}" for="TMInsuredType"></apex:outputLabel>
                            <!--<apex:inputField id="TMInsuredType" value="{!PIS.pi.Insured_Type__c}" onchange="displayParentPIId('{!pinum}','{!$Component.theForm1.detail.PersonInsuredInformation.personInsuredList}','{!productCode}')"></apex:inputField>-->
                            <apex:outputField id="TMInsuredType" value="{!PIS.pi.Insured_Type__c}" ></apex:outputField>                            
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem id="theBenefitLevelItem" dataStyleClass="requiredInput required" rendered="{! IF(CONTAINS(SPECIAL_RIDER_PRODUCTCODE_FOR_PAGE2,selectedProduct.product_code__c), false, true)}">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Benefit_Level__c.Label}" for="benefitLevel"></apex:outputLabel>
                            <!--<apex:inputField id="benefitLevel" value="{!PIS.pi.Benefit_Level__c}" required="true"></apex:inputField>-->
                            <apex:actionRegion >
                                <apex:selectList size="1" value="{!PIS.pi.Benefit_Level__c}" multiselect="false" >
                                    <apex:selectOptions value="{!benefitLevelOption}"/>                                    
                                    <apex:actionSupport action="{!changeRider}" event="onchange" reRender="availabelBlock,selectedBlock">
                                        <apex:param name="PINum" value="{!pinum-1}" assignTo="{!piIndex}"/>
                                    </apex:actionSupport>
                                </apex:selectList>
                            </apex:actionRegion>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem id="theBenefitLevelItem1" dataStyleClass="requiredInput required" rendered="{! IF(CONTAINS(SPECIAL_RIDER_PRODUCTCODE_FOR_PAGE2,selectedProduct.product_code__c), true, false)}">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Benefit_Level__c.Label}" for="benefitLevel"></apex:outputLabel>
                            <!--<apex:inputField id="benefitLevel" value="{!PIS.pi.Benefit_Level__c}" required="true"></apex:inputField>-->
                            <apex:selectList size="1" value="{!PIS.pi.Benefit_Level__c}" multiselect="false" >
                                <apex:selectOptions value="{!benefitLevelOption}"/>                                    
                                <apex:actionSupport action="{!changeRider}" event="onchange" reRender="PersonInsuredInformation">
                                    <apex:param name="PINum" value="{!pinum-1}" assignTo="{!piIndex}"/>
                                </apex:actionSupport>
                            </apex:selectList>
                        </apex:pageBlockSectionItem>
                        <!-- ;displayParentPIId('{!pinum}','{!$Component.theForm1.detail.PersonInsuredInformation.personInsuredList}','{!newPolicy.Product_Code__c}')-->
                        <apex:pageBlockSectionItem id="theInsuredRelationship" dataStyleClass="requiredInput required">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Relationship__c.Label}"></apex:outputLabel>
                            <apex:inputField id="piRelationship" value="{!PIS.pi.Relationship__c}" onchange="autoGenerateInsureTypeByJS('{!piNum-1}')"></apex:inputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem id="thePIEmail" dataStyleClass="requiredInput required">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Email__c.Label}" for="PIEmail"></apex:outputLabel>
                            <apex:outputPanel >
                                <apex:inputField id="PIEmail" value="{!PIS.pi.Email__c}" ></apex:inputField>
                                <apex:inputField id="PIEmailCheck" value="{!PIS.pi.Is_Email_Needed__c}" ></apex:inputField>
                                <apex:outputLabel value="No Email"></apex:outputLabel>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>
                        
                        <!-- GL31 jack add -->
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="Available Rider Name for Assessment Question" />
                            <apex:outputText value="{!PIS.assessAvailableRider}" />
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                        </apex:pageBlockSectionItem>
                        
                        <apex:pageBlockSectionItem id="theInsuredFirstName" dataStyleClass="requiredInput required">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Insured_First_Name__c.Label}" for="insuredFirstName"></apex:outputLabel>
                            <apex:inputField id="insuredFirstName" value="{!PIS.pi.Insured_First_Name__c}" ></apex:inputField>
                        </apex:pageBlockSectionItem>                        
                        <apex:pageBlockSectionItem id="theInsuredLastName" dataStyleClass="requiredInput required">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Insured_Last_Name__c.Label}" for="insuredLastName"></apex:outputLabel>
                            <apex:inputField id="insuredLastName" value="{!PIS.pi.Insured_Last_Name__c}" ></apex:inputField>
                        </apex:pageBlockSectionItem>
                        
                        <!--
                        <apex:pageBlockSectionItem id="theInsuredChi">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Insured_Name_Chi__c.Label}" for="insuredNameChi"></apex:outputLabel>
                            <apex:inputField id="insuredNameChi" value="{!PIS.pi.Insured_Name_Chi__c}" ></apex:inputField>
                        </apex:pageBlockSectionItem>
                        
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Marital_Status__c.Label}" for="maritalStatus"></apex:outputLabel>
                            <apex:inputField id="maritalStatus" value="{!PIS.pi.Marital_Status__c}" ></apex:inputField>
                        </apex:pageBlockSectionItem>
                        -->
                        <apex:pageBlockSectionItem id="thePIGender" dataStyleClass="requiredInput required">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Gender__c.Label}" for="PIGender"></apex:outputLabel>
                            <apex:inputField id="PIGender" value="{!PIS.pi.Gender__c}" ></apex:inputField>
                        </apex:pageBlockSectionItem>

                        <!-- add by Jack on 2021-12-14 for project: IA AML nationality mandatory -->
                        <apex:pageBlockSectionItem id="thePINationality" dataStyleClass="requiredInput required">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Nationality__c.Label}" for="PINationality"></apex:outputLabel>
                            <apex:inputField id="PINationality" value="{!PIS.pi.Nationality__c}" ></apex:inputField>
                        </apex:pageBlockSectionItem>
                        <!-- <apex:pageBlockSectionItem id="thePINationality2">
                        </apex:pageBlockSectionItem> -->

                        <apex:pageBlockSectionItem id="thePIDateOfBirth" dataStyleClass="requiredInput required">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Date_of_Birth__c.Label}" for="PIDateOfBirth">
                            </apex:outputLabel>
                            <apex:inputField id="PIDateOfBirth" value="{!PIS.pi.Date_of_Birth__c}" onchange="autoCalculateAgeToCtrl()"></apex:inputField>
                        </apex:pageBlockSectionItem>
                        <!-- add by Jack on 2021-12-14 for project: IA AML nationality mandatory -->
                        <apex:pageBlockSectionItem id="thePiPlaceOfBirth" dataStyleClass="requiredInput required">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Place_of_Birth__c.Label}"></apex:outputLabel>
                            <apex:inputField id="piPlaceOfBirth" value="{!PIS.pi.Place_of_Birth__c}" ></apex:inputField>
                        </apex:pageBlockSectionItem> 

                        <apex:pageBlockSectionItem id="thePIIDType" dataStyleClass="requiredInput required">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.ID_Type__c.Label}" for="PIIDType"></apex:outputLabel>
                            <apex:inputField id="PIIDType" value="{!PIS.pi.ID_Type__c}" ></apex:inputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem id="thePIAge">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.PI_Age__c.Label}" for="PIAge"></apex:outputLabel>
                            <apex:outputText id="PIAge" value="{!PIS.pi.PI_Age__c}"></apex:outputText>
                        </apex:pageBlockSectionItem>

                        <apex:pageBlockSectionItem id="theWeight" dataStyleClass="{!IF(selectedProduct.Product_Code__c != '@PBTG', 'requiredInput required', '')}" 
                                                   rendered="{! (ptvs.policyTransactionValidationItem.showBMIInd || PIS.isSpecialProductShowBMIInd) && !PIS.pi.Is_GA__c }">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Weight__c.Label}" for="weight"></apex:outputLabel>

                            <apex:outputPanel >
                                <!--<apex:inputField id="weight" value="{!PIS.pi.Weight__c}" styleClass="number" style="width: 50px;"></apex:inputField>-->
                                <apex:inputText id="weight" value="{!PIS.weight}" styleClass="number" style="width: 50px;"></apex:inputText>
                                <apex:inputField id="weightUnit" value="{!PIS.pi.Weight_Unit__c}"  styleClass="Unit"></apex:inputField>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem rendered="{! !ptvs.policyTransactionValidationItem.showBMIInd && !PIS.isSpecialProductShowBMIInd }">
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem id="thePIPersonalId" dataStyleClass="requiredInput required">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Personal_ID__c.Label}" for="PIPersonalId"></apex:outputLabel>
                            <apex:inputField id="PIPersonalId" value="{!PIS.pi.Personal_ID__c}" ></apex:inputField>
                        </apex:pageBlockSectionItem>

                        <apex:pageBlockSectionItem id="theParentPIId" rendered="{!PIS.isParentPIIdMandatory == false}">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Parent_PI_ID__c.Label}" rendered="{!PIS.displayParentPIId == true}"></apex:outputLabel>
                            <apex:inputField id="parentPIId" value="{!PIS.pi.Parent_PI_ID__c}" rendered="{!PIS.displayParentPIId == true}"></apex:inputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem id="theParentPIId2" dataStyleClass="requiredInput required" rendered="{!PIS.isParentPIIdMandatory == true }">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Parent_PI_ID__c.Label}" rendered="{!PIS.displayParentPIId == true}"></apex:outputLabel>
                            <apex:inputField id="parentPIId" value="{!PIS.pi.Parent_PI_ID__c}" rendered="{!PIS.displayParentPIId == true}"></apex:inputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem id="theHeight" dataStyleClass="{!IF(selectedProduct.Product_Code__c != '@PBTG', 'requiredInput required', '')}" 
                                                   rendered="{! (ptvs.policyTransactionValidationItem.showBMIInd || PIS.isSpecialProductShowBMIInd) && !PIS.pi.Is_GA__c }">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Height__c.Label}" for="heightUnit"></apex:outputLabel>
                            <apex:outputPanel >
                                
                           
                                <!--<apex:inputField id="height" value="{!PIS.pi.Height__c}" styleClass="number" style="width: 50px;"></apex:inputField> rendered="{!PIS.pi.Height_Unit__c == 'ft'}"-->
                                <apex:inputText id="height" value="{!PIS.height}" styleClass="number" style="width: 50px;"></apex:inputText>
                                <apex:inputField id="heightUnit" value="{!PIS.pi.Height_Unit__c}"  styleClass="Unit" onchange="displayInchInput('{!pinum}',this.value,false)"></apex:inputField>
                                <apex:inputText id="heightInch" value="{!PIS.heightInch}" styleClass="number heightInchValue" style="width: 50px;margin-left: 10px;display:none;"/>
                                <apex:outputText id="heightInchUnit" value="Inch" styleClass="inchUnit" style="margin-left: 10px;display:none;" ></apex:outputText>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem rendered="{! !ptvs.policyTransactionValidationItem.showBMIInd && !PIS.isSpecialProductShowBMIInd }">
                        </apex:pageBlockSectionItem>
                        
                        <!--
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Weight_Unit__c.Label}" for="weightUnit"></apex:outputLabel>
                            <apex:inputField id="weightUnit" value="{!PIS.pi.Weight_Unit__c}" required="true"></apex:inputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Height__c.Label}" for="height"></apex:outputLabel>
                            <apex:inputField id="height" value="{!PIS.pi.Height__c}" ></apex:inputField>
                        </apex:pageBlockSectionItem>
                        -->
                                               
                       <!-- <apex:pageBlockSectionItem id="thePIEducationLevel">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Education_Level__c.Label}"></apex:outputLabel>
                            <apex:inputField id="piEducationLevel" value="{!PIS.pi.Education_Level__c}" ></apex:inputField>
                        </apex:pageBlockSectionItem> -->
                        
                        <!--
                        <apex:pageBlockSectionItem id="thePIHomePhone">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Home_Phone__c.Label}" for="homePhone"></apex:outputLabel>
                            <apex:inputField id="homePhone" value="{!PIS.pi.Home_Phone__c}" ></apex:inputField>
                        </apex:pageBlockSectionItem>
                        -->
                        <!--
                        <apex:pageBlockSectionItem id="thePIMobielPhone" dataStyleClass="requiredInput required">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Mobile_Phone__c.Label}" for="mobielPhone"></apex:outputLabel>
                            <apex:inputField id="mobielPhone" value="{!PIS.pi.Mobile_Phone__c}" ></apex:inputField>
                        </apex:pageBlockSectionItem>
                        -->
                        <!--
                        <apex:pageBlockSectionItem id="theOfficePhone">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Office_Phone__c.Label}" for="officePhone"></apex:outputLabel>
                            <apex:inputField id="officePhone" value="{!PIS.pi.Office_Phone__c}" ></apex:inputField>
                        </apex:pageBlockSectionItem>
                        -->
                        
                        <!--
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Position__c.Label}" for="TMPosition"></apex:outputLabel>
                            <apex:inputField id="TMPosition" value="{!PIS.pi.Position__c}" ></apex:inputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Income_HKD__c.Label}" for="IncomeHKD"></apex:outputLabel>
                            <apex:inputField id="IncomeHKD" value="{!PIS.pi.Income_HKD__c}" ></apex:inputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem id="thePICorrespondingAddress1">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Corresponding_Address_1__c.Label}" for="PICorrespondingAddress1"></apex:outputLabel>
                            <apex:inputField id="PICorrespondingAddress1" value="{!PIS.pi.Corresponding_Address_1__c}" ></apex:inputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem id="thePICorrespondingAddress2">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Corresponding_Address_2__c.Label}" for="PICorrespondingAddress2"></apex:outputLabel>
                            <apex:inputField id="PICorrespondingAddress2" value="{!PIS.pi.Corresponding_Address_2__c}" ></apex:inputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem id="thePICorrespondingAddress3">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Corresponding_Address_3__c.Label}" for="PICorrespondingAddress3"></apex:outputLabel>
                            <apex:inputField id="PICorrespondingAddress3" value="{!PIS.pi.Corresponding_Address_3__c}" ></apex:inputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem id="thePICorrespondingAddress4">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Corresponding_Address_4__c.Label}" for="PICorrespondingAddress4"></apex:outputLabel>
                            <apex:inputField id="PICorrespondingAddress4" value="{!PIS.pi.Corresponding_Address_4__c}" ></apex:inputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem id="thePICorrespondingAddressCountry">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Corresponding_Address_Country__c.Label}" for="PICorrespondingAddressCountry"></apex:outputLabel>
                            <apex:inputField id="PICorrespondingAddressCountry" value="{!PIS.pi.Corresponding_Address_Country__c}" ></apex:inputField>
                        </apex:pageBlockSectionItem>
                        -->
                        
                           
                        
                        
                        
                        <!-- Add by Manuel for VHIS -->
                        <!-- comment by kermit for AH16430-->
                        <!--
                        <apex:pageBlockSectionItem id="theSpousePIId" rendered="{!PIS.displaySpousePIId == true && (newPolicy.Product_Code__c=='VSTDG'||newPolicy.Product_Code__c=='VSMMG'||newPolicy.Product_Code__c=='VSUPG')}">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Spouse_PI_ID__c.Label}" rendered="{!PIS.displaySpousePIId == true}"></apex:outputLabel>
                            <apex:inputField id="spousePIId" value="{!PIS.pi.Spouse_PI_ID__c}" rendered="{!PIS.displaySpousePIId == true}"></apex:inputField>
                        </apex:pageBlockSectionItem> 
                        <apex:pageBlockSectionItem rendered="{!PIS.displaySpousePIId == true && (newPolicy.Product_Code__c=='VSTDG'||newPolicy.Product_Code__c=='VSMMG'||newPolicy.Product_Code__c=='VSUPG')}">
                        </apex:pageBlockSectionItem>
                        -->
                        
                        <!--
                        <apex:pageBlockSectionItem rendered="{!If('Dependent' == PIS.pi.Insured_Type__c && ('Son' == PIS.pi.Relationship__c || 'Daughter' == PIS.pi.Relationship__c), false, true)}">
                        </apex:pageBlockSectionItem>
                        -->
                        
                        <!-- AM project AM info jack add -->
                        <!-- add by Jack on 2022-10-12 for project: JOBR-217 Enhance Asiamiles membership info validation -->
                        <!-- CXagent -->
                        <apex:pageBlockSectionItem id="theAsiaMilesMembershipNumCX" rendered="{!isCXagent}">
                            <apex:outputLabel for="AsiaMilesMembershipNumCXpi" value="{!$ObjectType.Person_Insured__c.Fields.Asia_Miles_Membership_Num__c.Label}"></apex:outputLabel>
                            <apex:inputField id="AsiaMilesMembershipNumCXpi" value="{!PIS.pi.Asia_Miles_Membership_Num__c}" styleClass="PiAsiaMilesMembershipNumInput" onchange="displayPISectionItem({!pinum},false);"></apex:inputField>
                        </apex:pageBlockSectionItem>
                        <!-- NOT CXagent -->
                        <apex:pageBlockSectionItem id="theAsiaMilesMembershipNum" rendered="{! !isCXagent}">
                            <apex:outputLabel for="AsiaMilesMembershipNumpi" value="{!$ObjectType.Person_Insured__c.Fields.Asia_Miles_Membership_Num__c.Label}"></apex:outputLabel>
                            <apex:inputField id="AsiaMilesMembershipNumpi" value="{!PIS.pi.Asia_Miles_Membership_Num__c}"></apex:inputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem id="thePISmoke" dataStyleClass="requiredInput required" rendered="{! ptvs.policyTransactionValidationItem.showSmokingInd }">
                            
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Smoker__c.Label}"></apex:outputLabel>
                            <apex:outputPanel id="theSmoke">
                                <apex:pageBlockSectionItem >                                                        
                                    <apex:outputLabel >
                                        <div class="radio">
                                           <label>
                                               <input type="radio" id="smokeYesRadios{!pinum}" value="option1" onClick="checkIsSmoke('yes','{!pinum}')"/> 
                                               yes
                                           </label>
                                        </div>
                                        <div class="radio">
                                           <label>
                                               <input type="radio" id="smokeNoRadios{!pinum}" value="option2" onClick="checkIsSmoke('no','{!pinum}')"/>
                                               no
                                           </label>
                                        </div>
                                    </apex:outputLabel> 
                                </apex:pageBlockSectionItem>
                                <apex:inputField id="PISmoke" value="{!PIS.pi.Smoker__c}" style="display:none"></apex:inputField>
                                <!--    
                                <apex:pageBlockSectionItem rendered="{!IF(PIS.pi.Smoker__c == false, true, false)}">                            
                                    <apex:outputLabel >
                                        <div class="radio">
                                           <label>
                                               <input type="radio" name="smokeYesRadios{!pinum}" value="option1" onClick="checkIsSmoke('yes','{!PIS.pi.id}')" /> 
                                               yes
                                           </label>
                                        </div>
                                        <div class="radio">
                                           <label>
                                               <input type="radio" name="smokeNoRadios{!pinum}" value="option2" onClick="checkIsSmoke('no','{!PIS.pi.id}')" checked="checked"/>
                                               no
                                           </label>
                                        </div>
                                    </apex:outputLabel> 
                                </apex:pageBlockSectionItem>
                                <apex:pageBlockSectionItem rendered="{!IF(PIS.pi.Smoker__c == null, true, false)}">                            
                                    <apex:outputLabel >
                                        <div class="radio">
                                           <label>
                                               <input type="radio" name="smokeYesRadios{!pinum}" value="option1" onClick="checkIsSmoke('yes','{!PIS.pi.id}')"/> 
                                               yes
                                           </label>
                                        </div>
                                        <div class="radio">
                                           <label>
                                               <input type="radio" name="smokeNoRadios{!pinum}" value="option2" onClick="checkIsSmoke('no','{!PIS.pi.id}')"/>
                                               no
                                           </label>
                                        </div>
                                    </apex:outputLabel> 
                                </apex:pageBlockSectionItem>
                                -->
                            </apex:outputPanel>
                            
                        </apex:pageBlockSectionItem>  
                        <apex:pageBlockSectionItem rendered="{! !ptvs.policyTransactionValidationItem.showSmokingInd }">
                        </apex:pageBlockSectionItem>

                        <!-- add by Jack on 2022-10-12 for project: JOBR-217 Enhance Asiamiles membership info validation -->
                        <!-- CXagent -->
                        <apex:pageBlockSectionItem id="theAsiaMilesMembershipLastNameCX" dataStyleClass="requiredInput required " labelStyleClass="piLastNameCX" rendered="{!isCXagent}">
                            <apex:outputLabel for="AsiaMilesMembershipLastNameCXpi" value="{!$ObjectType.Person_Insured__c.Fields.Asia_Miles_Membership_Last_Name__c.Label}"></apex:outputLabel>
                            <apex:inputField id="AsiaMilesMembershipLastNameCXpi" value="{!PIS.pi.Asia_Miles_Membership_Last_Name__c}"></apex:inputField>
                        </apex:pageBlockSectionItem>
                        <!-- NOT CXagent -->
                        <apex:pageBlockSectionItem id="theAsiaMilesMembershipLastName" rendered="{! !isCXagent}">
                            <apex:outputLabel for="AsiaMilesMembershipLastNamepi" value="{!$ObjectType.Person_Insured__c.Fields.Asia_Miles_Membership_Last_Name__c.Label}"></apex:outputLabel>
                            <apex:inputField id="AsiaMilesMembershipLastNamepi" value="{!PIS.pi.Asia_Miles_Membership_Last_Name__c}"></apex:inputField>
                        </apex:pageBlockSectionItem>

                        <!-- add by Jack on 2021-12-14 for project: IA AML nationality mandatory -->
                        <apex:pageBlockSectionItem id="thePIResAddCountry" dataStyleClass="requiredInput required">
                        <!-- <apex:pageBlockSectionItem id="thePIResAddCountry" rendered="{!IF(newPolicy.Product_Code__c == '@SP100', true, false)}"> -->
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Residential_Address_Country__c.Label}" ></apex:outputLabel>
                            <!-- Rancho_IA AML_20220120: add the button behind the field -->
                            <apex:outputPanel >
                                <apex:inputField id="piResAddCountry" value="{!PIS.pi.Residential_Address_Country__c}" ></apex:inputField>
                                <input type="button" class="btn" value="Copy Holder Address" id="{!pinum}CopyAddressBtn" onclick="copyHolderAddress(this.id)"/>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>
                        <!-- <apex:pageBlockSectionItem > -->
                        <!-- <apex:pageBlockSectionItem rendered="{!IF(newPolicy.Product_Code__c == '@SP100', true, false)}"> -->
                            <!-- <apex:outputLabel value=""></apex:outputLabel>
                            <input type="button" class="btn" value="Copy Holder Address" id="{!pinum}CopyAddressBtn" onclick="copyHolderAddress(this.id)"/>                                            
                        </apex:pageBlockSectionItem> -->
                        <!-- add by Jack on 2021-12-14 for project: IA AML nationality mandatory -->
                        <!--<apex:pageBlockSectionItem rendered="{!IF(newPolicy.Product_Code__c != '@SP100', true, false)}"></apex:pageBlockSectionItem>-->
                        
                        <!-- add by Jack on 2022-10-12 for project: JOBR-217 Enhance Asiamiles membership info validation -->
                        <!-- CXagent -->
                        <apex:pageBlockSectionItem id="theAsiaMilesMembershipFirstNameCX" dataStyleClass="requiredInput required"  labelStyleClass="piFirstNameCX" rendered="{!isCXagent}">
                            <apex:outputLabel for="AsiaMilesMembershipFirstNameCXpi" value="{!$ObjectType.Person_Insured__c.Fields.Asia_Miles_Membership_First_Name__c.Label}"></apex:outputLabel>
                            <apex:inputField id="AsiaMilesMembershipFirstNameCXpi" value="{!PIS.pi.Asia_Miles_Membership_First_Name__c}"></apex:inputField>
                        </apex:pageBlockSectionItem>
                        <!-- NOT CXagent -->
                        <apex:pageBlockSectionItem id="theAsiaMilesMembershipFirstName" rendered="{! !isCXagent}">
                            <apex:outputLabel for="AsiaMilesMembershipFirstNamepi" value="{!$ObjectType.Person_Insured__c.Fields.Asia_Miles_Membership_First_Name__c.Label}"></apex:outputLabel>
                            <apex:inputField id="AsiaMilesMembershipFirstNamepi" value="{!PIS.pi.Asia_Miles_Membership_First_Name__c}"></apex:inputField>
                        </apex:pageBlockSectionItem>
                        <!-- AM project AM info jack add -->

                        <!--Combo Product-->
                        <!-- add by Jack on 2022-04-07 for project: Separation project - TM -->
                        <!-- <apex:pageBlockSectionItem id="CADGDeclaration" dataStyleClass="requiredInput required" rendered="{!PIS.piPolicy.Product_Code__c=='@CBOG'}">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Accident_Declaration__c.Label}" for="accidentDec" rendered="{!PIS.isCADGSelected}"></apex:outputLabel>
                            <apex:inputField id="accidentDec" value="{!PIS.pi.Accident_Declaration__c}" rendered="{!PIS.isCADGSelected}">
                                
                                <apex:actionSupport event="onchange" action="{!PIS.disableRiderItem}" reRender="PersonInsuredInformation" status="loader-icon">
                                    <apex:param name="riderCode" value="CADG" assignTo="{!PIS.declaRiderCode}"/>
                                </apex:actionSupport> 
                            </apex:inputField>
                            
                        </apex:pageBlockSectionItem> -->
                        <!-- add by Jack on 2022-04-07 for project: Separation project - TM -->
                        
                        <apex:pageBlockSectionItem id="CCAGDeclaration" dataStyleClass="requiredInput required" rendered="{!PIS.piPolicy.Product_Code__c=='@CBOG'}">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Cancer_Declaration__c.Label}" for="cancerDec" rendered="{!PIS.isCCAGSelected}"></apex:outputLabel>
                            <apex:inputField id="cancerDec" value="{!PIS.pi.Cancer_Declaration__c}" rendered="{!PIS.isCCAGSelected}">
                                <!-- Combo declaration -->
                                <apex:actionSupport event="onchange" action="{!PIS.disableRiderItem}" reRender="PersonInsuredInformation" status="loader-icon">
                                    <apex:param name="riderCode" value="CCAG" assignTo="{!PIS.declaRiderCode}"/>
                                </apex:actionSupport>
                            </apex:inputField>
                            
                        </apex:pageBlockSectionItem>
                        <!--Combo Product-->

                        <apex:pageBlockSectionItem id="thePIBenefitCompare" dataStyleClass="requiredInput required" rendered="{!(selectedProduct.Product_Code__c == 'TMCPU' || selectedProduct.Product_Code__c == 'TMC50') && PIS.pi.Insured_Type__c != 'PH = PI'}">
                            <apex:outputLabel value="Benefit level of DP/SP > Benefit level of MI ?"></apex:outputLabel>
                            <apex:outputPanel id="theBenefitCompare">
                                <apex:pageBlockSectionItem >                                                        
                                    <apex:outputLabel >
                                        <div class="radio">
                                           <label>
                                               <input type="radio" id="benefitCompareYes{!pinum}" value="option1" onClick="checkBenefitCompare('yes','{!pinum}')"/> 
                                               yes
                                           </label>
                                        </div>
                                        <div class="radio">
                                           <label>
                                               <input type="radio" id="benefitCompareNo{!pinum}" value="option2" onClick="checkBenefitCompare('no','{!pinum}')"/>
                                               no
                                           </label>
                                        </div>
                                    </apex:outputLabel> 
                                </apex:pageBlockSectionItem>
                                <apex:inputField id="PIBenefitCompare" value="{!PIS.pi.Benefit_lv_DP_SP_larger_than_MI__c}" style="display:none"></apex:inputField>                                
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>
                        <!-- Rancho_IA AML_20220120: arrange field position -->
                        <!-- <apex:pageBlockSectionItem rendered="{!(selectedProduct.Product_Code__c != 'TMCPU' && selectedProduct.Product_Code__c != 'TMC50') || PIS.pi.Insured_Type__c == 'PH = PI'}">
                        </apex:pageBlockSectionItem> -->
                        <!--
                        <apex:pageBlockSectionItem rendered="{!IF(newPolicy.Product_Code__c == '15R6L' || newPolicy.Product_Code__c == '25R6L' || newPolicy.Product_Code__c == '15C6L' || newPolicy.Product_Code__c == '25C6L' || newPolicy.Product_Code__c == '15C8L' || newPolicy.Product_Code__c == '25C8L' || newPolicy.Product_Code__c == '15C1L' || newPolicy.Product_Code__c == '25C1L',true,false)}"></apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem id="IsGAInd" rendered="{!IF(newPolicy.Product_Code__c == '15R6L' || newPolicy.Product_Code__c == '25R6L' || newPolicy.Product_Code__c == '15C6L' || newPolicy.Product_Code__c == '25C6L' || newPolicy.Product_Code__c == '15C8L' || newPolicy.Product_Code__c == '25C8L' || newPolicy.Product_Code__c == '15C1L' || newPolicy.Product_Code__c == '25C1L',true,false)}">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Is_GA__c.Label}"></apex:outputLabel>
                            <apex:inputField value="{!PIS.pi.Is_GA__c}" onchange="onCheckIsGA()"></apex:inputField>
                        </apex:pageBlockSectionItem>-->
                        
                        
                        <!-- Added by Andy for Portable CR begin-->
                        <apex:pageBlockSectionItem id="theLHBpolicyNum" rendered="{! newPolicy.Product_Code__c == '@PBTG'}" dataStyleClass="requiredInput required">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.LHB_policy_number__c.Label}"></apex:outputLabel>
                            <apex:inputField value="{!PIS.pi.LHB_policy_number__c}" ></apex:inputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem id="theLHBcertNum" rendered="{! newPolicy.Product_Code__c == '@PBTG'}" dataStyleClass="requiredInput required">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.LHB_certificate_number__c.Label}"></apex:outputLabel>
                            <apex:inputField value="{!PIS.pi.LHB_certificate_number__c}" ></apex:inputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem id="declareNewBornBaby" rendered="{! newPolicy.Product_Code__c == '@PBTG'}" >
                            <apex:outputLabel value="Declare to have new marriage/new born baby"></apex:outputLabel>
                            <apex:inputField value="{!PIS.pi.Declare_new_marriage_new_born_baby__c}" ></apex:inputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem rendered="{! newPolicy.Product_Code__c == '@PBTG'}">
                        </apex:pageBlockSectionItem>
                        <!-- Added by Andy for Portable CR end-->
                        
                        <!-- Add by Manuel for VHIS products place start -->
                        <!-- comment by Jack on 2022-01-14 for project: IA AML -->
                        <!-- <apex:pageBlockSectionItem id="thePIPlaceOfResidenceVHIS" dataStyleClass="requiredInput required" rendered="{!IF(newPolicy.Product_Code__c=='VSTDG'||newPolicy.Product_Code__c=='VSMMG'||newPolicy.Product_Code__c=='VSUPG', true, false)}">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Place_of_Residence_picklist__c.Label}" ></apex:outputLabel>
                            <apex:inputField id="piPlaceOfResidence" value="{!PIS.pi.Place_of_Residence_picklist__c}" ></apex:inputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem rendered="{!IF(newPolicy.Product_Code__c=='VSTDG'||newPolicy.Product_Code__c=='VSMMG'||newPolicy.Product_Code__c=='VSUPG', true, false)}">
                        </apex:pageBlockSectionItem> -->
                        <!-- comment by Jack on 2022-01-14 for project: IA AML -->
                        <!-- Add by Manuel for VHIS products place stop -->
                        
                        <apex:pageBlockSectionItem id="thePIResAdd1" dataStyleClass="requiredInput required" rendered="{!IF('PH = PI' != PIS.pi.Insured_Type__c && newPolicy.Product_Code__c == '@SP100', true, false)}">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Residential_Address_1__c.Label}" ></apex:outputLabel>
                            <apex:inputField id="piResAdd1" value="{!PIS.pi.Residential_Address_1__c}" ></apex:inputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem id="thePIResAdd11" rendered="{!IF('PH = PI' == PIS.pi.Insured_Type__c && newPolicy.Product_Code__c == '@SP100', true, false)}">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Residential_Address_1__c.Label}" ></apex:outputLabel>
                            <apex:inputField id="piResAdd1" value="{!PIS.pi.Residential_Address_1__c}" ></apex:inputField>
                        </apex:pageBlockSectionItem>
                        <!--
                        <apex:pageBlockSectionItem id="thePIResAdd2" dataStyleClass="requiredInput required" rendered="{!IF('PH = PI' != PIS.pi.Insured_Type__c && newPolicy.Product_Code__c == '@SP100', true, false)}">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Residential_Address_2__c.Label}" ></apex:outputLabel>
                            <apex:inputField id="piResAdd2" value="{!PIS.pi.Residential_Address_2__c}" ></apex:inputField>                        
                        </apex:pageBlockSectionItem>
                        -->
                        <apex:pageBlockSectionItem id="thePIResAdd21" rendered="{!IF(newPolicy.Product_Code__c == '@SP100', true, false)}">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Residential_Address_2__c.Label}" ></apex:outputLabel>
                            <apex:inputField id="piResAdd2" value="{!PIS.pi.Residential_Address_2__c}" ></apex:inputField>                        
                        </apex:pageBlockSectionItem>
                        <!-- 
                        <apex:pageBlockSectionItem id="thePIResAdd3" dataStyleClass="requiredInput required" rendered="{!IF('PH = PI' != PIS.pi.Insured_Type__c && newPolicy.Product_Code__c == '@SP100', true, false)}">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Residential_Address_3__c.Label}" ></apex:outputLabel>
                            <apex:inputField id="piResAdd3" value="{!PIS.pi.Residential_Address_3__c}" ></apex:inputField>                        
                        </apex:pageBlockSectionItem>
                        -->
                        <apex:pageBlockSectionItem id="thePIResAdd31" rendered="{!IF(newPolicy.Product_Code__c == '@SP100', true, false)}">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Residential_Address_3__c.Label}" ></apex:outputLabel>
                            <apex:inputField id="piResAdd3" value="{!PIS.pi.Residential_Address_3__c}" ></apex:inputField>                        
                        </apex:pageBlockSectionItem>
                        <!-- 
                        <apex:pageBlockSectionItem id="thePIResAdd4" dataStyleClass="requiredInput required" rendered="{!IF('PH = PI' != PIS.pi.Insured_Type__c && newPolicy.Product_Code__c == '@SP100', true, false)}">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Residential_Address_4__c.Label}" ></apex:outputLabel>
                            <apex:inputField id="piResAdd4" value="{!PIS.pi.Residential_Address_4__c}" ></apex:inputField>                        
                        </apex:pageBlockSectionItem> 
                        -->
                        <apex:pageBlockSectionItem id="thePIResAdd41" rendered="{!IF(newPolicy.Product_Code__c == '@SP100', true, false)}">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Residential_Address_4__c.Label}" ></apex:outputLabel>
                            <apex:inputField id="piResAdd4" value="{!PIS.pi.Residential_Address_4__c}" ></apex:inputField>                        
                        </apex:pageBlockSectionItem>
                        
                        <apex:pageBlockSectionItem id="hiddenField">
                            <apex:variable var="pinum" value="{! pinum+1}" />  
                            <apex:inputField id="TMInsuredTypeHidden" value="{!PIS.pi.Insured_Type__c}" style="display:none;"/>
                        </apex:pageBlockSectionItem>

                        <!--<apex:pageBlockSectionItem id="theTMInsuredTypeHidden">
                            <apex:inputField id="TMInsuredTypeHidden" value="{!PIS.pi.Insured_Type__c}" style="display:none;"/>
                        </apex:pageBlockSectionItem>-->
                        
                        <!-- add by jack for JR1829 begin-->
                        <apex:pageBlockSectionItem id="theReasonForPIAgeOver18" rendered="{!IF(OR(ISBLANK(PIS.pi.PI_Age__c),ISBLANK(PIS.pi.Relationship__c),newPolicy.Product_Code__c=='VSPWG',newPolicy.Product_Code__c=='VSMMG',newPolicy.Product_Code__c=='VSUPG',newPolicy.Product_Code__c=='VSTDG'),false,IF(AND(PIS.pi.PI_Age__c > 17, PIS.pi.Relationship__c != 'Policy Holder', PIS.pi.Relationship__c != 'Spouse'),true,false)) }" dataStyleClass="{!IF(OR(ISBLANK(PIS.pi.PI_Age__c),ISBLANK(PIS.pi.Relationship__c),newPolicy.Product_Code__c=='VSMMG',newPolicy.Product_Code__c=='VSUPG',newPolicy.Product_Code__c=='VSTDG'),'',IF(AND(PIS.pi.PI_Age__c > 17,PIS.pi.Relationship__c != 'Policy Holder', PIS.pi.Relationship__c != 'Spouse'),'requiredInput required','')) }">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Reason_for_PI_age_over_18__c.Label}" ></apex:outputLabel>
                            <apex:inputField id="reasonForPIAgeOver18" value="{!PIS.pi.Reason_for_PI_age_over_18__c}" onchange="refreshEvent();"></apex:inputField>
                        </apex:pageBlockSectionItem>
                        
                        <apex:pageBlockSectionItem id="theOtherReasonForPIAgeOver18" rendered="{! AND(!ISBLANK(PIS.pi.Reason_for_PI_age_over_18__c),PIS.pi.Reason_for_PI_age_over_18__c == 'Others')}" dataStyleClass="{! IF(AND(!ISBLANK(PIS.pi.Reason_for_PI_age_over_18__c),PIS.pi.Reason_for_PI_age_over_18__c == 'Others'),'requiredInput required','')}">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Other_Reason_for_PI_age_over_18__c.Label}" ></apex:outputLabel>
                            <apex:inputField id="otherReasonForPIAgeOver18" value="{!PIS.pi.Other_Reason_for_PI_age_over_18__c}" ></apex:inputField>
                        </apex:pageBlockSectionItem>
                        
                        <!--Nicole_CDDUAT-24_20200511-->
                        <apex:pageBlockSectionItem rendered="{!IF(OR(ISBLANK(PIS.pi.PI_Age__c),ISBLANK(PIS.pi.Relationship__c),newPolicy.Product_Code__c=='VSPWG',newPolicy.Product_Code__c=='VSMMG',newPolicy.Product_Code__c=='VSUPG',newPolicy.Product_Code__c=='VSTDG'),false,IF(AND(PIS.pi.PI_Age__c > 17,PIS.pi.Relationship__c != 'Policy Holder',PIS.pi.Relationship__c != 'Spouse',PIS.pi.Reason_for_PI_age_over_18__c != 'Others'),true,false)) }" />

                        <!-- add by jack for JR1829 end-->

                        <apex:outputPanel style="display:none">
                            <script type="text/javascript">
                            displaySmoke('{!PIS.pi.Smoker__c}','{!pinum}');
                            defaultParentPIId('{!pinum}','{!$Component.theForm1.detail.PersonInsuredInformation.personInsuredList}');
                            //Add by Manuel for VHIS products
                            defaultSpousePIId('{!pinum}','{!$Component.theForm1.detail.PersonInsuredInformation.personInsuredList}');
                            displayInchInput('{!pinum}','{!PIS.pi.Height_Unit__c}',true);
                            if({!(selectedProduct.Product_Code__c == 'TMC50' || selectedProduct.Product_Code__c == 'TMCPU') && PIS.pi.Insured_Type__c != 'PH = PI'} == true){
                                displayBenefitCompare('{!PIS.pi.Benefit_lv_DP_SP_larger_than_MI__c}','{!pinum}');
                            } 
                            if({!isCXagent}){     
                                displayPISectionItem({!pinum},true);/* add by Jack on 2022-10-12 for project: JOBR-217 Enhance Asiamiles membership info validation */              
                            }
                            </script>
                        </apex:outputPanel>
                        </apex:pageblockSection>
                    </apex:repeat>
                    <script type="text/javascript">
                        Cigna.NewPolicy.removeFirstCopyHodlerBtn();
                        changeStyle();  
                    //autoCalculateAgeToCtrl();
                    </script>
                </apex:pageblockSection>
                            
                <apex:pageblockSection title="{!selectedProduct.Name}" collapsible="false" columns="2" rendered="{!currentStep == 3}">
                </apex:pageblockSection>
                <apex:pageblockSection title="{!$Label.TM_Beneficiary_Information}" collapsible="false" columns="2" rendered="{!currentStep == 3}" id="BeneficiaryInformation">
                    <apex:variable var="PINo" value="{!0}"/>
                    <apex:repeat value="{!personInsuredStructureList}" var="pis" id="piRepeat">
                        <apex:variable var="BNNum" value="{!0}"/>
                        <apex:pageBlockSectionItem >
                            <!--<apex:outputLabel value="Person Insured No.{!PINo+1} : {!pis.pi.Insured_First_Name__c} {!pis.pi.Insured_Last_Name__c}"></apex:outputLabel>-->
                            <apex:outputPanel >
                                <apex:outputLabel value="Person Insured No.{!PINo+1} : " styleClass="personInsuredLabel"></apex:outputLabel>
                                <br/>
                                <apex:outputLabel value="( PolicyNumber : {!pis.policyNumber} )"></apex:outputLabel>
                            </apex:outputPanel>                            
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                        </apex:pageBlockSectionItem>
                        <apex:repeat value="{!pis.beneficiaryList}" var="BeneficiaryStruct" id="beneficiaryRepeat">
                            <apex:pageBlockSectionItem >
                                <apex:outputLabel value="{!BeneficiaryStruct.PIName} 's Beneficiary No.{!BNNum+1}"></apex:outputLabel>
                                <apex:outputPanel rendered="{!IF(newPolicy.Product_Code__c != '@SP100' || pis.pi.Insured_Type__c != 'Dependent', true, false)}">
                                    <!--<div class="requiredInput"><div class="requiredBlock"></div></div>-->
                                    <input value="Copy Holder" class="btn" onclick="copyHolderForBenefit({!PINo},{!BNNum})" type="button" />
                                    <input value="Remove Beneficiary" class="btn" onclick="removeBeneficiaryToCtrl('{!PINo}'+','+'{!BNNum}')" type="button" id="removeBenefitBtn{!BNNum}"/>
                                </apex:outputPanel>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem >
                                <apex:outputLabel value=""></apex:outputLabel>
                                <!--
                                <apex:commandButton value="Copy Above" reRender="BeneficiaryInformation">
                                    <apex:actionSupport event="onclick" action="{!copyAboveBeneficiary}" reRender="BeneficiaryInformation">
                                        <apex:param name="PINoOfStep3" value="{!PINo}" assignTo="{!PINoOfStep3}"/>
                                    </apex:actionSupport>
                                </apex:commandButton>
                                -->
                                <input value="Copy Above" class="btn copy-Above-Bene" onclick="copyAboveBene({!PINo})" type="button" name="above{!PINo}" id="aboveBtn{!BNNum}"/>
                                <!--copy above-->
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem id="theBeneFirstName" rendered="{!IF(newPolicy.Product_Code__c == '@SP100' && pis.pi.Insured_Type__c == 'Dependent', true, false)}">
                                <apex:outputLabel value="{!$ObjectType.Beneficiary__c.Fields.First_Name__c.Label}" for="beneficiaryFirstName"></apex:outputLabel>
                                <apex:outputField id="beneficiaryFirstName" value="{!BeneficiaryStruct.beneficiary.First_Name__c}" ></apex:outputField>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem id="theBeneFirstName2" rendered="{!IF(newPolicy.Product_Code__c != '@SP100' || pis.pi.Insured_Type__c != 'Dependent', true, false)}">
                                <apex:outputLabel value="{!$ObjectType.Beneficiary__c.Fields.First_Name__c.Label}" for="beneficiaryFirstName"></apex:outputLabel>
                                <apex:inputField id="beneficiaryFirstName" value="{!BeneficiaryStruct.beneficiary.First_Name__c}" ></apex:inputField>
                            </apex:pageBlockSectionItem>
                                                      
                            <apex:pageBlockSectionItem id="theBeneLastName" rendered="{!IF(newPolicy.Product_Code__c == '@SP100' && pis.pi.Insured_Type__c == 'Dependent', true, false)}">
                                <apex:outputLabel value="{!$ObjectType.Beneficiary__c.Fields.Last_Name__c.Label}" for="beneficiaryLastName"></apex:outputLabel>
                                <apex:outputField id="beneficiaryLastName" value="{!BeneficiaryStruct.beneficiary.Last_Name__c}"></apex:outputField>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem id="theBeneLastName2" rendered="{!IF(newPolicy.Product_Code__c != '@SP100' || pis.pi.Insured_Type__c != 'Dependent', true, false)}">
                                <apex:outputLabel value="{!$ObjectType.Beneficiary__c.Fields.Last_Name__c.Label}" for="beneficiaryLastName"></apex:outputLabel>
                                <apex:inputField id="beneficiaryLastName" value="{!BeneficiaryStruct.beneficiary.Last_Name__c}"></apex:inputField>
                            </apex:pageBlockSectionItem>
                            
                           
                            <apex:pageBlockSectionItem id="theBenePersonId" rendered="{!IF(newPolicy.Product_Code__c == '@SP100' && pis.pi.Insured_Type__c == 'Dependent', true, false)}">
                                <apex:outputLabel value="{!$ObjectType.Beneficiary__c.Fields.Person_ID__c.Label}" for="beneficiaryPersonID"></apex:outputLabel>
                                <apex:outputField id="beneficiaryPersonID" value="{!BeneficiaryStruct.beneficiary.Person_ID__c}" ></apex:outputField>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem id="theBenePersonId2" rendered="{!IF(newPolicy.Product_Code__c != '@SP100' || pis.pi.Insured_Type__c != 'Dependent', true, false)}">
                                <apex:outputLabel value="{!$ObjectType.Beneficiary__c.Fields.Person_ID__c.Label}" for="beneficiaryPersonID"></apex:outputLabel>
                                <apex:inputField id="beneficiaryPersonID" value="{!BeneficiaryStruct.beneficiary.Person_ID__c}" ></apex:inputField>
                            </apex:pageBlockSectionItem>
                            
                            <apex:pageBlockSectionItem id="theBeneGender" rendered="{!IF(newPolicy.Product_Code__c == '@SP100' && pis.pi.Insured_Type__c == 'Dependent', true, false)}">
                                <apex:outputLabel value="{!$ObjectType.Beneficiary__c.Fields.Gender__c.Label}" for="beneficiaryGender"></apex:outputLabel>
                                <apex:outputField id="beneficiaryGender" value="{!BeneficiaryStruct.beneficiary.Gender__c}" ></apex:outputField>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem id="theBeneGender2" rendered="{!IF(newPolicy.Product_Code__c != '@SP100' || pis.pi.Insured_Type__c != 'Dependent', true, false)}">
                                <apex:outputLabel value="{!$ObjectType.Beneficiary__c.Fields.Gender__c.Label}" for="beneficiaryGender"></apex:outputLabel>
                                <apex:inputField id="beneficiaryGender" value="{!BeneficiaryStruct.beneficiary.Gender__c}" ></apex:inputField>
                            </apex:pageBlockSectionItem>
                            
                            <apex:pageBlockSectionItem id="theBeneBeneficiaryType" rendered="{!IF(newPolicy.Product_Code__c == '@SP100' && pis.pi.Insured_Type__c == 'Dependent', true, false)}">
                                <apex:outputLabel value="{!$ObjectType.Beneficiary__c.Fields.Beneficiary_Type__c.Label}" for="beneficiaryType"></apex:outputLabel>
                                <apex:outputField id="beneficiaryType" value="{!BeneficiaryStruct.beneficiary.Beneficiary_Type__c}" ></apex:outputField>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem id="theBeneBeneficiaryType2" rendered="{!IF(newPolicy.Product_Code__c != '@SP100' || pis.pi.Insured_Type__c != 'Dependent', true, false)}">
                                <apex:outputLabel value="{!$ObjectType.Beneficiary__c.Fields.Beneficiary_Type__c.Label}" for="beneficiaryType"></apex:outputLabel>
                                <apex:inputField id="beneficiaryType" value="{!BeneficiaryStruct.beneficiary.Beneficiary_Type__c}" ></apex:inputField>
                            </apex:pageBlockSectionItem>
                            <!--
                            <apex:pageBlockSectionItem id="theBeneGender" dataStyleClass="requiredInput required">
                                <apex:outputLabel value="{!$ObjectType.Beneficiary__c.Fields.Gender__c.Label}" for="beneficiaryGender"></apex:outputLabel>
                                <apex:inputField id="beneficiaryGender" value="{!BeneficiaryStruct.beneficiary.Gender__c}" ></apex:inputField>
                            </apex:pageBlockSectionItem>
                            -->
                            <apex:pageBlockSectionItem id="theBeneRelationship" rendered="{!IF(newPolicy.Product_Code__c == '@SP100' && pis.pi.Insured_Type__c == 'Dependent', true, false)}">
                                <apex:outputLabel value="{!$ObjectType.Beneficiary__c.Fields.Relationship__c.Label}" for="beneficiaryRelationship"></apex:outputLabel>
                                <apex:outputField id="beneficiaryRelationship" value="{!BeneficiaryStruct.beneficiary.Relationship__c}" ></apex:outputField>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem id="theBeneRelationship2" rendered="{!IF(newPolicy.Product_Code__c != '@SP100' || pis.pi.Insured_Type__c != 'Dependent', true, false)}">
                                <apex:outputLabel value="{!$ObjectType.Beneficiary__c.Fields.Relationship__c.Label}" for="beneficiaryRelationship"></apex:outputLabel>
                                <apex:inputField id="beneficiaryRelationship" value="{!BeneficiaryStruct.beneficiary.Relationship__c}" ></apex:inputField>
                            </apex:pageBlockSectionItem>
                            
                            <apex:pageBlockSectionItem id="theBeneBeneficiaryPercent" rendered="{!IF(newPolicy.Product_Code__c == '@SP100' && pis.pi.Insured_Type__c == 'Dependent', true, false)}">
                                <apex:outputLabel value="{!$ObjectType.Beneficiary__c.Fields.Percent__c.Label}" for="beneficiaryPercent"></apex:outputLabel>
                                <apex:outputField id="beneficiaryPercent" value="{!BeneficiaryStruct.beneficiary.Percent__c}" ></apex:outputField>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem id="theBeneBeneficiaryPercent2" rendered="{!IF(newPolicy.Product_Code__c != '@SP100' || pis.pi.Insured_Type__c != 'Dependent', true, false)}">
                                <apex:outputLabel value="{!$ObjectType.Beneficiary__c.Fields.Percent__c.Label}" for="beneficiaryPercent"></apex:outputLabel>
                                <apex:inputField id="beneficiaryPercent" value="{!BeneficiaryStruct.beneficiary.Percent__c}" ></apex:inputField>
                            </apex:pageBlockSectionItem>
                            
                            <apex:pageBlockSectionItem rendered="{!IF(newPolicy.Product_Code__c != '@SP100' || pis.pi.Insured_Type__c != 'Dependent', true, false)}">
                                <input value="Add Beneficiary" class="btn" onclick="addBeneficiaryToCtrl('{!PINo}'+','+'{!BNNum}')" type="button" />
                                <!--
                                    <apex:commandButton value="Add Beneficiary" reRender="BeneficiaryInformation">
                                        <apex:actionSupport event="onclick" action="{!addBenefit}" reRender="BeneficiaryInformation">
                                            <apex:param name="benefitId" value="{!PINo},{!BNNum - 1}" assignTo="{!selectedPINoBNNum}"/>
                                        </apex:actionSupport>
                                    </apex:commandButton>
                                -->
                                <apex:outputLabel ></apex:outputLabel>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem rendered="{!IF(newPolicy.Product_Code__c == '@SP100' && pis.pi.Insured_Type__c == 'Dependent', true, false)}">
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem >
                                <apex:variable var="BNNum" value="{!BNNum + 1}"/>
                            </apex:pageBlockSectionItem>
                            <apex:pageBlockSectionItem >
                                <!-- SPS-567 -->
                                <apex:inputHidden id="origPersonId" value="{!BeneficiaryStruct.origPersonId}" rendered="{!orgnDataBeforeMask.workAtHome}" html-data-hidden-id="origPersonId{!PINo}-{!BNNum-1}"/>
                            </apex:pageBlockSectionItem>
                        </apex:repeat>
                        <apex:variable var="PINo" value="{!PINo + 1}"/>
                    </apex:repeat>
                    <script type="text/javascript" >
                        Cigna.NewPolicy.removeFirstCopyAboveBtn();
                        changeStyle();
                    </script>
                </apex:pageblockSection> 
                
                <apex:pageblockSection title="{!selectedProduct.Name}" collapsible="false" columns="2" rendered="{!currentStep == 4}">
                </apex:pageblockSection>
                <apex:pageBlockSection title="UW INFORMATION" collapsible="false" columns="1" rendered="{!currentStep == 4}">
                    <script>
                    //if({!callPreSalesOnPage==true}){
                    //presales();
                    //}
                    </script>
                </apex:pageBlockSection>
                <apex:pageblockSection id="theUWInformation"  collapsible="false" columns="1" rendered="{!IF(currentStep == 4 && isShowStep4Page == true, true, false)}">
                    <apex:variable var="PINo" value="{!0}"/>
                    <apex:repeat value="{!personInsuredStructureList}" var="PIS" id="PISList">                        
                        <label id="AMLLabel2" hidden="hidden" class="amlRisk">AML High Risk</label>
                        <apex:pageBlockSectionItem >
                            <apex:outputPanel >
                                <apex:outputLabel value="{!PIS.pi.Insured_First_Name__c } {!PIS.pi.Insured_Last_Name__c } 's Application"></apex:outputLabel>
                                <br/>
                                <apex:outputLabel value="( PolicyNumber : {!PIS.policyNumber} )" styleClass="personInsuredLabel"></apex:outputLabel>
                            </apex:outputPanel>                            
                        </apex:pageBlockSectionItem>
                        
                        <!--
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Benefit_Level__c.Label}"></apex:outputLabel>
                            <apex:outputField value="{!PIS.pi.Benefit_Level__c}"></apex:outputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Rider__c.Label}"></apex:outputLabel>
                            <apex:outputField value="{!PIS.pi.Rider__c}"></apex:outputField>
                        </apex:pageBlockSectionItem>
                        -->
                        
                        <apex:pageBlockSectionItem dataStyleClass="nullValue">
                            <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Pre_Sales_Result__c.Label}"></apex:outputLabel>
                            <apex:outputField value="{!PIS.piPolicy.Pre_Sales_Result__c}"></apex:outputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem rendered="{!PIS.presalesResultMsgList != null && PIS.presalesResultMsgList.size != 0}">
                            <apex:outputLabel value="PreSalesResultMessage"></apex:outputLabel>
                            <apex:pageBlockTable value="{!PIS.presalesResultMsgList}" var="item" style="width: auto;">
                                <apex:column value="{!item.ProductCode}" headerValue="ProductCode"/>
                                <apex:column headerValue="Message">
                                    <apex:outputText escape="false" value="{!item.message}"></apex:outputText>
                                </apex:column>
                            </apex:pageBlockTable>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem rendered="{!PIS.presalesResultMsgList == null || PIS.presalesResultMsgList.size == 0}">
                            <apex:outputLabel value="PreSalesResultMessage"></apex:outputLabel>
                            <apex:outputText value="-"></apex:outputText>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem dataStyleClass="nullValue">
                            <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.UW_Result__c.Label}"></apex:outputLabel>
                            <apex:outputField value="{!PIS.piPolicy.UW_Result__c}"></apex:outputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem dataStyleClass="nullValue">
                            <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Referral_Exclusion_Reason__c.Label}"></apex:outputLabel>
                            <apex:outputField value="{!newPolicy.Referral_Exclusion_Reason__c}"></apex:outputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem dataStyleClass="nullValue">
                            <apex:outputLabel value="{!$ObjectType.UW_Result__c.Fields.Loading__c.Label}"></apex:outputLabel>
                            <apex:outputField value="{!PIS.piPolicy.Loading__c}"></apex:outputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem dataStyleClass="nullValue">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Personal_ID__c.Label}"></apex:outputLabel>
                            <apex:outputField value="{!PIS.pi.Personal_ID__c}"></apex:outputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem dataStyleClass="nullValue">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Insured_Type__c.Label}"></apex:outputLabel>
                            <apex:outputField value="{!PIS.pi.Insured_Type__c}"></apex:outputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem dataStyleClass="nullValue">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Date_of_Birth__c.Label}"></apex:outputLabel>
                            <apex:outputField value="{!PIS.pi.Date_of_Birth__c}"></apex:outputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem dataStyleClass="nullValue">
                            <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Product_Name__c.Label}"></apex:outputLabel>
                            <apex:outputField value="{!newPolicy.Product_Name__c}"></apex:outputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem dataStyleClass="nullValue">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Benefit_Level__c.Label}"></apex:outputLabel>
                            <apex:outputField value="{!PIS.pi.Benefit_Level__c}"></apex:outputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem dataStyleClass="nullValue">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Rider__c.Label}"></apex:outputLabel>
                            <!--<apex:outputField value="{!PIS.pi.Rider__c}"></apex:outputField>-->
                            <apex:outputLabel value="{!PIS.forDisplayedRiders}"></apex:outputLabel>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem dataStyleClass="nullValue">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Date_of_Birth__c.Label}"></apex:outputLabel>
                            <apex:outputField value="{!PIS.pi.Date_of_Birth__c}"></apex:outputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem dataStyleClass="nullValue">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Smoker__c.Label}"></apex:outputLabel>
                            <apex:outputField value="{!PIS.pi.Smoker__c}"></apex:outputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem id="thePreSalesAppeal" rendered="{!PIS.piPolicy.Pre_Sales_Result__c == 'Referred'}">
                            <apex:outputLabel value="Customer Response"></apex:outputLabel>
                            <apex:outputPanel >
                                <apex:outputLabel >
                                    <div class="radio">
                                        <label>
                                            <input type="radio" id="preSaleAppealYes{!PINo}" value="option1" onClick="checkAppeal('Appeal','presales','{!PINo}')"/> 
                                            Appeal
                                        </label>
                                    </div>
                                    <div class="radio">
                                        <label>
                                            <input type="radio" id="preSaleAppealNo{!PINo}" value="option2" onClick="checkAppeal('Accept','presales','{!PINo}')"/>
                                            Accept
                                        </label>
                                    </div>
                                    <apex:inputField id="preSalesAppeal" value="{!PIS.piPolicy.Appeal__c}" style="display:none"></apex:inputField>
                                </apex:outputLabel>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem rendered="{!PIS.piPolicy.Pre_Sales_Result__c == 'Referred'}">
                            <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Remarks_to_Cigna_Underwriter__c.Label}"></apex:outputLabel>
                            <apex:inputField value="{!PIS.piPolicy.Remarks_to_Cigna_Underwriter__c}"></apex:inputField>
                        </apex:pageBlockSectionItem>
                        <apex:outputPanel style="display:none">
                            <script type="text/javascript">
                                displayAppeal('{!PIS.piPolicy.Appeal__c}','presales','{!PINo}');
                            </script>                           
                        </apex:outputPanel> 
                        <apex:variable var="PINo" value="{! PINo+1}" />
                    </apex:repeat>                                        
                    <script>                        
                        isAMLShow("{!isAML}");                             
                        changeStyle();
                    </script>
                </apex:pageblockSection>
                
                <apex:pageblockSection title="{!selectedProduct.Name}" collapsible="false" columns="2" rendered="{!currentStep == 5}">
                </apex:pageblockSection>
                <apex:pageblockSection title="UW INFORMATION" collapsible="false" columns="1" id="auwPannel" rendered="{!currentStep == 5}">    
                    <input type="hidden" id="application-id2" value="{!applicationId}" />
                    <input hidden="hidden" id="lastModifiedDate" value="{!personInsuredStructureList[auwPIindex].uwResultLastModifiedDate}"/>
                    <apex:outputPanel >
                        <apex:variable var="PINo" value="{!1}"/>
                        <apex:repeat value="{!uwPISListForDisplay}" var="PIS">
                            <!--Person Insured No.{!PINo} : -->
                            <apex:commandLink action="{!JumpToPI}" value="{!PIS.pi.Person_Insured_Name__c}" reRender="auwPannel" style="font-weight:bold;margin-left: 60px;">
                                <apex:param name="PINo" value="{!PINo}" assignTo="{!uwPISIndex}"/>
                            </apex:commandLink>
                            <apex:variable var="PINo" value="{! PINo+1}" />
                        </apex:repeat>
                    </apex:outputPanel>

                    <apex:outputPanel >
                        <div><h2><center>{! piName } ( PolicyNumber : {!personInsuredStructureList[auwPIindex].policyNumber} )</center></h2></div>
                        <br/>
                    </apex:outputPanel>
                    <!--
                    <apex:pageBlockSectionItem>
                        <div style="z-index: 1001;">
                            
                            <iframe scr="{!auwUrl}" height="1024px" frameborder="0" width="100%" id="iframe" name="iframe"></iframe>
                        </div>
                    </apex:pageBlockSectionItem>
                    -->
                    
                    <apex:iframe src="{!auwUrl}" height="1024px" scrolling="true" id="iframe" />
                        
                    <div name="start">
                        <div style="position: relative; z-index: 0; left: 0; top: 0; bottom: 0; right: 0; margin: 15% 48%">
                            <div style="display: inline-block; padding: 2px; background-color: #fff; width: 125px;">
                                <img src="/img/loading.gif" style="float: left; margin: 8px;" />
                                <span style="display: inline-block; padding: 10px 0px;">Please Wait...</span>
                            </div>
                        </div>
                    </div>
                    
                    <script type="text/javascript">
                        loading();
                    Cigna.NewPolicy.setUWStatusPolling();
                        
                    </script>
                </apex:pageblockSection>
                
                <apex:pageblockSection title="{!$Label.TM_CONFIRMATION_PAYMENT}" collapsible="false" columns="1" rendered="{!currentStep == 6}" id="theConfirmationPayment">
                    <apex:variable var="PINo" value="{!0}"/>
                    <apex:repeat value="{!personInsuredStructureList}" var="PIS" id="UWPISList">                        
                        <!--<span id="AMLLabel" class="label label-danger" hidden="hidden">AML High Risk</span>-->
                        <label id="AMLLabel" hidden="hidden" class="amlRisk">AML High Risk</label>
                        <apex:pageBlockSectionItem >
                            <apex:outputPanel >
                                <apex:outputLabel value="{!PIS.pi.Insured_First_Name__c }  {!PIS.pi.Insured_Last_Name__c } 's Application "></apex:outputLabel>
                                <br/>
                                <apex:outputLabel value="( PolicyNumber : {!PIS.policyNumber} )" styleClass="personInsuredLabel"></apex:outputLabel>
                                
                                <!--Add for Appeal change-->
                                <input type="text" id="pn{!PINo}" value="{!PIS.piPolicy.Policy_No__c}" style="display:none"/>
                                <!--end add-->
                                
                                &nbsp;&nbsp;&nbsp;
                                <!-- Added by Andy for TS-694 add "Remove" button next to any PI whose pre-sales result = decline  -->
                                <apex:outputPanel rendered="{! PIS.piPolicy.policy_status__c == 'Invalid' && PIS.piPolicy.Pre_Sales_Result__c == 'Declined'}" >
                                    Invalid &nbsp;&nbsp;
                                </apex:outputPanel>
                                
                                <apex:outputPanel rendered="{! PIS.piPolicy.policy_status__c == 'Pending Payment' && (PIS.piPolicy.Pre_Sales_Result__c == 'Declined' || PIS.piValidationItem.otherValidation == false || PIS.piValidationItem.isDuplicate == true)}">
                                    <input class="btn" type="button" value="Remove" name="RemovePI" onclick="removePI('{!PIS.policyNumber}')" />
                                </apex:outputPanel>
                                <apex:outputPanel rendered="{! PIS.piPolicy.policy_status__c == 'Invalid' && (PIS.piValidationItem.otherValidation == false || PIS.piValidationItem.isDuplicate == true)}" >
                                    <input class="btn" type="button" value="Cancel" name="CancelRemovePI" onclick="cancelRemovePI('{!PIS.policyNumber}')" />
                                </apex:outputPanel>
                                <!-- Added by Andy end -->
                                
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem dataStyleClass="nullValue">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Benefit_Level__c.Label}"></apex:outputLabel>
                            <apex:outputText value="{!PIS.pi.Benefit_Level__c}"></apex:outputText>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem dataStyleClass="nullValue">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Rider__c.Label}"></apex:outputLabel>
                            <!--<apex:outputField value="{!PIS.pi.Rider__c}" ></apex:outputField>-->
                            <apex:outputLabel value="{!PIS.forDisplayedRiders}"></apex:outputLabel>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem dataStyleClass="nullValue" rendered="{!PIS.pivalidationItem.needAUW || PIS.piPolicy.Pre_Sales_Result__c == 'Decline' || showPolicyReplacement}"><!-- change rendered by jack to display the field for policy replacement-->
                            <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Pre_Sales_Result__c.Label}"></apex:outputLabel>
                            <apex:outputField value="{!PIS.piPolicy.Pre_Sales_Result__c}"></apex:outputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem dataStyleClass="nullValue">
                            <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.UW_Result__c.Label}"></apex:outputLabel>
                            <apex:outputField value="{!PIS.piPolicy.UW_Result__c}"></apex:outputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem dataStyleClass="nullValue">
                            <apex:outputLabel value="Overall Result"></apex:outputLabel>
                            <apex:outputField value="{!PIS.piPolicy.UW_Overrall_Result__c}"></apex:outputField>
                        </apex:pageBlockSectionItem>                        
                        <apex:pageBlockSectionItem dataStyleClass="nullValue">
                            <apex:outputLabel value="{!$ObjectType.UW_Result__c.Fields.Loading__c.Label}"></apex:outputLabel>
                            <apex:outputField value="{!PIS.piPolicy.Loading__c}"></apex:outputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem dataStyleClass="nullValue" rendered="{!PIS.reasonList.size == 0}">
                            <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Referral_Exclusion_Reason__c.Label}"></apex:outputLabel>
                            <apex:outputText value="-"></apex:outputText>
                        </apex:pageBlockSectionItem>
                        
                        <apex:pageBlockSectionItem dataStyleClass="nullValue" rendered="{!PIS.reasonList.size > 0}">
                            <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Referral_Exclusion_Reason__c.Label}"></apex:outputLabel>
                            <apex:pageBlockTable value="{!PIS.reasonList}" var="item" style="width: auto;">
                                <apex:column headerValue="Reason">
                                    <apex:outputText escape="false" value="{!item}"></apex:outputText>
                                </apex:column>
                            </apex:pageBlockTable>
                        </apex:pageBlockSectionItem>
                        
                        <apex:pageBlockSectionItem dataStyleClass="nullValue">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Personal_ID__c.Label}"></apex:outputLabel>
                            <apex:outputField value="{!PIS.pi.Personal_ID__c}"></apex:outputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem dataStyleClass="nullValue">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Insured_Type__c.Label}"></apex:outputLabel>
                            <apex:outputField value="{!PIS.pi.Insured_Type__c}"></apex:outputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem dataStyleClass="nullValue">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Date_of_Birth__c.Label}"></apex:outputLabel>
                            <apex:outputField value="{!PIS.pi.Date_of_Birth__c}"></apex:outputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem dataStyleClass="nullValue">
                            <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Product_Name__c.Label}"></apex:outputLabel>
                            <apex:outputField value="{!newPolicy.Product_Name__c}"></apex:outputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem dataStyleClass="nullValue">
                            <apex:outputLabel value="{!$ObjectType.Person_Insured__c.Fields.Smoker__c.Label}"></apex:outputLabel>
                            <apex:outputField value="{!PIS.pi.Smoker__c}"></apex:outputField>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem dataStyleClass="requiredInput required">
                            <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Master_Policy_No__c.Label}"></apex:outputLabel>
                            <apex:inputField value="{!PIS.piPolicy.Master_Policy_No__c}"/>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem >
                            <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Policy_Effective_Date__c.Label}"></apex:outputLabel>
                            <apex:outputField value="{!PIS.piPolicy.Policy_Effective_Date__c}"></apex:outputField>
                        </apex:pageBlockSectionItem>
                        
                        <!--!IF( ( (presalesAccepted == false || uwResultAccepted == false) && isSkipStep5 == false) || (presalesAccepted == false && isSkipStep5 == true) {IF(PIS.uwResult.Full_Result__c != 'Accepted', true, false)}-->
                        <apex:pageBlockSectionItem id="theUwResultAppeal" rendered="{! ( (PIS.piPolicy.UW_Result__c != null && PIS.piPolicy.UW_Result__c != '') || CONTAINS(GAList,newPolicy.Product_Code__c) ) && PIS.piPolicy.Pre_Sales_Result__c != 'Declined'}" dataStyleClass="requiredInput required"><!-- jack add for policy replacement -->
                            <apex:outputLabel value="Customer Response"></apex:outputLabel>
                            <apex:outputPanel >
                                <apex:outputLabel >
                                    <div class="radio">
                                       <label>
                                           <input type="radio" id="uwResultAppealNo{!PINo}" value="option2" onClick="checkAppeal('Accept','uwresults','{!PINo}')"/>
                                           Accept
                                       </label>
                                    </div>
                                    <div class="radio">
                                       <label>
                                           <input type="radio" id="uwResultAppealWithdraw{!PINo}" value="option3" onClick="checkAppeal('Withdrawn','uwresults','{!PINo}')"/>
                                           Withdraw
                                       </label>
                                    </div>
                                    <div class="radio">
                                       <label>
                                           <input type="radio" id="uwResultAppealYes{!PINo}" value="option1" onClick="checkAppeal('Appeal','uwresults','{!PINo}')"/> 
                                           Appeal
                                       </label>
                                    </div>
                                </apex:outputLabel>
                                <!-- Add by Manuel -->
                                <script>
                                    if({!PIS.piPolicy.Appeal__c=='Accept'}){
                                        document.getElementById("uwResultAppealNo{!PINo}").checked = true;
                                    }else if({!PIS.piPolicy.Appeal__c=='Appeal'}){
                                        document.getElementById("uwResultAppealYes{!PINo}").checked = true;
                                    }else if({!PIS.piPolicy.Appeal__c=='Withdraw'}){
                                        document.getElementById("uwResultAppealWithdraw{!PINo}").checked = true;
                                    }
                                </script>
                                
                                <apex:inputField id="uwResultAppeal" value="{!PIS.piPolicy.Appeal_For_UW_Result__c}" style="display:none"></apex:inputField>
                            </apex:outputPanel>
                        </apex:pageBlockSectionItem>
                        <apex:pageBlockSectionItem rendered="{!PIS.piValidationItem.needAUW == true  || CONTAINS(GAList,newPolicy.Product_Code__c) }"><!-- jack add for policy replacement -->
                            <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Remarks_to_Cigna_Underwriter_2__c.Label}"></apex:outputLabel>
                            <apex:inputField value="{!PIS.piPolicy.Remarks_to_Cigna_Underwriter_2__c}"></apex:inputField>
                        </apex:pageBlockSectionItem>
                        <apex:outputPanel style="display:none">
                            <script type="text/javascript">
                                displayAppeal('{!PIS.piPolicy.Appeal_For_UW_Result__c}','uwresults','{!PINo}');
                            </script>
                        </apex:outputPanel>                        
                        <apex:variable var="PINo" value="{! PINo+1}" />
                    </apex:repeat>
                    
                    <!--Nicole_20200408_CDD-->
                    <apex:pageBlockSectionItem rendered="{!newPolicy.Missing_CDD_Info__c}">
                        <apex:outputLabel value="{!$ObjectType.Policy_Transaction__c.Fields.LC_Assessed__c.Label}"></apex:outputLabel>
                        <apex:inputField value="{!policyTransaction.LC_Assessed__c}" onchange="onLCAssessedChange();"></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem dataStyleClass="requiredInput required" rendered="{!newPolicy.Missing_CDD_Info__c && policyTransaction.LC_Assessed__c!=null}">
                        <apex:outputLabel value="{!$ObjectType.Policy_Transaction__c.Fields.LC_Reviewer__c.Label}"></apex:outputLabel>
                        <apex:inputField value="{!policyTransaction.LC_Reviewer__c}"></apex:inputField>
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem dataStyleClass="requiredInput required" rendered="{!newPolicy.Missing_CDD_Info__c && policyTransaction.LC_Assessed__c!=null}">
                        <apex:outputLabel value="{!$ObjectType.Policy_Transaction__c.Fields.LC_Reviewer_Date__c.Label}"></apex:outputLabel>
                        <apex:inputField value="{!policyTransaction.LC_Reviewer_Date__c}"></apex:inputField>
                    </apex:pageBlockSectionItem>
                    
                    <apex:pageblockSectionItem >
                        <apex:outputLabel ></apex:outputLabel>
                        <apex:outputPanel >
                            <input class="btn" type="button" value="Display Payment Information" onclick="getPaymentPremium()" />
                        </apex:outputPanel>
                    </apex:pageblockSectionItem>
                    
                    <script>
                        isAMLShow("{!isAML}");
                        changeStyle();                        
                    </script>
                </apex:pageblockSection>
                
                <!-- Rancho_HKITSFDC398_20250909 - 2025Q4 CX Campaign - allow select different discount for each policy -->
                <apex:outputPanel id="discountSection" styleClass="discountPanel" layout="block">
                    <apex:pageblockSection title="Discount" collapsible="false" columns="2" rendered="{!currentStep == 6}">
                        <apex:repeat value="{!personInsuredStructureList}" var="pis" >
                            <apex:pageblockSection rendered="{!isPaymentButtonClicked}" collapsible="true" title="{!pis.piPolicy.Policy_No__c + ' - ' + pis.pi.Person_Insured_Name__c}" columns="1">
                                <apex:pageBlockSectionItem rendered="{!premiumAmountList.size >0 && null != premiumAmountList && isPaymentButtonClicked == true}">
                                    <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Discount_1__c.Label}"></apex:outputLabel> 
                                    <!--Combo: not use discount type  -->
                                    <apex:selectList id="discount1Option" size="1" value="{!pis.discount1}" multiselect="false" disabled="{!IF(CONTAINS(SPECIAL_RIDER_PRODUCTCODE_FOR_PAGE3,selectedProduct.Product_Code__c), true, false)}">
                                        <apex:selectOptions value="{!discount12Options}"/>
                                        <apex:actionSupport event="onchange" action="{!selectDiscount1}" status="loader-icon" rerender="discountSection,paymentInfoPanel,pageMessage,theConfirmationPayment">
                                            <apex:param value="{!pis.piPolicy.Policy_No__c}" name="currentPolicyNo" assignTo="{!currentPolicyNo}"></apex:param>
                                        </apex:actionSupport>
                                    </apex:selectList>
                                </apex:pageBlockSectionItem> 
                                
                                <apex:pageBlockSectionItem rendered="{!premiumAmountList.size >0 && null != premiumAmountList && isPaymentButtonClicked == true}">
                                    <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Discount_2__c.Label}"></apex:outputLabel>
                                    <!--Combo: not use discount type  -->
                                    <apex:selectList id="discount2Option" size="1" value="{!pis.discount2}" multiselect="false" disabled="{!IF(CONTAINS(SPECIAL_RIDER_PRODUCTCODE_FOR_PAGE3,selectedProduct.Product_Code__c), true, false)}">
                                        <apex:selectOptions value="{!discount12Options}"/>
                                        <apex:actionSupport event="onchange" action="{!selectDiscount2}" status="loader-icon" rerender="discountSection,paymentInfoPanel,pageMessage,theConfirmationPayment">
                                            <apex:param value="{!pis.piPolicy.Policy_No__c}" name="currentPolicyNo" assignTo="{!currentPolicyNo}"></apex:param>
                                        </apex:actionSupport>
                                    </apex:selectList>
                                </apex:pageBlockSectionItem>
                                
                                <!-- jack add for friend and family discount in SFDC begin -->
                                <apex:pageBlockSectionItem rendered="{!premiumAmountList.size >0 && null != premiumAmountList && isPaymentButtonClicked == true && pis.selectFamilyDiscount == true}">
                                    <apex:outputLabel value="Referral Mobile"></apex:outputLabel>
                                    <!--Combo: not use discount type  -->
                                    <!-- Rancho_FriendDiscount_20210812: enable phone number search for TM -->
                                    <!-- <apex:inputText id="referralMobile" value="{!referralMobile}"/> -->
                                    <apex:outputPanel >
                                        <apex:inputText id="referralMobile" value="{!pis.referralMobile}"/>
                                        <apex:commandButton action="{!searchWithMobileNo}" value="Search" rerender="discountSection" status="loader-icon">
                                            <apex:param value="{!pis.piPolicy.Policy_No__c}" name="currentPolicyNo" assignTo="{!currentPolicyNo}"></apex:param>
                                        </apex:commandButton>
                                    </apex:outputPanel>
                                </apex:pageBlockSectionItem>

                                <apex:pageBlockSectionItem rendered="{!premiumAmountList.size >0 && null != premiumAmountList && isPaymentButtonClicked == true && pis.selectFamilyDiscount == true}">
                                    <apex:outputLabel value="Referral Policy Num"></apex:outputLabel>
                                    <!--Combo: not use discount type  -->
                                    <apex:outputText id="referralPolicyNum" value="{!pis.referralPolicyNum}" />
                                </apex:pageBlockSectionItem>

                                <apex:pageBlockSectionItem dataStyle="text-align:right;" rendered="{!premiumAmountList.size >0 && null != premiumAmountList && isPaymentButtonClicked == true && pis.showDiscountErrorMsg == 3 && pis.selectFamilyDiscount == true}">
                                    <apex:outputLabel value="No inforce policy found or master policy exceed 30 days" styleClass="locationError" />
                                </apex:pageBlockSectionItem>
                                <!-- jack add for friend and family discount in SFDC end -->

                                <apex:pageBlockSectionItem dataStyle="text-align:right;" rendered="{!premiumAmountList.size >0 && null != premiumAmountList && isPaymentButtonClicked == true && pis.showDiscountErrorMsg == 1}" >
                                    <apex:outputLabel value="{!$Label.TM_Discount_1_and_Discount_2_cannot_be_the_same}" styleClass="locationError"/>
                                </apex:pageBlockSectionItem>
                                
                                <apex:pageBlockSectionItem dataStyle="text-align:right;" rendered="{!premiumAmountList.size >0 && null != premiumAmountList && isPaymentButtonClicked == true && pis.showDiscountErrorMsg == 2}" >
                                    <apex:outputLabel value="{!pis.discountErrorMsg}" styleClass="locationError"/>
                                </apex:pageBlockSectionItem>
                                
                                <apex:pageBlockSectionItem rendered="{!premiumAmountList.size >0 && null != premiumAmountList && isPaymentButtonClicked == true && (pis.showDiscountErrorMsg == 2 || pis.showDiscountErrorMsg == 1) && refundOptions.size > 1}"></apex:pageBlockSectionItem>
                                <apex:pageBlockSectionItem rendered="{!premiumAmountList.size >0 && null != premiumAmountList && isPaymentButtonClicked == true && refundOptions.size > 1 }">
                                    <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Refund_Discount__c.Label}"></apex:outputLabel>
                                    <apex:selectList id="refundOption" size="1" value="{!pis.selectedRefund}">
                                        <apex:selectOptions value="{!refundOptions}"/>
                                        <apex:actionSupport event="onchange" action="{!onSelectedRefund}" status="loader-icon" rerender="discountSection,paymentInfoPanel,pageMessage,theConfirmationPayment">
                                            <apex:param value="{!pis.piPolicy.Policy_No__c}" name="currentPolicyNo" assignTo="{!currentPolicyNo}"></apex:param>
                                        </apex:actionSupport>
                                    </apex:selectList>
                                </apex:pageBlockSectionItem>
                                <apex:pageBlockSectionItem rendered="{!premiumAmountList.size >0 && null != premiumAmountList && isPaymentButtonClicked == true && refundOptions.size > 1 }"></apex:pageBlockSectionItem>
                                
                                <apex:pageBlockSectionItem dataStyle="text-align:right;" rendered="{!premiumAmountList.size >0 && null != premiumAmountList && isPaymentButtonClicked == true && pis.showRefundErrorMessage == 1}" >
                                    <apex:outputLabel value="{!pis.refundErrorMessage}" styleClass="locationError"/>
                                </apex:pageBlockSectionItem>
                            </apex:pageblockSection>
                        </apex:repeat>
                    </apex:pageblockSection>   
                </apex:outputPanel>
                
                <!-- AM project coupon jack add Coupon Pannel -->
                <apex:outputPanel id="couponPannel" styleClass="couponSection" layout="block">
                    <apex:pageblockSection title="Coupon" rendered="{!currentStep == 6}" collapsible="true" columns="2">
                        <apex:repeat value="{!personInsuredStructureList}" var="pis" >
                            <!-- <apex:outputPanel layout="block" styleClass="couponSection"> -->
                            <apex:pageblockSection rendered="{!isPaymentButtonClicked}" collapsible="true" title="{!pis.piPolicy.Policy_No__c}" columns="1">
                                <apex:pageblockSection columns="2">
                                    <apex:pageBlockSectionItem >
                                            <apex:outputLabel value="Coupon Number:" for="coupon__number" />
                                            <apex:inputText value="{!pis.newCouponNumber}" id="coupon__number" disabled="{! !enableCoupon}"/>
                                        </apex:pageBlockSectionItem>
                                        <apex:commandButton disabled="{! !enableCoupon}" action="{!addCoupon}" value="Add" reRender="couponPannel,pageMessage,paymentInfoPanel" status="loader-icon">
                                            <apex:param value="{!pis.piPolicy.id}" name="policyId"></apex:param>
                                        </apex:commandButton>
                                </apex:pageblockSection>
                                    <!-- <apex:outputText value="{!pis.couponMap}"/> -->
                                <apex:pageblockSection columns="1">
                                     <apex:pageMessage rendered="{!IF(pis.couponMsg == '', false, true)}" summary="{!pis.couponMsg}" severity="warning" strength="2" />
                                    <apex:pageBlockTable value="{!pis.couponMap}" var="couponNumber">
                                        <apex:column >
                                            <a onclick="deleteCoupon('{!pis.piPolicy.id}','{!pis.couponMap[couponNumber].sojectCoupon.coupon_number__c}')">Delete</a>
                                        </apex:column>
                                        <apex:column value="{!pis.couponMap[couponNumber].sojectCoupon.coupon_number__c}"></apex:column>
                                        <apex:column value="{!pis.couponMap[couponNumber].sojectCoupon.coupon_amount__c}"></apex:column>
                                        <apex:column value="{!pis.couponMap[couponNumber].sojectCoupon.coupon_status__c}"></apex:column>
                                        <apex:column value="{!pis.couponMap[couponNumber].sojectCoupon.Error_Message__c}"></apex:column>
                                    </apex:pageBlockTable>
                                </apex:pageblockSection>
                            </apex:pageblockSection>
                            <!-- <apex:outputPanel/> -->
                        </apex:repeat>
                    </apex:pageblockSection>
                </apex:outputPanel>
                <!-- AM project coupon jack add Coupon Pannel -->

                <apex:pageblockSection collapsible="false" id="thePremuimTabel" title="{!$Label.TM_Payment_Information}" rendered="{!currentStep == 6}">
                    <apex:outputPanel id="paymentInfoPanel" rendered="{!currentStep == 6 && premiumAmountList.size >0 && null != premiumAmountList && isPaymentButtonClicked == true}">
                        <lable sytle="color:blue;font-weight:1000px;margin-left: 400px;">{!$Label.TM_Total_Annual_Premium}:&nbsp;{!selectedProduct.currency__c}&nbsp;<apex:outputText value="{0,Number,###,###,###}"><apex:param value="{!totalPremium.subTotal}"/></apex:outputText></lable>                        
                        <table class="datatable" style= "align:right; text-align:right;border-collapse:collapse; margin-top: 10px;">
                            <tbody>
                            <tr style="height:20px;">
                                <td></td>
                                <apex:repeat var="p" value="{!premiumAmountList}">
                                    <td >{!p.personInsuredIndex}</td>
                                </apex:repeat>
                            </tr>
                            
                            <tr style="height:20px; border:1px solid black;">
                                <td style="border:1px solid black;"></td>
                                <apex:repeat var="p" value="{!premiumAmountList}">
                                    <td style="border:1px solid black;">{!p.premiumDescription}</td>
                                </apex:repeat>
                            </tr>
                            
                            <tr style="height:20px; border:1px solid black;">
                                <td style="border:1px solid black;">Original Premium &nbsp; ({!selectedProduct.currency__c})</td>
                                <apex:repeat var="p" value="{!premiumAmountList}">
                                    <td style="border:1px solid black;" class="hidenZero"><apex:outputText value="{0,Number,###,###,###}"><apex:param value="{!p.originalPremium}"/></apex:outputText></td>
                                </apex:repeat>
                            </tr>
                            <!--
                            <tr style="height:20px; border:1px solid black;">
                                <td style="border:1px solid black;">{!$Label.TM_Original_Premium_Month}</td>
                                <apex:repeat var="p" value="{!premiumAmountList}">
                                    <td style="border:1px solid black;" class="hidenZero"><apex:outputText value="{0,Number,###,###,###}"><apex:param value="{!p.originalPremiumMonth}"/></apex:outputText></td>
                                </apex:repeat>
                            </tr>
                            <tr style="height:20px; border:1px solid black;">
                                <td style="border:1px solid black;">{!$Label.TM_Annual_Premium}</td>
                                <apex:repeat var="p" value="{!premiumAmountList}">
                                    <td style="border:1px solid black;"><apex:outputText value="{0,Number,###,###,###}"><apex:param value="{!p.annualPremium}"/></apex:outputText></td>
                                </apex:repeat>
                            </tr>
                            -->
                            <tr style="height:20px; border:1px solid black;">
                                <td style="border:1px solid black;">Discount (%) Off</td>
                                <apex:repeat var="p" value="{!premiumAmountList}">
                                    <td style="border:1px solid black;"><apex:outputText value="{0,Number,###,###,##0.00}"><apex:param value="{!p.totalDiscountPercent}"/></apex:outputText></td>
                                </apex:repeat>
                            </tr>
                            <tr style="height:20px; border:1px solid black;">
                                <td style="border:1px solid black;">Overall Medical Loading (%)</td>  
                                <apex:repeat var="p" value="{!premiumAmountList}">
                                    <td style="border:1px solid black;">{!p.medicalLoadingPercent}</td>
                                </apex:repeat>
                            </tr>
                            <tr style="height:20px; border:1px solid black;">
                                <td style="border:1px solid black;">Loading Premium &nbsp; ({!selectedProduct.currency__c})</td>  
                                <apex:repeat var="p" value="{!premiumAmountList}">
                                    <td style="border:1px solid black;"><apex:outputText value="{0,Number,###,###,###}"><apex:param value="{!p.loadingPremium}"/></apex:outputText></td>
                                </apex:repeat>
                            </tr>
                            <!--
                            <tr style="height:20px; border:1px solid black;">
                                <td style="border:1px solid black;"></td>  
                                <apex:repeat var="p" value="{!premiumAmountList}">
                                    <td style="border:1px solid black;"></td>
                                </apex:repeat>
                            </tr>
                            -->
                            <tr style="height:20px; border:1px solid black;">
                                <td style="border:1px solid black;">Adjusted Premium &nbsp; ({!selectedProduct.currency__c})</td>  
                                <apex:repeat var="p" value="{!premiumAmountList}">
                                    <td style="border:1px solid black;"><apex:outputText value="{0,Number,###,###,###}"><apex:param value="{!p.actualPremium}"/></apex:outputText></td>
                                </apex:repeat>
                            </tr>
                            <tr style="height:20px; border:1px solid black;">
                                <td style="border:1px solid black;"><b>Total Premium &nbsp; ({!selectedProduct.currency__c})</b></td>  
                                <apex:repeat var="p" value="{!premiumAmountList}">
                                    <td style="border:1px solid black;"><b><apex:outputText value="{0,Number,###,###,###}"><apex:param value="{!p.subTotal}"/></apex:outputText></b></td>
                                </apex:repeat>
                            </tr>
                            <!-- AM project coupon jack add Coupon Pannel -->
                            <tr style="height:20px; border:1px solid black;">
                                <td style="border:1px solid black;"><b>Total Coupon &nbsp; ({!selectedProduct.currency__c})</b></td>  
                                <apex:repeat var="p" value="{!premiumAmountList}">
                                    <td style="border:1px solid black;"><b><apex:outputText value="{0,Number,###,###,###}"><apex:param value="{!p.totalCoupon}"/></apex:outputText></b></td>
                                </apex:repeat>
                            </tr>
                            <!-- AM project coupon jack add Coupon Pannel -->
                            </tbody>
                        </table>
                        <script>
                            hidenZero();
                        </script>
                    </apex:outputPanel>
                
                </apex:pageblockSection>
                
                
                 <apex:pageblockSection id="thePaymentInfo" collapsible="false" columns="2" rendered="{!currentStep == 6}">   
                    <apex:pageBlockSectionItem dataStyleClass="requiredInput required" rendered="{!premiumAmountList.size >0 && null != premiumAmountList && isPaymentButtonClicked == true}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Payment_Type__c.Label}"></apex:outputLabel>
                        <!--<apex:inputField value="{!newPolicy.Payment_Type__c}"></apex:inputField>-->
                        <apex:actionRegion >
                            <apex:selectList size="1" value="{!selectedPaymentType}" multiselect="false" label="{!$ObjectType.New_Policy__c.Fields.Payment_Type__c.Label}">
                                <apex:selectOptions value="{!paymentTypeOptions}"/>
                                <!-- Rancho_CreditCardIssue_20250318 - add loder icon -->
                                <apex:actionSupport event="onchange" action="{!displayOptionalField}" status="loader-icon" rerender="theBankRelatedField,theCreditCardField,thePaymentFrequency,discountSection,paymentInfoPanel,pageMessage,refreshButton" />
                            </apex:selectList>
                        </apex:actionRegion>
                    </apex:pageBlockSectionItem>
                    
                    <apex:pageBlockSectionItem dataStyleClass="requiredInput required" rendered="{!premiumAmountList.size >0 && null != premiumAmountList && isPaymentButtonClicked == true}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Payment_Frequency__c.Label}"></apex:outputLabel>
                        <apex:selectList id="thePaymentFrequency" size="1" value="{!selectedPaymentFrequency}" multiselect="false" label="{!$ObjectType.New_Policy__c.Fields.Payment_Frequency__c.Label}">
                            <apex:selectOptions value="{!paymentFrequencyOptions}"/>
                            <apex:actionSupport event="onchange" action="{!selectPaymentFrequency}" status="loader-icon" rerender="discountSection,paymentInfoPanel,pageMessage" />
                        </apex:selectList>
                    </apex:pageBlockSectionItem>
                     <script type="text/javascript">
                     changeStyle();
                    </script>
                </apex:pageblockSection>
                
                <apex:pageblockSection id="theBankRelatedField" collapsible="false" rendered="{!currentStep == 6}" columns="2" >
                    <!--dataStyleClass="requiredInput required"-->
                    <apex:pageBlockSectionItem rendered="{!displayOptionalField == true && premiumAmountList.size >0 && null != premiumAmountList && isPaymentButtonClicked == true}" id="theBankName">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Bank_Name__c.Label}"></apex:outputLabel>
                        <!--<apex:inputField value="{!newPolicy.Bank_Name__c}"></apex:inputField>-->
                        <apex:selectList size="1" value="{!selectedBank}" multiselect="false" label="{!$ObjectType.New_Policy__c.Fields.Bank_Name__c.Label}">
                            <apex:selectOptions value="{!bankOptions}"/>
                        </apex:selectList>
                    </apex:pageBlockSectionItem>
                    
                    <!-- Add by andy for credit card no. function -->
                    <apex:pageBlockSectionItem rendered="{!displayOptionalField == true && showEditBankNumber == false && premiumAmountList.size >0 && null != premiumAmountList && isPaymentButtonClicked == true}" id="theAccountNoMask">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Bank_Account_No__c.Label}"></apex:outputLabel>
                        <apex:outputPanel >
                            {!newPolicy.Bank_Account_No_Mask__c}
                            &nbsp;&nbsp;&nbsp;
                            <input class="btn" type="button" value="Edit" name="EditBankAcc" onclick="editBankNumber()" />
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    
                    <apex:pageBlockSectionItem rendered="{!displayOptionalField == true && showEditBankNumber == true && premiumAmountList.size >0 && null != premiumAmountList && isPaymentButtonClicked == true}" id="theAccountNo" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Bank_Account_No__c.Label}"></apex:outputLabel>
                        <apex:inputField value="{!newPolicy.Bank_Account_No__c}"></apex:inputField>
                    </apex:pageBlockSectionItem>
                    
                    <apex:pageBlockSectionItem rendered="{!displayOptionalField == true && premiumAmountList.size >0 && null != premiumAmountList && isPaymentButtonClicked == true}" id="theRemarks">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Remarks__c.Label}"></apex:outputLabel>
                        <apex:inputField value="{!newPolicy.Remarks__c}"></apex:inputField>
                    </apex:pageBlockSectionItem>
                    
                    <apex:pageBlockSectionItem >
                    </apex:pageBlockSectionItem>
                    <script type="text/javascript">
                    changeStyle();
                    </script>
                </apex:pageblockSection>
                     
                <apex:pageblockSection id="theCreditCardField" collapsible="false" rendered="{!currentStep == 6 }" columns="2" >   
                    <!--
                        <apex:pageBlockSectionItem rendered="{!displayCreditCardOptionalField == true}" dataStyleClass="requiredInput required">
                            <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Credit_Card_Holder_Full_Name__c.Label}"></apex:outputLabel>
                            <apex:inputField value="{!newPolicy.Credit_Card_Holder_Full_Name__c}" />
                        </apex:pageBlockSectionItem>
                    -->
                    
                    <apex:pageBlockSectionItem rendered="{!displayCreditCardOptionalField == true && premiumAmountList.size >0 && null != premiumAmountList && isPaymentButtonClicked == true}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Name_of_Card_Issuing_Bank__c.Label}"></apex:outputLabel>
                        <apex:selectList size="1" value="{!selectedCreditCardBank}" multiselect="false" label="{!$ObjectType.New_Policy__c.Fields.Name_of_Card_Issuing_Bank__c.Label}">
                            <apex:selectOptions value="{!bankOptions}"/>
                        </apex:selectList>
                    </apex:pageBlockSectionItem>
                    
                    <apex:pageBlockSectionItem rendered="{!displayCreditCardOptionalField == true && premiumAmountList.size >0 && null != premiumAmountList && isPaymentButtonClicked == true}" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Credit_Card_Type__c.Label}"></apex:outputLabel>
                        <apex:selectList size="1" value="{!newPolicy.Credit_Card_Type__c}" multiselect="false">
                            <apex:selectOptions value="{!creditCardTypeOptions}"/>
                        </apex:selectList>
                        <!--<apex:inputField value="{!newPolicy.Credit_Card_Type__c}"></apex:inputField>-->                    
                    </apex:pageBlockSectionItem>
                    
                    <!-- Add by andy for credit card no. function -->
                    <apex:pageBlockSectionItem rendered="{!displayCreditCardOptionalField == true && showEditCreditCardNumber == false && premiumAmountList.size >0 && null != premiumAmountList && isPaymentButtonClicked == true}">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Credit_Card_Number__c.Label}"></apex:outputLabel>
                        <apex:outputPanel >
                            {!newPolicy.Credit_Card_Number_Mask__c}
                            &nbsp;&nbsp;&nbsp;
                            <input class="btn" type="button" value="Edit" name="EditCreditCard" onclick="editCrerditCardNumber()" />
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    
                    <apex:pageBlockSectionItem rendered="{!displayCreditCardOptionalField == true &&  showEditCreditCardNumber == true && premiumAmountList.size >0 && null != premiumAmountList && isPaymentButtonClicked == true}" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Credit_Card_Number__c.Label}"></apex:outputLabel>
                        <apex:inputField value="{!newPolicy.Credit_Card_Number__c}"/>
                    </apex:pageBlockSectionItem>
                    
                    <!--
                    <apex:pageBlockSectionItem rendered="{!displayCreditCardOptionalField == true}" dataStyleClass="requiredInput required">
                        <apex:outputLabel value="{!$ObjectType.New_Policy__c.Fields.Card_Expiry_Date_Text__c.Label} (MM/YYYY)"></apex:outputLabel>
                        //<apex:inputField value="{!newPolicy.Card_Expiry_Date_Text__c}"></apex:inputField>
                        <apex:outputPanel >
                            /**
                            <apex:selectList value="{!selectedCardMonth}" multiselect="false" size="1">
                                <apex:selectOptions value="{!cardExpiryMonthOptions}"></apex:selectOptions>                            
                            </apex:selectList>
                            <apex:selectList value="{!selectedCardYear}" multiselect="false" size="1">
                                <apex:selectOptions value="{!cardExpiryYearOptions}"></apex:selectOptions>                            
                            </apex:selectList>    
                            **/
                            <apex:inputText value="{!selectedCardMonth}" style="width: 50px;"/>
                            <apex:inputText value="{!selectedCardYear}" style="width: 50px;"/>
                        </apex:outputPanel>
                    </apex:pageBlockSectionItem>
                    -->
                    <script type="text/javascript">
                    changeStyle();
                    </script>
                </apex:pageblockSection>
                                
                <!--TM Work From Home_20200827-->
                <apex:pageblockSection id="refreshButton" collapsible="false" rendered="{!currentStep == 6 && wortAtHome}" columns="2" >
                    <apex:pageBlockSectionItem dataStyle="text-align:right;" rendered="{!AND(OR(displayOptionalField, displayCreditCardOptionalField), CASE(selectedPaymentType, 'Direct Debit', IF(showEditBankNumber, 0, 1),'Direct Billing', IF(showEditBankNumber, 0, 1),'Credit Card Billing', IF(showEditCreditCardNumber, 0, 1),0) = 1, !ISNULL(premiumAmountList), premiumAmountList.size >0, isPaymentButtonClicked == true)}">
                        <input class="btn" type="button" value="Refresh" name="Refresh" onclick="Server.refreshPaymentInformation()" />
                    </apex:pageBlockSectionItem>
                    <apex:pageBlockSectionItem >
                    </apex:pageBlockSectionItem>
                </apex:pageblockSection>
                
                <script type="text/javascript" >                
                    function copyHolderForBenefit(piNo,bnNum){
                        var prefix = "{!$Component.theForm1.detail.beneficiaryInformation.piRepeat}";
                        if(null != document.getElementById(prefix+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBeneLastName:beneficiaryLastName")){
                            document.getElementById(prefix+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBeneLastName:beneficiaryLastName").value = "{!newPolicy.Policy_Holder_Last_Name__c}";
                        }else if(null != document.getElementById(prefix+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBeneLastName2:beneficiaryLastName")){
                            document.getElementById(prefix+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBeneLastName2:beneficiaryLastName").value = "{!newPolicy.Policy_Holder_Last_Name__c}";
                        }
                        if(null != document.getElementById(prefix+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBeneFirstName:beneficiaryFirstName")){
                            document.getElementById(prefix+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBeneFirstName:beneficiaryFirstName").value = "{!newPolicy.Policy_Holder_First_Name__c}";
                        }else if(null != document.getElementById(prefix+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBeneFirstName2:beneficiaryFirstName")){
                            document.getElementById(prefix+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBeneFirstName2:beneficiaryFirstName").value = "{!newPolicy.Policy_Holder_First_Name__c}";
                        }
                        if(null != document.getElementById(prefix+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBenePersonId:beneficiaryPersonID")){
                            //TM Work from Home
                            // SPS-567
                            let holderPersonId = "{!newPolicy.Personal_ID__c}";
                            let origHolderPersonId = "{!orgnDataBeforeMask.Personal_ID_Ori}";
                            let workAtHome = {!orgnDataBeforeMask.workAtHome};
                            if(workAtHome) {
                                
                                const beneOrigPersonId =  $("input[data-hidden-id='origPersonId"+piNo + "-"+bnNum+"']");
                                if(beneOrigPersonId.length > 0) {
                                    beneOrigPersonId.val(origHolderPersonId);
                                }
                                document.getElementById(prefix+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBenePersonId:beneficiaryPersonID").value = holderPersonId;

                            } else {
                                document.getElementById(prefix+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBenePersonId:beneficiaryPersonID").value = holderPerson;
                            }
                        }else if(null != document.getElementById(prefix+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBenePersonId2:beneficiaryPersonID")){
                            //TM Work from Home
                            // SPS-567
                            let holderPersonId = "{!newPolicy.Personal_ID__c}";
                            let origHolderPersonId = "{!orgnDataBeforeMask.Personal_ID_Ori}";
                            let workAtHome = {!orgnDataBeforeMask.workAtHome};
                            if(workAtHome) {
                                const beneOrigPersonId =  $("input[data-hidden-id='origPersonId"+piNo + "-"+bnNum+"']");
                                if(beneOrigPersonId.length > 0) {
                                    beneOrigPersonId.val(origHolderPersonId);
                                }

                                document.getElementById(prefix+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBenePersonId2:beneficiaryPersonID").value = holderPersonId;

                            } else {
                                document.getElementById(prefix+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBenePersonId2:beneficiaryPersonID").value = holderPerson;
                            }
                        }
                        if(null != document.getElementById(prefix+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBeneBeneficiaryType:beneficiaryType")){
                            document.getElementById(prefix+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBeneBeneficiaryType:beneficiaryType").value = "Primary";
                        }else if(null != document.getElementById(prefix+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBeneBeneficiaryType2:beneficiaryType")){
                            document.getElementById(prefix+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBeneBeneficiaryType2:beneficiaryType").value = "Primary";
                        }
                        if(null != document.getElementById(prefix+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBeneGender:beneficiaryGender")){
                            document.getElementById(prefix+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBeneGender:beneficiaryGender").value = "{!newPolicy.Gender__c}";
                        }else if(null != document.getElementById(prefix+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBeneGender2:beneficiaryGender")){
                            document.getElementById(prefix+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBeneGender2:beneficiaryGender").value = "{!newPolicy.Gender__c}";
                        }
                        if(null != document.getElementById(prefix+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBeneRelationship:beneficiaryRelationship")){
                            document.getElementById(prefix+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBeneRelationship:beneficiaryRelationship").value = "Policy Holder";
                        }else if(null != document.getElementById(prefix+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBeneRelationship2:beneficiaryRelationship")){
                            document.getElementById(prefix+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBeneRelationship2:beneficiaryRelationship").value = "Policy Holder";
                        }
                        if(null != document.getElementById(prefix+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBeneBeneficiaryPercent:beneficiaryPercent")){
                            document.getElementById(prefix+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBeneBeneficiaryPercent:beneficiaryPercent").value = 100;
                        }else if(null != document.getElementById(prefix+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBeneBeneficiaryPercent2:beneficiaryPercent")){
                            document.getElementById(prefix+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBeneBeneficiaryPercent2:beneficiaryPercent").value = 100;
                        }
                        //document.getElementById("{!$Component.theForm1.detail.beneficiaryInformation.piRepeat}"+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBeneBeneficiaryType:beneficiaryType").value = "{!newPolicy.Benefit_Type__c}";
                    }
                
                    function changeTaxNum(selectedCountryName,id){
                        var no = id.slice(-1);
                        var countryList = JSON.parse('{!countryListJson}');
                        for(var i=0;i<countryList.length;i++){
                            if(selectedCountryName == countryList[i].Name && countryList[i].Crs_Ind__c == true){
                                document.getElementById("{!$Component.theForm1.detail.policyHolderInformation}"+ ":theTaxNum"+ no + ":tin" + no).value = "PENDING";
                                break;
                            }else{
                                document.getElementById("{!$Component.theForm1.detail.policyHolderInformation}"+ ":theTaxNum"+ no + ":tin" + no).value = "";
                            }
                        }
                    }                    
                    
                    function UWPresalesComplete(){                        
                        if({!presalesAccepted} == true){
                            Server.nextStep();
                        }else{
                            return;
                        }                    
                    }
                </script>                
            </apex:pageBlock>
        </apex:form>
    </apex:outputPanel>
    </div>
    <script type="text/javascript" >
        function addRider1(button){
            addRider(button);
        }
    
        function checkAppeal(result,type,piNo){            
            if(type == 'presales'){
                if(result=='Appeal'){
                    document.getElementById("preSaleAppealNo"+piNo).checked = false;
                }else if(result=='Accept'){
                    document.getElementById("preSaleAppealYes"+piNo).checked = false;
                }
                document.getElementById("{!$Component.theForm1.detail.theUWInformation.PISList}:"+ piNo +":thePreSalesAppeal:preSalesAppeal").value = result;
                displayAppealForPresalesToCtrl();
            }else if(type == 'uwresults'){
                if(result=='Appeal'){
                    document.getElementById("uwResultAppealNo"+piNo).checked = false;
                    document.getElementById("uwResultAppealWithdraw"+piNo).checked = false;
                }else if(result=='Accept'){
                    document.getElementById("uwResultAppealYes"+piNo).checked = false;
                    document.getElementById("uwResultAppealWithdraw"+piNo).checked = false;
                }else if(result=='Withdrawn'){
                    document.getElementById("uwResultAppealYes"+piNo).checked = false;
                    document.getElementById("uwResultAppealNo"+piNo).checked = false;
                }
                document.getElementById("{!$Component.theForm1.detail.theConfirmationPayment.UWPISList}:"+ piNo +":theUwResultAppeal:uwResultAppeal").value = result;
                selectUWAppeal();
                console.log('element='+document.getElementById("{!$Component.theForm1.detail.theConfirmationPayment.UWPISList}:"+ piNo +":theUwResultAppeal:uwResultAppeal").value);
                if(result == 'Appeal'){
                    var policyno = document.getElementById("pn"+piNo).value;
                    console.log('selected policy no='+policyno);
                    alert('Selected appeal for policy-'+policyno+'\n'+'Please click save before closing the window');
                }
            }
        }
    
        function copyHolderInfo(){
            //console.log('{!$Component.detail.policyHolderInformation}');
            var idAttr = "{!$Component.theForm1.detail.PersonInsuredInformation.personInsuredList}:0:PIPageBlock:";/* add by Jack on 2022-01-28 for project: IA AML */
            var insuredLastName = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theLastName.policyHolderLastName}").value;
            var insuredFirstName = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theFirstName.policyHolderFirstName}").value;
            //var insuredChi = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theChiName.policyHolderNameChi}").value;
            var theGender = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theGender.gender}").value;
            var theDateOfBirth = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theDateOfBirth.dateOfBirth}").value;
            var theNationality = null;
            if(null != document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theNationality.nationality}")){
                theNationality = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theNationality.nationality}").value;
            }
            var theIDType = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theIDType.idType}").value;
            var thePersonalId = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.thePersonalId.personalId}").value;
            var theEmail;
            if(null != document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theEmail.Email}")){
                theEmail = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theEmail.Email}").value;
            }
            var thePlaceOfBirth = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.thePlaceOfBirth.placeOfBirth}").value;/* add by Jack on 2021-12-14 for project: IA AML nationality mandatory */ 
            console.log('thePlaceOfBirth:'+thePlaceOfBirth);
            var theEmailCheck
            if(null != document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theEmail.EmailCheck}")){
                theEmailCheck = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theEmail.EmailCheck}").checked;
            }
            var thePHAge = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.thePHAge.PHAge}").innerText;
            var theResiAdd1;
            var theResiAdd2;
            var theResiAdd3;
            var theResiAdd4;
            var theResiAddCountry;
            if(null != document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theResiAdd1.ResidentialAddress1}")){
                theResiAdd1 = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theResiAdd1.ResidentialAddress1}").value;
                //add by haoli for tm address
                theResiAdd2 = $("input[id*='ResidentialAddress2']").val();
                //end
                theResiAdd3 = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theResiAdd3.ResidentialAddress3}").value;
                theResiAdd4 = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theResiAdd4.ResidentialAddress4}").value;
                theResiAddCountry = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theResiCountry.ResidentialAddressCountry}").value;                
            }
            // AM project AM info enhancement jack add
            /* add by Jack on 2022-10-12 for project: JOBR-217 Enhance Asiamiles membership info validation */
            if({!isCXagent}){
                if(null != document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theAsiaMilesMembershipNumCX.AsiaMilesMembershipNumCX}")){
                    var AMid = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theAsiaMilesMembershipNumCX.AsiaMilesMembershipNumCX}").value;
                    document.getElementById(idAttr + "theAsiaMilesMembershipNumCX:AsiaMilesMembershipNumCXpi").value = AMid;
                }
                if(null != document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theAsiaMilesMembershipFirstNameCX.AsiaMilesMembershipFirstNameCX}")){
                    var AMfirstName = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theAsiaMilesMembershipFirstNameCX.AsiaMilesMembershipFirstNameCX}").value;
                    document.getElementById(idAttr + "theAsiaMilesMembershipFirstNameCX:AsiaMilesMembershipFirstNameCXpi").value = AMfirstName;
                }
                if(null != document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theAsiaMilesMembershipLastNameCX.AsiaMilesMembershipLastNameCX}")){
                    var AMlastName = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theAsiaMilesMembershipLastNameCX.AsiaMilesMembershipLastNameCX}").value;
                    document.getElementById(idAttr + "theAsiaMilesMembershipLastNameCX:AsiaMilesMembershipLastNameCXpi").value = AMlastName;
                }
            }else{
                if(null != document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theAsiaMilesMembershipNum.AsiaMilesMembershipNum}")){
                    var AMid = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theAsiaMilesMembershipNum.AsiaMilesMembershipNum}").value;
                    document.getElementById(idAttr + "theAsiaMilesMembershipNum:AsiaMilesMembershipNumpi").value = AMid;
                }
                    if(null != document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theAsiaMilesMembershipFirstName.AsiaMilesMembershipFirstName}")){
                    var AMfirstName = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theAsiaMilesMembershipFirstName.AsiaMilesMembershipFirstName}").value;
                    document.getElementById(idAttr + "theAsiaMilesMembershipFirstName:AsiaMilesMembershipFirstNamepi").value = AMfirstName;
                }
                    if(null != document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theAsiaMilesMembershipLastName.AsiaMilesMembershipLastName}")){
                    var AMlastName = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theAsiaMilesMembershipLastName.AsiaMilesMembershipLastName}").value;
                    document.getElementById(idAttr + "theAsiaMilesMembershipLastName:AsiaMilesMembershipLastNamepi").value = AMlastName;
                }
            }

            document.getElementById(idAttr+"theInsuredType:TMInsuredType").innerText = "PH = PI";
            document.getElementById(idAttr+"theInsuredLastName:insuredLastName").value = insuredLastName;
            document.getElementById(idAttr+"theInsuredFirstName:insuredFirstName").value = insuredFirstName;
            document.getElementById(idAttr+"thePIGender:PIGender").value = theGender;
            document.getElementById(idAttr+"thePIDateOfBirth:PIDateOfBirth").value = theDateOfBirth;
            if(null != theNationality){
                if(null != document.getElementById(idAttr+"thePINationality:PINationality")){
                    document.getElementById(idAttr+"thePINationality:PINationality").value = theNationality;
                }
                
            }
            document.getElementById(idAttr+"thePIIDType:PIIDType").value = theIDType;
            document.getElementById(idAttr+"thePIPersonalId:PIPersonalId").value = thePersonalId;

            // TM Work at Home
            // SPS-567
            var copyHlderEle =  $("input[data-hidden-id='isCopyHolder0']");
            if(copyHlderEle.length > 0) {
                copyHlderEle.val(true);
            }

            if(null != document.getElementById(idAttr+"thePIEmail:PIEmail")){
                document.getElementById(idAttr+"thePIEmail:PIEmail").value = theEmail;
            }        
            /* add by Jack on 2021-12-14 for project: IA AML nationality mandatory */
            console.log(document.getElementById(idAttr+"thePiPlaceOfBirth:piPlaceOfBirth"));
            if(null != document.getElementById(idAttr+"thePiPlaceOfBirth:piPlaceOfBirth")){
                document.getElementById(idAttr+"thePiPlaceOfBirth:piPlaceOfBirth").value = thePlaceOfBirth;
            }
            /* add by Jack on 2021-12-14 for project: IA AML nationality mandatory */
            document.getElementById(idAttr+"theInsuredRelationship:piRelationship").value = "Policy Holder";       
            if(null != theEmailCheck && null != document.getElementById(idAttr+"thePIEmail:PIEmailCheck")){
                document.getElementById(idAttr+"thePIEmail:PIEmailCheck").checked = theEmailCheck;
            }
            document.getElementById(idAttr+"thePIAge:PIAge").innerText = thePHAge;
            if(null != document.getElementById(idAttr+"thePIResAdd1:piResAdd1") && null!=theResiAdd1){
                document.getElementById(idAttr+"thePIResAdd1:piResAdd1").value = theResiAdd1;
                //refreshPIResidentialAddressToCtrl();
            }else if(null != document.getElementById(idAttr+"thePIResAdd11:piResAdd1") && null!=theResiAdd1){
                document.getElementById(idAttr+"thePIResAdd11:piResAdd1").value = theResiAdd1;
                // TM Work at Home
                // SPS-567
                var copyHlderAddEle =  $("input[data-hidden-id='iscopyHlderAddress0']");
                if(copyHlderAddEle.length > 0) {
                    copyHlderAddEle.val(true);
                }
                //refreshPIResidentialAddressToCtrl();
            }

            if(document.getElementById(idAttr+"thePIResAdd21:piResAdd2") != null){
                document.getElementById(idAttr+"thePIResAdd21:piResAdd2").value = theResiAdd2;
            }
            if(document.getElementById(idAttr+"thePIResAdd31:piResAdd3") != null){
                document.getElementById(idAttr+"thePIResAdd31:piResAdd3").value = theResiAdd3;
            }
            if(document.getElementById(idAttr+"thePIResAdd41:piResAdd4") != null){
                document.getElementById(idAttr+"thePIResAdd41:piResAdd4").value = theResiAdd4;
            }
            if(document.getElementById(idAttr+"thePIResAddCountry:piResAddCountry") != null){
                document.getElementById(idAttr+"thePIResAddCountry:piResAddCountry").value = theResiAddCountry;
            }
            
            autoGenerateInsureType();
        }
        
        function copyCorrespondingAddress(){
            debugger;
            var theCorre1;
            var theCorre2;
            var theCorre3;
            var theCorre4;
            if(null != document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theCorre1.correspondingAddress1}") ){
                theCorre1 = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theCorre1.correspondingAddress1}");
            }else{
                theCorre1 = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theCorre11.correspondingAddress1}");
            }
            if(null != document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theCorre2.correspondingAddress2}") ){
                 theCorre2 = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theCorre2.correspondingAddress2}");
            }else{
                 theCorre2 = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theCorre21.correspondingAddress2}");
            }
            if(null != document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theCorre3.correspondingAddress3}") ){
                 theCorre3 = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theCorre3.correspondingAddress3}");
            }else{
                 theCorre3 = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theCorre31.correspondingAddress3}");
            }
            if(null != document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theCorre4.correspondingAddress4}") ){
                 theCorre4 = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theCorre4.correspondingAddress4}");
            }else{
                 theCorre4 = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theCorre41.correspondingAddress4}");
            }
            
            var theCorreCountry = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theCorreCountry.correspondingAddressCountry}");  
           
            theCorre1.value = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theResiAdd1.ResidentialAddress1}").value;

            // TM Work at Home
            // SPS-567
            var copyCrspdAddEle =  $("input[data-hidden-id='isCopyCrspdAddress0']");
            if(copyCrspdAddEle.length > 0) {
                copyCrspdAddEle.val(true);
            }

            theCorre2.value = $("input[id*='ResidentialAddress2']").val();
            //end
            theCorre3.value = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theResiAdd3.ResidentialAddress3}").value;
            theCorre4.value = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theResiAdd4.ResidentialAddress4}").value;
            theCorreCountry.value = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theResiCountry.ResidentialAddressCountry}").value;
        }
    
        function copyHolderAddress(noOfPI){
            var no = noOfPI.replace('CopyAddressBtn','');
            no = no -1;
            var att = "{!$Component.theForm1.detail.PersonInsuredInformation.personInsuredList}:";
            // Rancho_IA AML_20220120: add element id - PIPageBlock for PI
            if(null != document.getElementById(att+no+":PIPageBlock:thePIResAdd1:piResAdd1")){
                document.getElementById(att+no+":PIPageBlock:thePIResAdd1:piResAdd1").value = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theResiAdd1.ResidentialAddress1}").value;

                // TM Work at Home
                // SPS-567
                var copyHlderAddEle =  $("input[data-hidden-id='iscopyHlderAddress" + no + "']");
                if(copyHlderAddEle.length > 0) {
                    copyHlderAddEle.val(true);
                }
            }else if(null != document.getElementById(att+no+":PIPageBlock:thePIResAdd11:piResAdd1")){
                document.getElementById(att+no+":PIPageBlock:thePIResAdd11:piResAdd1").value = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theResiAdd1.ResidentialAddress1}").value;
            }
            if(null != document.getElementById(att+no+":PIPageBlock:thePIResAdd21:piResAdd2")){
                document.getElementById(att+no+":PIPageBlock:thePIResAdd21:piResAdd2").value = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theResiAdd2.ResidentialAddress2}").value;
            }
            
            if(null != document.getElementById(att+no+":PIPageBlock:thePIResAdd31:piResAdd3")){
                document.getElementById(att+no+":PIPageBlock:thePIResAdd31:piResAdd3").value = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theResiAdd3.ResidentialAddress3}").value;
            }
            
            if(null != document.getElementById(att+no+":PIPageBlock:thePIResAdd41:piResAdd4")){
                document.getElementById(att+no+":PIPageBlock:thePIResAdd41:piResAdd4").value = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theResiAdd4.ResidentialAddress4}").value;
            }
            
            if(null != document.getElementById(att+no+":PIPageBlock:thePIResAddCountry:piResAddCountry")){
                document.getElementById(att+no+":PIPageBlock:thePIResAddCountry:piResAddCountry").value = document.getElementById("{!$Component.theForm1.detail.policyHolderInformation.theResiCountry.ResidentialAddressCountry}").value;
            }  
            
        }
    
        function hideFirstCopyAboveButton(){
            //alert("hideFirstCopyAboveButton");
            $("[name='above0']").hide();
        }
    
        /**
        function copyAboveBeneficiary(piNo,bnNum){
            var attr = "{!$Component.theForm1.detail.beneficiaryInformation.piRepeat}";
            var lastBnNum = bnNum - 1;
            document.getElementById(attr+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBeneLastName:beneficiaryLastName").value = document.getElementById(attr+":"+piNo+":beneficiaryRepeat:"+lastBnNum+":theBeneLastName:beneficiaryLastName").value;
            document.getElementById(attr+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBeneFirstName:beneficiaryFirstName").value = document.getElementById(attr+":"+piNo+":beneficiaryRepeat:"+lastBnNum+":theBeneFirstName:beneficiaryFirstName").value;
            document.getElementById(attr+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBenePersonId:beneficiaryPersonID").value = document.getElementById(attr+":"+piNo+":beneficiaryRepeat:"+lastBnNum+":theBenePersonId:beneficiaryPersonID").value;
            document.getElementById(attr+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBeneBeneficiaryType:beneficiaryType").value = document.getElementById(attr+":"+piNo+":beneficiaryRepeat:"+lastBnNum+":theBeneBeneficiaryType:beneficiaryType").value;
            document.getElementById(attr+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBeneGender:beneficiaryGender").value = document.getElementById(attr+":"+piNo+":beneficiaryRepeat:"+lastBnNum+":theBeneGender:beneficiaryGender").value;
            document.getElementById(attr+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBeneRelationship:beneficiaryRelationship").value = document.getElementById(attr+":"+piNo+":beneficiaryRepeat:"+lastBnNum+":theBeneRelationship:beneficiaryRelationship").value;
            document.getElementById(attr+":"+piNo+":beneficiaryRepeat:"+bnNum+":theBeneBeneficiaryPercent:beneficiaryPercent").value = document.getElementById(attr+":"+piNo+":beneficiaryRepeat:"+lastBnNum+":theBeneBeneficiaryPercent:beneficiaryPercent").value;
        }
        **/
      
        function autoGenerateInsureTypeByJS(piNum){
            autoGenerateInsureType();
            debugger
            /* add by Jack on 2022-04-08 for project: IA AML issue fix */
            var prefix = "{!$Component.theForm1.detail.PersonInsuredInformation.personInsuredList}:"
            var outputfield = document.getElementById(prefix + piNum + ":PIPageBlock:theInsuredType:TMInsuredType");
            var inputfield = document.getElementById(prefix + piNum + ":PIPageBlock:hiddenField:TMInsuredTypeHidden");
            var relationship = document.getElementById(prefix + piNum + ":PIPageBlock:theInsuredRelationship:piRelationship").value;
            var insuredType;
            if(relationship === "Policy Holder"){
                insuredType = "PH = PI";
            }else if(relationship === "Spouse"){
                insuredType = 'Spouse';
            }else if(relationship === "Son" || relationship === "Daughter" || relationship === "Dependent"){
                insuredType = 'Dependent';
            }else{
                insuredType = '';
            }
            console.log(insuredType);
            outputfield.value = insuredType;
            inputfield.value = insuredType;
        }
        
    </script>
</apex:page>