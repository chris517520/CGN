<!-- Page: composition -->
<!-- This page acts as the template. action="{!getDownTimeMessage}"-->
<apex:page showHeader="false" docType="html-5.0"  controller="CustomerPageTemplateCtrl" language="{!JSINHTMLENCODE($CurrentPage.Parameters.lang)}" action="{!getDownTimeMessage}">
                                                                                                              
    <head>
        
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, viewport-fit=cover, app-id=1202342855" />
        <!--<script type='text/javascript' src='{!$Setup.Portal_Settings__c.Live_Agent_JavaScript_URL__c}'></script>-->
        
        

        <!-- CR-58 performance tuning: defer the no critical resoruce 2022-03-01 Zane -->
        <link rel="preconnect" href="https://www.glancecdn.net/cobrowse/CobrowseJS.ashx"/>
        <link rel="preconnect" href="https://storage.glancecdn.net/"/>
        <link rel="preconnect" href="https://www.google-analytics.com"/>
        <link rel="preconnect" href="https://www.googleadservices.com"/>

        <link rel="preload" href="{!$Setup.Portal_Settings__c.Live_Agent_JavaScript_URL__c}" as="script"/>
        <link rel="preload" href="{!URLFOR($Resource.Cigna_HK_Icons, 'Cigna-HK-Icons.css')}" as="style" onload="this.onload=null;this.rel='stylesheet'"/>
        <!-- temp comment, invalid in sandbox -->
        <link rel="preload" href="{!$Setup.Portal_Settings__c.Typography_Font_URL__c}" as="style" onload="this.onload=null;this.rel='stylesheet'"/>
        <!-- CR-56_Link_20220214 -->
        <link rel="preload" href="{!URLFOR($Resource.DD_Demo, 'css/bootstrap3.4.1.css')}" as="style" onload="this.onload=null;this.rel='stylesheet'"/>
        <link rel="preload" href="{!URLFOR($Resource.DD_Demo, 'css/font-awesome.min.css')}" as="style" onload="this.onload=null;this.rel='stylesheet'"/>
        <link rel="preload" href="{!URLFOR($Resource.jasny_bootstrap, 'css/jasny-bootstrap.min.css')}" as="style" onload="this.onload=null;this.rel='stylesheet'"/>
        <link rel="preload" href="{!$Resource.Cigna_Deployment}" as="script"/>

        
        <!-- CR-58 End -->
        <apex:includeScript value="{!$Resource.Cigna_Deployment}"/>
        <apex:stylesheet value="{!URLFOR($Resource.Cigna_HK_Icons, 'Cigna-HK-Icons.css')}" />

        <!--Nicole_SMT_20210617-->
        <!-- Google Tag Manager -->
        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl+ '&gtm_auth=bMOSXx-Ik5APkrCQOskHiA&gtm_preview=env-5&gtm_cookies_win=x';f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer','GTM-PGJ23KN');</script>
        <!-- End Google Tag Manager -->

        <style>
            .compact a {
                padding: 7px !important;
            }

            .compact li {
                margin-left: 0px !important;
                font-size: 0.8em;
            }

            .footer-text {
                padding-left: 20px;
                padding-right: 20px;
                border-right: 1px solid #777;
            }

            .standout {
                font-size: 12pt;
            }

            <!-- sm screen -->@media(min-width:768px) and (max-width:991px) {
                .compactIfSmall a {
                    padding: 9px !important;
                }
                .compactIfSmall li {
                    margin-left: 0px !important;
                }
                .bs .header-title-2 {
                    font-size: 0.72em;
                }
                .footer-text {
                    padding-left: 4px;
                    padding-right: 4px;
                }
                .bs .media-button {
                    padding-left: 4px !important;
                }
                .bs .navmenu-footer {
                    padding: 0px;
                }
            }

            <!-- screen -->@media(min-width:991px) and (max-width:1200px) {
                .compactIfSmall a {
                    padding: 9px !important;
                }
                .compactIfSmall li {
                    margin-left: 0px !important;
                }
                .bs .header-title-2 {
                    font-size: 0.82em;
                }
                .footer-text {
                    padding-left: 5px;
                    padding-right: 5px;
                }
                .bs .media-button {
                    padding-left: 4px !important;
                }
                .bs .navmenu-footer {
                    padding: 2px;
                }
            }

            .bs .header-title-1 {
                padding-top: 0px;
            }

            .navbar-img {
                background: url('{!$Resource.Cigna_Horizontal_Logo}');
                background-repeat: no-repeat;
                background-size: contain;
                width: 140px;
                height: 50px;
                position: initial;
            }
            .navbar-text a {
                color: inherit !important;
                margin-right: 10px;
            }

            .navbar-collapse {
                max-height: 100vh !important;
            }

            body {
                padding-top: 80px;
            }

            @media (max-width: 767px) {
                body {
                    padding-top: 50px;
                }
                div#reallocationSpecialBox,
                div#specialBox,
                div#specialBoxPIC {
                    display: none;
                    position: absolute;
                    z-index: 11;
                    margin: 100px auto 0px auto;
                    width: 90%;
                    height: 80%;
                    background: #FFF;
                    color: #000;
                    left: 5%;
                    padding: 20px;
                    border-radius: 5px;
                }
                <!-- Kit's -->
                div#downtimeMessageBox {
                    display: none;
                    position: absolute;
                    z-index: 11;
                    margin: 100px auto 0px auto;   /*20210803 - minghua - SMT-99 116677 - IPhone 12 pro max UI issue, change 60 to 100*/
                    width: 80%; /*Autumn_JR1902_20210409*/
                    max-height: 70%; /*Autumn JR1902*/
                    overflow-y: auto;
                    background: #FFF;
                    color: #000;
                    left: 10%;
                    padding: 20px;
                    border-radius: 5px;
                }
                /*Rancho_PendingMemo_20201105*/
                div#reallocationSpecialBox_PendingMemo {
                    position: absolute;
                    z-index: 11;
                    margin: 100px auto 0px auto;
                    width: 80%;
                    height: 20%;
                    background: #FFF;
                    color: #000;
                    left: 10%;
                    padding: 20px;
                    border-radius: 5px;
                }
                /*20201030 - minghua - PendingMemo*/
                div#pendMemoBox {
                    display: none;
                    position: absolute;
                    z-index: 1100;
                    width: 100%;
                    height: 100%;
                    background: #FFF;
                    color: #000;
                    right: 0px;
                    padding: 10px;
                    border-radius: 5px;
                    border: 2px solid rgb(246, 134, 33);
                }
                div#overlayPendMemo {
                    display: none;
                    z-index: 1100;
                    position: fixed;
                    width: 100%;
                    height: 90%;
                }
                 #contentPendMemo {
                    padding:10px 20px 10px 10px;
                    color:#000;
                    font-size:12px;
                    width: 100%;
                    height: 95%;
                    overflow-y:auto;
                }
            }

            @media (min-width: 768px) {
                body {
                    padding-top: 50px;
                }
                div#reallocationSpecialBox,
                div#specialBox,
                div#specialBoxPIC {
                    display: none;
                    position: absolute;
                    z-index: 11;
                    margin: 150px auto 0px auto;
                    width: 80%;
                    height: 60%;
                    background: #FFF;
                    color: #000;
                    left: 10%;
                    padding: 20px;
                    border-radius: 5px;
                }
                <!-- Kit's -->
                div#downtimeMessageBox {
                    display: none;
                    position: absolute;
                    z-index: 11;
                    margin: 124px auto;
                    width: 40%; /*Autumn_JR1902_20210409*/
                    max-height: 70%; /*Autumn JR1902*/
                    overflow-y: auto;
                    background: #FFF;
                    color: #000;
                    left: 30%;
                    padding: 20px;
                    border-radius: 5px;
                }
                /*Rancho_PendingMemo_20201105*/
                div#reallocationSpecialBox_PendingMemo{
                    position: absolute;
                    z-index: 11;
                    margin: 150px auto 0px auto;
                    width: 50%;
                    height: 15%;
                    background: #FFF;
                    color: #000;
                    left: 25%;
                    padding: 20px;
                    border-radius: 5px;
                }
                /*20201030 - minghua - PendingMemo*/
                div#pendMemoBox {
                    display: none;
                    position: absolute;
                    z-index: 1100;
                    width: 600px;
                    height: 80%;
                    background: #FFF;
                    color: #000;
                    right: 0px;
                    padding: 20px;
                    text-align: left;
                    border-radius:5px;
                    border: 2px solid rgb(246, 134, 33);
                }
                div#overlayPendMemo {
                    display: none;
                    z-index: 1100;
                    position: fixed;
                    width: 600px;
                    height: 100%;
                    top: 35px;
                    right: 10px;
                }
                #contentPendMemo {
                    padding:10px 20px 10px 10px;
                    color:#000;
                    font-size:12px;
                    width: 100%;
                    height: 95%;
                    overflow-y:auto;
                }
            }
            /*Rancho_PendingMemo_20201123*/
            @media (min-width: 768px) and (max-width: 1200px){
                div#reallocationSpecialBox_PendingMemo{
                    position: absolute;
                    z-index: 11;
                    margin: 220px auto 0px auto;
                    width: 50%;
                    height: 15%;
                    background: #FFF;
                    color: #000;
                    left: 25%;
                    padding: 20px;
                    border-radius: 5px;
                }
            }

            /*20201030 - minghua - PendingMemo*/
            .tip {
                display:block;
                background:#f00;
                border-radius:50%;
                width:8px;
                height:8px;
                top:10px;
                left:-10px;
                position:absolute;
            }
            .bs .bold-font {
                font-weight: bold;
            }
            .bs .table-content{
                padding: 20px 20px 0px 20px;
            }
            .bs .grey-background {
                background-color: rgb(242, 242, 242);
            }
            .pendingMemoBox {
                position: relative;
            }
            .pendingMemoBox .pendingMemoNum {
                position: absolute;
                left: 50%;
                top: -1px;
                background-color: red;
                color: white;
                line-height: 15px;
                width: 15px;
                border-radius: 16px;
                text-align: center;
                font-size: 0.7em;
            }
            .pendingMemoBox .pendingMemoLoading {
                position:absolute;
                left: 50%;
                top: -5px;
                -webkit-border-radius: 16px;
                border-radius: 16px;
            }
            
            #closeOverlayPendMemo {
                position: absolute;
                top: 10px;
                right: 10px;
            }
            .bs .navbar-message-icon {
                margin-right: 13px;
                margin-top: 6px;
            }
            div#reallocationOverlay_PendingMemo {
                z-index: 10;
                background: #D9D9D6;
                position: fixed;
                width: 100%;
                height: 100%;
                top: 0px;
                left: 0px;
                text-align: center;
            }
            #reallocationCloseOverlay_PendingMemo {
                position: absolute;
                top: 10px;
                right: 10px;
            }
            #reallocationtccontent_PendingMemo {
                padding: 10px;
                color: #000;
                font-size: 14px;
                width: 100%;
                height: 95%;
                overflow-y: auto;
            }

            .firstTab {
                margin-left: 2px;
            }
            /* TL */

            .bs {
                font-family: "Gotham SSm A", "Gotham SSm B", "Microsoft Jhenghei", "LiHei Pro", "Heiti TC", Arial, Helvetica, sans-serif;
                font-style: normal;
                font-weight: 400;
                font-size: 12px;
            }

            .bs .navbar-brand {
                padding: 10px !important;
            }

            @media (max-width: 767px) {
                .bs .navbar-nav li {
                    background-color: #004986 !important;
                    border-bottom: 1px solid #fff !important;
                }
                .bs .navbar-nav li>a {
                    color: #fff !important;
                }
            }

            .bs .navbar-nav li:hover {
                background-color: #39B54A !important;
            }

            .bs .navbar-uppercase {
                text-transform: uppercase;
            }

            .bs .navbar-nav li a:hover {
                color: #fff !important;
            }

            .bs .navbar-no-margin li {
                margin: 0;
            }

            .bs .navmenu {
                background: #f3f3f4;
            }

            .bs .navmenu ul li,
            .bs .navmenu a,
            .bs .navmenu p,
            .bs .navmenu span,
            .bs .navmenu div {
                font-family: "Gotham SSm A", "Gotham SSm B", "Microsoft Jhenghei", "LiHei Pro", "Heiti TC", Arial, Helvetica, sans-serif !important;
                font-weight: 400 !important;
            }

            .bs .nav-sub-menu {
                margin-top: 45px;
            }

            .bs .nav-sub-menu li a {
                font-size: .9em !important;
            }

            .bs .navmenu ul.navmenu-nav {
                background: #fff;
            }

            .bs .navmenu ul.navmenu-nav li {
                border-top: 1px solid #C8C9C7;
                margin: 0;
            }

            .bs .navmenu ul.navmenu-nav li a {
                margin: .4em 0 .4em .7em;
                font-weight: bold;
            }

            .bs .navmenu-nav>.dropdown>ul.dropdown-menu {
                padding: 0 !important;
            }

            .bs .navmenu ul.navmenu-nav li:last-child {
                border-bottom: 1px solid #C8C9C7;
            }

            .bs .navmenu ul.nav-sub-menu .dropdown-menu li:last-child {
                border-bottom: 0 !important;
            }

            .bs .navmenu ul li a>i {
                min-width: 25px;
            }

            .bs .navmenu-footer {
                font-size: 12px !important;
                margin-top: 10px;
                margin-bottom: 10px;
                color: #777;
                text-transform: uppercase;
                text-align: center;
            }

            .bs .navmenu-footer a {
                color: #777;
                text-decoration: none;
            }

            .bs .navmenu-footer a:hover {
                color: #777;
                text-decoration: none;
            }

            .offcanvas {
                display: none;
            }

            .bs .navmenu-nav>.open>a {
                background: none !important;
            }

            .custom-icon {
                font-size: 16px !important;
                -webkit-border-radius: 1100%;
                -moz-border-radius: 100%;
                -o-border-radius: 100%;
                border-radius: 100%;
                border: 2px solid #777;
                color: #777;
                text-align: center;
                /*display: table-cell !important;*/
                vertical-align: middle;
                padding-top: 5px;
                width: 30px;
                height: 30px;
            }

            .fix-editor {
                display: none;
            }

            .icon-wrapper {
                display: inline-block;
                vertical-align: middle;
                margin-left: 8px;
            }

            .navmenu-default .navmenu-nav>.active>a,
            .navbar-default .navbar-offcanvas .navmenu-nav>.active>a,
            .navmenu-default .navmenu-nav>.active>a:hover,
            .navbar-default .navbar-offcanvas .navmenu-nav>.active>a:hover,
            .navmenu-default .navmenu-nav>.active>a:focus,
            .navbar-default .navbar-offcanvas .navmenu-nav>.active>a:focus {
                color: #fff !important;
                background-color: #58595B !important;
            }

            .bs .navmenu-brand a {
                color: #777;
                font-family: "Gotham SSm A", "Gotham SSm B", "Microsoft Jhenghei", "LiHei Pro", "Heiti TC", Arial, Helvetica, sans-serif !important;
                margin-left: 15px;
            }

            .bs .navmenu-brand a:hover {
                text-decoration: none;
            }

            .bs .navbar-toggle {
                border: 0 !important;
                margin-right: 5px !important;
            }

            .bs .navbar-toggle .icon-bar {
                background-color: #39B54A !important;
            }

            .bs .navbar-chat-icon {
                margin-top: 7px;
                margin-right: 10px;
            }

            .bs .navmenu-nav li {
                text-transform: uppercase;
            }

            #template-overlayBody {
                width: 10000px;
                height: 10000px;
                position: absolute;
                top: 0;
                left: 0;
            }

            #template-overlayBody {
                z-index: 99;
            }

            #template-nav-menu .dropdown-backdrop {
                display: none !important;
                z-index: -100 !important;
            }

            div#reallocationOverlay,
            div#overlay,
            div#overlayPIC,
            #downtimeMessageOverlay {
                display: none;
                z-index: 10;
                background: #D9D9D6;
                position: fixed;
                width: 100%;
                height: 100%;
                top: 0px;
                left: 0px;
                text-align: center;
            }

            #reallocationCloseOverlay,
            #reallocationCloseOverlayWeb,
            #closeOverlay,
            #closeOverlayPIC,
            #downtimeMessageCloseOverlay
            {
                position: absolute;
                top: 10px;
                right: 10px;
            }

            #reallocationtccontent {
                padding: 10px;
                color: #000;
                font-size: 12px;
                width: 100%;
                height: 90%;
                overflow-y: auto;
            }

            .noscroll {
                overflow: hidden;
            }
            <!--Ray's-->
            @media (min-width: 768px){
                .bs .navbar-nav li>a {

                }
            }
            <!-- Kit's -->
            #downtimeMessageOverlay .contentDiv{ height:80%;overflow-y:auto}
            #downtimeMessageOverlay .checkboxLabel{display:inline-block;font-size:12px;vertical-align:top;margin-top:2px;margin-left:4px} 
        </style>

        <apex:remoteObjects >
            <apex:remoteObjectModel name="User" jsShorthand="Users" fields="Id, LanguageLocaleKey">
            </apex:remoteObjectModel>
        </apex:remoteObjects>

        <script>
            // 20220121-David-timeout message
            localStorage.setItem('login', true);
            // 20201030 - minghua - PendingMemo
            function checkDisplayPopupMessage(){
                var haveNewPendingMemo = $('input[type=hidden][id$=haveNewPendingMemo]').val();
                if (haveNewPendingMemo != undefined && haveNewPendingMemo != '') {
                    if (haveNewPendingMemo == 'true') {
                        reallocationToggleOverlay_PendingMemo();
                    }
                }
            }
            function gotoRedirect(pendMemoId,requestId, category, docIsClaim, numberId, policyType, SHA256Key,presNo, esigUrl){
                openMessage(pendMemoId);
                if (category != undefined && category != null && category != '') {
                    if (category == 'pc' ) {
                        Cigna.Util.navigateToVFP('PendingMemoVFP?requestId='+requestId+'&category='+category);
                    }else if(category == 'cl'){
                        Cigna.Util.navigateToVFP('PendingMemoVFP?requestId='+numberId+'&category='+category);
                    }else if (category == 'Prescription') {
                        Cigna.Util.navigateToVFP('PrescriptionDetailsVFP?PrescriptionNo='+presNo, null, null, true);
                    }else if (category == 'doc') {
                        if (docIsClaim == 'true') {
                            Cigna.Util.navigateToVFP('ClaimDetailsVFP?claimNo='+numberId+'&policyType='+policyType, null, null, true);
                        }else{
                            Cigna.Util.navigateToVFP('PolicyDetailsPageVFP?policyNumber='+numberId+'&policyType='+policyType+'&SHA256Key='+SHA256Key, null, null, true);
                        }
                    }else if (category == 'E-Signature') {
                        window.location=esigUrl;
                    }
                    //Nicole_SMT_20210429
                    else if(category == 'TD'){
                        Cigna.Util.navigateToVFP('SmtPartnershipVFP?pendMemoId='+pendMemoId);
                    }
                }
            }
            function showPendingMemoPanl() {
                var overlayPendMemo = document.getElementById('overlayPendMemo');
                var pendMemoBox = document.getElementById('pendMemoBox');
                overlayPendMemo.style.opacity = 1;
                if (overlayPendMemo.style.display == "block") {
                    overlayPendMemo.style.display = "none";
                    pendMemoBox.style.display = "none";
                } else {
                    overlayPendMemo.style.display = "block";
                    pendMemoBox.style.display = "block";
                }
                return false;
            }

            var updateLanguageAlert = function() {
                if (typeof changeLanguageWarningRequired !== 'undefined' && changeLanguageWarningRequired) {
                    $('#changeLanguageAlert').show();
                    $('#changeLanguageAlert').css('left', '0px');
                } else {
                    updateLanguage();
                }
            }

            var updateLanguage = function() {
                console.log('{!$Label.Header_Language_Code}');
                console.log('{!$User.Id}');
                var record = new SObjectModel.Users();
                record.update(
                    ['{!$User.Id}'], {
                        LanguageLocaleKey: '{!$Label.Header_Language_Code}'
                    },
                    function() {
                        //console.log(Date.now());
                        if({!isGuestuser}){
                            location.reload(true);
                        }else{
                            return true;
                        }
                    }
                );
                
            };
            //Nicole_SMT_20210617
            function GTMonClickPush(event,clickURL,partner){
                 dataLayer.push({
                    'event' : event,
                    'click' : clickURL,
                    'partner' : partner
                 });
                 console.log('GTMonClickPush event:'+event+', click:'+clickURL+', partner:'+partner);
            }
        </script>


        <!-- Insert the additional libraries of the page -->
        <apex:define name="additionalLibraries">
            <apex:include pageName="CignaCommonCSS" />
            <!--script type="text/javascript" id="cobrowsescript" src="https://www.glancecdn.net/cobrowse/CobrowseJS.ashx?group={!$Setup.Portal_Settings__c.Glance_Cobrowse_Group_ID__c}&site={!$Setup.Portal_Settings__c.Glance_Cobrowse_Site__c}" data-inputevents='{"shift-13":"startSession"}' data-groupid="{!$Setup.Portal_Settings__c.Glance_Cobrowse_Group_ID__c}" data-site="{!$Setup.Portal_Settings__c.Glance_Cobrowse_Site__c}" charset="UTF-8"></script-->
            <!-- CR-58 performance tuning: temp comment 2022-03-01 Zane -->
            <link rel="stylesheet" type="text/css" href="{!$Setup.Portal_Settings__c.Typography_Font_URL__c}" />
            <!-- CR-58 End -->
            <!-- CR-56_Link_20220214 -->
            <link rel="stylesheet" type="text/css" href="{!URLFOR($Resource.DD_Demo, 'css/bootstrap3.4.1.css')}" />
            <link rel="stylesheet" type="text/css" href="{!URLFOR($Resource.DD_Demo, 'css/font-awesome.min.css')}" />
            <link rel="stylesheet" type="text/css" href="{!URLFOR($Resource.jasny_bootstrap, 'css/jasny-bootstrap.min.css')}" />

            <!-- Bootstrap Core CSS -->
            <!--Nicole_GS Login Performance_20200617-->
            <!--<script type="text/javascript" src="{!URLFOR($Resource.DD_Demo, 'js/jquery.min.js')}"></script>
            <script type="text/javascript" src="{!URLFOR($Resource.DD_Demo, 'js/bootstrap.min.js')}"></script>
            <script type="text/javascript" src="{!URLFOR($Resource.jasny_bootstrap, 'js/jasny-bootstrap.min.js')}"></script>-->
            <!-- CR-56_Link_20220214, updated by minghua -->
            <apex:include pageName="DDDemoJS"/>
            <apex:include pageName="CignaUtilJS" />
            <apex:include pageName="JasnyBootstrapJS"/>
            <!-- <script src="https://cdn.clare.ai/websdk/v3/clare.js"></script>  -->
        </apex:define>
        <script>
            function checkWebView() {
                var isWebView = false;
                var standalone = window.navigator.standalone,
                    userAgent = window.navigator.userAgent.toLowerCase(),
                    safari = /safari/i.test(userAgent),
                    ios = /iphone|ipod|ipad/i.test(userAgent);
                if (ios) {

                    if (!standalone && safari) {

                        isWebView = false;

                    } else if (standalone && !safari) {

                        isWebView = false;

                    } else if (!standalone && !safari) {

                        isWebView = true;

                    };

                } else {

                    var hasAndroid = /Android/i.test(userAgent);
                    var hasVersion = /Version\/[.0.9]*/i.test(userAgent);

                    if (hasAndroid && hasVersion) {
                        isWebView = true;
                    }

                }

                return isWebView;
            }

            //junda add 20201012
            function checkAppView(){
                var isAppView = false,
                        userAgent = window.navigator.userAgent.toLowerCase();
                if(userAgent.indexOf('html5plus')>-1){
                    isAppView=true;
                }
                //for test
                isAppView=true;
                return isAppView;
            }

            function logout() {
                //add by kit
                sessionStorage.setItem("isClosed",false);
                // 20220121-David-timeout message
                localStorage.setItem('login', false);

                if (checkWebView()) {
                    window.location = "https://localhost/logout.html";
                } else {
                    location.href = "{!$Label.Logout_URL}";
                }
            }

            function toggleOverlay() {
                var overlay = document.getElementById('overlay');
                var specialBox = document.getElementById('specialBox');
                overlay.style.opacity = .95;
                if (overlay.style.display == "block") {
                    overlay.style.display = "none";
                    specialBox.style.display = "none";
                } else {
                    overlay.style.display = "block";
                    specialBox.style.display = "block";
                }
            }

            function termsandCondition() {
                document.getElementById("overlayChecker").value = "TriggerbyHamburger";

            }

            function closetermsandCondition() {
                document.getElementById("overlayChecker").value = "";

            }

            function triggerToggleOverlay() {
                var overlayChecker = document.getElementById("overlayChecker").value;
                if (overlayChecker == 'TriggerbyHamburger') {
                    var overlay = document.getElementById('reallocationOverlay');
                    var specialBox = document.getElementById('reallocationSpecialBox');
                    overlay.style.opacity = .95;
                    overlay.style.display = "block";
                    specialBox.style.display = "block";
                }


            }

            function reallocationToggleOverlay() {
                if (!Cigna.Util.checkWebView()) {
                    closetermsandCondition();
                }
                var overlay = document.getElementById('reallocationOverlay');
                var specialBox = document.getElementById('reallocationSpecialBox');
                overlay.style.opacity = .95;
                if (overlay.style.display == "block") {
                    overlay.style.display = "none";
                    specialBox.style.display = "none";
                } else {
                    overlay.style.display = "block";
                    specialBox.style.display = "block";
                }

            }
            
            //start add by kit
            function toggleDowntimeMessageOverlay(){
                var overlay = document.getElementById('downtimeMessageOverlay');
                var specialBox = document.getElementById('downtimeMessageBox');
                overlay.style.opacity = .95;
                if (overlay.style.display == "block") {
                    overlay.style.display = "none";
                    specialBox.style.display = "none";
                    sessionStorage.setItem("isClosed",true);
                    $(".navbar-nav li a").attr("disabled",false);
                } else {
                    overlay.style.display = "block";
                    specialBox.style.display = "block";
                    $(".navbar-nav li a").attr("disabled",true);
                }
            }
            
            function closeDownTimeMessageOverlay(){
                //Do not show again
                if($("input[id*='downtimeMessageCheckbox']")[0].checked){
                    setUserNotReceiveTime();
                    toggleDowntimeMessageOverlay();
                }
                else{
                    toggleDowntimeMessageOverlay();
                }
            }
        
            function navigateToVFP(vfpName,ele){
                if($(ele).attr("disabled")){ return }
                Cigna.Util.navigateToVFP(vfpName);
            }

            // 20201030 - minghua - PendingMemo
            function reallocationToggleOverlay_PendingMemo() {
                var overlay = document.getElementById('reallocationOverlay_PendingMemo');
                var specialBox = document.getElementById('reallocationSpecialBox_PendingMemo');
                overlay.style.opacity = .95;
                if (overlay.style.display == "block") {
                    overlay.style.display = "none";
                    specialBox.style.display = "none";
                } else {
                    overlay.style.display = "block";
                    specialBox.style.display = "block";
                }
            }

            // 20230921 - minghua - PI-129 Vulnerability follow up request - Pentest (FND-61951) High
            function getCookieValue(key) {
                var cookies = document.cookie.split(';');
                for (var i = 0; i < cookies.length; i++) {
                    var cookie = cookies[i].trim();
                    if (cookie.startsWith(key + '=')) {
                        return cookie.substring(key.length + 1);
                    }
                }
                return null;
            }
            function openDownload(pointURL){
                // var ssId = getCookieValue('sid');
                var ssId = '{!GETSESSIONID()}';
                console.log('ssId:'+ssId);
                if (ssId) {
                    var attAddress='{!$Site.BaseUrl}/secur/frontdoor.jsp?sid='+ssId+'&retURL={!$Site.BaseUrl}'+pointURL;
                    var openURL='{!$Setup.Portal_Settings__c.File_Download_Site__c}/apex/ComFileDownloadOpenVFP?retURL2='+encodeURI(attAddress);
                    if (Cigna.Util.isIOS()) {
                        var baseURL='{!$Site.BaseUrl}';
                        var siteUrl='{!$Setup.Portal_Settings__c.Site_URL__c}';
                        var temp=siteUrl.split(';');
                        var index=0;
                        for (var ind=0;ind<temp.length;ind++){
                            if (baseURL===temp[ind]) {
                               index=ind;
                            }
                        }
                        attAddress=index+'/secur/frontdoor.jsp?sid='+ssId+'&retURL='+pointURL;
                        openURL='{!$Setup.Portal_Settings__c.File_Download_Site__c}/apex/ComFileDownloadOpenVFP?retURL2='+encodeURI(attAddress);
                        return openURL;
                    }else{
                        window.open(openURL);
                    }
                }
            }
        </script>
    </head>
    
    <!--Nicole_SMT_20210617-->
    <body>
        <!-- Google Tag Manager (noscript) -->
        <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PGJ23KN&gtm_auth=bMOSXx-Ik5APkrCQOskHiA&gtm_preview=env-5&gtm_cookies_win=x" 
        height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
        <!-- End Google Tag Manager (noscript) -->
    </body>

    <div class="bs">

        <div id="changeLanguageAlert" class="overlay" style="display:none;z-index:1100;">
            <div class="ConfirmBox" style="display:block;">
                <div id="confirmMsg" class="alertmsg" style="padding-top:20px;">
                    {!$Label.Confirm_Change_Language}
                </div>
                <div class="bs col-xs-6 col-sm-6">
                    <i class="glyphicon glyphicon-ok-sign oksign onclick-pointer" onclick="updateLanguage()"></i>
                </div>
                <div class="bs col-xs-6 col-sm-6">
                    <i class="glyphicon glyphicon-remove-sign cancelsign onclick-pointer" onclick="$('#changeLanguageAlert').hide();"></i>
                </div>
            </div>
        </div>
       
        
        <div id="navtopbar" class="bs navbar navbar-default navbar-fixed-top" style="background-color: #fff;">
            <!-- 20201030 - minghua - PendingMemo -->
            <apex:form id="PendingMemoForm">
                <apex:inputHidden value="{!haveNewPendingMemo}" id="haveNewPendingMemo" />
                <apex:actionFunction action="{!checkPendMemoWSComplete}"  name="checkPendMemoWSComplete" reRender="pendingMemoPanelAll,PendingMemoPanel,noPendingMemoMessage,pendingMemoMessage,desktopPendingMemoPanel,mobilePendingMemoPanel,PendingMemoForm" oncomplete="checkDisplayPopupMessage();" />
                <apex:actionFunction name="openMessage" action="{!openMessage}" reRender="PendingMemoFrom">
                    <apex:param name="memoId" value="" assignTo="{!memoId}" />
                </apex:actionFunction>
                <apex:actionFunction name="deleteMessage" action="{!deleteMessage}" reRender="pendingMemoPanelAll,PendingMemoPanel,noPendingMemoMessage,pendingMemoMessage,desktopPendingMemoPanel,mobilePendingMemoPanel">
                    <apex:param name="memoId" value="" assignTo="{!memoId}" />
                </apex:actionFunction>
            </apex:form>

           <!-- <a class="bs navbar-brand visible-xs" href="/customer/apex/CustomerLandingPage">
                <apex:image value="{!$Resource.Cigna_Horizontal_Logo}" height="100%"></apex:image>
            </a> -->
            <!-- change by kit  -->
            <a class="bs navbar-brand visible-xs" onClick="Cigna.Util.navigateToVFP('CustomerLandingPage', null, null, false, false)">
                <apex:image value="{!$Resource.Cigna_Horizontal_Logo}" height="100%"></apex:image>
            </a>
            <script type="text/javascript">
                if({!!isGuestuser}){
                    $('#navtopbar > a').removeAttr('onClick');
                }
            </script>
            <div class="bs col-sm-12 col-lg-12" style="background-color: #e3e3e3;">
                
                <!--
                <a href="/customer/apex/CustomerLandingPage" class="bs navbar-brand navbar-img hidden-xs">
                </a>-->

                <div class="bs pull-right">
                    <div class="bs" >
                        <ul class="bs nav navbar-nav pull-right hidden-xs compact header-title-1">
                            <!-- <li><a href="#">{!$Label.NavBar_Find_Medical}</a></li>-->
                            <!--<li><a href="#">{!$Label.NavBar_Support}</a></li>-->
                            <!--<li class="visible-sm" style="border-right: 1px solid #999;">-->
                            <li class="visible-sm" >
                                <a id="liveagent_button_online-sm" onclick="startLiveChat()" style="display:none" href="#">
                                    <i class="ci-hk-chat ci-hk-lg"></i>&nbsp;&nbsp;{!$Label.Header_Live_Chat}
                                </a>
                            </li>
                            <li class="visible-sm" >
                                <!--<apex:outputLink id="liveagent_button_offline-sm" value="{!$Label.LiveChatMessageToCasePageName}" style="display:none" target="_blank">
                                    <i class="fa fa-comment fa-lg"></i>&nbsp;&nbsp;{!$Label.Header_Live_Chat}&nbsp;&nbsp;&nbsp;&nbsp;|
                                </apex:outputLink>-->
                                <a id="liveagent_button_offline-sm" href="#" onclick="Cigna.Util.navigateToVFP('{!$Label.LiveChatMessageToCasePageName}', null, null, false, false);" style="display:none">
                                    <i class="ci-hk-chat ci-hk-lg"></i>&nbsp;&nbsp;{!$Label.Header_Live_Chat}
                                </a>
                            </li>
                            <li class="visible-sm" >
                                <a id="liveagent_button_online-sm-app" onclick="startLiveChat()" style="display:none">
                                    <i class="ci-hk-chat ci-hk-lg"></i>&nbsp;&nbsp;{!$Label.Header_Live_Chat}
                                </a>
                            </li>
                            <li class="visible-sm" >
                                <!--<apex:outputLink id="liveagent_button_offline-sm-app" value="{!$Setup.Portal_Settings__c.Live_Chat_Site_URL__c}/apex/LiveChatLandingVFP?bid={!$Label.Customer_Portal_Live_Chat_Button_ID}&status=offline" style="display:none" target="_blank">
                                    <i class="fa fa-comment fa-lg"></i>&nbsp;&nbsp;{!$Label.Header_Live_Chat}&nbsp;&nbsp;&nbsp;&nbsp;|
                                </apex:outputLink>-->
                                <a id="liveagent_button_offline-sm-app" href="#" onclick="Cigna.Util.navigateToVFP('LiveChatLandingVFP?bid={!$Label.Customer_Portal_Live_Chat_Button_ID}&status=offline', null, null, false, false)" style="display:none">
                                    <i class="ci-hk-chat ci-hk-lg"></i>&nbsp;&nbsp;{!$Label.Header_Live_Chat}
                                </a>
                            </li>

                            <!-- 20201030 - minghua - PendingMemo -->
                            <li id="pendingMemoli" class="{!IF(numOfNewPendMemo == 0, '', 'cigna-bg-orange-medium')}">
                                <a id="pendingMemoBtn" class="{!IF(numOfNewPendMemo == 0, '', 'cigna-fg-white')}" href="#" onclick="showPendingMemoPanl();">
                                    <apex:outputPanel id="desktopPendingMemoPanel" >
                                        <span style="display: inline-block;">{!$Label.pendMemoMessage}
                                            <span style="display: inline-block;">
                                                <apex:outputPanel rendered="{!!isPendMemoComplete}">
                                                    <i class="spinner-icon fa fa-spinner fa-pulse fa-fw" style="margin-right: 5px;"></i>
                                                </apex:outputPanel>
                                                <apex:outputPanel rendered="{!isPendMemoComplete}">
                                                    | {!numOfNewPendMemo}
                                                </apex:outputPanel>
                                            </span>
                                        </span>
                                        <script>
                                            if ({!isPendMemoComplete}) {
                                                $("#pendingMemoBtn").attr("disabled",false).css("pointer-events","auto");
                                                var numOfNewPendMemo = '{!numOfNewPendMemo}';
                                                if (numOfNewPendMemo > 0) {
                                                    $("#pendingMemoli").addClass('cigna-bg-orange-medium');
                                                    $("#pendingMemoBtn").addClass('cigna-fg-white');
                                                } 
                                            }else{
                                                setTimeout(checkPendMemoWSComplete,2000);
                                                $("#pendingMemoBtn").attr("disabled",true).css("pointer-events","none"); 
                                            }
                                        </script>
                                    </apex:outputPanel>
                                </a>
                            </li>

                            <li id="isGuestuser-true-diasplay-Logout"><a  style="padding-left: 15px !important; padding-right: 15px !important;" href="{!$Label.Logout_URL}" onclick="logout();">{!$Label.NavBar_Log_Out}</a></li>
                            <!-- MRP-264 Existing Web Enhancement for MyCigna Revamp -->
                            <!-- <li id="isGuestuser-true-diasplay-setting"><a style="padding-left: 15px !important; padding-right: 15px !important;" href="#" onclick="Cigna.Util.navigateToVFP('CustomerMySettingAlertVFP?', null, null, false, false)">{!$Label.NavBar_My_Settings}</a></li> -->
                            <li id="isGuestuser-true-diasplay-setting"><a style="padding-left: 15px !important; padding-right: 15px !important;" href="#" onclick="Cigna.Util.navigateToVFP('MyAccountPageVFP')">{!$Label.NavBar_My_Settings}</a></li>

                            <li id="isGuestuser-true-diasplay-lang"><a style="padding-left: 15px !important;padding-right: 15px !important;" class="onclick-pointer" onclick="updateLanguageAlert()">{!$Label.Header_Change_Language}</a></li>
                            <li id="isGuestuser-true-diasplay-lang-href"><a onclick="updateLanguage();" href="#">{!$Label.Header_Change_Language}</a></li>

                            <script>
                                if({!!isGuestuser}){
                                    $('#isGuestuser-true-diasplay-Logout').attr('style','display:none');
                                    $('#isGuestuser-true-diasplay-setting').attr('style','display:none');
                                    $('#isGuestuser-true-diasplay-lang').attr('style','display:none');                           
                                }else{
                                    $('#isGuestuser-true-diasplay-lang-href').attr('style','display:none');
                                }
                            </script>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="bs hidden-xs col-sm-12 col-lg-12" style="padding-top:14px;">

                <!-- change by kit -->
                <li id='isGuestuser-cigna-logo' style="list-style:none;">
                <a onClick="Cigna.Util.navigateToVFP('CustomerLandingPage', null, null, false, false)" class="bs navbar-brand navbar-img hidden-xs">
                </a>
                </li>
                
                <script>
                    if({!!isGuestuser}){
                        
                        $('#isGuestuser-cigna-logo > a').removeAttr('onClick');
                    }
                </script>

                <!--junda 20200918 health show-->
                <apex:outputPanel id="manage-health-tab-js-refresh-panel">
                    <apex:outputPanel rendered="{!isManageHealthShow}">
                        <script>
                            $('#manage-health-tab-mobile').css('padding', '10px 15px 10px 15px');
                            $('#manage-health-tab-mobile').css('margin', '6.4px 0px 6.4px 11.2px');
                        </script>
                    </apex:outputPanel>
                </apex:outputPanel>
                <apex:outputPanel rendered="{!$Label.Header_Language_Code == 'en_US'&&isGuestuser}">               
                <div class="bs pull-right">
                    <div class="bs" >                       
                       <ul class="bs nav navbar-nav hidden-xs navbar-uppercase navbar-no-margin header-title-2">                        
                            <li id="manage-getProtected-tab-zh"><a href="#" style="border-right: 1px solid #D9D9D6 !important;" onclick="Cigna.Util.navigateToVFP('GetProtectedVFP')"><i class="ci-hk-beach-umbrella ci-hk-lg" style="display: inline-block;vertical-align:middle;"></i>&nbsp;&nbsp;<div style="display: inline-block;align:left;vertical-align:middle;"><apex:outputText value="{!$Label.NavBar_Get_A_Quote_New}" escape="false" ></apex:outputText></div></a></li>
                            <li id="manage-myPolicy-tab-zh"><a href="#" style="border-right: 1px solid #D9D9D6 !important;" onclick="Cigna.Util.navigateToVFP('MyPolicyVFP')"><i class="ci-hk-notes ci-hk-lg" style="display: inline-block;vertical-align:middle;"></i>&nbsp;&nbsp;<div style="display: inline-block;align:left;vertical-align:middle;"><apex:outputText value="{!$Label.NavBar_My_Policy_New}" escape="false" ></apex:outputText></div></a></li>
                            
                            <!-- <li id="manage-policy-tab-zh"><a href="#" style="border-right: 1px solid #D9D9D6 !important;" onclick="Cigna.Util.navigateToVFP('PolicyChangeVFP')"><i class="ci-hk-fix ci-hk-lg" style="display: inline-block;vertical-align:middle;"></i>&nbsp;&nbsp;<div style="display: inline-block;align:left;vertical-align:middle;"><apex:outputText value="{!$Label.NavBar_Policy_Change_New}" escape="false" ></apex:outputText></div></a></li> -->
                           <li style="{!IF(isManagePolicyShow, '', 'display:none')}" id="manage-policyChange-tab-zh"><a href="#" style="border-right: 1px solid #D9D9D6 !important;" onclick="Cigna.Util.navigateToVFP('PolicyChangeVFP')"><i class="ci-hk-fix ci-hk-lg" style="display: inline-block;vertical-align:middle;"></i>&nbsp;&nbsp;<div style="display: inline-block;align:left;vertical-align:middle;"><apex:outputText value="{!$Label.NavBar_Policy_Change_New}" escape="false" ></apex:outputText></div></a></li>                           
                            <li id="manage-myClaim-tab-zh"><a href="#" style="border-right: 1px solid #D9D9D6 !important;" onclick="Cigna.Util.navigateToVFP('MyClaimVFP')"><i class="ci-hk-clip-offcial ci-hk-lg" style="display: inline-block;vertical-align:middle;"></i>&nbsp;&nbsp;<div style="display: inline-block;align:left;vertical-align:middle;"><apex:outputText value="{!$Label.NavBar_My_Claim_New}" escape="false" ></apex:outputText></div></a></li>
                            <!--junda SMT add 20201007-->
                            <!-- 20211207 - minghua - AMP-31, add padding, Can't show Virtual Health tab after login MyCigna (PH = PI) -->
                           <li id="manage-myhealth-tab-zh" style="{!IF(isManageHealthShow, '', 'display:none')}"><a href="#" style="border-right: 1px solid #D9D9D6 !important;padding-top: 6px !important;padding-bottom: 6px !important;" onclick="GTMonClickPush('{!SMTMyVirtualHealthTag}','{!$Setup.Portal_Settings__c.Customer_Portal_URL__c}/apex/CusMyVirtualHealthVFP','{!cusPartSMT}');Cigna.Util.navigateToVFP('MyVirtualHealthVFP')"><i class="ci-hk-med-bag ci-hk-lg" style="display: inline-block;vertical-align:middle;"></i>&nbsp;&nbsp;<div style="display: inline-block;align:left;vertical-align:middle;"><apex:outputText value="{!$Label.NavBar_My_Health_New}" escape="false" ></apex:outputText></div></a></li>
                           <!--<li id="manage-prescription-tab-zh" style="display: none"><a href="#" style="border-right: 1px solid #D9D9D6 !important;" onclick="Cigna.Util.navigateToVFP('PrescriptionVFP')"><i class="ci-hk-clipboard ci-hk-lg" style="display: inline-block;vertical-align:middle;"></i>&nbsp;&nbsp;<div style="display: inline-block;align:left;vertical-align:middle;"><apex:outputText value="{!$Label.NavBar_Prescription_New}" escape="false" ></apex:outputText></div></a></li>-->
                           <!--junda add end-->
                          
                           <!-- Autumn_SMT Partnership_20210224 starts-->
                           <!-- i calss= "ci-hk-Smartone" -->
                           <li id="manage-MySmartoneHealthOffer-tab-zh" style="{!IF(isManageHealthShow,'', 'display:none')}"><a href="#" style="border-right: 1px solid #D9D9D6 !important;" onclick="GTMonClickPush('{!SMTMyVirtualPrivilegesTag}','{!$Setup.Portal_Settings__c.Customer_Portal_URL__c}/apex/CusMySmartoneHealthOfferVFP','{!cusPartSMT}');Cigna.Util.navigateToVFP('MySmartoneHealthOfferVFP')"><i class="ci-hk-stethoscope ci-hk-lg" style="display: inline-block;vertical-align:middle;"></i>&nbsp;&nbsp;<div style="display: inline-block;align:left;vertical-align:middle;"><apex:outputText value="{!$Label.NavBar_My_Smartone_Health_Offer_New}" escape="false" ></apex:outputText></div></a></li>
                           <!-- end -->
                           
                            <li id="manage-doctorList-tab-zh" ><a href="#" style="border-right: 1px solid #D9D9D6 !important;" onclick="Cigna.Util.navigateToVFP('DoctorListVFP')"><i class="ci-hk-doctor ci-hk-lg" style="display: inline-block;vertical-align:middle;"></i>&nbsp;&nbsp;<div style="display: inline-block;align:left;vertical-align:middle;"><apex:outputText value="{!$Label.NavBar_Doctor_List_New}" escape="false" ></apex:outputText></div></a></li>                           
                            <li id="liveagent_button_online" onclick="startLiveChat()" style="display: none;" class="hidden-sm"><a href="#"><i class="ci-hk-chat ci-hk-lg" style="display: inline-block;vertical-align:middle;"></i>&nbsp;&nbsp;<div style="display: inline-block;align:left;vertical-align:middle;"><apex:outputText value="{!$Label.Header_Live_Chat_New}" escape="false" ></apex:outputText></div></a></li>
                            <li id="liveagent_button_offline" style="display: none;" class="hidden-sm">
                                <a href="#" onclick="Cigna.Util.navigateToVFP('{!$Label.LiveChatMessageToCasePageName}', null, null, false, false)"><i class="ci-hk-chat ci-hk-lg" style="display: inline-block;vertical-align:middle;"></i>&nbsp;&nbsp;<div style="display: inline-block;align:left;vertical-align:middle;"><apex:outputText value="{!$Label.Header_Live_Chat_New}" escape="false" ></apex:outputText></div></a>
                                <!--<apex:outputLink value="{!$Label.LiveChatMessageToCasePageName}" target="_blank"><i class="fa fa-comment fa-lg"></i>&nbsp;&nbsp;{!$Label.Header_Live_Chat}</apex:outputLink>-->
                            </li>
                            <li id="liveagent_button_online-app" style="display: none;" onclick="startLiveChat()" class="hidden-sm"><a href="#"><i class="ci-hk-chat ci-hk-lg" style="display: inline-block;vertical-align:middle;"></i>&nbsp;&nbsp;<div style="display: inline-block;align:left;vertical-align:middle;min-height: 50px;"><apex:outputText value="{!$Label.Header_Live_Chat_New}" escape="false" ></apex:outputText></div></a></li>
                            <li id="liveagent_button_offline-app" style="display: none;" class="hidden-sm">
                                <a href="#" onclick="Cigna.Util.navigateToVFP('LiveChatLandingVFP?bid={!$Label.Customer_Portal_Live_Chat_Button_ID}&status=offline', null, null, false, false)"><i class="ci-hk-chat ci-hk-lg" style="display: inline-block;vertical-align:middle;"></i>&nbsp;&nbsp;<div style="display: inline-block;align:left;vertical-align:middle;"><apex:outputText value="{!$Label.Header_Live_Chat_New}" escape="false" ></apex:outputText></div></a>
                                <!--<apex:outputLink value="{!$Setup.Portal_Settings__c.Live_Chat_Site_URL__c}/apex/LiveChatLandingVFP?bid={!$Label.Customer_Portal_Live_Chat_Button_ID}&status=offline" target="_blank"><i class="fa fa-comment fa-lg"></i>&nbsp;&nbsp;{!$Label.Header_Live_Chat}</apex:outputLink>-->
                            </li>
                           <!--add junda-->
                           <script>
                               if({!isVirtualHealthShow}){
                                   //$('#manage-getProtected-tab-zh').attr('style','display:none'); //Nicole_SMT_20210413
                                   $('#manage-myPolicy-tab-zh').attr('style','display:none');
                                   $('#manage-policyChange-tab-zh').attr('style','display:none');
                                   $('#manage-myClaim-tab-zh').attr('style','display:none');
                                   //Nicole_SMT_20210316
                                   if(!{!isManageHealthShow}){$('#manage-doctorList-tab-zh').attr('style','display:none');} 
                                   //$('#manage-prescription-tab-zh').attr('style','display:none');                                  
                               }
                           </script>
                           <!--add end junda-->
                        </ul>
                    </div>
                </div>
                </apex:outputPanel>
                
                <apex:outputPanel rendered="{!$Label.Header_Language_Code == 'zh_TW'&&isGuestuser}">
                <div class="bs pull-right">
                    <div class="bs" >
                        <ul class="bs nav navbar-nav hidden-xs navbar-uppercase navbar-no-margin header-title-2">
                            <li id="manage-getProtected-tab-en-panel"><a href="#" style="border-right: 1px solid #D9D9D6 !important;padding-top: 9px !important;padding-bottom: 9px !important;" onclick="navigateToVFP('GetProtectedVFP',this)"><i class="ci-hk-beach-umbrella ci-hk-lg" style="display: inline-block;vertical-align:middle;"></i>&nbsp;&nbsp;<div style="display: inline-block;align:left;vertical-align:middle;"><apex:outputText value="{!$Label.NavBar_Get_A_Quote_New}" escape="false" ></apex:outputText></div></a></li>
                            <li id="manage-myPolicy-tab-en-panel"><a href="#" style="border-right: 1px solid #D9D9D6 !important;padding-top: 9px !important;padding-bottom: 9px !important;" onclick="navigateToVFP('MyPolicyVFP',this)"><i class="ci-hk-notes ci-hk-lg" style="display: inline-block;vertical-align:middle;"></i>&nbsp;&nbsp;<div style="display: inline-block;align:left;vertical-align:middle;"><apex:outputText value="{!$Label.NavBar_My_Policy_New}" escape="false" ></apex:outputText></div></a></li>

                            <!-- 20211207 - minghua - AMP-31, add id, Can't show Virtual Health tab after login MyCigna (PH = PI) -->
                            <li id="manage-policy-tab-en" style="{!IF(isManagePolicyShow, '', 'display:none')}"><a href="#" style="border-right: 1px solid #D9D9D6 !important;padding-top: 9px !important;padding-bottom: 9px !important;" onclick="navigateToVFP('PolicyChangeVFP',this)"><i class="ci-hk-fix ci-hk-lg" style="display: inline-block;vertical-align:middle;"></i>&nbsp;&nbsp;<div style="display: inline-block;align:left;vertical-align:middle;"><apex:outputText value="{!$Label.NavBar_Policy_Change_New}" escape="false" ></apex:outputText></div></a></li>
                            
                            <li id="manage-myClaim-tab-en-panel"><a href="#" style="border-right: 1px solid #D9D9D6 !important;padding-top: 9px !important;padding-bottom: 9px !important;" onclick="navigateToVFP('MyClaimVFP',this)"><i class="ci-hk-clip-offcial ci-hk-lg" style="display: inline-block;vertical-align:middle;"></i>&nbsp;&nbsp;<div style="display: inline-block;align:left;vertical-align:middle;"><apex:outputText value="{!$Label.NavBar_My_Claim_New}" escape="false" ></apex:outputText></div></a></li>
                            
                            <!--junda add 20201007-->
                            <!-- 20211207 - minghua - AMP-31, change isManageHealthShow to isVirtualHealthAMShow, and change the style to li from a, Can't show Virtual Health tab after login MyCigna (PH = PI) -->
                            <li id="manage-myHealth-tab-en-panel" style="{!IF(isVirtualHealthAMShow, '', 'display:none')}"><a href="#" style="border-right: 1px solid #D9D9D6 !important;padding-top: 9px !important;padding-bottom: 9px !important;" onclick="GTMonClickPush('{!SMTMyVirtualHealthTag}','{!$Setup.Portal_Settings__c.Customer_Portal_URL__c}/apex/CusMyVirtualHealthVFP','{!cusPartSMT}');Cigna.Util.navigateToVFP('MyVirtualHealthVFP')"><i class="ci-hk-med-bag ci-hk-lg" style="display: inline-block;vertical-align:middle;"></i>&nbsp;&nbsp;<div style="display: inline-block;align:left;vertical-align:middle;"><apex:outputText value="{!$Label.NavBar_My_Health_New}" escape="false" ></apex:outputText></div></a></li>
                            <!--<li id="manage-prescription-tab-en-panel" style="display: none"><a href="#" style="border-right: 1px solid #D9D9D6 !important;padding-top: 9px !important;padding-bottom: 9px !important;{!IF(isManageHealthShow, '', 'display:none')}" onclick="Cigna.Util.navigateToVFP('PrescriptionVFP')"><i class="ci-hk-clipboard ci-hk-lg" style="display: inline-block;vertical-align:middle;"></i>&nbsp;&nbsp;<div style="display: inline-block;align:left;vertical-align:middle;"><apex:outputText value="{!$Label.NavBar_Prescription_New}" escape="false" ></apex:outputText></div></a></li>-->
                            <!--add end junda-->
                            
                            <!-- Autumn_SMT Partnership_20210224 start-->
                            <!-- i class = "ci-hk-Smartone" -->
                            <li id="manage-MySmartoneHealthOffer-tab-en-panel"><a href="#" style="border-right: 1px solid #D9D9D6 !important;padding-top: 9px !important;padding-bottom: 9px !important;" onclick="GTMonClickPush('{!SMTMyVirtualPrivilegesTag}','{!$Setup.Portal_Settings__c.Customer_Portal_URL__c}/apex/CusMySmartoneHealthOfferVFP','{!cusPartSMT}');navigateToVFP('MySmartoneHealthOfferVFP',this)"><i class="ci-hk-stethoscope ci-hk-lg" style="display: inline-block;vertical-align:middle;"></i>&nbsp;&nbsp;<div style="display: inline-block;align:left;vertical-align:middle;"><apex:outputText value="{!$Label.NavBar_My_Smartone_Health_Offer_New}" escape="false" ></apex:outputText></div></a></li>
                            <!-- end -->
                            
                            <li id="manage-doctorList-tab-en-panel"><a href="#" style="border-right: 1px solid #D9D9D6 !important;padding-top: 9px !important;padding-bottom: 9px !important;" onclick="navigateToVFP('DoctorListVFP',this)"><i class="ci-hk-doctor ci-hk-lg" style="display: inline-block;vertical-align:middle;"></i>&nbsp;&nbsp;<div style="display: inline-block;align:left;vertical-align:middle;"><apex:outputText value="{!$Label.NavBar_Doctor_List_New}" escape="false" ></apex:outputText></div></a></li>                            
                            <li id="liveagent_button_online" onclick="startLiveChat()" style="display: none;" class="hidden-sm"><a href="#" style="padding-top: 9px !important;padding-bottom: 9px !important;"><i class="ci-hk-chat ci-hk-lg" style="display: inline-block;vertical-align:middle;"></i>&nbsp;&nbsp;<div style="display: inline-block;align:left;vertical-align:middle;"><apex:outputText value="{!$Label.Header_Live_Chat_New}" escape="false" ></apex:outputText></div></a></li>
                            <li id="liveagent_button_offline" style="display: none;" class="hidden-sm">
                                <a href="#" onclick="Cigna.Util.navigateToVFP('{!$Label.LiveChatMessageToCasePageName}', null, null, false, false)" style="padding-top: 9px !important;padding-bottom: 9px !important;"><i class="ci-hk-chat ci-hk-lg" style="display: inline-block;vertical-align:middle;"></i>&nbsp;&nbsp;<div style="display: inline-block;align:left;vertical-align:middle;"><apex:outputText value="{!$Label.Header_Live_Chat_New}" escape="false" ></apex:outputText></div></a>
                                <!--<apex:outputLink value="{!$Label.LiveChatMessageToCasePageName}" target="_blank"><i class="fa fa-comment fa-lg"></i>&nbsp;&nbsp;{!$Label.Header_Live_Chat}</apex:outputLink>-->
                            </li>
                            <li id="liveagent_button_online-app" style="display: none;" class="hidden-sm" onclick="startLiveChat()"><a href="#" style="padding-top: 9px !important;padding-bottom: 9px !important;" ><i class="ci-hk-chat ci-hk-lg" style="display: inline-block;vertical-align:middle;"></i>&nbsp;&nbsp;<div style="display: inline-block;align:left;vertical-align:middle;min-height: 50px;"><apex:outputText value="{!$Label.Header_Live_Chat_New}" escape="false" ></apex:outputText></div></a></li>
                            <li id="liveagent_button_offline-app" style="display: none;" class="hidden-sm">
                                <a href="#" onclick="Cigna.Util.navigateToVFP('LiveChatLandingVFP?bid={!$Label.Customer_Portal_Live_Chat_Button_ID}&status=offline', null, null, false, false)" style="padding-top: 9px !important;padding-bottom: 9px !important;" ><i class="ci-hk-chat ci-hk-lg" style="display: inline-block;vertical-align:middle;"></i>&nbsp;&nbsp;<div style="display: inline-block;align:left;vertical-align:middle;"><apex:outputText value="{!$Label.Header_Live_Chat_New}" escape="false" ></apex:outputText></div></a>
                                <!--<apex:outputLink value="{!$Setup.Portal_Settings__c.Live_Chat_Site_URL__c}/apex/LiveChatLandingVFP?bid={!$Label.Customer_Portal_Live_Chat_Button_ID}&status=offline" target="_blank"><i class="fa fa-comment fa-lg"></i>&nbsp;&nbsp;{!$Label.Header_Live_Chat}</apex:outputLink>-->
                            </li>                      
                            <!--junda add 20201007-->
                            <script>
                                if({!isVirtualHealthShow}){
                                    console.log('isVirtualHealthShow:'+{!isVirtualHealthShow});                       
                                    //$('#manage-getProtected-tab-en-panel').attr('style','display:none'); //Nicole_SMT_20210413
                                    $('#manage-myPolicy-tab-en-panel').attr('style','display:none');
                                    $('#manage-myClaim-tab-en-panel').attr('style','display:none');
                                    $('#manage-policy-tab-en').attr('style','display:none');
                                    //Nicole_SMT_20210316
                                    if(!{!isManageHealthShow}){
                                        $('#manage-doctorList-tab-en-panel').attr('style','display:none');
                                    }
                                    //$('#manage-prescription-tab-en-panel').attr('style','display:none');
                                }
                                //Nicole_SMT_20210316
                                if(!{!isManageHealthShow}){
                                  $('#manage-MySmartoneHealthOffer-tab-en-panel').attr('style','display:none');
                                  // 20211207 - minghua - AMP-31, Can't show Virtual Health tab after login MyCigna (PH = PI)
                                  // $('#manage-myHealth-tab-en-panel').attr('style','display:none');
                               }
                            </script>
                            <!--junda add end-->
                        </ul>
                    </div>
                </div>
                </apex:outputPanel>
            </div>
            <button type="button" class="bs navbar-toggle" data-toggle="offcanvas" data-target=".navmenu" data-canvas="body">
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <div class="bs navbar-chat-icon pull-right visible-xs">

                <a id="liveagent_button_online-xs" onclick="startLiveChat()" style="display: none"><i class="ci-hk-chat ci-hk-2x cigna-fg-green-medium"></i></a>
                <a id="liveagent_button_offline-xs" style="display: none" href="#" onclick="Cigna.Util.navigateToVFP('{!$Label.LiveChatMessageToCasePageName}', null, null, false, false)"><i class="ci-hk-chat ci-hk-2x cigna-fg-green-medium"></i></a>
                <!--<apex:outputLink id="liveagent_button_offline-xs" style="display: none" value="{!$Label.LiveChatMessageToCasePageName}" target="_blank"><i class="cigna-fg-green-medium fa fa-comment fa-2x"></i></apex:outputLink>-->

                <a id="liveagent_button_online-xs-app" onclick="startLiveChat()" style="display: none"><i class="ci-hk-chat ci-hk-2x cigna-fg-green-medium"></i></a>
                <a id="liveagent_button_offline-xs-app" style="display: none" href="#" onclick="Cigna.Util.navigateToVFP('LiveChatLandingVFP?bid={!$Label.Customer_Portal_Live_Chat_Button_ID}&status=offline', null, null, false, false)"><i class="ci-hk-chat ci-hk-2x cigna-fg-green-medium"></i></a>
                <!--<apex:outputLink id="liveagent_button_offline-xs-app" style="display: none" value="{!$Setup.Portal_Settings__c.Live_Chat_Site_URL__c}/apex/LiveChatLandingVFP?bid={!$Label.Customer_Portal_Live_Chat_Button_ID}&status=offline"><i class="cigna-fg-green-medium fa fa-comment fa-2x"></i></apex:outputLink> -->

            </div>

            <!-- 20201030 - minghua - PendingMemo -->
            <div class="bs navbar-message-icon pull-right visible-xs">
                <a id="pendingMemoMobileBtn" onclick="showPendingMemoPanl()">
                    <div style="display: inline-block;" class="pendingMemoBox">
                        <apex:outputPanel id="mobilePendingMemoPanel">
                            <apex:outputPanel rendered="{!!isPendMemoComplete}">
                                <span class="pendingMemoLoading">
                                    <i class="spinner-icon fa fa-spinner fa-pulse fa-fw" style="margin-right: 5px;"></i>
                                </span>
                            </apex:outputPanel>
                            <apex:outputPanel rendered="{!isPendMemoComplete}">
                                <span class="pendingMemoNum">
                                    {!numOfNewPendMemo}
                                </span>
                            </apex:outputPanel>
                            <script>
                                function togglePendingMemoPanel(e){
                                    e.preventDefault();
                                    e.stopPropagation();
                                }
                                if ({!isPendMemoComplete}) {
                                    //CR-56_Link_20220214
                                    $("#pendingMemoMobileBtn").on("click",togglePendingMemoPanel);
                                    $("#pendingMemoMobileBtn").attr("disabled",false).css("pointer-events","auto"); 
                                }else{
                                    $("#pendingMemoMobileBtn").attr("disabled",true).css("pointer-events","none");
                                }
                            </script>
                            </apex:outputPanel>
                        <span>
                            <img src="{!$Resource.bell}" alt="Messages"  style="margin: 0 auto" />
                        </span>
                    </div>
                </a>
            </div>
        </div>

        <div id="template-nav-menu" class="bs navmenu navmenu-default navmenu-fixed-right offcanvas navbar-uppercase">
            <div style="margin: 10px 0 0 0; text-align: right;" class="bs navmenu-brand">
                <a id="isGuestuser-CustomerLandingPage" href="/customer/CustomerLandingPage"><i style="vertical-align: middle;" class="fa fa-home fa-2x" aria-hidden="true"></i></a>
                <a id="isGuestuser-Header_Change_Language" class="onclick-pointer" style="font-size: 1.5em; vertical-align: middle;" onclick="updateLanguageAlert()">{!$Label.Header_Change_Language}</a>
                <a id="isGuestuser-personalchoice-Header_Change_Language" class="onclick-pointer" style="font-size: 1.5em; vertical-align: middle;" onclick="updateLanguage()">{!$Label.Header_Change_Language}</a>
            </div>
            <ul class="bs nav navmenu-nav" style="font-weight: bold;">
                <li id="isGuestuser-NavBar_Get_A_Quote"><a href="javascript:void(0);" class="bs" onclick="Cigna.Util.navigateToVFP('GetProtectedVFP')"><i class="ci-hk-beach-umbrella ci-hk-lg"></i>&nbsp;&nbsp;{!$Label.NavBar_Get_A_Quote}</a></li>
                <li id="isGuestuser-NavBar_My_Policy"><a href="javascript:void(0);" class="bs" onclick="Cigna.Util.navigateToVFP('MyPolicyVFP')"><i class="ci-hk-notes ci-hk-lg"></i>&nbsp;&nbsp;{!$Label.NavBar_My_Policy}</a></li>
                
                <!-- 20211207 - minghua - AMP-31, add id for li -->
                <li id="isGuestuser-NavBar_Policy_Change" style="{!IF(isManagePolicyShow, '', 'display:none')}"><a href="javascript:void(0);" class="bs" onclick="Cigna.Util.navigateToVFP('PolicyChangeVFP')"><i class="ci-hk-fix ci-hk-lg"></i>&nbsp;&nbsp;{!$Label.NavBar_Policy_Change}</a></li>

                <li id="isGuestuser-NavBar_My_Claim"><a href="javascript:void(0);" class="bs" onclick="Cigna.Util.navigateToVFP('MyClaimVFP')"><i class="ci-hk-clip-offcial ci-hk-lg"></i>&nbsp;&nbsp;{!$Label.NavBar_My_Claim}</a></li>                
                <!--junda add 2020-9-24-->
                <!--<li id="isGuestuser-NavBar_My_Health" >-->
                    <!--<a id="manage-health-tab-mobile" href="javascript:void(0);" class="bs" onclick="" style="margin: 0px !important;padding: 0px !important;">-->
                        <!--<apex:outputPanel id="manage-health-tab-en-mobile-panel" >-->
                            <!--<apex:outputPanel rendered="{!isManageHealthShow}">-->
                                <!--<i class="ci-hk-ekg ci-hk-lg"></i>&nbsp;&nbsp;{!$Label.NavBar_My_Health}-->
                            <!--</apex:outputPanel>-->
                        <!--</apex:outputPanel>-->
                    <!--</a>-->
                <!--</li>-->
                <li style="{!IF(isManageHealthShow, '', 'display:none')}" id="isGuestuser-NavBar_My_Health"><a href="javascript:void(0);" class="bs" onclick="GTMonClickPush('{!SMTMyVirtualHealthTag}','{!$Setup.Portal_Settings__c.Customer_Portal_URL__c}/apex/CusMyVirtualHealthVFP','{!cusPartSMT}');Cigna.Util.navigateToVFP('MyVirtualHealthVFP')"><i class="ci-hk-med-bag ci-hk-lg"></i>&nbsp;&nbsp;{!$Label.NavBar_My_Health}</a></li>
                <!--<li style="display: none" id="isGuestuser-NavBar_Prescription"><a href="javascript:void(0);" class="bs" onclick="Cigna.Util.navigateToVFP('PrescriptionVFP')"><i class="ci-hk-clipboard ci-hk-lg"></i>&nbsp;&nbsp;{!$Label.NavBar_Prescription}</a></li>-->

                <!-- Autumn_SMT Partnership_20210224 start-->
                <li id="isGuestuser-NavBar_Smartone_List"><a href="javascript:void(0);" onclick="GTMonClickPush('{!SMTMyVirtualPrivilegesTag}','{!$Setup.Portal_Settings__c.Customer_Portal_URL__c}/apex/CusMySmartoneHealthOfferVFP','{!cusPartSMT}');navigateToVFP('MySmartoneHealthOfferVFP',this)"><i class="ci-hk-stethoscope ci-hk-lg" style="display: inline-block;vertical-align:middle;"></i>&nbsp;&nbsp;<div style="display: inline-block;align:left;vertical-align:middle;"><apex:outputText value="{!$Label.NavBar_My_Smartone_Health_Offer_New}" escape="false" ></apex:outputText></div></a></li>
                <!-- end -->
                <li id="isGuestuser-NavBar_Doctor_List"><a href="javascript:void(0);" class="bs" onclick="Cigna.Util.navigateToVFP('DoctorListVFP')"><i class="ci-hk-doctor ci-hk-lg"></i>&nbsp;&nbsp;{!$Label.NavBar_Doctor_List}</a></li>
        <script type="text/javascript">
                    function getToken(){
                        showLoading();
                        console.log('getToken----');
                        console.log('checkAndroidView----'+Cigna.Util.isAndroid());
                        console.log('checkIOSView----'+Cigna.Util.isIOS());
                        CustomerPageTemplateCtrl.getTelaDocToken(function (result){
                            console.log('result----'+result);                           
                            if(result!=null){
                                window.location=result;
                            }else{
                                alert( '{!$Label.NavBar_My_Health_Error}' );
                            }
                            hideLoading();
                        })
                    }
                </script>
                <!--junda add end-->
            </ul>
            <ul class="bs nav navmenu-nav nav-sub-menu" id="isGuestuser-down-list">
                <li><a href="javascript:void(0);" onclick="Cigna.Util.navigateToVFP('MyAccountPageVFP')" class="bs">{!$Label.NavBar_My_Settings}</a></li>
                <li class="bs dropdown">
                    <a href="javascript:void(0);" class="bs dropdown-toggle" data-toggle="dropdown">{!$Label.Help} <b class="caret"></b></a>
                    <ul class="bs dropdown-menu navmenu-nav" role="menu">
                        <li><a href="{!$Label.Cigna_HK_URL}" class="bs">{!$Label.Cigna_HK_Webpage}</a></li>
                        <li><a href="javascript:void(0);" onClick="Cigna.Util.navigateToVFP('FAQVFP')" class="bs">{!$Label.FAQ}</a></li>
                        <li><a href="javascript:void(0);" onClick="Cigna.Util.navigateToVFP('UsefulFormVFP')" class="bs">{!$Label.Useful_Forms}</a></li>
                        <!--<li><a href="javascript:void(0);" class="bs">{!$Label.Start_a_Live_Chat}</a></li>-->
                        <li id="liveagent_button_online-helpMenu" style="display: none;">
                            <a href="javascript:void(0);" onclick="startLiveChat()">{!$Label.Start_a_Live_Chat}</a>

                        </li>
                        <li id="liveagent_button_online-helpMenu-app" style="display: none;" onclick="startLiveChat()">
                            <a href="#">
                                {!$Label.Start_a_Live_Chat}
                            </a>
                        </li>
                        <li id="liveagent_button_offline-helpMenu" style="display: none;">
                            <a href="javascript:void(0);" class="bs" onclick="Cigna.Util.navigateToVFP('{!$Label.LiveChatMessageToCasePageName}', null, null, false, false)">{!$Label.Start_a_Live_Chat}</a>
                            <!--<apex:outputLink value="{!$Label.LiveChatMessageToCasePageName}" target="_blank">{!$Label.Start_a_Live_Chat}</apex:outputLink>-->
                        </li>
                        <li id="liveagent_button_offline-helpMenu-app" style="display:none">
                            <a href="javascript:void(0);" onclick="Cigna.Util.navigateToVFP('LiveChatLandingVFP?bid={!$Label.Customer_Portal_Live_Chat_Button_ID}&status=offline', null, null, false, false)">
                                {!$Label.Start_a_Live_Chat}
                            </a>
                        </li>
                        <li><a href="javascript:void(0);" class="bs" onclick="Cigna.Util.navigateToVFP('ContactUsVFP')">{!$Label.Contact_Us}</a></li>
                        <!--rancho_20220525,remove coah by link--> 
                        <!--<li><a href="{!$Label.Coach_By_Cigna_URL}" class="bs">{!$Label.Footer_Coach_By_Cigna}</a></li>-->
                        <!--<li><a href="{!$Label.Tutorial_URL}" class="bs">{!$Label.Footer_Tutorial}</a></li>-->
                        <li><a href="javascript:void(0);" class="bs" onclick="termsandCondition();$('#template-nav-menu').offcanvas('hide');">{!$Label.Footer_Terms_Conditions}</a></li>

                    </ul>
                </li>
                <li><a href="javascript:void(0);" class="bs" onclick="logout();">{!$Label.NavBar_Log_Out}</a></li>
            </ul>
            <div class="bs" style="height:25%; position: relative;" id="isGuestuser-facebook-youtube">
                <div style="bottom: 0; position: absolute; padding-left: 10px;">
                    <a href="{!$Label.Cigna_Facebook_URL}" target="_blank">
                        <div class="icon-wrapper">
                            <i class="fa fa-facebook custom-icon"><span class="fix-editor">&nbsp;</span></i>
                        </div>
                    </a>
                    <a href="{!$Label.Cigna_YouTube_URL}" target="_blank">
                        <div class="icon-wrapper">
                            <i class="fa fa-youtube-play custom-icon"><span class="fix-editor">&nbsp;</span></i>
                        </div>
                    </a>

                </div>
            </div>
        </div>
        <script>
            if({!!isGuestuser}){
                console.log('isGuestuser=>'+{!isGuestuser});
                $('#isGuestuser-CustomerLandingPage').attr('style','display:none');
                $('#isGuestuser-Header_Change_Language').attr('style','display:none');
                $('#isGuestuser-NavBar_Get_A_Quote').attr('style','display:none');
                $('#isGuestuser-NavBar_Policy_Change').attr('style','display:none');
                $('#isGuestuser-NavBar_My_Claim').attr('style','display:none');
                $('#isGuestuser-NavBar_Doctor_List').attr('style','display:none');

                <!--junda 2020-9-16-->
                $('#isGuestuser-NavBar_My_Health').attr('style','display:none');
                $('#isGuestuser-NavBar_Prescription').attr('style','display:none');
                $('#isGuestuser-NavBar_My_Policy').attr('style','display:none');
                $('#isGuestuser-down-list').attr('style','display:none');
            }else{
                $('#isGuestuser-personalchoice-Header_Change_Language').attr('style','display:none');
            }

            //junda add 20201007
            if({!isVirtualHealthShow}){
                //$('#isGuestuser-NavBar_Get_A_Quote').attr('style','display:none'); //Nicole_SMT_20210413
                $('#isGuestuser-NavBar').attr('style','display:none');
                $('#isGuestuser-NavBar_Policy_Change').attr('style','display:none');
                $('#isGuestuser-NavBar_My_Claim').attr('style','display:none');
                
                $('#isGuestuser-NavBar_My_Policy').attr('style','display:none');
                $('#isGuestuser-facebook-youtube').attr('style','display:none');
                
                if(!{!isManageHealthShow}){
                    $('#isGuestuser-NavBar_Doctor_List').attr('style','display:none');
                    $('#isGuestuser-NavBar_Smartone_List').attr('style','display:none');
                }
                //$('#isGuestuser-NavBar_Prescription').attr('style','display:none');
                //Nicole_SMT_20210618
                $('#liveagent_button_online-helpMenu').attr('style','display:none'); 
                $('#liveagent_button_online-helpMenu-app').attr('style','display:none'); 
                $('#liveagent_button_offline-helpMenu').attr('style','display:none'); 
                $('#liveagent_button_offline-helpMenu-app').attr('style','display:none'); 
            }
            if(!{!isManageHealthShow}){
                $('#isGuestuser-NavBar_My_Health').attr('style','display:none');
                $('#isGuestuser-NavBar_Smartone_List').attr('style','display:none');
            }
            if(checkAppView()){
                //$('#isGuestuser-NavBar_My_Health').attr('onclick','getToken()');
            }
            //Cooment_Tovid_SMT-47_if(Cigna.Util.isMobile()){   
            //    var ua = navigator.userAgent.toLowerCase();
            //    if(Cigna.Util.isIOS()){
            //        if (ua.indexOf('safari') >0 || ua.indexOf('chrome') >0) {
            //            $('#isGuestuser-NavBar_My_Health').attr('data-applink','cignacustomerportal://app');
            //            $('#isGuestuser-NavBar_My_Health').attr('onclick','window.location.href=\'{!$Label.IOSStore_MyCignaHK_App_Link}\'');
            //        }else{
            //            $('#isGuestuser-NavBar_My_Health').attr('onclick','getToken()');
            //        }
            //    }else if(Cigna.Util.isAndroid()){
            //        var hasVersion = /Version\/[.0.9]*/i.test(ua);
            //        if(hasVersion){
            //            $('#isGuestuser-NavBar_My_Health').attr('onclick','getToken()');
            //        }else{
            //            $('#isGuestuser-NavBar_My_Health').attr('data-applink','cignacustomerportal://app');
            //            $('#isGuestuser-NavBar_My_Health').attr('onclick','window.location.href=\'{!$Label.GoogleStore_MyCignaHK_App_Link}\'');
            //        }
            //     }else{
            //        $('#isGuestuser-NavBar_My_Health').attr('onclick','Cigna.Util.navigateToVFP(\'MyHealthVFP\')')
            //    }
            //}else{
            //    $('#isGuestuser-NavBar_My_Health').attr('onclick','Cigna.Util.navigateToVFP(\'MyHealthVFP\')')
            //}
        </script>
        <!-- End of Header -->

        <!-- Rancho_JOBR334_20230914 - rebranding -->
        <div style="display:none;"><input type="text" id="overlayChecker" /></div>
        <div id="reallocationOverlay" style="display:none;">
            <div id="reallocationSpecialBox">
                <a href="#">
                    <div id="reallocationCloseOverlay" class="glyphicon glyphicon-remove" onclick="reallocationToggleOverlay();"></div>
                </a>
                <h4 style="font-weight:bold;">{!$Label.Terms_and_Conditions}</h4>
                <div style="padding-bottom:10px; border-top: 1px solid #f2f2f2;"></div>
                <apex:outputPanel rendered="{!$Label.Header_Language_Code == 'zh_TW'}">
                    <div id="reallocationtccontent" style="text-align:left">
                        <b>Products and Services Provided by The Cigna Group Subsidiaries</b><br/> Cigna Healthcare is a registered service mark of Cigna Intellectual Property, Inc., licensed for use by The Cigna Group and its subsidiaries. The Cigna Group
                        is a holding company and is not an insurance or an operating company. Therefore, products and services are provided exclusively by subsidiaries and not by The Cigna Group. "Cigna Healthcare" may refer to The Cigna Group itself or one
                        or more of its subsidiaries, but when used in connection with the provision of a product or service, always refers to a subsidiary. In Hong Kong, products and services referred to on MyCigna.com.hk are provided exclusively by 
                        Cigna Worldwide General Insurance Company ("Cigna Hong Kong"). Cigna Hong Kong is authorized to carry on insurance business in Hong Kong. The materials and information on MyCigna.com.hk are
                        provided to you by Cigna Healthcare in accordance with these Legal Disclaimers/Conditions of Use.
                        <br/><br/><b>Availability</b><br/> The products and services available on MyCigna.com.hk are made available in Hong Kong only and are not made available to any person in any other place. Although it is possible to access MyCigna.com.hk
                        overseas, Cigna Healthcare makes no representation that the products and services available through MyCigna.com.hk complies with the laws of any country outside Hong Kong. If you access this site from outside Hong Kong, you do so on your
                        own responsibility and are responsible for ensuring compliance with all laws in the place where you are located.
                        <br/><br/><b>Product Descriptions</b><br/> The product descriptions, if any, provided on MyCigna.com.hk are not intended to constitute offers to sell or solicitations in connection with any products or services. Some products may
                        not be available in jurisdictions other than Hong Kong. Anyone interested in a particular product should contact Cigna Hong Kong to determine whether the product is available in their jurisdiction and to request a copy of the applicable
                        policy or prospectus for a complete description of the product.
                        <!--SMT-105 Tovid 20210811 start -->
                        <br/><br/><b>eDoctor by SmarTone X Cigna Service and Data Privacy Statement</b><br/>
                        Relevant services in the eDoctor offer are provided by third party vendors, subject to its terms and conditions. Cigna Healthcare is not the owner or the provider of relevant services and so is not liable in any way whatsoever in relation to any aspects for the use and consequence of the services.<br/>
                        To use relevant services, you need to agree to the Terms and Conditions and Privacy Notice of the services provided by the third party vendors, which include 
                        <a href="{!$Setup.Portal_Settings__c.File_Download_URL__c}{!SMT_Teladoc}" target="_blank" style="text-decoration: underline;">Teladoc TeleHealth</a>, 
                        <a href="{!$Setup.Portal_Settings__c.File_Download_URL__c}{!SMT_TC_Body_Check_Vcare}" target="_blank" style="text-decoration: underline;">V-Care Body Check Discount</a>, and 
                        <a href="{!$Setup.Portal_Settings__c.File_Download_URL__c}{!SMT_TC_Outpatient_Discount}" target="_blank" style="text-decoration: underline;">Network Provider for Outpatient Discount service</a>.
                        <!--SMT-105 Tovid 20210811 end -->
                        <br/><br/><b>Links to Other Sites</b><br/> While visiting MyCigna.com.hk, you may leave MyCigna.com.hk and access certain non-Cigna Healthcare Web sites. Cigna Healthcare neither reviews nor controls the content and accuracy of these Web sites, and
                        therefore will not be responsible for their content and accuracy. Your access to non-Cigna Healthcare Web sites is at your sole risk. Other Web sites on the Internet may contain unedited, sexually explicit, violent, racist or other types
                        of material, which may be offensive to you. Please access other Web sites at your own discretion.
                        <br/><br/><b>General Disclaimer</b><br/> All material including any link to other sites and content found at linked sites is provided "as is". Cigna Healthcare does not exclude or limit the application of any provision of any statute legislation
                        (including the Control of Exemption Clauses Ordinance and the Supply of Services (Implied Terms) Ordinance) where to do so would contravene that statute or cause any part of this provision to be void. Cigna Healthcare excludes all conditions,
                        warranties and terms implied by legislation, general law or custom, except any implied condition or warranty the exclusion of which would contravene any legislation or cause this provision to be void. Due to the nature of the Internet,
                        Cigna Healthcare does not warrant that access to MyCigna.com.hk or any of its pages will be uninterrupted or error free. Cigna Healthcare does not warrant or make any representations regarding the usefulness of or the expected results of the material
                        contained on MyCigna.com.hk. To the fullest extent permitted by law, Cigna Healthcare excludes: (a) all liability to you in contract, tort or otherwise for consequential or indirect damages arising out of or in connection with MyCigna.com.hk
                        even if: (i) Cigna Healthcare knew they were possible; or (ii) they were otherwise foreseeable, including without limitation, lost profits and damage suffered as a result of claims by any third person; and (b) all liability to you in negligence
                        for acts or omissions of Cigna Healthcare, its employees, agents and contractors arising out of or in connection with MyCigna.com.hk.
                        <br/><br/><b>Viruses, Worms, Use of Files</b><br/> Cigna Healthcare cannot and does not guarantee or warrant that files available for downloading from this site are free of viruses, worms, Trojan horses or other code that has contaminating
                        or destructive properties. Cigna Healthcare does not make any express or implied warranties, representations or endorsements whatsoever (including without limitation warranties of title, non-infringement or fitness for a particular purpose)
                        with respect to the files available for downloading from this site. In no event will Cigna Healthcare be liable to you or to anyone else for any decision made or action taken by you or anyone else in reliance on results obtained from use
                        of files downloaded from this Web site. These files may be downloaded and/or reprinted for personal use only. Permission to reprint or electronically reproduce any document or graphic in whole or in part for any reason except for
                        personal use is expressly prohibited, unless prior written consent is obtained from the appropriate Cigna Healthcare copyright holder.

                        <br/><br/><b>Health Information</b><br/> The health information on this Web site is provided by Cigna Healthcare solely for informational purposes as a public service to promote consumer health. It does not constitute medical advice and is
                        not intended to be a substitute for proper medical care provided by a physician. Cigna Healthcare assumes no responsibility for any circumstances arising out of the use, misuse, interpretation or application of any information supplied on
                        this site. Always consult with your doctor for appropriate examinations, treatment, testing, and care recommendations. Do not rely on information on this site as a tool for self-diagnosis.
                        <br/><br/><b>Trademarks</b><br/> There are references throughout MyCigna.com.hk to various trademarks or service marks and these, whether registered or not, are the property of their respective owners.
                        <br/><br/><b>Message Boards and Chat Rooms</b><br/> It is a condition of your use of Message Boards or Chat Rooms that you do not: (i) post or transmit any unlawful, threatening, abusive, libelous, defamatory, racial, obscene,
                        vulgar, pornographic, profane or indecent information of any kind, including without limitation any transmissions constituting or encouraging conduct that would constitute a criminal offense, give rise to civil liability or otherwise
                        violate any local, state, national or international law; (ii) post or transmit comments containing harassing or offensive language, using sexual references, sexual nicknames, racial slurs or rude or deliberately offensive comments
                        or engage in disruptive activity online, including excessive use of scripts, sound waves, scrolling (repeating the same message over and over), or use viruses, worms or Trojan horses; (iii) post or transmit any information, software
                        or other material which violates or infringes the rights of others, including material which is an invasion of privacy or publicity rights or which is protected by copyright, trademark or other proprietary right, or derivative
                        works without first obtaining permission from the owner; (iv) post or transmit any information, software or other material which contains a virus, worm, Trojan horse or other code that has contaminating or destructive properties;
                        (v) post any information, software, or other material for commercial purposes; (vi) solicit other users to join or contribute money to any online service or other organization, advocate or attempt to get users to join in legal
                        or illegal schemes; (vii) impersonate any person or entity or falsely represent your professional or other affiliation with any person or entity; or (viii) use MyCigna.com.hk to collect personally identifiable information in violation
                        of our Privacy Policy. You agree Cigna Healthcare, at its sole and absolute discretion, shall determine whether any information transmitted or received violates this provision. You agree to indemnify and hold Cigna Healthcare and its employees, officers,
                        directors and agents harmless from any claim or demand, including reasonable attorneys' fees, made by a third party arising from any material you contribute to Message Boards or Chat Rooms you access via MyCigna.com.hk. You understand
                        that Cigna Healthcare has no obligation to monitor Message Boards or Chat Rooms. Cigna Healthcare reserves the right at all times to disclose any information regarding the Message Boards or Chat Rooms, or to remove any information or materials, in whole
                        or in part, that in Cigna Healthcare's sole and absolute discretion are objectionable. You acknowledge that Cigna Healthcare reserves the right to monitor any and all information transmitted or received through MyCigna.com.hk which may be examined,
                        recorded, copied, and used in accordance with our Privacy Statement. Use of MyCigna.com.hk constitutes consent to such activity by Cigna Healthcare. When using MyCigna.com.hk, please be certain that anything you disclose does not compromise
                        your personal safety. Do not provide your name, phone number, social security number or any other personally identifying information to people you do not know. Do not continue any conversation online that makes you feel uncomfortable.
                        <br/><br/><b>Limitation of Liability</b><br/> You agree by accessing MyCigna.com.hk that to the fullest extent permitted by law, under no circumstances or any theories of liability under international or civil, common or statutory
                        law including but not limited to strict liability, negligence or other tort theories or contract, patent or copyright laws, will Cigna Healthcare be liable for damages of any kind occurring from the use of this web site or any information,
                        goods or services obtained on this web site including direct, indirect, consequential, incidental, or punitive damages (even if Cigna Healthcare has been advised of the possibility of such damages), to the fullest extent permitted by law.
                        Some jurisdictions do not allow the exclusion or limitation of certain damages so some of these limitations may not apply to you. Calculations and Investment Decisions Financial calculators/calculations are provided for illustrative
                        purposes only. You are responsible for verifying the accuracy and suitability of all assumptions and calculations. Please seek the advice of licensed and/or competent individuals before making any investment or financial planning
                        decisions. Do not rely solely on financial calculators/calculations or financial or retirement information found on MyCigna.com.hk.
                        <br/><br/><b>Personal Data</b><br/> You agree that, to the extent permitted by law, any and all personal data relating to you collected by Cigna Healthcare from time to time may be used and disclosed in accordance with the (a)
                        <!--Comment by Shengt for JOBR-235-->
                        <!-- <a href="{!$Setup.Portal_Settings__c.File_Download_URL__c}{!Privacy_statement_eng}" target="_blank" style="text-decoration: underline;"> -->
                        <a href="{!$Label.CignaPrivacyStatement}" target="_blank" style="text-decoration: underline;">
                        Privacy Statement
                        </a> of Cigna Healthcare (as may be amended from time to time) which is posted on MyCigna.com.hk and (b) the
                        <!--<a href="{!Privacy_statement_eng}" target="_blank" style="text-decoration: underline;">-->
                        <a href="{!PersonalInformationCollectionStatement_eng}" target="_blank" style="text-decoration: underline;">
                            Personal Information Collection Statement of Cigna Hong Kong
                   </a> 
                        <br/><br/><b>English Version</b><br/> The English text in our Legal Disclaimers/Conditions of Use shall prevail in the event of any inconsistency or conflict between the English version and any translations (if any) thereof.
                        <br/><br/><b>Changes and Applicable Law</b><br/> We reserve the right to make changes to MyCigna.com.hk and our Legal Disclaimers/Conditions of Use. We encourage you to review the Web site and these Legal Disclaimers/Conditions
                        of Use periodically for any updates or changes. Your continued access or use of MyCigna.com.hk shall be deemed your acceptance of these Legal Disclaimers/Conditions of Use and any changes and the reasonableness of these standards
                        for notice of changes. Use of MyCigna.com.hk will be governed by and construed in accordance with the laws of Hong Kong Special Administrative Region of the People's Public of China ("Hong Kong"), without giving effect to its conflict
                        of law provisions. You agree that any legal action or proceeding between you and MyCigna.com.hk will be brought exclusively in the courts of Hong Kong. If any provision of this Legal Disclaimers/Conditions of Use shall be unlawful,
                        void, or for any reason unenforceable, then that provision shall be deemed severable from this Legal Disclaimers/Conditions of Use and shall not affect the validity and enforceability of any remaining provisions.
                        <!-- <br/><br/>Last Updated: 12 Nov 2021 --><!-- Rancho_JOBR273_20221118 - T&C update -->

                    </div>
                </apex:outputPanel>
                <apex:outputPanel rendered="{!$Label.Header_Language_Code == 'en_US'}">
                    <div id="reallocationtccontent" style="text-align:left">
                        <b style="font-weight:bold !important;"></b><br/> Cigna Healthcare( Cigna Healthcare )  MyCigna.com.hk
                        --() MyCigna.com.hk /( Cigna Healthcare ) 
                        MyCigna.com.hk --() MyCigna.com.hk /
                        <br/><br/><b style="font-weight:bold !important;"></b><br/> MyCigna.com.hk  MyCigna.com.hk  MyCigna.com.hk 
                        <br/><br/><b style="font-weight:bold !important;"></b><br/> MyCigna.com.hk 
                        <!--SMT-105 Linus 2021 Nov 4 start -->
                        <br/><br/><b style="font-weight:bold !important;">SmarTone eDoctor x </b><br/>eDoctor 
                        
                        <a href="{!$Setup.Portal_Settings__c.File_Download_URL__c}{!SMT_Teladoc_TC}" target="_blank" style="text-decoration: underline;"></a>, 
                        <a href="{!$Setup.Portal_Settings__c.File_Download_URL__c}{!SMT_TC_Body_Check_Vcare}" target="_blank" style="text-decoration: underline;"> V-Care</a> 
                        <a href="{!$Setup.Portal_Settings__c.File_Download_URL__c}{!SMT_TC_Outpatient_Discount}" target="_blank" style="text-decoration: underline;"></a>
                        <!--SMT-105 Linus 2021 Nov 4 end -->
                        <br/><br/><b style="font-weight:bold !important;"></b><br/>  MyCigna.com.hk  
                        <br/><br/><b style="font-weight:bold !important;"></b><br/> "" MyCigna.com.hk 
                        MyCigna.com.hk   ( a )  MyCigna.com.hk  ( i )  ( i i )  ( b )  MyCigna.com.hk  
                         MyCigna.com.hk  MyCigna.com.hk 
                        <br/><br/><b></b><br/> ( Trojanhorses )
                        <br/><br/><b style="font-weight:bold !important;"></b><br/> 
                        <br/><br/><b style="font-weight:bold !important;"></b><br/>  MyCigna.com.hk 
                        <br/><br/><b style="font-weight:bold !important;"></b><br/> (i)( ii ) (
                        iii )( iv )( v )( vi )( vii )(
                        viii ) MyCigna.com.hk   MyCigna.com.hk  
                        MyCigna.com.hk  MyCigna.com.hk   MyCigna.com.hk 
                        <br/><br/><b style="font-weight:bold !important;"></b><br/>  MyCigna.com.hk 
                        <br/><br/><b style="font-weight:bold !important;"></b><br/>  MyCigna.com.hk 
                        <br/><br/><b style="font-weight:bold !important;"></b><br/> (a)
                        <!--Comment by Shengt for JOBR-235-->
                        <!-- <a href="{!$Setup.Portal_Settings__c.File_Download_URL__c}{!Privacy_statement_chi}" target="_blank" style="text-decoration: underline;"> -->
                        <!--<a href="{!Privacy_statement_chi}" target="_blank" style="text-decoration: underline;">-->
                        <a href="{!$Label.CignaPrivacyStatement}" target="_blank" style="text-decoration: underline;">
                            
                        </a> MyCigna.com.hk (b)
                        <a href="{!PersonalInformationCollectionStatement_chi}" target="_blank" style="text-decoration: underline;">
                            
                        </a>
                        <br/><br/><b style="font-weight:bold !important;"></b><br/> ()
                        <br/><br/><b style="font-weight:bold !important;"></b><br/>  MyCigna.com.hk  MyCigna.com.hk  MyCigna.com.hk
                         MyCigna.com.hk  MyCigna.com.hk 
                        <!-- <br/><br/><b style="font-weight:bold !important;">20211112</b><br/> --><!-- Rancho_JOBR273_20221118 - T&C update -->

                    </div>
                </apex:outputPanel>
            </div>
        </div>
        
        <!-- 20201030 - minghua - PendingMemo -->
        <div id="reallocationOverlay_PendingMemo" style="display: none;">
            <div id="reallocationSpecialBox_PendingMemo">
                <a href="#">
                    <div id="reallocationCloseOverlay_PendingMemo" class="glyphicon glyphicon-remove" onclick="reallocationToggleOverlay_PendingMemo();"></div>
                </a>
                <div style="padding-bottom:10px; border-top: 1px solid #f2f2f2;"></div>
                    <div id="reallocationtccontent_PendingMemo" style="text-align:left">
                        {!$Label.pendingMemoUnreadM}
                    </div>
            </div>
        </div>
        <div id="overlayPendMemo" style="display: none;">
            <div id="pendMemoBox">
                <a><div id="closeOverlayPendMemo" class="onclick-pointer ci-hk-x" onclick="showPendingMemoPanl();"></div></a>
                <div class="bs col-xs-11 col-sm-12" style="padding-bottom: 10px;">
                    <h5>
                        <apex:outputPanel id="pendingMemoMessage">
                            <apex:outputText value="{!$Label.You_have_number_messages}" >
                                <apex:param value="{!numOfNewPendMemo}" />
                            </apex:outputText>
                        </apex:outputPanel>
                    </h5>
                </div>
                <div id="contentPendMemo">
                    <apex:outputPanel id="pendingMemoPanelAll">
                        <apex:outputPanel id="PendingMemoPanel" rendered="{!numberOfMessages > 0}">
                            <div class="bs row">
                                <div class="bs col-xs-12 col-sm-12">
                                    <apex:variable var="memoCount" value="{!1}" />
                                    <apex:repeat value="{!pendingMemoList}" var="memoSummary">
                                            <div class="bs row table-content {!IF(MOD(memoCount,2)==1,'grey-background','')}" style="padding-bottom: 5px">
                                                <div class="bs bold-font col-xs-7 col-sm-9" style="text-align: left;font-size: 0.8em;">
                                                    <apex:outputPanel rendered="{!memoSummary.Is_New__c}">
                                                        <span class="tip"></span>
                                                    </apex:outputPanel>
                                                    <apex:outputPanel rendered="{!$Label.Header_Language_Code == 'en_US'}">
                                                        <apex:outputText value="{!IF(memoSummary.New_Message_CH__c == '', '' ,memoSummary.New_Message_CH__c)}" escape="false" />
                                                    </apex:outputPanel>
                                                    <apex:outputPanel rendered="{!$Label.Header_Language_Code != 'en_US'}">
                                                        <apex:outputText value="{!IF(memoSummary.New_Message_EN__c == '', '' ,memoSummary.New_Message_EN__c)}" escape="false" />
                                                    </apex:outputPanel>
                                                </div>
                                                <div class="bs col-xs-4 col-sm-2" style="padding: 0px;text-align: center;font-size: 0.8em;">
                                                    <apex:outputText value="{0, date, yyyy/MM/dd}">
                                                        <apex:param value="{!memoSummary.Penging_Memo_Date__c}"/>
                                                    </apex:outputText>
                                                </div>
                                                <!-- add bob CM User 20210122 -->
                                                <apex:outputPanel rendered="{!memoSummary.Button_label_EN__c != 'Reply'&&!isCMUser}">
                                                    <div class="bs col-xs-1 col-sm-1" style="padding: 0px;margin: 0px;text-align: right;font-size: 0.7em;">
                                                        <a><div class="onclick-pointer ci-hk-x" onclick="deleteMessage('{!memoSummary.id}')"></div></a>
                                                    </div>
                                                </apex:outputPanel>
                                                <!-- {!memoSummary.Prescription__r.Prescription_Id__c} -->
                                                <div class="bs col-xs-12 col-sm-12" style="margin: 0px;padding: 0px;">
                                                    <div class="cigna-bg-blue-light cigna-fg-white" style="border-radius:6px;margin: 5px;width: 80px; text-align: center;font-size: 0.8em" onclick="gotoRedirect('{!memoSummary.id}','{!memoSummary.External_ID__c}', '{!memoSummary.Category__c}', '{!memoSummary.DOC_IS_Claim__c}', '{!memoSummary.Pending_Memo_Number__c}', '{!memoSummary.Policy_Type__c}', '{!memoSummary.SHA256Key__c}','','{!memoSummary.E_Signature_Request__r.E_Signature_URL__c}')"  role="button">
                                                        <apex:outputPanel rendered="{!$Label.Header_Language_Code == 'en_US'}">
                                                            {!memoSummary.Button_label_CH__c}
                                                        </apex:outputPanel>
                                                        <apex:outputPanel rendered="{!$Label.Header_Language_Code != 'en_US'}">
                                                            {!memoSummary.Button_label_EN__c}
                                                        </apex:outputPanel>
                                                    </div>
                                                </div>
                                            </div>
                                        <apex:variable var="memoCount" value="{!memoCount + 1}" />
                                    </apex:repeat>
                                </div>
                            </div>
                        </apex:outputPanel>
                        <apex:outputPanel id="noPendingMemoMessage" rendered="{!numberOfMessages == 0}">
                            <div style="text-align: center;">
                                {!$Label.You_have_no_message}
                            </div>
                        </apex:outputPanel>
                    </apex:outputPanel>
                </div>
            </div>
        </div>
        
        <!-- DownTime Message Popup Window -->
        <div id="downtimeMessageOverlay">
            <div id="downtimeMessageBox">
                <a href="#">
                    <div id="downtimeMessageCloseOverlay" class="glyphicon glyphicon-remove" onclick="closeDownTimeMessageOverlay()"></div>
                </a>
                <!-- Autumn_JR1902_20210409 -->
                <apex:repeat value="{!portalMessageList}" var="portalMessage">
                <!-- English -->
                    <apex:outputPanel rendered="{!$Label.Header_Language_Code == 'zh_TW'}" layout="block" title="{!portalMessage.English_Subject__c}" style="text-align: left;">
                            <div>
                                <apex:outputText style="font-weight:bold;" value="{!portalMessage.English_Subject__c}" lang="en">
                                </apex:outputText>
                                <apex:outputText style="margin-left: 1rem;color: #999999;font-size: 8px;line-height: 1;" value="{0, date, dd/MM/yyyy}"><apex:param value="{!portalMessage.Start_Time__c}" /></apex:outputText>
                            </div>
                            <div style="margin-top: 1rem;">
                                <apex:outputText style="font-size: small;" escape="false" value="{!portalMessage.English_Message__c}" lang="en">
                        </apex:outputText>
                            </div>
                            <br/>
                </apex:outputPanel>
                <!-- Chinese -->
                    <apex:outputPanel rendered="{!$Label.Header_Language_Code == 'en_US'}" layout="block" title="{!portalMessage.Chinese_Subject__c}" style="text-align: left;">
                            <div>
                                <apex:outputText style="font-weight:bold;" value="{!portalMessage.Chinese_Subject__c}" lang="zh">
                        </apex:outputText>
                                <apex:outputText style="margin-left: 1rem;color: #999999;font-size: 8px;line-height: 1;" value="{0, date, dd/MM/yyyy}"><apex:param value="{!portalMessage.Start_Time__c}" /></apex:outputText>
                            </div>
                            <div style="margin-top: 1rem;">
                                <apex:outputText style="font-size: small;" escape="false" value="{!portalMessage.Chinese_Message__c}" lang="zh">
                                </apex:outputText>
                            </div>
                            <br/>
                </apex:outputPanel>
                    <p></p>
                </apex:repeat>
                <apex:form >
                    <apex:inputCheckbox id="downtimeMessageCheckbox"/>
                    <apex:outputText styleClass="checkboxLabel" rendered="{!$Label.Header_Language_Code == 'zh_TW'}" value="Do not show again"></apex:outputText>
                    <apex:outputText styleClass="checkboxLabel" rendered="{!$Label.Header_Language_Code == 'en_US'}" value=""></apex:outputText>
                    <apex:actionFunction action="{!setUserNotReceiveTime}" name="setUserNotReceiveTime">
                    </apex:actionFunction>
                    
                    <!--Nicole_GS Login Performance_20200617-->
                    <apex:actionFunction action="{!initManagePolicyDisplayLogic}" name="initManagePolicyDisplayLogic" reRender="manage-policy-tab-en-panel,manage-policy-tab-zh-panel,manage-policy-tab-en-mobile-panel,manage-policy-tab-js-refresh-panel" >
                    </apex:actionFunction>

            <!--junda 20200918 health show-->
                    <apex:actionFunction action="{!initManageHealthDisplayLogic}" name="initManageHealthDisplayLogic" reRender="manage-health-tab-en-mobile-panel,manage-health-tab-js-refresh-panel" >
                    </apex:actionFunction>
                    <apex:actionFunction name="updateTxn" action="{!updateTxn}" oncomplete="updateLanguage();"/>
                    <div id="params-pbt-tm" style="display: none;">
                        <apex:outputPanel id="params-pbt-tm">
                            <apex:inputHidden value="{!params}" id="params-pbt-tm-esales"/>
                        </apex:outputPanel>
                    </div>
                </apex:form>
            </div>    
        </div>
        
        <div id="container">
            <div id="template-templateBody">
                <!-- Insert the body of the page -->
                <apex:insert name="body" /><br/>
            </div>
            <div id="template-overlayBody" href="#" onclick="$('#template-nav-menu').offcanvas('hide');" style="display:none;" />
            <!-- alert('hi'); -->
        </div>

        <br/><br/><br/>

        <!-- Footer -->
        <div class="navbar navbar-inverse navbar-fixed-bottom hidden-xs" role="navigation">
            <div class="container" style="margin: 0 auto;padding-right: 0px;">
                <div class="bs row col-sm-12 navmenu-footer" id="footer">
                    <a class="footer-text" href="#" onclick="Cigna.Util.navigateToVFP('FAQVFP')">{!$Label.FAQ}</a>
                    <a class="footer-text" href="#" onclick="Cigna.Util.navigateToVFP('UsefulFormVFP')">{!$Label.Useful_Forms}</a>
                    <a class="footer-text" href="#" onclick="Cigna.Util.navigateToVFP('ContactUsVFP')">{!$Label.Contact_Us}</a>
                    <a class="footer-text" href="{!$Label.Cigna_HK_URL}" target="_blank">{!$Label.Cigna_HK_Webpage}</a>
                    <!--<a class="footer-text" href="{!$Label.Tutorial_URL}" target="_blank">{!$Label.Footer_Tutorial}</a>-->
                    <!--rancho_20220525,remove coah by link--> 
                    <!--<a class="footer-text" href="{!$Label.Coach_By_Cigna_URL}" target="_blank">{!$Label.Footer_Coach_By_Cigna}</a>-->
                    <a class="footer-text" href="#" onclick="reallocationToggleOverlay();">{!$Label.Footer_Terms_Conditions}</a>
                    <a class="bs media-button" style="padding-left:20px;" href="{!$Label.Cigna_Facebook_URL}" target="_blank"><i class="fa fa-facebook custom-icon" aria-hidden="true"></i></a>
                    <a class="bs media-button" style="padding-left:10px;" href="{!$Label.Cigna_YouTube_URL}" target="_blank"><i class="fa fa-youtube-play custom-icon" aria-hidden="true"></i></a>

                </div>
                <script>
                    //junda add 20201007
                    if({!isVirtualHealthShow}){
                         //$('#footer').attr('style','display:none'); //Nicole_SMT_20210413
                    }
                </script>
            </div>
        </div>
        <!-- End of Footer -->

        <!-- Terms Dialog, when click live chat button, need to pop up this dialog -->
        <div class="bs">
            <div id="TermsDialog" class="bs modal fade" role="dialog">
                <div class="modal-dialog">
                    <!-- Modal content-->
                    <div class="modal-content">
                        <div class="modal-header">
                            <!--<button type="button" class="close" data-dismiss="modal">&times;</button>-->
                            <h4 class="modal-title">{!$Label.Please_accept_the_T_and_C_below_to_continue}</h4>
                        </div>
                        <div class="modal-body" style="height:300px;overflow:auto;">
                            <p> {!$Label.T_C}</p>
                        </div>
                        <div class="modal-footer">
                            <button class="btn btn-primary" onclick="hideTermsDialog();startLiveChat();" type="button">{!$Label.Cobrowse_Initiating_Accept}</button>
                            <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="hideTermsDialog();return false;">{!$Label.Cobrowse_Initiating_Decline}</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- End of Terms Dialog -->
    </div>

    <script type="text/javascript">
        function openTermsDialog() {
            $('#TermsDialog').modal('hide');
            $('#TermsDialog').modal({
                backdrop: 'static'
            });
        }

        function hideTermsDialog() {
            $('#TermsDialog').modal('hide');
        }

        function startLiveChat() {
            if (Cigna.Util.checkWebView()) {
                liveagent.startChat('{!$Label.Customer_Portal_Live_Chat_Button_ID}');
                //Cigna.Util.navigateToVFP('LiveChatLandingVFP?bid={!$Label.Customer_Portal_Live_Chat_Button_ID}&status=online&lang={!$Label.Header_Language_Code_Current}', null, null, false, false);
            } else {
                liveagent.startChat('{!$Label.Customer_Portal_Live_Chat_Button_ID}');
            }
        }

        function equiNavMenu() {
            // alert(' $(this).innerWidth()='+ $(this).innerWidth());
            /*
            var mq1 = window.matchMedia('(max-width: 767px)');
            if(mq1.matches && $('#template-nav-menu').is(':visible')){
                $('#template-nav-menu').offcanvas('hide');
            }
            var mq2 = window.matchMedia('(min-width: 768px)');
            var mq3 = window.matchMedia('(max-width: 991px)');
            if(mq2.matches && mq3.matches && $('#template-nav-menu').is(':visible')){
                $('#template-nav-menu').offcanvas('hide');
            }
            */
            if ($('#template-nav-menu').is(':visible')) {
                $('#template-nav-menu').offcanvas('hide');
            }
        }

        //CR-56_Link_20220214
        $(window).on("resize",function() {
            equiNavMenu();
        });

        if (Cigna.Util.checkWebView()) {

            if (Cigna.Util.isIOS()) {
                // 20210723 - minghua - SMT-83 109297 - Top Page Margin on IOS, change padding-top from 20 to 30
                document.getElementById("navtopbar").style.padding = "30px 0px 0px 0px";
                document.getElementsByTagName("body")[0].style.padding = "70px 0px 0px 0px";
                // 20210803 - minghua - SMT-99 116677 - IPhone 12 pro max UI issue
                document.getElementById("template-nav-menu").style.padding = "30px 0px 0px 0px";
            }

        }

        //livechat();
        if (!window._laq) {
            window._laq = [];
        }

        window._laq.push(function() {
            //junda modify 20201008
            if(!{!isVirtualHealthShow}){
                if (Cigna.Util.checkWebView()) {

                    liveagent.showWhenOnline('{!$Label.Customer_Portal_Live_Chat_Button_ID}', $("#liveagent_button_online-app")[0]);
                    liveagent.showWhenOffline('{!$Label.Customer_Portal_Live_Chat_Button_ID}', $("[id$='liveagent_button_offline-app']")[0]);

                    liveagent.showWhenOnline('{!$Label.Customer_Portal_Live_Chat_Button_ID}', $("#liveagent_button_online-xs-app")[0]);
                    liveagent.showWhenOffline('{!$Label.Customer_Portal_Live_Chat_Button_ID}', $("[id$='liveagent_button_offline-xs-app']")[0]);

                    liveagent.showWhenOnline('{!$Label.Customer_Portal_Live_Chat_Button_ID}', $("#liveagent_button_online-sm-app")[0]);
                    liveagent.showWhenOffline('{!$Label.Customer_Portal_Live_Chat_Button_ID}', $("[id$='liveagent_button_offline-sm-app']")[0]);

                    liveagent.showWhenOnline('{!$Label.Customer_Portal_Live_Chat_Button_ID}', $("#liveagent_button_online-helpMenu-app")[0]);
                    liveagent.showWhenOffline('{!$Label.Customer_Portal_Live_Chat_Button_ID}', $("[id$='liveagent_button_offline-helpMenu-app']")[0]);

                } else {

                    liveagent.showWhenOnline('{!$Label.Customer_Portal_Live_Chat_Button_ID}', $("#liveagent_button_online")[0]);
                    liveagent.showWhenOffline('{!$Label.Customer_Portal_Live_Chat_Button_ID}', $("#liveagent_button_offline")[0]);

                    liveagent.showWhenOnline('{!$Label.Customer_Portal_Live_Chat_Button_ID}', $("#liveagent_button_online-sm")[0]);
                    liveagent.showWhenOffline('{!$Label.Customer_Portal_Live_Chat_Button_ID}', $("[id$='liveagent_button_offline-sm']")[0]);

                    liveagent.showWhenOnline('{!$Label.Customer_Portal_Live_Chat_Button_ID}', $("#liveagent_button_online-xs")[0]);
                    liveagent.showWhenOffline('{!$Label.Customer_Portal_Live_Chat_Button_ID}', $("[id$='liveagent_button_offline-xs']")[0]);

                    liveagent.showWhenOnline('{!$Label.Customer_Portal_Live_Chat_Button_ID}', $("#liveagent_button_online-helpMenu")[0]);
                    liveagent.showWhenOffline('{!$Label.Customer_Portal_Live_Chat_Button_ID}', $("[id$='liveagent_button_offline-helpMenu']")[0]);
                }
            }
        });

        //Fix for not account linked to the LiveChatTranscript records
        liveagent.addCustomDetail('FirstName', '{!$User.FirstName}', true);
        liveagent.addCustomDetail('LastName', '{!$User.LastName}', true);
        //Add contactID for fix duplicate contact issue. as no accountID could be found, so liveagent.findOrCreate("Account") was removed
        //alert('{!$User.FirstName}' + '{!$User.LastName}' + '{!$User.ContactId}');
        liveagent.addCustomDetail('ContactId', '{!$User.ContactId}', true);
        liveagent.findOrCreate("Contact").map("Id", "ContactId", true, true, true).saveToTranscript('contactId').showOnCreate();

        //add by jack for livechat auto
        console.log('{!isVisitor}');
        if('{!isVisitor}' == 'false'){
            liveagent.addCustomDetail('caseSub', '{!$Setup.Live_Chat_Auto_Case_Default_Value__c.Subject__c} '+ ' {!$User.FirstName}' +'{!$User.LastName}', false);
            liveagent.addCustomDetail('LeadSource', '{!$Setup.Live_Chat_Auto_Case_Default_Value__c.Lead_Source__c}', true);
            liveagent.addCustomDetail('Media', '{!$Setup.Live_Chat_Auto_Case_Default_Value__c.Media__c}', true);
            liveagent.addCustomDetail('Category', '{!$Setup.Live_Chat_Auto_Case_Default_Value__c.Pulse_Survey_Category__c}', true);
            liveagent.addCustomDetail('S2S', '{!$Setup.Live_Chat_Auto_Case_Default_Value__c.S2S__c}', true);
            liveagent.addCustomDetail('CaseStatus', '{!$Setup.Live_Chat_Auto_Case_Default_Value__c.Status__c}', true);
            liveagent.addCustomDetail('AutoCreateCase', '{!$Setup.Live_Chat_Auto_Case_Default_Value__c.Auto_Create_Case__c}', true);
            liveagent.addCustomDetail('CaseRecordtype', '{!autoCaseRecordtype}', true);
            liveagent.addCustomDetail('UserContactId', '{!$User.ContactId}', true);
            liveagent.addCustomDetail('UserAccountId', '{!accountId}', true);
            console.log('{!accountId}');
            liveagent.findOrCreate("Case")
                                        .map("RecordType", "CaseRecordtype",false, false, true)
                                        .map("Subject", "caseSub",false, true, true)
                                        .map('S2S__c','S2S',false,false,true)
                                        .map('Lead_Source__c','LeadSource',false,false,true)
                                        .map('Media__c','Media',false,false,true)
                                        .map('Pulse_Survey_Category__c','Category',false,false,true)
                                        .map('Auto_Create_Case_Text__c','AutoCreateCase',false,false,true)
                                        .map('Status','CaseStatus',false,false,true)
                                        .map('ContactId','UserContactId',false,false,true)
                                        .map('AccountId','UserAccountId',false,false,true)
                                        .saveToTranscript('CaseId').showOnCreate();
        }
        
        liveagent.init('{!$Setup.Portal_Settings__c.Live_Agent_Init_URL__c}', '{!$Setup.Portal_Settings__c.Live_Agent_Deployment_ID__c}', '{!LEFT($Organization.Id, 15)}');
    </script>

    <!--script type="text/javascript" id="cobrowsescript" src="https://www.glancecdn.net/cobrowse/CobrowseJS.ashx?group={!$Setup.Portal_Settings__c.Glance_Cobrowse_Group_ID__c}&site={!$Setup.Portal_Settings__c.Glance_Cobrowse_Site__c}" data-inputevents='{"shift-13":"startSession"}' data-groupid="{!$Setup.Portal_Settings__c.Glance_Cobrowse_Group_ID__c}" data-site="{!$Setup.Portal_Settings__c.Glance_Cobrowse_Site__c}" charset="UTF-8"></script-->

    <script>
        function closeOffCanvas(evt) {
            $('#template-nav-menu').offcanvas('hide');
            evt.stopPropagation();

            var container = document.getElementById('container');
            container.removeEventListener("click", closeOffCanvas, true);
        }
        $('#template-nav-menu').on('shown.bs.offcanvas', function(evt) {
            var container = document.getElementById('container');
            //alert('window: ' + $(window).height());

            if (Cigna.Util.isIOS() && Cigna.Util.isCustomerPortal()) {
                $(container).css('height', $(window).height() - 44 - 20);
                $(container).css('overflow', 'hidden');
                //$(container).addClass('noscroll');
            }
            container.addEventListener("click", closeOffCanvas, true);
        });

        $('#template-nav-menu').on('hidden.bs.offcanvas', function(evt) {
            var container = document.getElementById('container');
            if (Cigna.Util.isIOS() && Cigna.Util.isCustomerPortal()) {
                $(container).css('height', 'auto');
                $(container).css('overflow', 'visible');
                //$(container).removeClass('noscroll');
            }
            triggerToggleOverlay();
            container.addEventListener("click", closeOffCanvas, true);
        });
        /*
        if (Cigna.Util.isIOS()) {
            $('html').css('position', 'fixed').css('overflow', 'auto').css('width', '100%').css('height', '100%');
            $('body').css('position', 'fixed').css('overflow-x', 'scroll').css('width', '100%').css('height', '100%');
        }
        */
    </script>
    <script>
        // Who added this touchevent? why?
        // var e = document.createEvent('TouchEvent');
        // Fix mobile floating toolbar when input is focused
        if (/iPhone|iPad/.test(window.navigator.platform)) {
            $(document)
                .on('focus', 'textarea,input,select', function(e) {
                    $('.navbar.navbar-fixed-bottom').css('display', 'none');
                    $('.navbar.navbar-fixed-top').css('position', 'absolute');
                })
                .on('blur', 'textarea,input,select', function(e) {
                    $('.navbar.navbar-fixed-bottom').css('display', 'inline');
                    $('.navbar.navbar-fixed-top').css('position', 'fixed');
                });
        }
    </script>
    <script type="text/javascript">
        function loadGlanceJS() {
            var element = document.createElement("script");
            element.type = "text/javascript";
            element.id = "cobrowsescript";
            element.src = "https://www.glancecdn.net/cobrowse/CobrowseJS.ashx?group={!$Setup.Portal_Settings__c.Glance_Cobrowse_Group_ID__c}&site={!$Setup.Portal_Settings__c.Glance_Cobrowse_Site__c}";
            element.setAttribute("data-inputevents", '{"shift-13":"startSession"}');
            element.setAttribute("data-groupid", "{!$Setup.Portal_Settings__c.Glance_Cobrowse_Group_ID__c}");
            element.setAttribute("data-site", "{!$Setup.Portal_Settings__c.Glance_Cobrowse_Site__c}");
            element.setAttribute("charset", "UTF-8");
            // CR-58 performance tuning 2022-03-01 Zane
            element.setAttribute("defer", "defer");
            document.body.appendChild(element);
        }

        function loadLivechatJS() {
            var element = document.createElement("script");
            element.id = 'deploymentJS';
            element.type = "text/javascript";
            element.src = "{!$Setup.Portal_Settings__c.Live_Agent_JavaScript_URL__c}";
            // CR-58 performance tuning 2022-03-01 Zane
            element.setAttribute("defer", "defer");
            document.body.appendChild(element);

            var interval = setInterval(
                function() {
                    if (typeof liveagent !== 'undefined') {
                        livechat();
                        clearInterval(interval);
                    }
                }, 200
            );
        }
    /*  function startChatbot(){
            if(ClareAI != undefined){
                if(!ClareAI.isOpened()){
                    $("#clare_widget").show();
                    ClareAI.open();
                }else{
                    $("#clare_widget").hide();
                    ClareAI.close();
                    
                }
            }
        }*/
    
    /*function initChatbot(){
            var appId = "5b7bc5ff4c995b0022192a31";
            var envLang = "zh-hk";
            var envHost = "https://api-dev.clare.ai";
            var flowId = "5e69a1d3ccb28d002a307297";
            switch("{!$Label.Header_Language_Code_Current}"){
                case "en_US":
                    envLang = "en-us";
                    flowId = "5e69a1d3ccb28d002a307297";
                    break;
                default:
                    envLang="zh-hk";
                    flowId = "5e6a3ba080d26c002a9a482e";
            }
            if((location.hostname).indexOf('livechatai-mycigna') >= 0){
                envHost = "https://api-dev.clare.ai";
                appId="5d1b1416863132000c0250f7";
            }
            try{  
                ClareAI.init({
                    appId: appId,
                    logo: "https://uatts.cigna.com.hk/iwov-resources/images/Chloe_web_icon.png",
                    appHost: envHost,
                    properties: { 
                        "loginId": "{!hashedLoginId}",
                        "accountId": "{!hashedAccountId}",
                        "contactId": "{!hashedContactId}",
                        "language": envLang,
                        
                        'triggerFlowId': flowId,
                        "categroy": '',
                        "buttonID":"{!$Label.Customer_Portal_Live_Chat_Button_ID}",
                        "fallbackbutton":'',
                        "perferProduct":'',
                        "deploymentID": "{!$Setup.Portal_Settings__c.Live_Agent_Deployment_ID__c}",
                        "organizationID": "{!LEFT($Organization.Id, 15)}"
                        },
                    soundNotificationEnabled: true,
                    title: "Cigna",
                    subtitle: "I am happy to help :)"
                });
                ClareAI.on(
                    'widget:closed',
                    function() {
                        $("#clare_widget").hide();
                    }
                );
                $("#clare_widget").hide();
           }catch(err){
               console.log("Chatbot init error");
           }
    }*/

        $(document).ready(function() {
            if({!!isGuestuser}){
                updateTxn();
            }
            else{
                //junda 20200918
                // 20211207 - minghua - AMP-31, now we get the tab display from validateUser WS
                // initManageHealthDisplayLogic();

                ctrlTabVisibiltyJS(); //Connor Asia miles

                //initManagePolicyDisplayLogic();
            }
            if(!sessionStorage.getItem("isClosed") || (sessionStorage.getItem("isClosed") && sessionStorage.getItem("isClosed") === "false")){
                //Autumn_JR1902_20210409
                if('{!portalMessageList}'){
                    toggleDowntimeMessageOverlay();
                }
            }
            loadGlanceJS();
            //   loadLivechatJS();
        });

        /*function livechat() {
            if (!window._laq) {
                window._laq = [];
            }

            window._laq.push(function() {

                if (Cigna.Util.checkWebView()) {

                    liveagent.showWhenOnline('{!$Label.Customer_Portal_Live_Chat_Button_ID}', $("#liveagent_button_online-app")[0]);
                    liveagent.showWhenOffline('{!$Label.Customer_Portal_Live_Chat_Button_ID}', $("[id$='liveagent_button_offline-app']")[0]);

                    liveagent.showWhenOnline('{!$Label.Customer_Portal_Live_Chat_Button_ID}', $("#liveagent_button_online-xs-app")[0]);
                    liveagent.showWhenOffline('{!$Label.Customer_Portal_Live_Chat_Button_ID}', $("[id$='liveagent_button_offline-xs-app']")[0]);

                    liveagent.showWhenOnline('{!$Label.Customer_Portal_Live_Chat_Button_ID}', $("#liveagent_button_online-sm-app")[0]);
                    liveagent.showWhenOffline('{!$Label.Customer_Portal_Live_Chat_Button_ID}', $("[id$='liveagent_button_offline-sm-app']")[0]);

                    liveagent.showWhenOnline('{!$Label.Customer_Portal_Live_Chat_Button_ID}', $("#liveagent_button_online-helpMenu-app")[0]);
                    liveagent.showWhenOffline('{!$Label.Customer_Portal_Live_Chat_Button_ID}', $("[id$='liveagent_button_offline-helpMenu-app']")[0]);

                } else {

                    liveagent.showWhenOnline('{!$Label.Customer_Portal_Live_Chat_Button_ID}', $("#liveagent_button_online")[0]);
                    liveagent.showWhenOffline('{!$Label.Customer_Portal_Live_Chat_Button_ID}', $("#liveagent_button_offline")[0]);

                    liveagent.showWhenOnline('{!$Label.Customer_Portal_Live_Chat_Button_ID}', $("#liveagent_button_online-sm")[0]);
                    liveagent.showWhenOffline('{!$Label.Customer_Portal_Live_Chat_Button_ID}', $("[id$='liveagent_button_offline-sm']")[0]);

                    liveagent.showWhenOnline('{!$Label.Customer_Portal_Live_Chat_Button_ID}', $("#liveagent_button_online-xs")[0]);
                    liveagent.showWhenOffline('{!$Label.Customer_Portal_Live_Chat_Button_ID}', $("[id$='liveagent_button_offline-xs']")[0]);

                    liveagent.showWhenOnline('{!$Label.Customer_Portal_Live_Chat_Button_ID}', $("#liveagent_button_online-helpMenu")[0]);
                    liveagent.showWhenOffline('{!$Label.Customer_Portal_Live_Chat_Button_ID}', $("[id$='liveagent_button_offline-helpMenu']")[0]);
                }
            });

            liveagent.addCustomDetail('Name', '{!$User.LastName} {!$User.FirstName}', true);
            liveagent.findOrCreate("Account").map("name", "Name", true, true, true).saveToTranscript('accountId').showOnCreate();
            liveagent.init('{!$Setup.Portal_Settings__c.Live_Agent_Init_URL__c}', '{!$Setup.Portal_Settings__c.Live_Agent_Deployment_ID__c}', '{!LEFT($Organization.Id, 15)}');
        }*/


        /*CR-52 penetration test: valide whether session time-out and reload the page and force log out user. issue: page can't be redirect to logout page in classic site Zane 2021-10-04*/
        /*part1: override XMLHttpRqest and localStorage setItem*/
        (function() {
            function ajaxEventTrigger(event) {
                var ajaxEvent = new CustomEvent(event, { detail: this });
                window.dispatchEvent(ajaxEvent);
            }
             
            var oldXHR = window.XMLHttpRequest;
         
            function newXHR() {
                var realXHR = new oldXHR();
         
                realXHR.addEventListener('readystatechange', function() { ajaxEventTrigger.call(this, 'ajaxReadyStateChange'); }, false);
         
                return realXHR;
            }
            window.XMLHttpRequest = newXHR;
            


            /*override localStorage setitem method and dispatch customer event*/
            var orignalSetItem = localStorage.setItem; 
            localStorage.setItem = function(key,newValue){
                var setItemEvent = new Event("setItemEvent");
                setItemEvent.key = key;
                setItemEvent.newValue = newValue;
                window.dispatchEvent(setItemEvent);
                orignalSetItem.apply(this,arguments);
            }

        })();

        /*part2: add event listener to detect http request and value change*/


        window.addEventListener("ajaxReadyStateChange",function(e){
            let xhr = e.detail;
            let siteDomain = "{!$Site.Domain}";
            // console.log("ajaxReadyStateChange", xhr);
            if(xhr.readyState == 4 && xhr.status == 200 && xhr.responseURL.indexOf(siteDomain) != -1){
                
                //reset timeout
                resetIdleTime();
            }
        });

        //detect idleTimerLastActivity change
        window.addEventListener("setItemEvent", function (e) {
            
            if(e.key ==='idleTimerLastActivity'){
                let oldValue = localStorage.getItem("idleTimerLastActivity");
                // console.log("setItemEvent", e);
                if(oldValue !== e.newValue){
                    startIdleTimer();

                }else{
                    // console.log('localStorageidleTimerLastActivity ' + e.newValue);
                }
            }
        });
        window.addEventListener("storage", function (e) {
            // console.log("storage ", e);
            if(e.key ==='idleTimerLastActivity'){
                if(e.oldValue !== e.newValue){
                    startIdleTimer();

                }else{
                    // console.log('localStorageidleTimerLastActivity ' + e.newValue);
                }
            }
        });

        /*part3: set timeout*/
        function resetIdleTime(){
            // console.log("reset idle time", new Date());
            localStorage.setItem('idleTimerLastActivity', new Date().getTime());
        }

        var idleTimer;
        function startIdleTimer() {
            clearTimeout(idleTimer);
            // 20220412 - minghua - issue fix - Reset password, authSession is null
            let sessionId=0;
            let authSess='{!authSession}';
            if (authSess!=undefined&&authSess!=null&&authSess!='') {
                sessionId={!authSession.NumSecondsValid};
            }
            let numValid = parseInt(sessionId)*1000+5*60*1000;
            console.log("checkIdleTimeoutLoop ", numValid);
            idleTimer = setTimeout(logoutUser, numValid);
        }


        function logoutUser(){
            // console.log('log out user', new Date());
            if (checkWebView()) {
                window.location = "https://localhost/logout.html";
            } else {
                window.location.href = "/customer/secur/logout.jsp";
            }
        }
        /*https://cignahk--smuat.sandbox.my.site.com/customer/secur/logout.jsp?startURL=%2Fcustomer%2Fapex%2FCustomerLoginVFP&retUrl=https%3A%2F%2Fcignahk--smuat.sandbox.my.site.com%2Fcustomer%2FCustomerLoginVFP&retUrl=https%3A%2F%2Fcignahk--smuat.sandbox.my.site.com%2Fcustomer%2FCustomerLoginVFP*/

        function ctrlTabVisibiltyJS(){ //Connor Asia miles 
            console.log('ctrlTabVisibiltyJS');
            console.log('ctrlTabVisibiltyJS isManagePolicyShow {!isManagePolicyShow}');
            console.log('ctrlTabVisibiltyJS isManageClaimShow {!isManageClaimShow}');
            console.log('ctrlTabVisibiltyJS isGetProtectedShow {!isGetProtectedShow}');
            console.log('ctrlTabVisibiltyJS isVirtualPrivilegeAMShow {!isVirtualPrivilegeAMShow}');
            console.log('ctrlTabVisibiltyJS isVirtualHealthAMShow {!isVirtualHealthAMShow}');
            console.log('ctrlTabVisibiltyJS isDoctorListShow {!isDoctorListShow}');
            if({!isManagePolicyShow}){  //my policy tab
                $('#manage-myPolicy-tab-zh').show();  
                $('#manage-myPolicy-tab-en-panel').show();
            }else{
                $('#manage-myPolicy-tab-zh').hide();
                $('#manage-myPolicy-tab-en-panel').hide();             
            }
            if({!isManageClaimShow}){
                $('#manage-myClaim-tab-en-panel').show();
                $('#manage-myClaim-tab-zh').show();
            }else{
                $('#manage-myClaim-tab-en-panel').hide();
                $('#manage-myClaim-tab-zh').hide();
            }
            if({!isGetProtectedShow}){
                $('#manage-getProtected-tab-en-panel').show();
                $('#manage-getProtected-tab-zh').show();
                $('#isGuestuser-NavBar_Get_A_Quote').show();  
            }else{
                $('#manage-getProtected-tab-en-panel').hide();
                $('#manage-getProtected-tab-zh').hide();
                $('#isGuestuser-NavBar_Get_A_Quote').hide();                  
            }
            if({!isVirtualPrivilegeAMShow}){
                $('#manage-MySmartoneHealthOffer-tab-zh').show();
                $('#manage-MySmartoneHealthOffer-tab-en-panel').show();
                $('#isGuestuser-NavBar_Smartone_List').show(); 
            }else{
                $('#manage-MySmartoneHealthOffer-tab-zh').hide();
                $('#manage-MySmartoneHealthOffer-tab-en-panel').hide();
                $('#isGuestuser-NavBar_Smartone_List').hide();                
            }
            if({!isVirtualHealthAMShow}){
                $('#isGuestuser-NavBar_My_Health').show();
                $('#manage-myhealth-tab-zh').show();
                $('#manage-myHealth-tab-en-panel').show();    
            }else{
                $('#isGuestuser-NavBar_My_Health').hide();
                $('#manage-myhealth-tab-zh').hide();
                $('#manage-myHealth-tab-en-panel').hide();                        
            }
            if({!isDoctorListShow}){
                $('#manage-doctorList-tab-zh').show();
                $('#manage-doctorList-tab-en-panel').show();
                $('#isGuestuser-NavBar_Doctor_List').show();  
            }else{
                $('#manage-doctorList-tab-zh').hide();
                $('#manage-doctorList-tab-en-panel').hide();
                $('#isGuestuser-NavBar_Doctor_List').hide();                   
            }
            
        }
    </script>
        
</apex:page>