<!--Please change apex page title-->
<apex:page docType="html-5.0" sidebar="false" showHeader="false" controller="PolicyAssignmentController" title="Policy Assignment">
    <head>  
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width"/>     
        <!-- TO BE REMOVED (if put in the template page) -->
        <apex:stylesheet value="{!URLFOR($Resource.Cigna_HK_Icons, 'Cigna-HK-Icons.css')}"/>
        <style>
            
            @media 
            only screen and (max-width: 760px),
            (min-device-width: 768px) and (max-device-width: 1024px)  {
            
               .nav-pills:active{
                color: #fff !important;
                background-color: #2E2E2E !important;   
               }
        
                .myTitle
                {
                  font-weight: bold;  
                }
                .myTable
                {
                    border-top:0px !important;
                }
                .bs .nav-pills>li.active>a, .bs .nav-pills>li.active>a:focus, .bs .nav-pills>li.active>a:hover {
                  color: #FFF !important;
                  background-color: #2E2E2E !important;
                }
                .bs .nav-pills>li>a:hover {
                  color: #FFF !important;
                  background-color: #BDBDBD !important;
                }
                .bs .nav-pills>li>a{
                  color: #2E2E2E !important;
                  background-color: #FFF !important;
                }
                
                .desktop-search-btn-div {
                    padding: 10px;
                }
        
            }
    
            
            @media (min-width: 768px) { 
                .fundName {
                    height: 52px;
                }
                
                .withdrawTablePlanName {
                    height: 38px;
                }
            }
              
              .desktop-search-btn-div {
                  padding-right:0px;
              }
              
              .desktop-search-btn-div div.desktop-action-btn{
                    padding-top: 10px;
                    padding-bottom: 10px;
              }
              
              div#overlay {
                display: none;
                z-index: 10;
                background: #D9D9D6;
                position: fixed;
                width: 100%;
                height: 100%;
                top: 0px;
                left: 0px;
                text-align: center;
              }
              div#specialBox {
                display: none;
                position: absolute;
                z-index: 11;
                margin: 150px auto 0px auto;
                width: 80%;
                height: 50%;
                background: #FFF;
                color: #000;
                left: 10%;
                padding:20px;
                border-radius:5px;
                
                
              }
              #closeOverlay {
                position: absolute;
                top: 10px;
                right: 10px;
              }
            
              #tccontent {
                padding:10px;
                color:#000;
                font-size:12px;
                width: 100%;
                height: 95%;
                overflow-y:auto;
              } 
              
              .content-active {
                color:#39B54A;
              }
              
              .fundTable th {
                  font-size:12px;
                  padding-bottom:3px !important;
              }
              
              .fundTable td {
                  padding-top:0 !important;
                  padding-bottom:0 !important;
              }
              
              .switchInTable td {
                  font-size:14px;
                  padding-bottom:3px !important;
                  vertical-align: middle !important;
              }
              
              /**
              input.amountInput {
                   margin-top:-10px;
              }*/
              
              .fontSize12 {
                  font-size:12px;
              }
              
              .fontSize14 {
                  font-size:14px;
              }
              
              div.errorDiv {
              }
              
              label.error {
                  font-size:11px;
              }
              
              label.cusError {
                  font-size:14px;
                  color: red;
              }
              
              .fontWeightNormal label{
                  font-weight: normal;
              }
              
              .wrapErrorRow label.error {
                   white-space: pre-wrap;      /* CSS3 */   
                   white-space: -moz-pre-wrap; /* Firefox */    
                   white-space: -pre-wrap;     /* before Opera 7 */   
                   white-space: -o-pre-wrap;   /* Opera 7 */    
                   word-wrap: break-word;      /* IE */
              }
              
              .wrapErrorRow th {
                   vertical-align: top !important;
              }
              
              .grey-bottom {
                  border-bottom:2px solid #f2f2f2;
              }
              
              .bs .form-field-style-select {
                  border:0px;
                  border-bottom:1px solid #58595B;
                  background: url('{!$Resource.select_arrow_style}') no-repeat 98% 50%;
                  background-size: 7px 7px;
                  padding-right:20px;
                  -moz-appearance: none; 
                  -webkit-appearance: none; 
                  appearance: none;
                  width: 100%;
                  //box-shadow: none !important;
                  border-radius: 0px;
                  //color: #58595B;
              }
              
              /* Overwrite the style to be check circle */
              .bs input[type="checkbox"].cigna-question-checkbox + label:before, 
              .bs input[type="radio"].cigna-question-radio + label:before {
                  //padding-top: 3px;
              }
              
              .bs input[type="checkbox"].cigna-question-checkbox + label:before {
                  content: "\f05d";
                  color: #58595B;
              }
              .bs input[type="checkbox"].cigna-question-checkbox:checked + label:before {
                  color: #E35205;
                  content: "\f05d";
                  font-weight: normal;
              }
              
              .bs input[type="radio"].cigna-question-radio + label:before {
                  content: "\f05d";
                  color: #58595B;
                  //font-weight: normal !important;
              }
              .bs input[type="radio"].cigna-question-radio:checked + label:before {
                  color: #E35205;
                  content: "\f05d";
                  font-weight: normal;
              }
              
              .bs input[type="radio"].cigna-question-radio + label {
                  color: #58595B;
                  font-weight: normal;
              }
              .bs input[type="radio"].cigna-question-radio:checked + label {
                  color: #E35205;
                  font-weight: normal;
              }
              
              .hidden-input-field{
                  height:0px; 
                  width:0px; 
                  border:0px !important;
                  webkit-appearance: none;
              }
              
              .content-ellipsis {
                    overflow: hidden;
                    word-wrap: break-word;
                    white-space: normal;
                    <!--white-space:nowrap;
                    text-overflow: ellipsis;-->
                    max-width: 500px !important;
              }
              
              .form-field-text-style {
                    height: 34px;
                    padding: 6px 12px;
                    line-height: 1.42857143 !important;
               }
            
        </style>
        <apex:define name="additionalLibraries">
             <!--additional css, bootstrap, jquery,js libraries-->
             <apex:includeScript value="{!URLFOR($Resource.signature_pad_1_5)}" />
             <!-- CR-56_Link_20220214 -->
             <script type="text/javascript" src="{!URLFOR($Resource.jQuery_Validation, 'jquery.validate_new.min.js')}"/>
             <script type="text/javascript" src="{!URLFOR($Resource.jQuery_Validation, 'additional-methods.min.js')}" />
             <apex:outputPanel rendered="{!userLanguage == 'zh_TW'}" layout="none">
                 <script type="text/javascript" src="{!URLFOR($Resource.jQuery_Validation, '/localization/messages_zh_TW.min.js')}" />
             </apex:outputPanel>
             <!-- Date Picker -->
             <link rel="stylesheet" href="{!URLFOR($Resource.jQuery_ui, 'jquery-ui/jquery-ui.min.css')}" />
             <!--CR-56_Link_20220214-->
             <script type="text/javascript" src="{!URLFOR($Resource.jQuery_ui, 'jquery-ui/jquery-ui-1.13.min.js')}"></script>
             <script type="text/javascript" src="{!URLFOR($Resource.jQuery_ui, 'jquery-ui/datepicker-zh-TW.js')}"></script>
        </apex:define>
        <script>
            var noSearchValueErrMsg = '{!$Label.Error_Input_Criteria}';

            $(document).ready(function(){        
    
               if (Cigna.Util.isIOS() && Cigna.Util.isSalesforce1() && Cigna.Util.isBrokerPortal()) {
                      $('#action-bar').css('position', 'absolute');
                      //$('#mobile-app-padding').css('display', 'block');
                      $("div[id*='mobile-app-padding']").css('display', 'block');
               }
                
               displayList('assignment');
               
                if (Cigna.Util.isBrokerPortal()) {
                    $('#firstbtnsm').text('{!$Label.Next}');    
                    $('#firstbtnxstext').text('{!$Label.Next}');   
                    $('#confirmbtnsm').text('{!$Label.Return_to_Policy_Assignment}');    
                    $('#confirmbtnxstext').text('{!$Label.Return_to_Policy_Assignment}');    
                }
                else if (Cigna.Util.isCustomerPortal()) {
                    $('#firstbtnsm').text('{!$Label.Submit}');  
                    $('#firstbtnxstext').text('{!$Label.Submit}');  
                    $('#confirmbtnsm').text('{!$Label.Return_to_Policy_Assignment}');    
                    $('#confirmbtnxstext').text('{!$Label.Return_to_Policy_Assignment}');  
                }
                
                pageJSInit();
                     
            }); 
            
            function styleTableRowColor() {
                 var srlist = document.getElementsByClassName("listcontent");
                 var flip = 0;
                 for(var i = 0; i < srlist.length; i++){
                     var item = srlist[i];
                     if (flip == 0) {
                         item.style.backgroundColor = '#f2f2f2';
                         flip = 1;
                     }
                     else if ($(item).is(':first-child')) {
                         item.style.backgroundColor = '#f2f2f2';
                     }
                     else{
                         flip = 0;
                     }
                 }
            }
            
            var activeTab = 'assignment';
            
            function displayList(status){
                if(status=='assignment'){
                    activeTab = 'assignment';
                    document.getElementById('assignment').style.display = "block";
                    document.getElementById('history').style.display = "none";
                }
                
                if(status=='history'){
                    activeTab = 'history';
                    document.getElementById('assignment').style.display = "none";
                    document.getElementById('history').style.display = "block";
                }
                
            }
            
            function selectedTab(item){
                  $(item).siblings().removeClass('active-bar-tab');
                  $(item).siblings().addClass('inactive-bar-tab');
                  $(item).removeClass('inactive-bar-tab');
                  $(item).addClass('active-bar-tab');
            }
            
            function selectedSingle(item){
                 $(item).siblings().removeClass('cigna-fg-orange-medium');
                 $(item).addClass('cigna-fg-orange-medium');
            }
            
            function refresh(select) {
                $($(select).val()).tab('show');
            }
    
            function getURLParameter(name) {
            
                return decodeURIComponent((new RegExp('[?|&]' + name + '=' + '([^&;]+?)(&|#|;|$)').exec(location.search) || [null, ''])[1].replace(/\+/g, '%20')) || null;
            }
            
            $("[id$='policyChange']").addClass('active'); // <-- change the id to the active tab          
            
            function toggleOverlay(){
                var overlay = document.getElementById('overlay');
                var specialBox = document.getElementById('specialBox');
                overlay.style.opacity = .95;
                if(overlay.style.display == "block"){
                    overlay.style.display = "none";
                    specialBox.style.display = "none";
                } else {
                    overlay.style.display = "block";
                    specialBox.style.display = "block";
                }
            }
            
            function jQueryValidate() {
                return $("form[id*='policyAssignmentForm']").validate().form();
            }
            
            function additionalValidate(){
                var pass;
                if (activeTab == 'Switching'){
                    pass = checkSwitchIn100();
                }
                else if (activeTab == 'Reallocation'){
                    pass = checkReallocate100() && checkAccept();
                }
                else if (activeTab == 'Withdrawal'){
                    pass = checkWithdrawFilled() && checkWithdrawRequired();
                }
                else{
                    pass = true;
                }
                return pass;
            }
            
            function clearThisError(element) {
                if ($(element).val() != '') {
                    $(element).siblings('label.duplicateError').text('');
                    $(element).siblings('label.duplicateError').style.display = "none";
                }
            }
            
            function clearErrorMes() {
                $('#errorMes').text('');
                $('#RealloErrorMes').text('');
                $('#partialTableErrorMes').text('');
                $('#paymentTypeErrorMes').text('');
                $('#deliveryErrorMes').text('');
                $('#chequeCurrencyErrorMes').text('');
                
            }
            
            function selectAll(element) {
                $(element).parent().parent().siblings().find('input').each(function(idx, elem){
                    if ($(element).is(':checked')){
                        $(elem).prop('checked', true);
                    }
                    else {
                        $(elem).prop('checked', false);
                    }
                });
            }
            
            function uncheckSelectAll(element) {
                $(element).parent().parent().parent().parent().siblings().find('input').each(function(idx, elem){
                    if ($(element).is(':checked')){
                        if ($(elem).is(':checked')) {
                            $(elem).prop('checked', false);
                        }
                    }
                });
            }
            
            //Ray's Updates
            function withoutAgentValidation(){
                $('[id$=withoutAgentPoliciesPanelmsg]').show();
                var opt = $("[id$='withoutAgentSearchOption']").find(":selected").val();
                if(opt == "{!$Label.Pol_Policy_holder_name}"){
                    var searchvalue = $("input[id*='withoutAgentSearchValue']").val().split(' ').join('');
                    if((searchvalue.length) < 2){
                        $('#withoutAgentErrorMessage').css('display','block');
                    }
                    else{
                        $('#withoutAgentErrorMessage').css('display','none');
                        withoutAgentPoliciesSearch();
                    }
                }
                else if(opt != ''){
                    $('#withoutAgentErrorMessage').css('display','none');
                    withoutAgentPoliciesSearch();
                }       
            }
            
            function allPolicyValidation(){
                var opt = $("[id$='allPolicySearchOption']").find(":selected").val();
                var searchvalue = $("input[id*='allPolicySearchValue']").val().split(' ').join('');

                if(!searchvalue.trim()){
                  $('#allPolicyErrorMessage').text(noSearchValueErrMsg); 
                  $('#allPolicyErrorMessage').show();
                     
                  return null;                  
                } else {
                  $('#allPolicyErrorMessage').hide();
                }

                if(opt == "{!$Label.Pol_Policy_holder_name}"){
                    
                    if((searchvalue.length) < 2){
                        $('#allPolicyErrorMessage').text('{!$Label.Please_input_at_least_2_characters_to_search}'); 
                        $('#allPolicyErrorMessage').css('display','block');
                    }
                    else{
                        $('#allPolicyErrorMessage').css('display','none');
                        allPoliciesSearch();
                    }
                }
                else{
                    $('#allPolicyErrorMessage').css('display','none');
                    allPoliciesSearch();
                }
            
            }

            function specificAgentValidation(){
                var searchvalue = $("input[id*='specificAgentSearchValue']").val().split(' ').join('');

                if(!searchvalue.trim()){
                  $('#specificAgentErrorMessage').text(noSearchValueErrMsg); 
                  $('#specificAgentErrorMessage').show();
                     
                  return null;                  
                } else {
                  $('#specificAgentErrorMessage').hide();
                  policyAgentSearch();
                }
            }
            
        </script> 
    </head>
    <div id="container">
    <apex:form id="policyAssignmentForm">
        <!-- Start of Assignment Form -->  
        <div class="bs content-step" data-step="1" id="assign-step">
            <div id ="bartab" class="onclick-pointer" >
                <table class="bs bar-tab-container col-sm-12 col-xs-12">
                    <tr>
                        <td class="bs active-bar-tab" onclick="selectedTab(this);displayList('assignment')" >
                        {!$Label.Policy_Assignment}
                        </td>
                        <td class="bs inactive-bar-tab" onclick="selectedTab(this);displayList('history')">
                        {!$Label.Policy_Assignment_History}
                        </td>
                    </tr>
                </table>  
            </div>
   
            <div style="padding-top:10px;" />
            <!--<div>
                <div id="headeraction" class="bs header-action">
                    <div id="back" class="bs col-xs-6 col-sm-6 form-field">
                        <a href="#" onclick="Cigna.Util.navigateToVFP('PolicyDetailsPageVFP, null, null, true)"  class="bs cigna-fg-orange-medium pull-left">
                            <i class="fa fa-chevron-left" aria-hidden="true"></i> {!$Label.Back}
                        </a>
                    </div>
                </div>
            </div> -->
                
            <!-- Start of Assignment Tab -->
            <div id="assignment">        
                <div class="bs col-xs-12"> <!-- col-sm-10 col-sm-offset-1  -->
                    <div class="bs-xs-12" style="padding-top:20px;"/>
                    <div class="bs col-xs-12 content-highlight cigna-fg-blue-light">{!$Label.Step_1}</div>
                
                    <div class="bs col-xs-12">
                        {!$Label.Policy_Assignment_Choose_Policy}
                    </div>
                    
                    <div class="bs col-xs-12 cigna-answer-wrapper form-field">
                        <p class="bs col-xs-12">
                            <input type="radio" id="select-policy-type-01" value="{!$Label.Policies_without_agents}" name="select-policy-type" class="bs cigna-question-radio" />
                            <label for="select-policy-type-01">{!$Label.Policies_without_agents}</label>
                        </p>
                        <p class="bs col-xs-12">
                            <input type="radio" id="select-policy-type-02" value="{!$Label.Policies_of_a_specific_agent}" name="select-policy-type" class="bs cigna-question-radio" />
                            <label for="select-policy-type-02">{!$Label.Policies_of_a_specific_agent}</label>
                        </p>
                        <p class="bs col-xs-12">
                            <input type="radio" id="select-policy-type-03" value="{!$Label.All_policies}" name="select-policy-type" class="bs cigna-question-radio" />
                            <label for="select-policy-type-03">{!$Label.All_policies}</label>
                        </p>
                        <apex:inputHidden value="{!searchPolicySelect}" id="select-policy-type"  />
                        <apex:input id="Required-select-policy-type" styleClass="hidden-input-field" />
                    </div>
                    
                    <div class="bs col-xs-12">
                        <apex:outputPanel layout="block" id="policy-without-agent" html-data-id="policy-without-agent" styleClass="bs col-xs-12 cigna-fg-gray-dark" style="display:none;">
                            <div class="bs row" style="padding-right:30px;"> <!--  style="padding: 20px 0px 20px 0px;" -->
                                <div class="bs col-sm-6 col-xs-12" style="padding-bottom:20px;">
                                    <apex:selectList id="withoutAgentSearchOption" value="{!withoutAgentSearchType}" size="1" styleClass="bs form-field-style-select cigna-fg-gray-dark">
                                        <apex:selectOption itemValue="" itemLabel="{!$Label.Select_Search_Type}"/>
                                        <apex:selectOption itemValue="{!$Label.Pol_Policy_holder_name}" itemLabel="{!$Label.Pol_Policy_holder_name}"/>
                                        <apex:selectOption itemValue="{!$Label.Policy_Holder_ID}" itemLabel="{!$Label.Policy_Holder_ID}"/>
                                    </apex:selectList>
                                </div> 
                            
                                <div class="bs col-sm-6 col-xs-12">
                                      <apex:inputText id="withoutAgentSearchValue" style="font-size:1em; height:35px; width:95%" styleClass="bs form-field-style cigna-fg-gray-dark" value="{!withoutAgentSearchText}"/><i class="ci-hk-search cigna-fg-orange-dark text-center onclick-pointer" onclick="withoutAgentValidation()" style="width:5%" aria-hidden="true"/>
                                </div>
                            </div>
                            <div id="withoutAgentErrorMessage" class="bs col-sm-12 col-xs-12 text-center" style="color:red;padding-bottom:20px;display:none;">
                                {!$Label.Please_input_at_least_2_characters_to_search}
                            </div>                          
                            
                            <apex:actionFunction name="withoutAgentPoliciesSearch" action="{!withoutAgentPoliciesSearch}" status="loader-icon" rerender="withoutAgentPoliciesPanel" oncomplete="pageJSInit();" />
                            
                            <!-- Start of Without Agent List -->
                            <apex:outputPanel id="withoutAgentPoliciesPanel" style="padding-bottom:20px;">  
                               <div class="bs row listcontent-header" style="{!IF(withoutAgentPoliciesWrapper.size == 0, 'display:none;', '')}">
                                    <div class="bs col-xs-1" id='select-all-check-without-agent'>
                                        <input type="checkbox" id="without-agent-select-all" name="without-agent-select-all" class="bs cigna-question-checkbox" onclick="selectAll(this);"/> 
                                        <label for="without-agent-select-all"></label>
                                            
                                        <!-- <apex:inputHidden value="{!userLanguage}" id="paramDMConsent" /> -->
                                    </div>
                                    <div class="bs col-xs-6 visible-xs onclick-pointer" id="select-all-label-without-agent">{!$Label.Select_All}</div>
                                    <div class="bs col-xs-5 visible-xs"></div>
                                    <div class="bs col-sm-2 hidden-xs">{!$Label.Policy_No}</div>
                                    <div class="bs col-sm-3 hidden-xs">{!$Label.Pol_Product_Name}</div>
                                    <div class="bs col-sm-2 hidden-xs">{!$Label.Policy_Holder_Name}</div>
                                    <div class="bs col-sm-2 hidden-xs">{!$Label.Status}</div>
                                    <div class="bs col-sm-2 hidden-xs">{!$Label.Assigned_Agent}</div>
                               </div>
                               <div id="withoutAgentPoliciesPanelmsg" class="bs row" style="{!IF(isWithoutAgentPoliciesError || withoutAgentPoliciesWrapper.size != 0, 'display:none;', '')}">
                                    <div class="bs col-xs-12 text-center">
                                        <i class="fa fa-smile-o cigna-fg-black" aria-hidden="true"></i>
                                        {!$Label.You_have_assigned_all_the_policies}
                                    </div>
                               </div>
                               <apex:outputPanel rendered="{!isWithoutAgentPoliciesError}" styleClass="bs row col-xs-12">
                                    <div class="bs col-xs-12 text-center">
                                        <label class="cusError" >{!withoutAgentPoliciesErrorMessage}</label>
                                    </div>
                               </apex:outputPanel>
                               <apex:outputPanel id="without-agent-list-panel">
                               
                                   <apex:repeat value="{!withoutAgentPoliciesWrapper}" var="pWrapper">
                                     <div class="bs row listcontent onclick-pointer" id="search-policy-without-agent-div-{!pWrapper.policyNo}">
                                        <div class="bs table-row col-xs-1 col-sm-1" style="padding:0px !important;">
                                            <div class="bs col-xs-12 col-sm-12 content-highlight table-cell">
                                                <apex:inputCheckbox id="without-agent-select-single" value="{!pWrapper.selected}" onselect="assignSelectJS('true');"
                                                                    html-name="without-agent-select-{!pWrapper.policyNo}" StyleClass="bs cigna-question-checkbox" 
                                                                    onclick="uncheckSelectAll(this);"/>
                                                <label for="without-agent-select-{!pWrapper.policyNo}"></label>
                                                <apex:inputHidden value="{!pWrapper.testSelected}" id="test-hidden" />
                                            </div>
                                        </div>
                                        <div class="bs table-row col-xs-11 col-sm-2" style="padding:0px !important;">   
                                            <div class="bs col-xs-6 visible-xs table-cell">{!$Label.Policy_No}</div>
                                            <div class="bs col-xs-6 col-sm-12 content-highlight table-cell">{!pWrapper.policyNo}</div>
                                        </div>
                                        <div class="bs table-row col-xs-11 col-xs-offset-1 col-sm-3 col-sm-offset-0" style="padding:0px !important;">    
                                            <div class="bs col-xs-6 visible-xs table-cell">{!$Label.Pol_Product_Name}</div>
                                            <div class="bs col-xs-6 col-sm-12 content-highlight table-cell">{!pWrapper.productName_Display}</div>
                                        </div>
                                        <div class="bs table-row col-xs-11 col-xs-offset-1 col-sm-2 col-sm-offset-0" style="padding:0px !important;">    
                                            <div class="bs col-xs-6 visible-xs table-cell">{!$Label.Policy_Holder_Name}</div>
                                            <div class="bs col-xs-6 col-sm-12 content-highlight table-cell">{!pWrapper.holderName}</div>
                                        </div>
                                        <div class="bs table-row col-xs-11 col-xs-offset-1 col-sm-2 col-sm-offset-0" style="padding:0px !important;">    
                                            <div class="bs col-xs-6 visible-xs table-cell">{!$Label.Status}</div>
                                            <div class="bs col-xs-6 col-sm-12 content-highlight table-cell">{!pWrapper.status_Display}</div>
                                        </div>
                                        <div class="bs table-row col-xs-11 col-xs-offset-1 col-sm-2 col-sm-offset-0" style="padding:0px !important;">   
                                            <div class="bs col-xs-6 visible-xs table-cell">{!$Label.Assigned_Agent}</div>
                                            <div class="bs col-xs-6 col-sm-12 content-highlight table-cell">
                                                <apex:outputText rendered="{!!pWrapper.isCompangCodeEqualsAgentCode}" value="{!pWrapper.assignedAgent}"></apex:outputText>
                                            </div>
                                        </div>
                                     </div>
                                     
                                   </apex:repeat>
                               </apex:outputPanel>
                           </apex:outputPanel>
                           <!-- End of Without Agent List -->
                           
                        </apex:outputPanel>
                    </div>
                    
                    <div class="bs col-xs-12">
                        <apex:outputPanel layout="block" id="policy-specific-agent" html-data-id="policy-specific-agent" styleClass="bs cigna-fg-gray-dark col-xs-12" style="display:none;" >
                            <div class="bs row" style="padding-right:30px;"> <!--  style="padding: 20px 0px 20px 0px;" -->
                                <!--<div class="bs col-sm-6 col-xs-12" style="padding-bottom:20px;">
                                    <apex:selectList value="{!policyAgentSearchType}" size="1" styleClass="bs form-field-style-select cigna-fg-gray-dark">
                                        <apex:selectOption itemValue="" itemLabel="{!$Label.Select_Search_Type}"/>
                                        <apex:selectOption itemValue="Agent Name" itemLabel="Agent Name"/>
                                        <apex:selectOption itemValue="Agent Code" itemLabel="Agent Code"/>
                                    </apex:selectList>
                                </div>-->
                                <div class="bs col-sm-6 col-xs-12" style="padding-bottom:20px;">
                                    <apex:inputText value="{!policyAgentSearchType}" onfocus="this.blur()" style="font-size:1em; width:95%" styleClass="bs form-field-style cigna-fg-gray-dark"></apex:inputText>
                                </div>   
                            
                                <div class="bs col-sm-6 col-xs-12">
                                      <apex:inputText id="specificAgentSearchValue" style="font-size:1em; height:35px; width:95%" styleClass="bs form-field-style cigna-fg-gray-dark" value="{!policyAgentSearchText}"/><i class="ci-hk-search cigna-fg-orange-dark text-center onclick-pointer" onclick="specificAgentValidation()" style="width:5%" aria-hidden="true"/>
                                </div>

                                <div id="specificAgentErrorMessage" class="bs col-sm-12 col-xs-12 text-center" style="color:red;padding-bottom:20px;display:none;">
                                </div>
                            </div> 
                            
                            <apex:actionFunction id="action-function-search" name="policyAgentSearch" action="{!policyAgentSearch}" status="loader-icon" rerender="policySearchResultList" oncomplete="pageJSInit();" />
                            
                            <apex:outputPanel id="policySearchResultList">  <!-- rendered="{!showSpecificAgentPolicy}" -->
                                <!-- Start of Specific Agent List -->
                                <div id="specific-agent-list" style="padding-bottom:20px;">  
                                   <div class="bs row listcontent-header" style="{!IF(specificAgentPoliciesWrapper.size == 0, 'display:none;', '')}">
                                        <div class="bs col-xs-1" id='select-all-check-specific-agent'>
                                            <input type="checkbox" id="specific-agent-select-all" name="specific-agent-select-all" class="bs cigna-question-checkbox" onclick="selectAll(this);"/> 
                                            <label for="specific-agent-select-all"></label>
                                        </div>
                                        <div class="bs col-xs-6 visible-xs onclick-pointer" id="select-all-label-specific-agent">{!$Label.Select_All}</div>
                                        <div class="bs col-xs-5 visible-xs"></div>
                                        <div class="bs col-sm-2 hidden-xs">{!$Label.Policy_No}</div>
                                        <div class="bs col-sm-3 hidden-xs">{!$Label.Pol_Product_Name}</div>
                                        <div class="bs col-sm-2 hidden-xs">{!$Label.Policy_Holder_Name}</div>
                                        <div class="bs col-sm-2 hidden-xs">{!$Label.Status}</div>
                                        <div class="bs col-sm-2 hidden-xs">{!$Label.Assigned_Agent}</div>
                                   </div>
                                   <div class="bs row" style="{!IF(isPolicyAgentError || specificAgentPoliciesWrapper.size != 0, 'display:none;', '')}">
                                        <div class="bs col-xs-12 text-center">
                                            <i class="fa fa-smile-o cigna-fg-black" aria-hidden="true"></i>
                                            {!$Label.No_policy_has_been_assigned_to_this_agent}
                                        </div>
                                   </div>
                                   <apex:outputPanel rendered="{!isPolicyAgentError}" styleClass="bs row col-xs-12">
                                       <div class="bs col-xs-12 text-center">
                                           <label class="cusError" >{!policyAgentErrorMessage }</label>
                                       </div>
                                   </apex:outputPanel>
                                   <apex:outputPanel id="specific-agent-list-panel">
                                       <apex:repeat value="{!specificAgentPoliciesWrapper}" var="pWrapper">
                                         <div  class="bs row listcontent onclick-pointer" id="search-policy-specific-agent-div-{!pWrapper.policyNo}">
                                            <div class="bs table-row col-xs-1 col-sm-1" style="padding:0px !important;">
                                                <div class="bs col-xs-12 col-sm-12 content-highlight table-cell">
                                                    <apex:inputCheckbox id="specific-agent-select-single" value="{!pWrapper.selected}" onselect="assignSelectJS('true');" 
                                                                        html-name="specific-agent-select-{!pWrapper.policyNo}" StyleClass="bs cigna-question-checkbox" 
                                                                        onclick="uncheckSelectAll(this);" />
                                                    <label for="specific-agent-select-{!pWrapper.policyNo}"></label>
                                                    
                                                    <apex:inputHidden value="{!pWrapper.testSelected}" id="test-hidden" />
                                                    
                                                </div>
                                            </div>
                                            <div class="bs table-row col-xs-11 col-sm-2" style="padding:0px !important;">   
                                                <div class="bs col-xs-6 visible-xs table-cell">{!$Label.Policy_No}</div>
                                                <div class="bs col-xs-6 col-sm-12 content-highlight table-cell">{!pWrapper.policyNo}</div>
                                            </div>
                                            <div class="bs table-row col-xs-11 col-xs-offset-1 col-sm-3 col-sm-offset-0" style="padding:0px !important;">    
                                                <div class="bs col-xs-6 visible-xs table-cell">{!$Label.Pol_Product_Name}</div>
                                                <div class="bs col-xs-6 col-sm-12 content-highlight table-cell">{!pWrapper.productName_Display}</div>
                                            </div>
                                            <div class="bs table-row col-xs-11 col-xs-offset-1 col-sm-2 col-sm-offset-0" style="padding:0px !important;">    
                                                <div class="bs col-xs-6 visible-xs table-cell">{!$Label.Policy_Holder_Name}</div>
                                                <div class="bs col-xs-6 col-sm-12 content-highlight table-cell">{!pWrapper.holderName}</div>
                                            </div>
                                            <div class="bs table-row col-xs-11 col-xs-offset-1 col-sm-2 col-sm-offset-0" style="padding:0px !important;">    
                                                <div class="bs col-xs-6 visible-xs table-cell">{!$Label.Status}</div>
                                                <div class="bs col-xs-6 col-sm-12 content-highlight table-cell">{!pWrapper.status_Display}</div>
                                            </div>
                                            <div class="bs table-row col-xs-11 col-xs-offset-1 col-sm-2 col-sm-offset-0" style="padding:0px !important;">   
                                                <div class="bs col-xs-6 visible-xs table-cell">{!$Label.Assigned_Agent}</div>
                                                <div class="bs col-xs-6 col-sm-12 content-highlight table-cell">
                                                    <apex:outputText rendered="{!!pWrapper.isCompangCodeEqualsAgentCode}" value="{!pWrapper.assignedAgent}"></apex:outputText>
                                                </div>
                                            </div>
                                         </div>
                                         
                                       </apex:repeat>
                                       
                                        <apex:actionFunction name="assignSelectJS" > <!-- action="{!assignSelected}" rerender="theForm" status="theStatus" -->
                                            <apex:param name="pSelected" value="" assignTo="{!pWrapper.selected}"/>
                                        </apex:actionFunction>
                                   </apex:outputPanel>
                               </div>
                               <!-- End of Specific Agent List -->
                               
                            </apex:outputPanel>        
                        </apex:outputPanel>
                    </div>
                    
                    <div class="bs col-xs-12">
                        <apex:outputPanel layout="block" id="policy-all" html-data-id="policy-all" styleClass="bs cigna-fg-gray-dark col-xs-12" style="display:none;">
                            <div class="bs row" style="padding-right:30px;"> <!--  style="padding: 20px 0px 20px 0px;" -->
                                <div class="bs col-sm-6 col-xs-12" style="padding-bottom:20px;">
                                    <apex:selectList id="allPolicySearchOption" value="{!allPoliciesSearchType}" size="1" styleClass="bs form-field-style-select cigna-fg-gray-dark">
                                        <apex:selectOption itemValue="" itemLabel="{!$Label.Select_Search_Type}"/>
                                        <apex:selectOption itemValue="{!$Label.Pol_Policy_holder_name}" itemLabel="{!$Label.Pol_Policy_holder_name}"/>
                                        <apex:selectOption itemValue="{!$Label.Policy_Holder_ID}" itemLabel="{!$Label.Policy_Holder_ID}"/>
                                    </apex:selectList>
                                </div> 
                            
                                <div class="bs col-sm-6 col-xs-12">
                                      <apex:inputText id="allPolicySearchValue" style="font-size:1em; height:35px; width:95%" styleClass="bs form-field-style cigna-fg-gray-dark" value="{!allPoliciesSearchText}"/><i class="ci-hk-search cigna-fg-orange-dark text-center onclick-pointer" onclick="allPolicyValidation()" style="width:5%" aria-hidden="true"/>
                                </div>
                            </div> 
                            <div id="allPolicyErrorMessage" class="bs col-sm-12 col-xs-12 text-center" style="color:red;padding-bottom:20px;display:none;">
                                {!$Label.Please_input_at_least_2_characters_to_search}
                            </div><!--Ray-->
                            <apex:actionFunction name="allPoliciesSearch" action="{!allPoliciesSearch}" status="loader-icon" rerender="allPoliciesPanel" oncomplete="pageJSInit();" />
                            
                            <!-- Start of All Policy List -->
                            <apex:outputPanel id="allPoliciesPanel" style="padding-bottom:20px;">  
                               <div class="bs row listcontent-header" style="{!IF(allPoliciesWrapper.size == 0, 'display:none;', '')}">
                                    <div class="bs col-xs-1" id='select-all-check-all-policy'>
                                        <input type="checkbox" id="all-policy-select-all" name="all-policy-select-all" class="bs cigna-question-checkbox" onclick="selectAll(this);"/> 
                                        <label for="all-policy-select-all"></label>
                                            
                                        <!-- <apex:inputHidden value="{!paramDMConsent}" id="paramDMConsent" /> -->
                                    </div>
                                    <div class="bs col-xs-6 visible-xs onclick-pointer" id="select-all-label-all-policy">{!$Label.Select_All}</div>
                                    <div class="bs col-xs-5 visible-xs"></div>
                                    <div class="bs col-sm-2 hidden-xs">{!$Label.Policy_No}</div>
                                    <div class="bs col-sm-3 hidden-xs">{!$Label.Pol_Product_Name}</div>
                                    <div class="bs col-sm-2 hidden-xs">{!$Label.Policy_Holder_Name}</div>
                                    <div class="bs col-sm-2 hidden-xs">{!$Label.Status}</div>
                                    <div class="bs col-sm-2 hidden-xs">{!$Label.Assigned_Agent}</div>
                               </div>
                               <div class="bs row" style="{!IF(isAllPoliciesError || allPoliciesWrapper.size != 0, 'display:none;', '')}">
                                    <div class="bs col-xs-12 text-center">
                                        <i class="fa fa-smile-o cigna-fg-black" aria-hidden="true"></i>
                                        {!$Label.No_Policy_Found}
                                    </div>
                               </div>
                               <apex:outputPanel rendered="{!isAllPoliciesError }" styleClass="bs row col-xs-12">
                                   <div class="bs col-xs-12 text-center">
                                       <label class="cusError" >{!allPoliciesErrorMessage }</label>
                                   </div>
                               </apex:outputPanel>
                               <apex:outputPanel id="all-policy-list-panel">
                                   <apex:repeat value="{!allPoliciesWrapper}" var="pWrapper">
                                     <div  class="bs row listcontent onclick-pointer" id="search-policy-all-policy-div-{!pWrapper.policy.Id}">
                                        <div class="bs table-row col-xs-1 col-sm-1" style="padding:0px !important;">
                                            <div class="bs col-xs-12 col-sm-12 content-highlight table-cell">
                                                <apex:inputCheckbox value="{!pWrapper.selected}" id="all-policy-select" onselect="assignSelectJS('true');"
                                                                    html-name="all-policy-select-{!pWrapper.policyNo}" StyleClass="bs cigna-question-checkbox" 
                                                                    onclick="uncheckSelectAll(this);"/> 
                                                <label for="all-policy-select-{!pWrapper.policyNo}"></label>
                                                <apex:inputHidden value="{!pWrapper.testSelected}" id="test-hidden" />
                                            </div>
                                        </div>
                                        <div class="bs table-row col-xs-11 col-sm-2" style="padding:0px !important;">   
                                            <div class="bs col-xs-6 visible-xs table-cell">{!$Label.Policy_No}</div>
                                            <div class="bs col-xs-6 col-sm-12 content-highlight table-cell">{!pWrapper.policyNo}</div>
                                        </div>
                                        <div class="bs table-row col-xs-11 col-xs-offset-1 col-sm-3 col-sm-offset-0" style="padding:0px !important;">    
                                            <div class="bs col-xs-6 visible-xs table-cell">{!$Label.Pol_Product_Name}</div>
                                            <div class="bs col-xs-6 col-sm-12 content-highlight table-cell">{!pWrapper.productName_Display}</div>
                                        </div>
                                        <div class="bs table-row col-xs-11 col-xs-offset-1 col-sm-2 col-sm-offset-0" style="padding:0px !important;">    
                                            <div class="bs col-xs-6 visible-xs table-cell">{!$Label.Policy_Holder_Name}</div>
                                            <div class="bs col-xs-6 col-sm-12 content-highlight table-cell">{!pWrapper.holderName}</div>
                                        </div>
                                        <div class="bs table-row col-xs-11 col-xs-offset-1 col-sm-2 col-sm-offset-0" style="padding:0px !important;">    
                                            <div class="bs col-xs-6 visible-xs table-cell">{!$Label.Status}</div>
                                            <div class="bs col-xs-6 col-sm-12 content-highlight table-cell">{!pWrapper.status_Display}</div>
                                        </div>
                                        <div class="bs table-row col-xs-11 col-xs-offset-1 col-sm-2 col-sm-offset-0" style="padding:0px !important;">   
                                            <div class="bs col-xs-6 visible-xs table-cell">{!$Label.Assigned_Agent}</div>
                                            <div class="bs col-xs-6 col-sm-12 content-highlight table-cell">
                                                <apex:outputText rendered="{!!pWrapper.isCompangCodeEqualsAgentCode}" value="{!pWrapper.assignedAgent}"></apex:outputText>
                                            </div>
                                        </div>
                                     </div>
                                     
                                   </apex:repeat>
                               </apex:outputPanel>
                           </apex:outputPanel>
                           <!-- End of All Policy List -->
                        </apex:outputPanel>
                    </div>
                    
                    
                    
                    <div class="bs col-xs-12 content-highlight cigna-fg-blue-light" style="margin-top:21px;">{!$Label.Step_2}</div>
                
                    <div class="bs col-xs-12">
                        {!$Label.Policy_Assignment_Choose_Agent}
                    </div>
                    
                    <!-- Start of Search Agent to Assign -->
                    <apex:outputPanel layout="block" id="assign-new-agent" html-data-id="assign-new-agent" styleClass="bs cigna-fg-gray-dark col-xs-12">
                        <div class="bs row col-xs-12" style="padding-bottom:15px;">
                            <div class="bs col-sm-12 col-xs-12" style="padding: 20px 0px 20px 0px;">
                                <div class="bs col-sm-6 col-xs-12" style="padding-bottom:20px;">
                                    <apex:selectList value="{!assignAgentSearchType}" size="1" styleClass="bs form-field-style-select cigna-fg-gray-dark">
                                        <apex:selectOption itemValue="" itemLabel="{!$Label.Select_Search_Type}"/>
                                        <apex:selectOption itemValue="{!$Label.Agent_Name}" itemLabel="{!$Label.Agent_Name}"/>
                                        <apex:selectOption itemValue="{!$Label.Agent_Code}" itemLabel="{!$Label.Agent_Code}"/>
                                    </apex:selectList>
                                </div>   
                            
                                <div class="bs col-sm-6 col-xs-12">
                                      <apex:inputText style="font-size:1em; height:35px; width:95%" styleClass="bs form-field-style cigna-fg-gray-dark" value="{!assignAgentSearchText}"/><i class="ci-hk-search cigna-fg-orange-dark text-center onclick-pointer" onclick="assignAgentSearch()" style="width:5%" aria-hidden="true"/>
                                </div>
                            </div> 
                        </div>
                        
                        <apex:actionFunction id="action-function-agent-search" name="assignAgentSearch" action="{!assignAgentSearch}" status="loader-icon" rerender="assign-new-agent" oncomplete="pageJSInit();" />
                        
                        <apex:outputPanel id="agentSearchResultList" rendered="{!showAgentToAssign}"> 
                            <!-- Start of Agent List -->
                            <div id="agent-to-assign-list" style="padding-bottom:20px;">  
                               <div class="bs row listcontent-header" style="{!IF(agentToAssignList.size == 0, 'display:none;', '')}">
                                    <div class="bs col-sm-1 hidden-xs"></div>
                                    <div class="bs col-sm-4 hidden-xs">{!$Label.Agent_Name}</div>
                                    <div class="bs col-sm-3 hidden-xs">{!$Label.Agent_Code}</div>
                                    <div class="bs col-sm-3 hidden-xs">{!$Label.Broker_Account}</div>
                               </div>
                               <div class="bs row listcontent-header" style="{!IF(agentToAssignList.size != 0, 'display:none;', '')}">
                                    <div class="bs col-xs-12 text-center">
                                        <i class="fa fa-smile-o cigna-fg-black" aria-hidden="true"></i>
                                        {!$Label.No_Agent_Found}
                                    </div>
                               </div>
                               <apex:outputPanel id="agent-to-assign-list-panel">
                                   <apex:repeat value="{!agentToAssignList}" var="agent">
                                     <div class="bs row listcontent onclick-pointer" id="assign-agent-div-{!agent.Id}">
                                        <div class="bs table-row col-xs-1 col-sm-1" style="padding:0px !important;">
                                            <div class="bs col-xs-12 col-sm-12 content-highlight table-cell">
                                                <input type="radio" id="select-agent-assign-{!agent.Id}" value="{!agent.Id}" name="select-agent-assign" 
                                                       class="bs cigna-question-radio" onchange="changeSearchSelectType(this);"/> 
                                                <label for="select-agent-assign-{!agent.Id}"></label>
                                            </div>
                                        </div>
                                        <div class="bs table-row col-xs-11 col-sm-4" style="padding:0px !important;">   
                                            <div class="bs col-xs-6 visible-xs table-cell">{!$Label.Agent_Name}</div>
                                            <div class="bs col-xs-6 col-sm-12 content-highlight table-cell">{!agent.Name}</div>
                                        </div>
                                        <div class="bs table-row col-xs-11 col-xs-offset-1 col-sm-3 col-sm-offset-0" style="padding:0px !important;">    
                                            <div class="bs col-xs-6 visible-xs table-cell">{!$Label.Agent_Code}</div>
                                            <div class="bs col-xs-6 col-sm-12 content-highlight table-cell">{!agent.Agent_Code__c}</div>
                                        </div>
                                        <div class="bs table-row col-xs-11 col-xs-offset-1 col-sm-3 col-sm-offset-0" style="padding:0px !important;">    
                                            <div class="bs col-xs-6 visible-xs table-cell">{!$Label.Broker_Account}</div>
                                            <div class="bs col-xs-6 col-sm-12 content-highlight table-cell">{!agent.Account.Name}</div>
                                        </div>
                                     </div>
                                     
                                   </apex:repeat>
                                   
                                   <apex:inputHidden value="{!agentToAssignId}" id="select-agent-assign"  />
                                   <apex:input id="Required-select-agent-assign" styleClass="hidden-input-field" />
                                          
                               </apex:outputPanel>
                           </div>
                           <!-- End of Agent List -->
                        </apex:outputPanel>   
                        
                        <script>
                            //$('input.cigna-question-radio').change(Cigna.PolicyAssignment.onRadioChange);
                        </script>      
                    </apex:outputPanel>
                    <!-- End of Search Agent to Assign -->
                    
                    
                    <!-- Error Message -->
                    <div id="scrollToErrorMessagePanel">
                        <apex:outputPanel id="ErrorMessagePanel" styleClass="bs col-xs-12">
                            <div id="selectPolicyErrorDiv" class="errorDiv" style="display:none;">
                                <label class="cusError" id="selectPolicyErrorMsg" >{!$Label.Please_select_at_least_one_policy}</label>
                            </div>
                            
                            <div id="selectAgentErrorDiv" class="errorDiv" style="display:none;">
                                <label class="cusError" id="selectAgentErrorMsg" >{!$Label.Please_select_at_least_one_agent}</label>  
                            </div>
                            
                            <div id="assignedErrorDiv" class="errorDiv" style="{!IF(isAssignSuccess , 'display:none;', '')}">
                                <label class="cusError" id="assignedErrorMsg" >{!assignErrorMessage}</label>
                            </div>
                            <div class="bs col-sm-12 col-xs-12"><div class="bs col-sm-12 col-xs-12" style="padding-bottom:100px;"/></div>
                        </apex:outputPanel>
                    </div> 
                </div>
                
                
                <div class="bs col-sm-12 col-xs-12">
                
                    <div style="padding:20px;"></div>
                    <!--desktop action button-->
                    <div id="firstbtnsm" class="bs hidden-xs col-sm-4 col-sm-offset-4 cigna-fg-white cigna-bg-orange-dark desktop-action-btn onclick-pointer" onclick="assignActionJS();">
                        {!$Label.Submit}
                    </div>
                        
                    <!--mobile action button-->    
                
                    <div id="mobile-app-padding" class="bs row" style="display: none;">
                        <div class="bs col-xs-12" style="padding-bottom: 100px;"></div>
                    </div>
                    
                   <!-- <div id="action-bar" class="bs visible-xs cigna-floating-bottom-panel" style="left:0px;">
                        <div id="firstbtnxs" class="bs cigna-action-btn-group cigna-fg-white cigna-bg-orange-dark onclick-pointer" onclick="assignActionJS();">
                            <a class="action-btn cigna-fg-white" role="button"><span class="glyphicon glyphicon-edit" aria-hidden="true"></span><br/><span id="firstbtnxstext">{!$Label.Submit}</span></a>
                        </div>
                    </div>-->
                </div>
                
            </div>
            <!-- End of Assignment Tab -->
            
            <!-- Start of History Tab -->
            <div id="history">
                <div class="col-sm-10 col-sm-offset-1 col-xs-12 content-highlight">                    
                    <div class="bs row form-field">
                        <div class="bs col-sm-1 col-xs-2 form-field-text-style">
                            <apex:outputLabel value="{!$Label.From}" />
                        </div>  
                        <div class="bs col-sm-5 col-xs-10">
                            <input type="text" id="GOP-admission-date-format" style="padding-left:0px;padding-right:0px;width:100%;" 
                                             data-date-yyyy-mm-dd="{!fromDate}"
                                             class="form-field-style" data-altField-id="from-date-datepicker-hidden" 
                                             disabled="disabled" readonly="readonly" onfocus="this.blur();" onchange="this.blur();"/>
                            <apex:inputHidden id="from-date-datepicker-hidden" value="{!fromDateValue}" />
                        </div>  
                        
                        <div class="bs col-sm-1 col-xs-2 form-field-text-style">
                            <apex:outputLabel value="{!$Label.To}" />
                        </div> 
                        <div class="bs col-sm-5 col-xs-10">
                            <input type="text" id="GOP-admission-date-format2" style="padding-left:0px;padding-right:0px;width:100%;" 
                                             data-date-yyyy-mm-dd="{!toDate}"
                                             class="form-field-style" data-altField-id="to-date-datepicker-hidden"
                                             disabled="disabled" readonly="readonly" onfocus="this.blur();" onchange="this.blur();" />
                            <apex:inputHidden id="to-date-datepicker-hidden" value="{!toDateValue}" />
                        </div>  
                    </div> 
                    <div class="bs row form-field">
                        <div class="bs col-sm-6 col-xs-12" style="padding-bottom:20px;">
                            <apex:selectList value="{!historySearchType}" size="1" styleClass="bs form-field-style-select cigna-fg-gray-dark">
                                <apex:selectOption itemValue="" itemLabel="{!$Label.Select_Search_Type}"/>
                                <apex:selectOption itemValue="{!$Label.Agent_Name}" itemLabel="{!$Label.Agent_Name}"/>
                                <apex:selectOption itemValue="{!$Label.Agent_Code}" itemLabel="{!$Label.Agent_Code}"/>
                            </apex:selectList>
                        </div>   
                    
                        <div class="bs col-sm-6 col-xs-12">
                              <apex:inputText style="font-size:1em; height:35px; width:95%" styleClass="bs form-field-style cigna-fg-gray-dark" value="{!historySearchText}"/><i class="ci-hk-search cigna-fg-orange-dark text-center onclick-pointer" onclick="historySearch()" style="width:5%" aria-hidden="true"/>
                        </div>
                    </div>                  
                    
                    <apex:actionFunction id="action-function-search-history" name="historySearch" action="{!historySearch}" status="loader-icon" rerender="historySearchResultPanel, historySearchHeaderPanel" oncomplete="pageJSInit();" />
                </div> 
                
                <!-- Start of Search Result -->
                <div id="historySearchResult"> 
                   <apex:outputPanel id="historySearchHeaderPanel">
                       <div class="bs row listcontent-header hidden-xs" style="{!IF(policyAssignmentHistory.size == 0, 'display:none;', '')}">
                            <div class="bs col-sm-2">{!$Label.Assignment_Date}</div>
                            <div class="bs col-sm-2">{!$Label.Policy_No}</div>
                            <div class="bs col-sm-2">{!$Label.Pol_Product_Name}</div>
                            <div class="bs col-sm-2">{!$Label.Status}</div>
                            <div class="bs col-sm-2">{!$Label.Previous_Agent}</div>
                            <div class="bs col-sm-2">{!$Label.Current_Agent}</div>
                       </div>
                       <div class="bs row" style="{!IF(policyAssignmentHistory.size != 0, 'display:none;', '')}">
                            <div class="bs col-xs-12 text-center">
                                <i class="fa fa-smile-o cigna-fg-black" aria-hidden="true"></i>
                                {!$Label.No_policy_assignment_log_found}
                            </div>
                       </div>
                   </apex:outputPanel>
                       
                   <apex:outputPanel id="historySearchResultPanel">
                       <apex:repeat value="{!policyAssignmentHistory}" var="log">
                         <div  class="bs row listcontent">
                            <div class="bs table-row col-xs-12 col-sm-2" style="padding:0px !important;">
                                <div class="bs col-xs-12 col-sm-12 content-highlight table-cell">
                                    <apex:outputText value="{0, date, yyyy/MM/dd}">
                                         <apex:param value="{!log.Assignment_Date__c}"/>
                                    </apex:outputText> 
                                </div>
                            </div>
                            <div class="bs table-row col-xs-12 col-sm-2" style="padding:0px !important;">   
                                <div class="bs col-xs-6 visible-xs table-cell">{!$Label.Policy_No}</div>
                                <div class="bs col-xs-6 col-sm-12 content-highlight table-cell">{!log.Policy_Number__c}</div>
                            </div>
                            <div class="bs table-row col-xs-12 col-sm-2" style="padding:0px !important;">    
                                <div class="bs col-xs-6 visible-xs table-cell">{!$Label.Pol_Product_Name}</div>
                                <div class="bs col-xs-6 col-sm-12 content-highlight table-cell">{!IF(userLanguage == 'en_US', log.Product_Name__c, log.Product_Name_CN__c)}</div>
                            </div>
                            <div class="bs table-row col-xs-12 col-sm-2" style="padding:0px !important;">    
                                <div class="bs col-xs-6 visible-xs table-cell">{!$Label.Status}</div>
                                <div class="bs col-xs-6 col-sm-12 content-highlight table-cell">{!IF(userLanguage == 'en_US', log.Policy_Status__c, log.Policy_Status_CN__c)}</div>
                            </div>
                            <div class="bs table-row col-xs-12 col-sm-2" style="padding:0px !important;">    
                                <div class="bs col-xs-6 visible-xs table-cell">{!$Label.Previous_Agent}</div>
                                <div class="bs col-xs-6 col-sm-12 content-highlight table-cell">{!log.Previous_Agent__r.Name}</div>
                            </div>
                            <div class="bs table-row col-xs-12 col-sm-2" style="padding:0px !important;">   
                                <div class="bs col-xs-6 visible-xs table-cell">{!$Label.Current_Agent}</div>
                                <div class="bs col-xs-6 col-sm-12 content-highlight table-cell">{!log.Current_Agent__r.Name}</div>
                            </div>
                         </div>
                         
                       </apex:repeat>
                   </apex:outputPanel>
               </div>
               <!-- End of Search Result -->
               
            </div>
            <!-- End of History Tab -->
            
            <!-- Start Special Centered Box -->
            <div id="overlay" style="display:none;">
                <div id="specialBox">
                  <a href="#"><div id="closeOverlay" class="glyphicon glyphicon-remove" onclick="toggleOverlay();"></div></a>
                    <h4>Terms and Conditions</h4>
                    <div style="padding-bottom:10px; border-top: 1px solid #f2f2f2;"></div>
                    <div id="tccontent">
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam at porttitor sem.  Aliquam erat volutpat. Donec placerat nisl magna, et faucibus arcu condimentum sed.
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam at porttitor sem.  Aliquam erat volutpat. Donec placerat nisl magna, et faucibus arcu condimentum sed.
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam at porttitor sem.  Aliquam erat volutpat. Donec placerat nisl magna, et faucibus arcu condimentum sed.
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam at porttitor sem.  Aliquam erat volutpat. Donec placerat nisl magna, et faucibus arcu condimentum sed.
                        Lorem ipsum dolor sit amet, consectetur adipiscing elit. Aliquam at porttitor sem.  Aliquam erat volutpat. Donec placerat nisl magna, et faucibus arcu condimentum sed.
                    </div>
                </div>
           </div>
           <!-- End Special Centered Box -->
        </div>
        <!-- End of Assignment Form -->
        
        <!-- Start of Confirmation Page -->
        <div class="bs content-step col-xs-12 form-field" data-step="2" style="display:none; padding-top:20px !important;" id="confirmationPage"> <!--  display:none; -->
            <div class="bs col-xs-12 col-sm-6 col-sm-offset-3">
                <div class="col-xs-12 col-sm-12" style="text-align:center;">
                    <i class="fa fa-check-circle-o content-active" style="font-size:50px;" aria-hidden="true"></i>
                </div>
                <div style="padding-top:70px;text-align:center;"> <!-- class="col-xs-12 col-sm-12"  -->
                    <apex:outputText value="{!$Label.The_requested_assignment_has_been_made}" escape="false" />
                </div>
            </div>  
            <div class="bs col-xs-3 hidden-xs" />
            <div class="bs col-xs-12 ">
                <div style="padding:20px;"></div>
                <!--desktop action button-->
                <div id="confirmbtnsm" class="bs hidden-xs col-sm-4 col-sm-offset-4 cigna-fg-white cigna-bg-orange-dark desktop-action-btn onclick-pointer" onclick="Cigna.Util.navigateToVFP('PolicyAssignmentVFP', null, null, true);">
                    {!$Label.Return_to_Policy_Assignment}
                </div>
                    
                <!--mobile action button-->    
                
                <div id="mobile-app-padding" class="bs row" style="display:none; padding-bottom:100px;">
                    <div class="bs col-xs-12"></div>
                </div>
                
               
                
            </div>
        </div>
        <!-- End of Confirmation Page -->
        
        <apex:actionFunction action="{!assignAction}" name="assignActionApex" status="loader-icon" reRender="ErrorMessagePanel" oncomplete="assignRequestFinish();"/>
        
    </apex:form>       
    </div>
    <script>
        function assignActionJS(){
            if (validateForm()){
                assignActionApex();
            }else{
                if (Cigna.Util.isIOS() && Cigna.Util.isSalesforce1() && Cigna.Util.isBrokerPortal()) {
                    var container = $('div'),
                    scrollTo = $('#scrollToErrorMessagePanel');
                    container.scrollTop(
                        9999
                    );
                    //scrollTo.offset().top - container.offset().top + container.scrollTop()

                }else{
                    $("html, body").animate({ scrollTop: $(document).height() }, "slow");
                }

            }
        }
        
        /** Validation */ 
        function validateForm() {
            if (!checkAtLeastOnePolicy()){
                $('#selectPolicyErrorDiv').show();
            }
            else {
                $('#selectPolicyErrorDiv').hide();
            }
            
            if (!checkAtLeastOneAgent()){
                $('#selectAgentErrorDiv').show();
                
            }
            else {
                $('#selectAgentErrorDiv').hide();
            }
            
            return checkAtLeastOnePolicy() && checkAtLeastOneAgent();
        }
        
        function assignRequestFinish() {
            if("{!isAssignSuccess}" == 'true'){
                $('#assign-step').hide();
                $('#confirmationPage').show();
                $('#confirmbtnxs').show();
                $('#firstbtnxs').hide();
            } else {
                //$('#assignedErrorMsg').text("{!assignErrorMessage}");
                $('#assignedErrorDiv').show();
            }
        }
        
        function checkAtLeastOnePolicy(){
            var pass = false;
            if ($('#select-policy-type-01').is(':checked')){
                $('input[id*="without-agent-select-single"]').each(function(idx, elem){
                    if ($(elem).is(':checked')){
                        pass = true;
                    }
                });
            }
            else if ($('#select-policy-type-02').is(':checked')){
                $('input[id*="specific-agent-select-single"]').each(function(idx, elem){
                    if ($(elem).is(':checked')){
                        pass = true;
                    }
                });
            }
            else if ($('#select-policy-type-03').is(':checked')){
                $('input[id*="all-policy-select"]').each(function(idx, elem){
                    if ($(elem).is(':checked')){
                        pass = true;
                    }
                });
            }
            
            return pass;
        }
        
        function checkAtLeastOneAgent(){
            var pass = false;
            $('input[id*="select-agent-assign-"]').each(function(idx, elem){
                if ($(elem).is(':checked')){
                    pass = true;
                }
            });
            
            return pass;
        }
        
        var Cigna = Cigna || {};
        Cigna.PolicyAssignment = function(){
            function onWithoutAgentChange(evt) { 
                if ($(this).is(':checked')) {
                    $('div[data-id="policy-without-agent"]').show(0);
                    $('div[data-id="policy-specific-agent"]').hide(0);
                    $('div[data-id="policy-all"]').hide(0);
                    
                    $('input:hidden[id$=select-policy-type]').val($(this).val());
                    $('input[id$=Required-select-policy-type]').val('selected');
                    $('#withoutAgentErrorMessage').css('display','none');
                    if({!$Profile.Name != 'Cigna Broker Super Admin'}){
                        $('[id$=withoutAgentPoliciesPanelmsg]').show();
                    	withoutAgentPoliciesSearch(); // auto load when click the option
                    } else {
                    	$('[id$=withoutAgentPoliciesPanelmsg]').hide();    
                    }
                } else {
                    $('div[data-id="policy-without-agent"]').hide(0);
                }
            }

            function onSpecificAgentChange(evt) {
                if ($(this).is(':checked')) {
                    $('div[data-id="policy-without-agent"]').hide(0);
                    $('div[data-id="policy-specific-agent"]').show(0);
                    $('div[data-id="policy-all"]').hide(0);
                    
                    $('input:hidden[id$=select-policy-type]').val($(this).val());
                    $('input[id$=Required-select-policy-type]').val('selected');
                } else {
                    $('div[data-id="policy-specific-agent"]').hide(0);
                }
            }
            
            function onAllPoliciesChange(evt) {
                if ($(this).is(':checked')) {
                    $('div[data-id="policy-without-agent"]').hide(0);
                    $('div[data-id="policy-specific-agent"]').hide(0);
                    $('div[data-id="policy-all"]').show(0);
                    
                    $('input:hidden[id$=select-policy-type]').val($(this).val());
                    $('input[id$=Required-select-policy-type]').val('selected');
                } else {
                    $('div[data-id="policy-all"]').hide(0);
                }
            }
            
            function onRadioChange(evt) {
                var val = $(this).val();
                var parent = $(this).parent();
                $(parent).siblings('input[type="hidden"]').val(val).trigger('change');
                //alert($(parent).siblings('input[type="hidden"]').val());
                
            }
            
            return {
                onWithoutAgentChange : onWithoutAgentChange,
                onSpecificAgentChange : onSpecificAgentChange,
                onAllPoliciesChange : onAllPoliciesChange,
                onRadioChange : onRadioChange
            }
        }();
        
        $(document).ready(function(){
            //CR-56_Link_20220214
            $('#select-policy-type-01').on("change",Cigna.PolicyAssignment.onWithoutAgentChange);
            $('#select-policy-type-02').on("change",Cigna.PolicyAssignment.onSpecificAgentChange);
            $('#select-policy-type-03').on("change",Cigna.PolicyAssignment.onAllPoliciesChange);
            
            $('input.cigna-question-radio').on("change",Cigna.PolicyAssignment.onRadioChange);
            
            //Cigna.PolicyAssignment.onWithoutAgentChange(click);
            initDatePicker();
        });
        
        function setFocusOnLoad() {} // to override the sfdc function that triggers the auto focus on the first input field
        
        function toggleCheckbox() {
            $("div[id*='search-policy-']").off("click.checkbox-div");    //clear the click event listener in the namespace checkbox-div to avoid duplicates
            $("div[id*='search-policy-']").on('click.checkbox-div', function () {
                  uncheckSelectAll($(this).find('input'));
                  
                  if ($(this).find('input.cigna-question-checkbox').is(":checked")) {
                      $(this).find('input.cigna-question-checkbox').prop("checked", false);
                  }
                  else {
                      $(this).find('input.cigna-question-checkbox').prop("checked", true);
                  }
                  
                  //$(this).find('input')[0].click();
                  console.log('before:' + $(this).find('input.cigna-question-checkbox').is(':checked'));
                  
                  if ($(this).find('input.cigna-question-checkbox').is(":checked")) {
                      $(this).find("input[id*='test-hidden']").val('good');
                      //$(this).find('input.cigna-question-checkbox').val('on');
                  }
                  else {
                      $(this).find("input[id*='test-hidden']").val('bad');
                      //$(this).find('input.cigna-question-checkbox').val('off');
                  }
                  
                  console.log('after: ' + $(this).find('input.cigna-question-checkbox').val());
                  
                  //alert($(this).find('input').is(':checked'));
            });
            
            $("div[id*='select-all-label-']").off("click.checkbox-div");   //clear the click event listener in the namespace checkbox-div to avoid duplicates
            $("div[id*='select-all-label-']").on('click.checkbox-div', function () {
                  $(this).siblings().find('input').each(function(idx, elem){
                        /**
                        if ($(elem).is(':checked')){
                            $(elem).prop('checked', false);
                        }
                        else {
                            $(elem).prop('checked', true);
                        }
                        */
                        //CR-56_Link_20220214
                        $(elem).trigger("click");
                        selectAll($(elem));
                    });
            });

            //Add By Owen,For Pi86
            $("div[id*='select-all-check-']").off("click.checkbox-div");   //clear the click event listener in the namespace checkbox-div to avoid duplicates
            $("div[id*='select-all-check-']").on('click.checkbox-div', function () {
                //console.log($(this).find('input.cigna-question-checkbox').attr('id'));
                if ($(this).find('input.cigna-question-checkbox').is(":checked")){
                    $("div[id*='search-policy-']").find("input[id*='test-hidden']").each(function(idx, elem){
                        //console.log($(elem).val());
                        $(elem).val('good');
                        // console.log($(elem).attr('id'));
                        // console.log($(elem).val());
                    });
                }else{
                    $("div[id*='search-policy-']").find("input[id*='test-hidden']").each(function(idx, elem){
                        //console.log($(elem).attr('id'));
                        $(elem).val('bad');
                        // console.log($(elem).val());
                    });
                }
            });
        }
        
        function toggleRadio() {
            $("div[id*='assign-agent-div-']").off("click.radio-div");    //clear the click event listener in the namespace checkbox-div to avoid duplicates
            $("div[id*='assign-agent-div-']").on('click.radio-div', function () {
                  /**
                  if ($(this).find('input').is(":checked")) {
                      $(this).find('input').prop("checked", false);
                  }
                  else {
                      $(this).find('input').prop("checked", true);
                      
                  }
                  */
                  $(this).find('input')[0].click();
                  changeSearchSelectType($(this).find('input')[0]);
            });
        }
        
        function pageJSInit() {
            toggleCheckbox();
            toggleRadio();
            styleTableRowColor();
            
        }
        
        function changeSearchSelectType(select){
            
            var buttonName = select.name;
            var selectValue = $(select).val();
            if ($(select).is(':checked')){
                $('input:hidden[id$=' + buttonName + ']').val(selectValue);
                //alert($('input:hidden[id$=' + buttonName + ']').val());
                //for validation
                $('input[id$= Required-' + buttonName + ']').val('selected');
            }
        }
        
        function initDatePicker(){
            Cigna.DatepickerUtil.init("input[id*='-date-format']");
        }
        
    </script>
</apex:page>