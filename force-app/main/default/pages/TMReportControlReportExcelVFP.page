<apex:page controller="TMReportControlReportCtrl" contentType="txt/xml#ControlReport.xls" cache="true" readOnly="true" id="TMReportControlReportExcelVFP">
<apex:outputText value="{!xlsHeader}"/>
    <Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet"
    xmlns:o="urn:schemas-microsoft-com:office:office"
    xmlns:x="urn:schemas-microsoft-com:office:excel"
    xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"
    xmlns:html="http://www.w3.org/TR/REC-html40">
  <Styles>
  <Style ss:ID="Default" ss:Name="Normal">
   <Alignment ss:Vertical="Bottom"/>
   <Borders/>
   <Font ss:FontName="Calibri" x:Family="Swiss" ss:Size="11" ss:Color="#000000"/>
   <Interior/>
   <NumberFormat/>
   <Protection/>
  </Style>
  <Style ss:ID="m123">
   <Alignment ss:Horizontal="Center" ss:Vertical="Top" ss:ReadingOrder="LeftToRight"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
   </Borders>
   <Font ss:FontName="Arial" x:Family="Swiss" ss:Size="9" ss:Color="#000000"/>
   <Interior/>
   <NumberFormat/>
  </Style>

<Style ss:ID="s62">
   <Borders/>
   <Font ss:FontName="Calibri" x:Family="Swiss" ss:Size="11"/>
   <Interior/>
  </Style>
  <Style ss:ID="s64">
   <Alignment ss:Vertical="Top" ss:ReadingOrder="LeftToRight" ss:WrapText="1"/>
   <Borders/>
   <Font ss:FontName="Verdana" x:Family="Swiss" ss:Size="9" ss:Color="#000000"/>
   <Interior/>
   <NumberFormat/>
  </Style>
  <Style ss:ID="s75">
   <Alignment ss:Vertical="Top" ss:ReadingOrder="LeftToRight" ss:WrapText="1"/>
   <Borders/>
   <Font ss:FontName="Arial" x:Family="Swiss" ss:Color="#FF0000"/>
   <Interior/>
   <NumberFormat/>
  </Style>
  <Style ss:ID="s90">
   <Alignment ss:Horizontal="Left" ss:Vertical="Top" ss:ReadingOrder="LeftToRight" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
   </Borders>
   <Font ss:FontName="Arial" x:Family="Swiss" ss:Size="9" ss:Color="#000000"/>
   <Interior/>
   <NumberFormat/>
  </Style>
  <Style ss:ID="s118">
   <Alignment ss:Horizontal="Left" ss:Vertical="Top" ss:ReadingOrder="LeftToRight" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
   </Borders>
   <Font ss:FontName="Arial" x:Family="Swiss" ss:Size="9" ss:Color="#000000" ss:Bold="1"/>
   <Interior/>
   <NumberFormat/>
  </Style>
  <Style ss:ID="s150">
   <Alignment ss:Vertical="Top" ss:ReadingOrder="LeftToRight" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
   </Borders>
   <Font ss:FontName="Arial" x:Family="Swiss" ss:Size="9" ss:Color="#000000" ss:Bold="1"/>
   <Interior ss:Color="#D3D3D3" ss:Pattern="Solid"/>
   <NumberFormat/>
  </Style>
  <Style ss:ID="s204">
   <Alignment ss:Horizontal="Left" ss:Vertical="Top" ss:ReadingOrder="LeftToRight" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
   </Borders>
   <Font ss:FontName="Arial" x:Family="Swiss" ss:Size="9" ss:Color="#000000"  ss:Bold="1"/>
   <Interior ss:Color="#D3D3D3" ss:Pattern="Solid"/>
   <NumberFormat/>
  </Style>
  <Style ss:ID="s205">
   <Alignment ss:Horizontal="Left" ss:Vertical="Top" ss:ReadingOrder="LeftToRight" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
   </Borders>
   <Font ss:FontName="Arial" x:Family="Swiss" ss:Size="9" ss:Color="#000000" ss:Bold="1"/>
   <Interior ss:Color="#D3D3D3" ss:Pattern="Solid"/>
   <NumberFormat/>
  </Style>
  <Style ss:ID="s219">
   <Alignment ss:Horizontal="Center" ss:Vertical="Top"
    ss:ReadingOrder="LeftToRight" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Bottom" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
    <Border ss:Position="Left" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
    <Border ss:Position="Right" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
   </Borders>
   <Font ss:FontName="Arial" x:Family="Swiss" ss:Size="9" ss:Color="#000000"
    ss:Bold="1"/>
   <Interior ss:Color="#D3D3D3" ss:Pattern="Solid"/>
   <NumberFormat/>
  </Style>
  <Style ss:ID="s227">
   <Alignment ss:Vertical="Top" ss:ReadingOrder="LeftToRight" ss:WrapText="1"/>
   <Borders>
    <Border ss:Position="Top" ss:LineStyle="Continuous" ss:Weight="1" ss:Color="#000000"/>
   </Borders>
   <Font ss:FontName="Arial" x:Family="Swiss" ss:Size="7" ss:Color="#000000" ss:Bold="1"/>
   <Interior/>
   <NumberFormat/>
  </Style>
  <Style ss:ID="s229">
   <Alignment ss:Vertical="Top" ss:ReadingOrder="LeftToRight" ss:WrapText="1"/>
   <Borders/>
   <Font ss:FontName="Arial" x:Family="Swiss" ss:Size="7" ss:Color="#000000" ss:Bold="1"/>
   <Interior/>
   <NumberFormat/>
  </Style>
 </Styles>
 
 <Worksheet ss:Name="Sheet1">
   
  <Table ss:ExpandedColumnCount="60"  x:FullColumns="1"
   x:FullRows="1" ss:StyleID="s62" ss:DefaultRowHeight="14.55">

    <Row ss:AutoFitHeight="0">
    	<Cell ss:StyleID="Default"><Data ss:Type="String">Policy Count</Data></Cell>
    </Row>
    <apex:repeat var="drow" value="{!distribution}">
    	<Row ss:AutoFitHeight="0" ss:Height="18"> 
    	<Cell ss:MergeAcross="2" ss:StyleID="m123"><Data ss:Type="String">{!drow.status}</Data></Cell>
    	<Cell ss:StyleID="m123"><Data ss:Type="String">{!drow.ct}</Data></Cell>
    	</Row>
 	</apex:repeat>

    <Row ss:AutoFitHeight="0" ss:Height="18"> 
    	<Cell ss:MergeAcross="2"  ss:StyleID="m123"><Data ss:Type="String">Total</Data></Cell>
    	<Cell ss:StyleID="m123"><Data ss:Type="String">{!rowData.size}</Data></Cell>
    </Row>
    
    <Row ss:AutoFitHeight="0"></Row>

    <Row ss:AutoFitHeight="0">
	    <Cell ss:Index="1" ss:MergeAcross="2"  ss:StyleID="Default"><Data
	      ss:Type="String">Print Date:  <apex:outputText value="{0,date,yyyy-MM-dd}">
	        <apex:Param value="{!Now()}"/>
	    </apex:outputText></Data></Cell>
   </Row>
   <Row ss:AutoFitHeight="0" ss:Height="18">
   	<Cell ss:StyleID="m123"><Data ss:Type="String"></Data></Cell>
   	<Cell ss:StyleID="m123"><Data ss:Type="String">License</Data></Cell>
   	<Cell ss:StyleID="m123"><Data ss:Type="String">Pol No.</Data></Cell>
   	<Cell ss:StyleID="m123"><Data ss:Type="String">Plan Code</Data></Cell>
   	<Cell ss:StyleID="m123"><Data ss:Type="String">UW Overall Result</Data></Cell>
   	<Cell ss:StyleID="m123"><Data ss:Type="String">Aml High Risk</Data></Cell>
   	<Cell ss:StyleID="m123"><Data ss:Type="String">Efft Date</Data></Cell>
   	<Cell ss:StyleID="m123"><Data ss:Type="String">Order Date</Data></Cell>
   	<Cell ss:StyleID="m123"><Data ss:Type="String">PH ID</Data></Cell>
   	<Cell ss:StyleID="m123"><Data ss:Type="String">PH Name</Data></Cell>
   	<Cell ss:StyleID="m123"><Data ss:Type="String">PH Addr vs Call List</Data></Cell>
   	<Cell ss:StyleID="m123"><Data ss:Type="String">MI ID</Data></Cell>
   	<Cell ss:StyleID="m123"><Data ss:Type="String">MI Name</Data></Cell>
   	<Cell ss:StyleID="m123"><Data ss:Type="String">Maturity policy number</Data></Cell>
   	 
   </Row>
   <apex:variable var="ind" value="{!1}" />
    <apex:repeat var="row" value="{!rowData}">
    	<apex:variable var="pol" value="{!row.policy}" />
    		<apex:outputPanel layout="none" rendered="{!pol.Person_Insureds__r !=null && pol.Person_Insureds__r.size>0}">
	    		<apex:repeat var="pi" value="{!pol.Person_Insureds__r}">
		    	<Row ss:AutoFitHeight="0" ss:Height="18">
		    		<Cell ss:StyleID="m123"><Data ss:Type="String">{!ind}</Data></Cell>
			   		<Cell ss:StyleID="m123"><Data ss:Type="String">{!pol.Product__r.License__c}</Data></Cell>
			   		<Cell ss:StyleID="m123"><Data ss:Type="String">{!pol.Policy_No__c}</Data></Cell>
			   		<Cell ss:StyleID="m123"><Data ss:Type="String">{!pol.Plan_code__c}</Data></Cell>
			   		<Cell ss:StyleID="m123"><Data ss:Type="String">{!pol.UW_Overrall_Result__c}</Data></Cell>
			   		<Cell ss:StyleID="m123"><Data ss:Type="String">{!pol.AML_High_Risk_Ind__c}</Data></Cell>
			   		<Cell ss:StyleID="m123"><Data ss:Type="String"> <apex:outputText value="{0,date,yyyy-MM-dd}">
				        <apex:Param value="{!pol.Policy_Effective_Date__c}"/>
				    </apex:outputText></Data></Cell>
				    <Cell ss:StyleID="m123"><Data ss:Type="String"> <apex:outputText value="{0,date,yyyy-MM-dd}">
				        <apex:Param value="{!pol.Submission_Date_Time__c}"/>
				    </apex:outputText></Data></Cell>
			   		<Cell ss:StyleID="m123"><Data ss:Type="String">{!pol.Personal_ID__c}</Data></Cell>
			   		<Cell ss:StyleID="m123"><Data ss:Type="String">{!pol.Policy_Holder_Name__c}</Data></Cell>
					<Cell ss:StyleID="m123"><Data ss:Type="String">{!pol.PH_Address_vs_Call_List__c}</Data></Cell>
					<Cell ss:StyleID="m123"><Data ss:Type="String">{!pi.Personal_ID__c}</Data></Cell>
					<Cell ss:StyleID="m123"><Data ss:Type="String">{!pi.Person_Insured_Name__c}</Data></Cell>
					<Cell ss:StyleID="m123"><Data ss:Type="String">{!pol.Account__r.Maturity_Policy_Number__c}</Data></Cell> 
			   	</Row>
			   </apex:repeat>
			</apex:outputPanel>
			<apex:outputPanel layout="none" rendered="{!pol.Person_Insureds__r.size=0}">	    		 
		    	<Row ss:AutoFitHeight="0" ss:Height="18">
		    		<Cell ss:StyleID="m123"><Data ss:Type="String">{!ind}</Data></Cell>
			   		<Cell ss:StyleID="m123"><Data ss:Type="String">{!pol.Product__r.License__c}</Data></Cell>
			   		<Cell ss:StyleID="m123"><Data ss:Type="String">{!pol.Policy_No__c}</Data></Cell>
			   		<Cell ss:StyleID="m123"><Data ss:Type="String">{!pol.Plan_code__c}</Data></Cell>
			   		<Cell ss:StyleID="m123"><Data ss:Type="String">{!pol.UW_Overrall_Result__c}</Data></Cell>
			   		<Cell ss:StyleID="m123"><Data ss:Type="String">{!pol.AML_High_Risk_Ind__c}</Data></Cell>
			   		<Cell ss:StyleID="m123"><Data ss:Type="String"> <apex:outputText value="{0,date,yyyy-MM-dd}">
				        <apex:Param value="{!pol.Policy_Effective_Date__c}"/>
				    </apex:outputText></Data></Cell>
				    <Cell ss:StyleID="m123"><Data ss:Type="String"> <apex:outputText value="{0,date,yyyy-MM-dd}">
				        <apex:Param value="{!pol.Submission_Date_Time__c}"/>
				    </apex:outputText></Data></Cell>
			   		<Cell ss:StyleID="m123"><Data ss:Type="String">{!pol.personal_id__c}</Data></Cell>
			   		<Cell ss:StyleID="m123"><Data ss:Type="String">{!pol.Policy_Holder_Name__c}</Data></Cell>
					<Cell ss:StyleID="m123"><Data ss:Type="String">{!pol.PH_Address_vs_Call_List__c}</Data></Cell>
					<Cell ss:StyleID="m123"><Data ss:Type="String"></Data></Cell>
					<Cell ss:StyleID="m123"><Data ss:Type="String"></Data></Cell>
					<Cell ss:StyleID="m123"><Data ss:Type="String">{!pol.Account__r.Maturity_Policy_Number__c}</Data></Cell> 
			   	</Row>
			</apex:outputPanel>
	   <apex:variable var="ind" value="{!ind+1}" />
 	</apex:repeat>

    </Table>
                                                            
 </Worksheet>
 
</Workbook>
</apex:page>